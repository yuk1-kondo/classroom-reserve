/*! For license information please see main.503f9fbd.js.LICENSE.txt */
(()=>{"use strict";var e={32:(e,t,n)=>{n.r(t),n.d(t,{AbstractUserDataWriter:()=>Lg,AggregateField:()=>Dp,AggregateQuerySnapshot:()=>Ap,Bytes:()=>kp,CACHE_SIZE_UNLIMITED:()=>dp,CollectionReference:()=>np,DocumentReference:()=>ep,DocumentSnapshot:()=>$g,FieldPath:()=>Np,FieldValue:()=>Mp,Firestore:()=>hp,FirestoreError:()=>Xr,GeoPoint:()=>Op,LoadBundleTask:()=>up,Query:()=>tp,QueryCompositeFilterConstraint:()=>mg,QueryConstraint:()=>hg,QueryDocumentSnapshot:()=>Gg,QueryEndAtConstraint:()=>Ig,QueryFieldFilterConstraint:()=>pg,QueryLimitConstraint:()=>Sg,QueryOrderByConstraint:()=>bg,QuerySnapshot:()=>Wg,QueryStartAtConstraint:()=>Cg,SnapshotMetadata:()=>qg,Timestamp:()=>fi,Transaction:()=>Dm,WriteBatch:()=>Tm,_DatabaseId:()=>Gs,_DocumentKey:()=>bi,_EmptyAppCheckTokenProvider:()=>ai,_EmptyAuthCredentialsProvider:()=>ei,_FieldPath:()=>yi,_TestingHooks:()=>ml,_cast:()=>Kf,_debugAssert:()=>Qr,_isBase64Available:()=>Ls,_logWarn:()=>qr,_validateIsNotUsedTogether:()=>$f,addDoc:()=>om,aggregateFieldEqual:()=>Vg,aggregateQuerySnapshotEqual:()=>Hg,and:()=>yg,arrayRemove:()=>Mm,arrayUnion:()=>Rm,average:()=>Bg,clearIndexedDbPersistence:()=>wp,collection:()=>rp,collectionGroup:()=>ip,connectFirestoreEmulator:()=>Zf,count:()=>zg,deleteDoc:()=>sm,deleteField:()=>km,disableNetwork:()=>_p,doc:()=>sp,documentId:()=>Rp,enableIndexedDbPersistence:()=>vp,enableMultiTabIndexedDbPersistence:()=>yp,enableNetwork:()=>Ep,endAt:()=>Ag,endBefore:()=>Dg,ensureFirestoreConfigured:()=>gp,executeWrite:()=>cm,getAggregateFromServer:()=>hm,getCountFromServer:()=>dm,getDoc:()=>Yg,getDocFromCache:()=>Jg,getDocFromServer:()=>Zg,getDocs:()=>em,getDocsFromCache:()=>tm,getDocsFromServer:()=>nm,getFirestore:()=>pp,increment:()=>Om,initializeFirestore:()=>fp,limit:()=>Eg,limitToLast:()=>_g,loadBundle:()=>xp,memoryEagerGarbageCollector:()=>vm,memoryLocalCache:()=>bm,memoryLruGarbageCollector:()=>ym,namedQuery:()=>Tp,onSnapshot:()=>am,onSnapshotsInSync:()=>lm,or:()=>vg,orderBy:()=>wg,persistentLocalCache:()=>wm,persistentMultipleTabManager:()=>Cm,persistentSingleTabManager:()=>_m,query:()=>fg,queryEqual:()=>ap,refEqual:()=>op,runTransaction:()=>Am,serverTimestamp:()=>Nm,setDoc:()=>rm,setIndexConfiguration:()=>Lm,setLogLevel:()=>zr,snapshotEqual:()=>Kg,startAfter:()=>Tg,startAt:()=>xg,sum:()=>Ug,terminate:()=>Cp,updateDoc:()=>im,waitForPendingWrites:()=>Sp,where:()=>gg,writeBatch:()=>Pm});var r,i=n(150),a=n(812),u=n(443),f=n(700),v="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},y={},b=b||{},w=v||self;function S(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function E(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var _="closure_uid_"+(1e9*Math.random()>>>0),C=0;function x(e,t,n){return e.call.apply(e.bind,arguments)}function T(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function I(e,t,n){return(I=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?x:T).apply(null,arguments)}function D(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function A(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function k(){this.s=this.s,this.o=this.o}k.prototype.s=!1,k.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function(e){Object.prototype.hasOwnProperty.call(e,_)&&e[_]||(e[_]=++C)}(this)},k.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const N=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function R(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function M(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(S(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function O(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!w.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{w.addEventListener("test",()=>{},t),w.removeEventListener("test",()=>{},t)}catch(d){}return e}();function L(e){return/^[\s\xa0]*$/.test(e)}function j(){var e=w.navigator;return e&&(e=e.userAgent)?e:""}function F(e){return-1!=j().indexOf(e)}function U(e){return U[" "](e),e}U[" "]=function(){};var B,z,V=F("Opera"),H=F("Trident")||F("MSIE"),q=F("Edge"),$=q||H,G=F("Gecko")&&!(-1!=j().toLowerCase().indexOf("webkit")&&!F("Edge"))&&!(F("Trident")||F("MSIE"))&&!F("Edge"),W=-1!=j().toLowerCase().indexOf("webkit")&&!F("Edge");function Q(){var e=w.document;return e?e.documentMode:void 0}e:{var K="",Y=function(){var e=j();return G?/rv:([^\);]+)(\)|;)/.exec(e):q?/Edge\/([\d\.]+)/.exec(e):H?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):W?/WebKit\/(\S+)/.exec(e):V?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Y&&(K=Y?Y[1]:""),H){var X=Q();if(null!=X&&X>parseFloat(K)){B=String(X);break e}}B=K}if(w.document&&H){var J=Q();z=J||(parseInt(B,10)||void 0)}else z=void 0;var Z=z;function ee(e,t){if(O.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(G){e:{try{U(t.nodeName);var i=!0;break e}catch(m){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:te[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ee.$.h.call(this)}}A(ee,O);var te={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),re=0;function ie(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++re,this.fa=this.ia=!1}function se(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function oe(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function ae(e){const t={};for(const n in e)t[n]=e[n];return t}const le="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ce(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<le.length;t++)n=le[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ue(e){this.src=e,this.g={},this.h=0}function de(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=N(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(se(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function he(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}ue.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=he(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new ie(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var fe="closure_lm_"+(1e6*Math.random()|0),pe={};function ge(e,t,n,r,i){if(r&&r.once)return ve(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)ge(e,t[s],n,r,i);return null}return n=Ce(n),e&&e[ne]?e.O(t,n,E(r)?!!r.capture:!!r,i):me(e,t,n,!1,r,i)}function me(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=E(i)?!!i.capture:!!i,a=Ee(e);if(a||(e[fe]=a=new ue(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Se;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)P||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(we(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ve(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ve(e,t[s],n,r,i);return null}return n=Ce(n),e&&e[ne]?e.P(t,n,E(r)?!!r.capture:!!r,i):me(e,t,n,!0,r,i)}function ye(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)ye(e,t[s],n,r,i);else r=E(r)?!!r.capture:!!r,n=Ce(n),e&&e[ne]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=he(s=e.g[t],n,r,i))&&(se(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Ee(e))&&(t=e.g[t.toString()],e=-1,t&&(e=he(t,n,r,i)),(n=-1<e?t[e]:null)&&be(n))}function be(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[ne])de(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(we(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ee(t))?(de(n,e),0==n.h&&(n.src=null,t[fe]=null)):se(e)}}}function we(e){return e in pe?pe[e]:pe[e]="on"+e}function Se(e,t){if(e.fa)e=!0;else{t=new ee(t,this);var n=e.listener,r=e.la||e.src;e.ia&&be(e),e=n.call(r,t)}return e}function Ee(e){return(e=e[fe])instanceof ue?e:null}var _e="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ce(e){return"function"===typeof e?e:(e[_e]||(e[_e]=function(t){return e.handleEvent(t)}),e[_e])}function xe(){k.call(this),this.i=new ue(this),this.S=this,this.J=null}function Te(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new O(t,e);else if(t instanceof O)t.target=t.target||e;else{var i=t;ce(t=new O(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Ie(o,r,!0,t)&&i}if(i=Ie(o=t.g=e,r,!0,t)&&i,i=Ie(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Ie(o=t.g=n[s],r,!1,t)&&i}function Ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&de(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}A(xe,k),xe.prototype[ne]=!0,xe.prototype.removeEventListener=function(e,t,n,r){ye(this,e,t,n,r)},xe.prototype.N=function(){if(xe.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)se(n[r]);delete t.g[e],t.h--}}this.J=null},xe.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},xe.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var De=w.JSON.stringify;function Ae(){var e=Le;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var ke=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Ne,e=>e.reset());class Ne{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Re(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Me(e){w.setTimeout(()=>{throw e},0)}let Oe,Pe=!1,Le=new class{constructor(){this.h=this.g=null}add(e,t){const n=ke.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},je=()=>{const e=w.Promise.resolve(void 0);Oe=()=>{e.then(Fe)}};var Fe=()=>{for(var e;e=Ae();){try{e.h.call(e.g)}catch(d){Me(d)}var t=ke;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Pe=!1};function Ue(e,t){xe.call(this),this.h=e||1,this.g=t||w,this.j=I(this.qb,this),this.l=Date.now()}function Be(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function ze(e,t,n){if("function"===typeof e)n&&(e=I(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=I(e.handleEvent,e)}return 2147483647<Number(t)?-1:w.setTimeout(e,t||0)}function Ve(e){e.g=ze(()=>{e.g=null,e.i&&(e.i=!1,Ve(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}A(Ue,xe),(r=Ue.prototype).ga=!1,r.T=null,r.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Te(this,"tick"),this.ga&&(Be(this),this.start()))}},r.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},r.N=function(){Ue.$.N.call(this),Be(this),delete this.g};class He extends k{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ve(this)}N(){super.N(),this.g&&(w.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qe(e){k.call(this),this.h=e,this.g={}}A(qe,k);var $e=[];function Ge(e,t,n,r){Array.isArray(n)||(n&&($e[0]=n.toString()),n=$e);for(var i=0;i<n.length;i++){var s=ge(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function We(e){oe(e.g,function(e,t){this.g.hasOwnProperty(t)&&be(e)},e),e.g={}}function Qe(){this.g=!0}function Ke(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return De(n)}catch(c){return t}}(e,n)+(r?" "+r:"")})}qe.prototype.N=function(){qe.$.N.call(this),We(this)},qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qe.prototype.Ea=function(){this.g=!1},Qe.prototype.info=function(){};var Ye={},Xe=null;function Je(){return Xe=Xe||new xe}function Ze(e){O.call(this,Ye.Ta,e)}function et(e){const t=Je();Te(t,new Ze(t))}function tt(e,t){O.call(this,Ye.STAT_EVENT,e),this.stat=t}function nt(e){const t=Je();Te(t,new tt(t,e))}function rt(e,t){O.call(this,Ye.Ua,e),this.size=t}function it(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return w.setTimeout(function(){e()},t)}Ye.Ta="serverreachability",A(Ze,O),Ye.STAT_EVENT="statevent",A(tt,O),Ye.Ua="timingevent",A(rt,O);var st={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ot={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function at(){}function lt(e){return e.h||(e.h=e.i())}function ct(){}at.prototype.h=null;var ut,dt={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ht(){O.call(this,"d")}function ft(){O.call(this,"c")}function pt(){}function gt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new qe(this),this.P=vt,e=$?125:void 0,this.V=new Ue(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new mt}function mt(){this.i=null,this.g="",this.h=!1}A(ht,O),A(ft,O),A(pt,at),pt.prototype.g=function(){return new XMLHttpRequest},pt.prototype.i=function(){return{}},ut=new pt;var vt=45e3,yt={},bt={};function wt(e,t,n){e.L=1,e.v=Ut(Ot(t)),e.s=n,e.S=!0,St(e,null)}function St(e,t){e.G=Date.now(),xt(e),e.A=Ot(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),Jt(n.i,"t",r),e.C=0,n=e.l.J,e.h=new mt,e.g=Zn(e.l,n?t:null,!e.s),0<e.O&&(e.M=new He(I(e.Pa,e,e.g),e.O)),Ge(e.U,e.g,"readystatechange",e.nb),t=e.I?ae(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),et(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&"type"==d[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.W,e.s)}function Et(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function _t(e,t,n){let r,i=!0;for(;!e.J&&e.C<n.length;){if(r=Ct(e,n),r==bt){4==t&&(e.o=4,nt(14),i=!1),Ke(e.j,e.m,null,"[Incomplete Response]");break}if(r==yt){e.o=4,nt(15),Ke(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ke(e.j,e.m,r,null),kt(e,r)}Et(e)&&r!=bt&&r!=yt&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,nt(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),$n(t),t.M=!0,nt(11))):(Ke(e.j,e.m,n,"[Invalid Chunked Response]"),At(e),Dt(e))}function Ct(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?bt:(n=Number(t.substring(n,r)),isNaN(n)?yt:(r+=1)+n>t.length?bt:(t=t.slice(r,r+n),e.C=r+n,t))}function xt(e){e.Y=Date.now()+e.P,Tt(e,e.P)}function Tt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=it(I(e.lb,e),t)}function It(e){e.B&&(w.clearTimeout(e.B),e.B=null)}function Dt(e){0==e.l.H||e.J||Qn(e.l,e)}function At(e){It(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Be(e.V),We(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function kt(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||on(n.i,e)))if(!e.K&&on(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(c){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Wn(n),jn(n)}qn(n),nt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=it(I(n.ib,n),6e3));if(1>=sn(n.i)&&n.oa){try{n.oa()}catch(c){}n.oa=void 0}}else Yn(n,11)}else if((e.K||n.g==e)&&Wn(n),!L(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const t=c[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=c[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(an(s,s.h),s.h=null))}if(r.F){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,Ft(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((r=n).wa=Jn(r,r.J?r.pa:null,r.Y),o.K){ln(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(It(a),xt(a)),r.g=o}else Hn(r);0<n.j.length&&Un(n)}else"stop"!=c[0]&&"close"!=c[0]||Yn(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?Yn(n,7):Ln(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}et()}catch(c){}}function Nt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(S(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(S(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(S(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(r=gt.prototype).setTimeout=function(e){this.P=e},r.nb=function(e){e=e.target;const t=this.M;t&&3==kn(e)?t.l():this.Pa(e)},r.Pa=function(e){try{if(e==this.g)e:{const u=kn(this.g);var t=this.g.Ia();this.g.da();if(!(3>u)&&(3!=u||$||this.g&&(this.h.h||this.g.ja()||Nn(this.g)))){this.J||4!=u||7==t||et(),It(this);var n=this.g.da();this.ca=n;t:if(Et(this)){var r=Nn(this.g);e="";var i=r.length,s=4==kn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){At(this),Dt(this);var o="";break t}this.h.i=new w.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(a)){var c=a;break t}}c=null}if(!(n=c)){this.i=!1,this.o=3,nt(12),At(this),Dt(this);break e}Ke(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,kt(this,n)}this.S?(_t(this,u,o),$&&this.i&&3==u&&(Ge(this.U,this.V,"tick",this.mb),this.V.start())):(Ke(this.j,this.m,o,null),kt(this,o)),4==u&&At(this),this.i&&!this.J&&(4==u?Qn(this.l,this):(this.i=!1,xt(this)))}else(function(e){const t={};e=(e.g&&2<=kn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(L(e[r]))continue;var n=Re(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,nt(12)):(this.o=0,nt(13)),At(this),Dt(this)}}}catch(p){}},r.mb=function(){if(this.g){var e=kn(this.g),t=this.g.ja();this.C<t.length&&(It(this),_t(this,e,t),this.i&&4!=e&&xt(this))}},r.cancel=function(){this.J=!0,At(this)},r.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.L&&(et(),nt(17)),At(this),this.o=2,Dt(this)):Tt(this,this.Y-e)};var Rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mt(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Mt){this.h=e.h,Pt(this,e.j),this.s=e.s,this.g=e.g,Lt(this,e.m),this.l=e.l;var t=e.i,n=new Qt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),jt(this,n),this.o=e.o}else e&&(t=String(e).match(Rt))?(this.h=!1,Pt(this,t[1]||"",!0),this.s=Bt(t[2]||""),this.g=Bt(t[3]||"",!0),Lt(this,t[4]),this.l=Bt(t[5]||"",!0),jt(this,t[6]||"",!0),this.o=Bt(t[7]||"")):(this.h=!1,this.i=new Qt(null,this.h))}function Ot(e){return new Mt(e)}function Pt(e,t,n){e.j=n?Bt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function jt(e,t,n){t instanceof Qt?(e.i=t,function(e,t){t&&!e.j&&(Kt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Yt(this,t),Jt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=zt(t,Gt)),e.i=new Qt(t,e.h))}function Ft(e,t,n){e.i.set(t,n)}function Ut(e){return Ft(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Bt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function zt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Vt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Vt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Mt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(zt(t,Ht,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(zt(t,Ht,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(zt(n,"/"==n.charAt(0)?$t:qt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",zt(n,Wt)),e.join("")};var Ht=/[#\/\?@]/g,qt=/[#\?:]/g,$t=/[#\?]/g,Gt=/[#\?@]/g,Wt=/#/g;function Qt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Kt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Yt(e,t){Kt(e),t=Zt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Xt(e,t){return Kt(e),t=Zt(e,t),e.g.has(t)}function Jt(e,t,n){Yt(e,t),0<n.length&&(e.i=null,e.g.set(Zt(e,t),R(n)),e.h+=n.length)}function Zt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(r=Qt.prototype).add=function(e,t){Kt(this),this.i=null,e=Zt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},r.forEach=function(e,t){Kt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},r.ta=function(){Kt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},r.Z=function(e){Kt(this);let t=[];if("string"===typeof e)Xt(this,e)&&(t=t.concat(this.g.get(Zt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},r.set=function(e,t){return Kt(this),this.i=null,Xt(this,e=Zt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},r.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var en=class{constructor(e,t){this.g=e,this.map=t}};function tn(e){this.l=e||nn,w.PerformanceNavigationTiming?e=0<(e=w.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(w.g&&w.g.Ka&&w.g.Ka()&&w.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var nn=10;function rn(e){return!!e.h||!!e.g&&e.g.size>=e.j}function sn(e){return e.h?1:e.g?e.g.size:0}function on(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function an(e,t){e.g?e.g.add(t):e.h=t}function ln(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function cn(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return R(e.i)}tn.prototype.cancel=function(){if(this.i=cn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var un=class{stringify(e){return w.JSON.stringify(e,void 0)}parse(e){return w.JSON.parse(e,void 0)}};function dn(){this.g=new un}function hn(e,t,n){const r=n||"";try{Nt(e,function(e,n){let i=e;E(e)&&(i=De(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function fn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(m){}}function pn(e){this.l=e.fc||null,this.j=e.ob||!1}function gn(e,t){xe.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=mn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}A(pn,at),pn.prototype.g=function(){return new gn(this.l,this.j)},pn.prototype.i=function(e){return function(){return e}}({}),A(gn,xe);var mn=0;function vn(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function yn(e){e.readyState=4,e.l=null,e.j=null,e.A=null,bn(e)}function bn(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(r=gn.prototype).open=function(e,t){if(this.readyState!=mn)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,bn(this)},r.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||w).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},r.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,yn(this)),this.readyState=mn},r.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,bn(this)),this.g&&(this.readyState=3,bn(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof w.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vn(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},r.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?yn(this):bn(this),3==this.readyState&&vn(this)}},r.Za=function(e){this.g&&(this.response=this.responseText=e,yn(this))},r.Ya=function(e){this.g&&(this.response=e,yn(this))},r.ka=function(){this.g&&yn(this)},r.setRequestHeader=function(e,t){this.v.append(e,t)},r.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(gn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var wn=w.JSON.parse;function Sn(e){xe.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=En,this.L=this.M=!1}A(Sn,xe);var En="",_n=/^https?$/i,Cn=["POST","PUT"];function xn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Tn(e),Dn(e)}function Tn(e){e.F||(e.F=!0,Te(e,"complete"),Te(e,"error"))}function In(e){if(e.h&&"undefined"!=typeof b&&(!e.C[1]||4!=kn(e)||2!=e.da()))if(e.v&&4==kn(e))ze(e.La,0,e);else if(Te(e,"readystatechange"),4==kn(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===o){var i=String(e.I).match(Rt)[1]||null;!i&&w.self&&w.self.location&&(i=w.self.location.protocol.slice(0,-1)),r=!_n.test(i?i.toLowerCase():"")}n=r}if(n)Te(e,"complete"),Te(e,"success");else{e.m=6;try{var s=2<kn(e)?e.g.statusText:""}catch(c){s=""}e.j=s+" ["+e.da()+"]",Tn(e)}}finally{Dn(e)}}}function Dn(e,t){if(e.g){An(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Te(e,"ready");try{n.onreadystatechange=r}catch(s){}}}function An(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(w.clearTimeout(e.A),e.A=null)}function kn(e){return e.g?e.g.readyState:0}function Nn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case En:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Lr){return null}}function Rn(e){let t="";return oe(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Mn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Rn(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Ft(e,t,n))}function On(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Pn(e){this.Ga=0,this.j=[],this.l=new Qe,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=On("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=On("baseRetryDelayMs",5e3,e),this.hb=On("retryDelaySeedMs",1e4,e),this.eb=On("forwardChannelMaxRetries",2,e),this.xa=On("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new tn(e&&e.concurrentRequestLimit),this.Ja=new dn,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Ln(e){if(Fn(e),3==e.H){var t=e.W++,n=Ot(e.I);if(Ft(n,"SID",e.K),Ft(n,"RID",t),Ft(n,"TYPE","terminate"),zn(e,n),(t=new gt(e,e.l,t)).L=2,t.v=Ut(Ot(n)),n=!1,w.navigator&&w.navigator.sendBeacon)try{n=w.navigator.sendBeacon(t.v.toString(),"")}catch(g){}!n&&w.Image&&((new Image).src=t.v,n=!0),n||(t.g=Zn(t.l,null),t.g.ha(t.v)),t.G=Date.now(),xt(t)}Xn(e)}function jn(e){e.g&&($n(e),e.g.cancel(),e.g=null)}function Fn(e){jn(e),e.u&&(w.clearTimeout(e.u),e.u=null),Wn(e),e.i.cancel(),e.m&&("number"===typeof e.m&&w.clearTimeout(e.m),e.m=null)}function Un(e){if(!rn(e.i)&&!e.m){e.m=!0;var t=e.Na;Oe||je(),Pe||(Oe(),Pe=!0),Le.add(t,e),e.C=0}}function Bn(e,t){var n;n=t?t.m:e.W++;const r=Ot(e.I);Ft(r,"SID",e.K),Ft(r,"RID",n),Ft(r,"AID",e.V),zn(e,r),e.o&&e.s&&Mn(r,e.o,e.s),n=new gt(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Vn(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),an(e.i,n),wt(n,r,t)}function zn(e,t){e.na&&oe(e.na,function(e,n){Ft(t,n,e)}),e.h&&Nt({},function(e,n){Ft(t,n,e)})}function Vn(e,t,n){n=Math.min(e.j.length,n);var r=e.h?I(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{hn(a,e,"req"+n+"_")}catch(Kr){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function Hn(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Oe||je(),Pe||(Oe(),Pe=!0),Le.add(t,e),e.A=0}}function qn(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=it(I(e.Ma,e),Kn(e,e.A)),e.A++,!0)}function $n(e){null!=e.B&&(w.clearTimeout(e.B),e.B=null)}function Gn(e){e.g=new gt(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Ot(e.wa);Ft(t,"RID","rpc"),Ft(t,"SID",e.K),Ft(t,"AID",e.V),Ft(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Ft(t,"TO",e.qa),Ft(t,"TYPE","xmlhttp"),zn(e,t),e.o&&e.s&&Mn(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Ut(Ot(t)),n.s=null,n.S=!0,St(n,e)}function Wn(e){null!=e.v&&(w.clearTimeout(e.v),e.v=null)}function Qn(e,t){var n=null;if(e.g==t){Wn(e),$n(e),e.g=null;var r=2}else{if(!on(e.i,t))return;n=t.F,ln(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;Te(r=Je(),new rt(r,n)),Un(e)}else Hn(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(sn(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=it(I(e.Na,e,t),Kn(e,e.C)),e.C++,!0))}(e,t)||2==r&&qn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Yn(e,5);break;case 4:Yn(e,10);break;case 3:Yn(e,6);break;default:Yn(e,2)}}function Kn(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Yn(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=I(e.pb,e);n||(n=new Mt("//www.google.com/images/cleardot.gif"),w.location&&"http"==w.location.protocol||Pt(n,"https"),Ut(n)),function(e,t){const n=new Qe;if(w.Image){const r=new Image;r.onload=D(fn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=D(fn,n,r,"TestLoadImage: error",!1,t),r.onabort=D(fn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=D(fn,n,r,"TestLoadImage: timeout",!1,t),w.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else nt(2);e.H=0,e.h&&e.h.za(t),Xn(e),Fn(e)}function Xn(e){if(e.H=0,e.ma=[],e.h){const t=cn(e.i);0==t.length&&0==e.j.length||(M(e.ma,t),M(e.ma,e.j),e.i.i.length=0,R(e.j),e.j.length=0),e.h.ya()}}function Jn(e,t,n){var r=n instanceof Mt?Ot(n):new Mt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Lt(r,r.m);else{var i=w.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Mt(null);r&&Pt(s,r),t&&(s.g=t),i&&Lt(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&Ft(r,n,t),Ft(r,"VER",e.ra),zn(e,r),r}function Zn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new Sn(new pn({ob:!0})):new Sn(e.va)).Oa(e.J),t}function er(){}function tr(){if(H&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function nr(e,t){xe.call(this),this.g=new Pn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!L(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!L(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new sr(this)}function rr(e){ht.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ir(){ft.call(this),this.status=1}function sr(e){this.g=e}function or(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ar(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function lr(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(r=Sn.prototype).Oa=function(e){this.M=e},r.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ut.g(),this.C=this.u?lt(this.u):lt(ut),this.g.onreadystatechange=I(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(m){return void xn(this,m)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=w.FormData&&e instanceof w.FormData,!(0<=N(Cn,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{An(this),0<this.B&&((this.L=function(e){return H&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=I(this.ua,this)):this.A=ze(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(m){xn(this,m)}},r.ua=function(){"undefined"!=typeof b&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Te(this,"timeout"),this.abort(8))},r.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Te(this,"complete"),Te(this,"abort"),Dn(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Dn(this,!0)),Sn.$.N.call(this)},r.La=function(){this.s||(this.G||this.v||this.l?In(this):this.kb())},r.kb=function(){In(this)},r.isActive=function(){return!!this.g},r.da=function(){try{return 2<kn(this)?this.g.status:-1}catch(l){return-1}},r.ja=function(){try{return this.g?this.g.responseText:""}catch(l){return""}},r.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),wn(t)}},r.Ia=function(){return this.m},r.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(r=Pn.prototype).ra=8,r.H=1,r.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new gt(this,this.l,e);let s=this.s;if(this.U&&(s?(s=ae(s),ce(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Vn(this,i,t),Ft(n=Ot(this.I),"RID",e),Ft(n,"CVER",22),this.F&&Ft(n,"X-HTTP-Session-Id",this.F),zn(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Rn(s)))+"&"+t:this.o&&Mn(n,this.o,s)),an(this.i,i),this.bb&&Ft(n,"TYPE","init"),this.P?(Ft(n,"$req",t),Ft(n,"SID","null"),i.aa=!0,wt(i,n,null)):wt(i,n,t),this.H=2}}else 3==this.H&&(e?Bn(this,e):0==this.j.length||rn(this.i)||Bn(this))},r.Ma=function(){if(this.u=null,Gn(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=it(I(this.jb,this),e)}},r.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,nt(10),jn(this),Gn(this))},r.ib=function(){null!=this.v&&(this.v=null,jn(this),qn(this),nt(19))},r.pb=function(e){e?(this.l.info("Successfully pinged google.com"),nt(2)):(this.l.info("Failed to ping google.com"),nt(1))},r.isActive=function(){return!!this.h&&this.h.isActive(this)},(r=er.prototype).Ba=function(){},r.Aa=function(){},r.za=function(){},r.ya=function(){},r.isActive=function(){return!0},r.Va=function(){},tr.prototype.g=function(e,t){return new nr(e,t)},A(nr,xe),nr.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;nt(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Jn(e,null,e.Y),Un(e)},nr.prototype.close=function(){Ln(this.g)},nr.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=De(e),e=n);t.j.push(new en(t.fb++,e)),3==t.H&&Un(t)},nr.prototype.N=function(){this.g.h=null,delete this.j,Ln(this.g),delete this.g,nr.$.N.call(this)},A(rr,ht),A(ir,ft),A(sr,er),sr.prototype.Ba=function(){Te(this.g,"a")},sr.prototype.Aa=function(e){Te(this.g,new rr(e))},sr.prototype.za=function(e){Te(this.g,new ir)},sr.prototype.ya=function(){Te(this.g,"b")},A(or,function(){this.blockSize=-1}),or.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},or.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)ar(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){ar(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){ar(this,r),i=0;break}}this.h=i,this.i+=t},or.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var cr={};function ur(e){return-128<=e&&128>e?function(e,t){var n=cr;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new lr([0|e],0>e?-1:0)}):new lr([0|e],0>e?-1:0)}function dr(e){if(isNaN(e)||!isFinite(e))return fr;if(0>e)return yr(dr(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=hr;return new lr(t,0)}var hr=4294967296,fr=ur(0),pr=ur(1),gr=ur(16777216);function mr(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function vr(e){return-1==e.h}function yr(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new lr(n,~e.h).add(pr)}function br(e,t){return e.add(yr(t))}function wr(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Sr(e,t){this.g=e,this.h=t}function Er(e,t){if(mr(t))throw Error("division by zero");if(mr(e))return new Sr(fr,fr);if(vr(e))return t=Er(yr(e),t),new Sr(yr(t.g),yr(t.h));if(vr(t))return t=Er(e,yr(t)),new Sr(yr(t.g),t.h);if(30<e.g.length){if(vr(e)||vr(t))throw Error("slowDivide_ only works with positive integers.");for(var n=pr,r=t;0>=r.X(e);)n=_r(n),r=_r(r);var i=Cr(n,1),s=Cr(r,1);for(r=Cr(r,2),n=Cr(n,2);!mr(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=Cr(r,1),n=Cr(n,1)}return t=br(e,i.R(t)),new Sr(i,t)}for(i=fr;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=dr(n)).R(t);vr(o)||0<o.X(e);)o=(s=dr(n-=r)).R(t);mr(s)&&(s=pr),i=i.add(s),e=br(e,o)}return new Sr(i,e)}function _r(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new lr(n,e.h)}function Cr(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new lr(i,e.h)}(r=lr.prototype).ea=function(){if(vr(this))return-yr(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:hr+r)*t,t*=hr}return e},r.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(mr(this))return"0";if(vr(this))return"-"+yr(this).toString(e);for(var t=dr(Math.pow(e,6)),n=this,r="";;){var i=Er(n,t).g,s=((0<(n=br(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(mr(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},r.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},r.X=function(e){return vr(e=br(this,e))?-1:mr(e)?0:1},r.abs=function(){return vr(this)?yr(this):this},r.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new lr(n,-2147483648&n[n.length-1]?-1:0)},r.R=function(e){if(mr(this)||mr(e))return fr;if(vr(this))return vr(e)?yr(this).R(yr(e)):yr(yr(this).R(e));if(vr(e))return yr(this.R(yr(e)));if(0>this.X(gr)&&0>e.X(gr))return dr(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=e.D(i)>>>16,l=65535&e.D(i);n[2*r+2*i]+=o*l,wr(n,2*r+2*i),n[2*r+2*i+1]+=s*l,wr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,wr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,wr(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new lr(n,0)},r.gb=function(e){return Er(this,e).h},r.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new lr(n,this.h&e.h)},r.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new lr(n,this.h|e.h)},r.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new lr(n,this.h^e.h)},tr.prototype.createWebChannel=tr.prototype.g,nr.prototype.send=nr.prototype.u,nr.prototype.open=nr.prototype.m,nr.prototype.close=nr.prototype.close,st.NO_ERROR=0,st.TIMEOUT=8,st.HTTP_ERROR=6,ot.COMPLETE="complete",ct.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",xe.prototype.listen=xe.prototype.O,Sn.prototype.listenOnce=Sn.prototype.P,Sn.prototype.getLastError=Sn.prototype.Sa,Sn.prototype.getLastErrorCode=Sn.prototype.Ia,Sn.prototype.getStatus=Sn.prototype.da,Sn.prototype.getResponseJson=Sn.prototype.Wa,Sn.prototype.getResponseText=Sn.prototype.ja,Sn.prototype.send=Sn.prototype.ha,Sn.prototype.setWithCredentials=Sn.prototype.Oa,or.prototype.digest=or.prototype.l,or.prototype.reset=or.prototype.reset,or.prototype.update=or.prototype.j,lr.prototype.add=lr.prototype.add,lr.prototype.multiply=lr.prototype.R,lr.prototype.modulo=lr.prototype.gb,lr.prototype.compare=lr.prototype.X,lr.prototype.toNumber=lr.prototype.ea,lr.prototype.toString=lr.prototype.toString,lr.prototype.getBits=lr.prototype.D,lr.fromNumber=dr,lr.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return yr(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=dr(Math.pow(n,8)),i=fr,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=dr(Math.pow(n,o)),i=i.R(o).add(dr(a))):i=(i=i.R(r)).add(dr(a))}return i};var xr=y.createWebChannelTransport=function(){return new tr},Tr=y.getStatEventTarget=function(){return Je()},Ir=y.ErrorCode=st,Dr=y.EventType=ot,Ar=y.Event=Ye,kr=y.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Nr=y.FetchXmlHttpFactory=pn,Rr=y.WebChannel=ct,Mr=y.XhrIo=Sn,Or=y.Md5=or,Pr=y.Integer=lr;const Lr="@firebase/firestore";class jr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jr.UNAUTHENTICATED=new jr(null),jr.GOOGLE_CREDENTIALS=new jr("google-credentials-uid"),jr.FIRST_PARTY=new jr("first-party-uid"),jr.MOCK_USER=new jr("mock-user");let Fr="9.23.0";const Ur=new u.Vy("@firebase/firestore");function Br(){return Ur.logLevel}function zr(e){Ur.setLogLevel(e)}function Vr(e){if(Ur.logLevel<=u.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map($r);Ur.debug(`Firestore (${Fr}): ${e}`,...i)}}function Hr(e){if(Ur.logLevel<=u.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map($r);Ur.error(`Firestore (${Fr}): ${e}`,...i)}}function qr(e){if(Ur.logLevel<=u.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map($r);Ur.warn(`Firestore (${Fr}): ${e}`,...i)}}function $r(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Gr(){const e=`FIRESTORE (${Fr}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw Hr(e),new Error(e)}function Wr(e,t){e||Gr()}function Qr(e,t){e||Gr()}function Kr(e,t){return e}const Yr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xr extends f.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Jr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Zr{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ei{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(jr.UNAUTHENTICATED))}shutdown(){}}class ti{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ni{constructor(e){this.t=e,this.currentUser=jr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Jr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Jr,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{Vr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Vr("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Jr)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Vr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Wr("string"==typeof t.accessToken),new Zr(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Wr(null===e||"string"==typeof e),new jr(e)}}class ri{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=jr.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class ii{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new ri(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(jr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class si{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oi{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&Vr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,Vr("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Vr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?r(e):Vr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Wr("string"==typeof e.token),this.T=e.token,new si(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class ai{getToken(){return Promise.resolve(new si(""))}invalidateToken(){}start(e,t){}shutdown(){}}function li(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class ci{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=li(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function ui(e,t){return e<t?-1:e>t?1:0}function di(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function hi(e){return e+"\0"}class fi{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Xr(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Xr(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Xr(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xr(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return fi.fromMillis(Date.now())}static fromDate(e){return fi.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new fi(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ui(this.nanoseconds,e.nanoseconds):ui(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class pi{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pi(e)}static min(){return new pi(new fi(0,0))}static max(){return new pi(new fi(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class gi{constructor(e,t,n){void 0===t?t=0:t>e.length&&Gr(),void 0===n?n=e.length-t:n>e.length-t&&Gr(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===gi.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof gi?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class mi extends gi{construct(e,t,n){return new mi(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Xr(Yr.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(e=>e.length>0))}return new mi(e)}static emptyPath(){return new mi([])}}const vi=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yi extends gi{construct(e,t,n){return new yi(e,t,n)}static isValidIdentifier(e){return vi.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yi.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new yi(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Xr(Yr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Xr(Yr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Xr(Yr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Xr(Yr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yi(t)}static emptyPath(){return new yi([])}}class bi{constructor(e){this.path=e}static fromPath(e){return new bi(mi.fromString(e))}static fromName(e){return new bi(mi.fromString(e).popFirst(5))}static empty(){return new bi(mi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===mi.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return mi.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new bi(new mi(e.slice()))}}class wi{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function Si(e){return e.fields.find(e=>2===e.kind)}function Ei(e){return e.fields.filter(e=>2!==e.kind)}function _i(e,t){let n=ui(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(n=xi(e.fields[r],t.fields[r]),0!==n)return n;return ui(e.fields.length,t.fields.length)}wi.UNKNOWN_ID=-1;class Ci{constructor(e,t){this.fieldPath=e,this.kind=t}}function xi(e,t){const n=yi.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:ui(e.kind,t.kind)}class Ti{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ti(0,Ai.min())}}function Ii(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=pi.fromTimestamp(1e9===r?new fi(n+1,0):new fi(n,r));return new Ai(i,bi.empty(),t)}function Di(e){return new Ai(e.readTime,e.key,-1)}class Ai{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ai(pi.min(),bi.empty(),-1)}static max(){return new Ai(pi.max(),bi.empty(),-1)}}function ki(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=bi.comparator(e.documentKey,t.documentKey),0!==n?n:ui(e.largestBatchId,t.largestBatchId))}const Ni="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ri{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Mi(e){if(e.code!==Yr.FAILED_PRECONDITION||e.message!==Ni)throw e;Vr("LocalStore","Unexpectedly lost primary lease")}class Oi{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Gr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Oi((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Oi?t:Oi.resolve(t)}catch(e){return Oi.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Oi.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Oi.reject(t)}static resolve(e){return new Oi((t,n)=>{t(e)})}static reject(e){return new Oi((t,n)=>{n(e)})}static waitFor(e){return new Oi((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Oi.resolve(!1);for(const n of e)t=t.next(e=>e?Oi.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Oi((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Oi((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}class Pi{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new Jr,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new Fi(e,t.error)):this.v.resolve()},this.transaction.onerror=t=>{const n=Hi(t.target.error);this.v.reject(new Fi(e,n))}}static open(e,t,n,r){try{return new Pi(t,e.transaction(r,n))}catch(e){throw new Fi(t,e)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(Vr("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Bi(t)}}class Li{constructor(e,t,n){this.name=e,this.version=t,this.V=n,12.2===Li.S((0,f.ZQ)())&&Hr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Vr("SimpleDb","Removing database:",e),zi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,f.zW)())return!1;if(Li.C())return!0;const e=(0,f.ZQ)(),t=Li.S(e),n=0<t&&t<10,r=Li.N(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static N(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async $(e){return this.db||(Vr("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Fi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Xr(Yr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Xr(Yr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Fi(e,r))},r.onupgradeneeded=e=>{Vr("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.V.O(t,r.transaction,e.oldVersion,this.version).next(()=>{Vr("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.F&&(this.db.onversionchange=e=>this.F(e)),this.db}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.$(e);const t=Pi.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.P(),e)).catch(e=>(t.abort(e),Oi.reject(e))).toPromise();return s.catch(()=>{}),await t.R,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(Vr("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class ji{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return zi(this.L.delete())}}class Fi extends Xr{constructor(e,t){super(Yr.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ui(e){return"IndexedDbTransactionError"===e.name}class Bi{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Vr("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Vr("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),zi(n)}add(e){return Vr("SimpleDb","ADD",this.store.name,e,e),zi(this.store.add(e))}get(e){return zi(this.store.get(e)).next(t=>(void 0===t&&(t=null),Vr("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Vr("SimpleDb","DELETE",this.store.name,e),zi(this.store.delete(e))}count(){return Vr("SimpleDb","COUNT",this.store.name),zi(this.store.count())}j(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const e=this.cursor(n),t=[];return this.W(e,(e,n)=>{t.push(n)}).next(()=>t)}{const e=this.store.getAll(n.range);return new Oi((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Oi((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}J(e,t){Vr("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.W(r,(e,t,n)=>n.delete())}X(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.W(r,t)}Z(e){const t=this.cursor({});return new Oi((n,r)=>{t.onerror=e=>{const t=Hi(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}W(e,t){const n=[];return new Oi((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new ji(i),o=t(i.primaryKey,i.value,s);if(o instanceof Oi){const e=o.catch(e=>(s.done(),Oi.reject(e)));n.push(e)}s.isDone?r():null===s.K?i.continue():i.continue(s.K)}}).next(()=>Oi.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function zi(e){return new Oi((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Hi(e.target.error);n(t)}})}let Vi=!1;function Hi(e){const t=Li.S((0,f.ZQ)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Xr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Vi||(Vi=!0,setTimeout(()=>{throw e},0)),e}}return e}class qi{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){Vr("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Vr("IndexBackiller",`Documents written: ${await this.tt.nt()}`)}catch(e){Ui(e)?Vr("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e):await Mi(e)}await this.et(6e4)})}}class $i{constructor(e,t){this.localStore=e,this.persistence=t}async nt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.st(t,e))}st(e,t){const n=new Set;let r=t,i=!0;return Oi.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return Vr("IndexBackiller",`Processing collection: ${t}`),this.it(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}it(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.rt(r,n)).next(n=>(Vr("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}rt(e,t){let n=e;return t.changes.forEach((e,t)=>{const r=Di(t);ki(r,n)>0&&(n=r)}),new Ai(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Gi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function Wi(e){return null==e}function Qi(e){return 0===e&&1/e==-1/0}function Ki(e){return"number"==typeof e&&Number.isInteger(e)&&!Qi(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function Yi(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ji(t)),t=Xi(e.get(n),t);return Ji(t)}function Xi(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=t}}return n}function Ji(e){return e+"\x01\x01"}function Zi(e){const t=e.length;if(Wr(t>=2),2===t)return Wr("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),mi.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("\x01",s);switch((t<0||t>n)&&Gr(),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:Gr()}s=t+2}return new mi(r)}Gi.ct=-1;const es=["userId","batchId"];function ts(e,t){return[e,Yi(t)]}function ns(e,t,n){return[e,Yi(t),n]}const rs={},is=["prefixPath","collectionGroup","readTime","documentId"],ss=["prefixPath","collectionGroup","documentId"],os=["collectionGroup","readTime","prefixPath","documentId"],as=["canonicalId","targetId"],ls=["targetId","path"],cs=["path","targetId"],us=["collectionId","parent"],ds=["indexId","uid"],hs=["uid","sequenceNumber"],fs=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ps=["indexId","uid","orderedDocumentKey"],gs=["userId","collectionPath","documentId"],ms=["userId","collectionPath","largestBatchId"],vs=["userId","collectionGroup","largestBatchId"],ys=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],bs=[...ys,"documentOverlays"],ws=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ss=ws,Es=[...Ss,"indexConfiguration","indexState","indexEntries"];class _s extends Ri{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}}function Cs(e,t){const n=Kr(e);return Li.M(n.ht,t)}function xs(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ts(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Is(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ds{constructor(e,t){this.comparator=e,this.root=t||ks.EMPTY}insert(e,t){return new Ds(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ks.BLACK,null,null))}remove(e){return new Ds(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ks.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new As(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new As(this.root,e,this.comparator,!1)}getReverseIterator(){return new As(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new As(this.root,e,this.comparator,!0)}}class As{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ks{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ks.RED,this.left=null!=r?r:ks.EMPTY,this.right=null!=i?i:ks.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new ks(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ks.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ks.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ks.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ks.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Gr();if(this.right.isRed())throw Gr();const e=this.left.check();if(e!==this.right.check())throw Gr();return e+(this.isRed()?0:1)}}ks.EMPTY=null,ks.RED=!0,ks.BLACK=!1,ks.EMPTY=new class{constructor(){this.size=0}get key(){throw Gr()}get value(){throw Gr()}get color(){throw Gr()}get left(){throw Gr()}get right(){throw Gr()}copy(e,t,n,r,i){return this}insert(e,t,n){return new ks(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ns{constructor(e){this.comparator=e,this.data=new Ds(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Rs(this.data.getIterator())}getIteratorFrom(e){return new Rs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Ns))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ns(this.comparator);return t.data=e,t}}class Rs{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ms(e){return e.hasNext()?e.getNext():void 0}class Os{constructor(e){this.fields=e,e.sort(yi.comparator)}static empty(){return new Os([])}unionWith(e){let t=new Ns(yi.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Os(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return di(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Ps extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function Ls(){return"undefined"!=typeof atob}class js{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ps("Invalid base64 string: "+e):e}}(e);return new js(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new js(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ui(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}js.EMPTY_BYTE_STRING=new js("");const Fs=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Us(e){if(Wr(!!e),"string"==typeof e){let t=0;const n=Fs.exec(e);if(Wr(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Bs(e.seconds),nanos:Bs(e.nanos)}}function Bs(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function zs(e){return"string"==typeof e?js.fromBase64String(e):js.fromUint8Array(e)}function Vs(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Hs(e){const t=e.mapValue.fields.__previous_value__;return Vs(t)?Hs(t):t}function qs(e){const t=Us(e.mapValue.fields.__local_write_time__.timestampValue);return new fi(t.seconds,t.nanos)}class $s{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class Gs{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Gs("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Gs&&e.projectId===this.projectId&&e.database===this.database}}const Ws={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Qs={nullValue:"NULL_VALUE"};function Ks(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Vs(e)?4:uo(e)?9007199254740991:10:Gr()}function Ys(e,t){if(e===t)return!0;const n=Ks(e);if(n!==Ks(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return qs(e).isEqual(qs(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Us(e.timestampValue),r=Us(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return zs(e.bytesValue).isEqual(zs(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Bs(e.geoPointValue.latitude)===Bs(t.geoPointValue.latitude)&&Bs(e.geoPointValue.longitude)===Bs(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Bs(e.integerValue)===Bs(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Bs(e.doubleValue),r=Bs(t.doubleValue);return n===r?Qi(n)===Qi(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return di(e.arrayValue.values||[],t.arrayValue.values||[],Ys);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(xs(n)!==xs(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ys(n[i],r[i])))return!1;return!0}(e,t);default:return Gr()}}function Xs(e,t){return void 0!==(e.values||[]).find(e=>Ys(e,t))}function Js(e,t){if(e===t)return 0;const n=Ks(e),r=Ks(t);if(n!==r)return ui(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ui(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Bs(e.integerValue||e.doubleValue),r=Bs(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Zs(e.timestampValue,t.timestampValue);case 4:return Zs(qs(e),qs(t));case 5:return ui(e.stringValue,t.stringValue);case 6:return function(e,t){const n=zs(e),r=zs(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=ui(n[i],r[i]);if(0!==e)return e}return ui(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=ui(Bs(e.latitude),Bs(t.latitude));return 0!==n?n:ui(Bs(e.longitude),Bs(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Js(n[i],r[i]);if(e)return e}return ui(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Ws.mapValue&&t===Ws.mapValue)return 0;if(e===Ws.mapValue)return 1;if(t===Ws.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=ui(r[o],s[o]);if(0!==e)return e;const t=Js(n[r[o]],i[s[o]]);if(0!==t)return t}return ui(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Gr()}}function Zs(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ui(e,t);const n=Us(e),r=Us(t),i=ui(n.seconds,r.seconds);return 0!==i?i:ui(n.nanos,r.nanos)}function eo(e){return to(e)}function to(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Us(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?zs(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,bi.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=to(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${to(e.fields[i])}`;return n+"}"}(e.mapValue):Gr();var t,n}function no(e){switch(Ks(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Hs(e);return t?16+no(t):16;case 5:return 2*e.stringValue.length;case 6:return zs(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce((e,t)=>e+no(t),0);case 10:return function(e){let t=0;return Ts(e.fields,(e,n)=>{t+=e.length+no(n)}),t}(e.mapValue);default:throw Gr()}}function ro(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function io(e){return!!e&&"integerValue"in e}function so(e){return!!e&&"arrayValue"in e}function oo(e){return!!e&&"nullValue"in e}function ao(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function lo(e){return!!e&&"mapValue"in e}function co(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ts(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=co(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=co(e.arrayValue.values[n]);return t}return Object.assign({},e)}function uo(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function ho(e){return"nullValue"in e?Qs:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?ro(Gs.empty(),bi.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Gr()}function fo(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?ro(Gs.empty(),bi.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?Ws:Gr()}function po(e,t){const n=Js(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function go(e,t){const n=Js(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class mo{constructor(e){this.value=e}static empty(){return new mo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!lo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=co(t)}setAll(e){let t=yi.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=co(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());lo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ys(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];lo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ts(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new mo(co(this.value))}}function vo(e){const t=[];return Ts(e.fields,(e,n)=>{const r=new yi([e]);if(lo(n)){const e=vo(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Os(t)}class yo{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new yo(e,0,pi.min(),pi.min(),pi.min(),mo.empty(),0)}static newFoundDocument(e,t,n,r){return new yo(e,1,t,pi.min(),n,r,0)}static newNoDocument(e,t){return new yo(e,2,t,pi.min(),pi.min(),mo.empty(),0)}static newUnknownDocument(e,t){return new yo(e,3,t,pi.min(),pi.min(),mo.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(pi.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=mo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=mo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pi.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof yo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class bo{constructor(e,t){this.position=e,this.inclusive=t}}function wo(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?bi.comparator(bi.fromName(o.referenceValue),n.key):Js(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function So(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ys(e.position[n],t.position[n]))return!1;return!0}class Eo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function _o(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Co{}class xo extends Co{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Po(e,t,n):"array-contains"===t?new Uo(e,n):"in"===t?new Bo(e,n):"not-in"===t?new zo(e,n):"array-contains-any"===t?new Vo(e,n):new xo(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Lo(e,n):new jo(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Js(t,this.value)):null!==t&&Ks(this.value)===Ks(t)&&this.matchesComparison(Js(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Gr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class To extends Co{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new To(e,t)}matches(e){return Io(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(e=>e.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Io(e){return"and"===e.op}function Do(e){return"or"===e.op}function Ao(e){return ko(e)&&Io(e)}function ko(e){for(const t of e.filters)if(t instanceof To)return!1;return!0}function No(e){if(e instanceof xo)return e.field.canonicalString()+e.op.toString()+eo(e.value);if(Ao(e))return e.filters.map(e=>No(e)).join(",");{const t=e.filters.map(e=>No(e)).join(",");return`${e.op}(${t})`}}function Ro(e,t){return e instanceof xo?function(e,t){return t instanceof xo&&e.op===t.op&&e.field.isEqual(t.field)&&Ys(e.value,t.value)}(e,t):e instanceof To?function(e,t){return t instanceof To&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Ro(n,t.filters[r]),!0)}(e,t):void Gr()}function Mo(e,t){const n=e.filters.concat(t);return To.create(n,e.op)}function Oo(e){return e instanceof xo?function(e){return`${e.field.canonicalString()} ${e.op} ${eo(e.value)}`}(e):e instanceof To?function(e){return e.op.toString()+" {"+e.getFilters().map(Oo).join(" ,")+"}"}(e):"Filter"}class Po extends xo{constructor(e,t,n){super(e,t,n),this.key=bi.fromName(n.referenceValue)}matches(e){const t=bi.comparator(e.key,this.key);return this.matchesComparison(t)}}class Lo extends xo{constructor(e,t){super(e,"in",t),this.keys=Fo("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class jo extends xo{constructor(e,t){super(e,"not-in",t),this.keys=Fo("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Fo(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>bi.fromName(e.referenceValue))}class Uo extends xo{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return so(t)&&Xs(t.arrayValue,this.value)}}class Bo extends xo{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Xs(this.value.arrayValue,t)}}class zo extends xo{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Xs(this.value.arrayValue,t)}}class Vo extends xo{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!so(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Xs(this.value.arrayValue,e))}}class Ho{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.dt=null}}function qo(e){return new Ho(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function $o(e){const t=Kr(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>No(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Wi(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>eo(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>eo(e)).join(",")),t.dt=e}return t.dt}function Go(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!_o(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Ro(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!So(e.startAt,t.startAt)&&So(e.endAt,t.endAt)}function Wo(e){return bi.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Qo(e,t){return e.filters.filter(e=>e instanceof xo&&e.field.isEqual(t))}function Ko(e,t,n){let r=Qs,i=!0;for(const s of Qo(e,t)){let e=Qs,t=!0;switch(s.op){case"<":case"<=":e=ho(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=Qs}po({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];po({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function Yo(e,t,n){let r=Ws,i=!0;for(const s of Qo(e,t)){let e=Ws,t=!0;switch(s.op){case">=":case">":e=fo(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=Ws}go({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];go({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Xo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function Jo(e,t,n,r,i,s,o,a){return new Xo(e,t,n,r,i,s,o,a)}function Zo(e){return new Xo(e)}function ea(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ta(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function na(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function ra(e){return null!==e.collectionGroup}function ia(e){const t=Kr(e);if(null===t.wt){t.wt=[];const e=na(t),n=ta(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new Eo(e)),t.wt.push(new Eo(yi.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new Eo(yi.keyField(),e))}}}return t.wt}function sa(e){const t=Kr(e);if(!t._t)if("F"===t.limitType)t._t=qo(t.path,t.collectionGroup,ia(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of ia(t)){const t="desc"===i.dir?"asc":"desc";e.push(new Eo(i.field,t))}const n=t.endAt?new bo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new bo(t.startAt.position,t.startAt.inclusive):null;t._t=qo(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t._t}function oa(e,t){t.getFirstInequalityField(),na(e);const n=e.filters.concat([t]);return new Xo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function aa(e,t,n){return new Xo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function la(e,t){return Go(sa(e),sa(t))&&e.limitType===t.limitType}function ca(e){return`${$o(sa(e))}|lt:${e.limitType}`}function ua(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Oo(e)).join(", ")}]`),Wi(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>eo(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>eo(e)).join(",")),`Target(${t})`}(sa(e))}; limitType=${e.limitType})`}function da(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):bi.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ia(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=wo(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,ia(e),t))&&!(e.endAt&&!function(e,t,n){const r=wo(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,ia(e),t))}(e,t)}function ha(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function fa(e){return(t,n)=>{let r=!1;for(const i of ia(e)){const e=pa(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function pa(e,t,n){const r=e.field.isKeyField()?bi.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Js(r,i):Gr()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Gr()}}class ga{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ts(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Is(this.inner)}size(){return this.innerSize}}const ma=new Ds(bi.comparator);function va(){return ma}const ya=new Ds(bi.comparator);function ba(){let e=ya;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function wa(e){let t=ya;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Sa(){return _a()}function Ea(){return _a()}function _a(){return new ga(e=>e.toString(),(e,t)=>e.isEqual(t))}const Ca=new Ds(bi.comparator),xa=new Ns(bi.comparator);function Ta(){let e=xa;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Ia=new Ns(ui);function Da(){return Ia}function Aa(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qi(t)?"-0":t}}function ka(e){return{integerValue:""+e}}function Na(e,t){return Ki(t)?ka(t):Aa(e,t)}class Ra{constructor(){this._=void 0}}function Ma(e,t,n){return e instanceof La?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Vs(t)&&(t=Hs(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof ja?Fa(e,t):e instanceof Ua?Ba(e,t):function(e,t){const n=Pa(e,t),r=Va(n)+Va(e.gt);return io(n)&&io(e.gt)?ka(r):Aa(e.serializer,r)}(e,t)}function Oa(e,t,n){return e instanceof ja?Fa(e,t):e instanceof Ua?Ba(e,t):n}function Pa(e,t){return e instanceof za?io(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class La extends Ra{}class ja extends Ra{constructor(e){super(),this.elements=e}}function Fa(e,t){const n=Ha(t);for(const r of e.elements)n.some(e=>Ys(e,r))||n.push(r);return{arrayValue:{values:n}}}class Ua extends Ra{constructor(e){super(),this.elements=e}}function Ba(e,t){let n=Ha(t);for(const r of e.elements)n=n.filter(e=>!Ys(e,r));return{arrayValue:{values:n}}}class za extends Ra{constructor(e,t){super(),this.serializer=e,this.gt=t}}function Va(e){return Bs(e.integerValue||e.doubleValue)}function Ha(e){return so(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class qa{constructor(e,t){this.field=e,this.transform=t}}class $a{constructor(e,t){this.version=e,this.transformResults=t}}class Ga{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ga}static exists(e){return new Ga(void 0,e)}static updateTime(e){return new Ga(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wa(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Qa{}function Ka(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new sl(e.key,Ga.none()):new el(e.key,e.data,Ga.none());{const n=e.data,r=mo.empty();let i=new Ns(yi.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new tl(e.key,r,new Os(i.toArray()),Ga.none())}}function Ya(e,t,n){e instanceof el?function(e,t,n){const r=e.value.clone(),i=rl(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof tl?function(e,t,n){if(!Wa(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=rl(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(nl(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Xa(e,t,n,r){return e instanceof el?function(e,t,n,r){if(!Wa(e.precondition,t))return n;const i=e.value.clone(),s=il(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof tl?function(e,t,n,r){if(!Wa(e.precondition,t))return n;const i=il(e.fieldTransforms,r,t),s=t.data;return s.setAll(nl(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Wa(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Ja(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Pa(r.transform,e||null);null!=i&&(null===n&&(n=mo.empty()),n.set(r.field,i))}return n||null}function Za(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&di(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ja&&t instanceof ja||e instanceof Ua&&t instanceof Ua?di(e.elements,t.elements,Ys):e instanceof za&&t instanceof za?Ys(e.gt,t.gt):e instanceof La&&t instanceof La}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class el extends Qa{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class tl extends Qa{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function nl(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function rl(e,t,n){const r=new Map;Wr(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Oa(o,a,n[i]))}return r}function il(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Ma(e,s,t))}return r}class sl extends Qa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ol extends Qa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class al{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Ya(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Xa(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Xa(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Ea();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Ka(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(pi.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ta())}isEqual(e){return this.batchId===e.batchId&&di(this.mutations,e.mutations,(e,t)=>Za(e,t))&&di(this.baseMutations,e.baseMutations,(e,t)=>Za(e,t))}}class ll{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Wr(e.mutations.length===n.length);let r=Ca;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new ll(e,t,n,r)}}class cl{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ul{constructor(e,t,n){this.alias=e,this.yt=t,this.fieldPath=n}}class dl{constructor(e,t){this.count=e,this.unchangedNames=t}}var hl,fl;function pl(e){switch(e){default:return Gr();case Yr.CANCELLED:case Yr.UNKNOWN:case Yr.DEADLINE_EXCEEDED:case Yr.RESOURCE_EXHAUSTED:case Yr.INTERNAL:case Yr.UNAVAILABLE:case Yr.UNAUTHENTICATED:return!1;case Yr.INVALID_ARGUMENT:case Yr.NOT_FOUND:case Yr.ALREADY_EXISTS:case Yr.PERMISSION_DENIED:case Yr.FAILED_PRECONDITION:case Yr.ABORTED:case Yr.OUT_OF_RANGE:case Yr.UNIMPLEMENTED:case Yr.DATA_LOSS:return!0}}function gl(e){if(void 0===e)return Hr("GRPC error has no .code"),Yr.UNKNOWN;switch(e){case hl.OK:return Yr.OK;case hl.CANCELLED:return Yr.CANCELLED;case hl.UNKNOWN:return Yr.UNKNOWN;case hl.DEADLINE_EXCEEDED:return Yr.DEADLINE_EXCEEDED;case hl.RESOURCE_EXHAUSTED:return Yr.RESOURCE_EXHAUSTED;case hl.INTERNAL:return Yr.INTERNAL;case hl.UNAVAILABLE:return Yr.UNAVAILABLE;case hl.UNAUTHENTICATED:return Yr.UNAUTHENTICATED;case hl.INVALID_ARGUMENT:return Yr.INVALID_ARGUMENT;case hl.NOT_FOUND:return Yr.NOT_FOUND;case hl.ALREADY_EXISTS:return Yr.ALREADY_EXISTS;case hl.PERMISSION_DENIED:return Yr.PERMISSION_DENIED;case hl.FAILED_PRECONDITION:return Yr.FAILED_PRECONDITION;case hl.ABORTED:return Yr.ABORTED;case hl.OUT_OF_RANGE:return Yr.OUT_OF_RANGE;case hl.UNIMPLEMENTED:return Yr.UNIMPLEMENTED;case hl.DATA_LOSS:return Yr.DATA_LOSS;default:return Gr()}}(fl=hl||(hl={}))[fl.OK=0]="OK",fl[fl.CANCELLED=1]="CANCELLED",fl[fl.UNKNOWN=2]="UNKNOWN",fl[fl.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fl[fl.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fl[fl.NOT_FOUND=5]="NOT_FOUND",fl[fl.ALREADY_EXISTS=6]="ALREADY_EXISTS",fl[fl.PERMISSION_DENIED=7]="PERMISSION_DENIED",fl[fl.UNAUTHENTICATED=16]="UNAUTHENTICATED",fl[fl.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fl[fl.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fl[fl.ABORTED=10]="ABORTED",fl[fl.OUT_OF_RANGE=11]="OUT_OF_RANGE",fl[fl.UNIMPLEMENTED=12]="UNIMPLEMENTED",fl[fl.INTERNAL=13]="INTERNAL",fl[fl.UNAVAILABLE=14]="UNAVAILABLE",fl[fl.DATA_LOSS=15]="DATA_LOSS";class ml{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return vl}static getOrCreateInstance(){return null===vl&&(vl=new ml),vl}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let vl=null;function yl(){return new TextEncoder}const bl=new Pr([4294967295,4294967295],0);function wl(e){const t=yl().encode(e),n=new Or;return n.update(t),new Uint8Array(n.digest())}function Sl(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Pr([n,r],0),new Pr([i,s],0)]}class El{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new _l(`Invalid padding: ${t}`);if(n<0)throw new _l(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new _l(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new _l(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Pr.fromNumber(this.It)}Et(e,t,n){let r=e.add(t.multiply(Pr.fromNumber(n)));return 1===r.compare(bl)&&(r=new Pr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=wl(e),[n,r]=Sl(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,r,i);if(!this.At(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new El(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.It)return;const t=wl(e),[n,r]=Sl(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,r,i);this.Rt(e)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class _l extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Cl{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,xl.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Cl(pi.min(),r,new Ds(ui),va(),Ta())}}class xl{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new xl(n,t,Ta(),Ta(),Ta())}}class Tl{constructor(e,t,n,r){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=r}}class Il{constructor(e,t){this.targetId=e,this.Vt=t}}class Dl{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:js.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Al{constructor(){this.St=0,this.Dt=Rl(),this.Ct=js.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Ta(),t=Ta(),n=Ta();return this.Dt.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Gr()}}),new xl(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=Rl()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class kl{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=va(),this.zt=Nl(),this.Wt=new Ds(ui)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:Gr()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((e,n)=>{this.te(n)&&t(n)})}ne(e){var t;const n=e.targetId,r=e.Vt.count,i=this.se(n);if(i){const s=i.target;if(Wo(s))if(0===r){const e=new bi(s.path);this.Yt(n,e,yo.newNoDocument(e,pi.min()))}else Wr(1===r);else{const i=this.ie(n);if(i!==r){const r=this.re(e,i);if(0!==r){this.ee(n);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=ml.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,i,s,o,a,l;const c={localCacheCount:t,existenceFilterCount:n.count},u=n.unchangedNames;return u&&(c.bloomFilter={applied:0===e,hashCount:null!==(r=null==u?void 0:u.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(o=null===(s=null===(i=null==u?void 0:u.bits)||void 0===i?void 0:i.bitmap)||void 0===s?void 0:s.length)&&void 0!==o?o:0,padding:null!==(l=null===(a=null==u?void 0:u.bits)||void 0===a?void 0:a.padding)&&void 0!==l?l:0}),c}(r,i,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:r}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=n;let a,l;try{a=zs(i).toUint8Array()}catch(e){if(e instanceof Ps)return qr("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{l=new El(a,s,o)}catch(e){return qr(e instanceof _l?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===l.It?1:r!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let r=0;return n.forEach(n=>{const i=this.Gt.ue(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;t.vt(s)||(this.Yt(e,n,null),r++)}),r}ce(e){const t=new Map;this.Qt.forEach((n,r)=>{const i=this.se(r);if(i){if(n.current&&Wo(i.target)){const t=new bi(i.target.path);null!==this.jt.get(t)||this.ae(r,t)||this.Yt(r,t,yo.newNoDocument(t,e))}n.Mt&&(t.set(r,n.Ot()),n.Ft())}});let n=Ta();this.zt.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.jt.forEach((t,n)=>n.setReadTime(e));const r=new Cl(e,t,this.Wt,this.jt,n);return this.jt=va(),this.zt=Nl(),this.Wt=new Ds(ui),r}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new Al,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Ns(ui),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Vr("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Al),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function Nl(){return new Ds(bi.comparator)}function Rl(){return new Ds(bi.comparator)}const Ml={asc:"ASCENDING",desc:"DESCENDING"},Ol={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pl={and:"AND",or:"OR"};class Ll{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function jl(e,t){return e.useProto3Json||Wi(t)?t:{value:t}}function Fl(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ul(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Bl(e,t){return Fl(e,t.toTimestamp())}function zl(e){return Wr(!!e),pi.fromTimestamp(function(e){const t=Us(e);return new fi(t.seconds,t.nanos)}(e))}function Vl(e,t){return function(e){return new mi(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Hl(e){const t=mi.fromString(e);return Wr(dc(t)),t}function ql(e,t){return Vl(e.databaseId,t.path)}function $l(e,t){const n=Hl(t);if(n.get(1)!==e.databaseId.projectId)throw new Xr(Yr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Xr(Yr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new bi(Kl(n))}function Gl(e,t){return Vl(e.databaseId,t)}function Wl(e){const t=Hl(e);return 4===t.length?mi.emptyPath():Kl(t)}function Ql(e){return new mi(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Kl(e){return Wr(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Yl(e,t,n){return{name:ql(e,t),fields:n.value.mapValue.fields}}function Xl(e,t,n){const r=$l(e,t.name),i=zl(t.updateTime),s=t.createTime?zl(t.createTime):pi.min(),o=new mo({mapValue:{fields:t.fields}}),a=yo.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Jl(e,t){let n;if(t instanceof el)n={update:Yl(e,t.key,t.value)};else if(t instanceof sl)n={delete:ql(e,t.key)};else if(t instanceof tl)n={update:Yl(e,t.key,t.data),updateMask:uc(t.fieldMask)};else{if(!(t instanceof ol))return Gr();n={verify:ql(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof La)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ja)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ua)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof za)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Gr()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Bl(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Gr()}(e,t.precondition)),n}function Zl(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Ga.updateTime(zl(e.updateTime)):void 0!==e.exists?Ga.exists(e.exists):Ga.none()}(t.currentDocument):Ga.none(),r=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let n=null;if("setToServerValue"in t)Wr("REQUEST_TIME"===t.setToServerValue),n=new La;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new ja(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Ua(e)}else"increment"in t?n=new za(e,t.increment):Gr();const r=yi.fromServerFormat(t.fieldPath);return new qa(r,n)}(e,t)):[];if(t.update){t.update.name;const i=$l(e,t.update.name),s=new mo({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new Os(t.map(e=>yi.fromServerFormat(e)))}(t.updateMask);return new tl(i,s,e,n,r)}return new el(i,s,n,r)}if(t.delete){const r=$l(e,t.delete);return new sl(r,n)}if(t.verify){const r=$l(e,t.verify);return new ol(r,n)}return Gr()}function ec(e,t){return{documents:[Gl(e,t.path)]}}function tc(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Gl(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Gl(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0!==e.length)return cc(To.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:ac(e.field),direction:ic(e.dir)}}(e))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=jl(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function nc(e){let t=Wl(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Wr(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=rc(e);return t instanceof To&&Ao(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>function(e){return new Eo(lc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Wi(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new bo(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new bo(n,t)}(n.endAt)),Jo(t,i,o,s,a,"F",l,c)}function rc(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=lc(e.unaryFilter.field);return xo.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=lc(e.unaryFilter.field);return xo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=lc(e.unaryFilter.field);return xo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=lc(e.unaryFilter.field);return xo.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Gr()}}(e):void 0!==e.fieldFilter?function(e){return xo.create(lc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Gr()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return To.create(e.compositeFilter.filters.map(e=>rc(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Gr()}}(e.compositeFilter.op))}(e):Gr()}function ic(e){return Ml[e]}function sc(e){return Ol[e]}function oc(e){return Pl[e]}function ac(e){return{fieldPath:e.canonicalString()}}function lc(e){return yi.fromServerFormat(e.fieldPath)}function cc(e){return e instanceof xo?function(e){if("=="===e.op){if(ao(e.value))return{unaryFilter:{field:ac(e.field),op:"IS_NAN"}};if(oo(e.value))return{unaryFilter:{field:ac(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ao(e.value))return{unaryFilter:{field:ac(e.field),op:"IS_NOT_NAN"}};if(oo(e.value))return{unaryFilter:{field:ac(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ac(e.field),op:sc(e.op),value:e.value}}}(e):e instanceof To?function(e){const t=e.getFilters().map(e=>cc(e));return 1===t.length?t[0]:{compositeFilter:{op:oc(e.op),filters:t}}}(e):Gr()}function uc(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function dc(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class hc{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pi.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:pi.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:js.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new hc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new hc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class fc{constructor(e){this.fe=e}}function pc(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:gc(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:ql(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Fl(e,t.version.toTimestamp()),createTime:Fl(e,t.createTime.toTimestamp())}}(e.fe,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:mc(t.version)};else{if(!t.isUnknownDocument())return Gr();r.unknownDocument={path:n.path.toArray(),version:mc(t.version)}}return r}function gc(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function mc(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function vc(e){const t=new fi(e.seconds,e.nanoseconds);return pi.fromTimestamp(t)}function yc(e,t){const n=(t.baseMutations||[]).map(t=>Zl(e.fe,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map(t=>Zl(e.fe,t)),i=fi.fromMillis(t.localWriteTimeMs);return new al(t.batchId,i,n,r)}function bc(e){const t=vc(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?vc(e.lastLimboFreeSnapshotVersion):pi.min();let r;var i;return void 0!==e.query.documents?(Wr(1===(i=e.query).documents.length),r=sa(Zo(Wl(i.documents[0])))):r=function(e){return sa(nc(e))}(e.query),new hc(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,js.fromBase64String(e.resumeToken))}function wc(e,t){const n=mc(t.snapshotVersion),r=mc(t.lastLimboFreeSnapshotVersion);let i;i=Wo(t.target)?ec(e.fe,t.target):tc(e.fe,t.target);const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:$o(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Sc(e){const t=nc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?aa(t,t.limit,"L"):t}function Ec(e,t){return new cl(t.largestBatchId,Zl(e.fe,t.overlayMutation))}function _c(e,t){const n=t.path.lastSegment();return[e,Yi(t.path.popLast()),n]}function Cc(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:mc(r.readTime),documentKey:Yi(r.documentKey.path),largestBatchId:r.largestBatchId}}class xc{getBundleMetadata(e,t){return Tc(e).get(t).next(e=>{if(e)return{id:(t=e).bundleId,createTime:vc(t.createTime),version:t.version};var t})}saveBundleMetadata(e,t){return Tc(e).put({bundleId:(n=t).id,createTime:mc(zl(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return Ic(e).get(t).next(e=>{if(e)return{name:(t=e).name,query:Sc(t.bundledQuery),readTime:vc(t.readTime)};var t})}saveNamedQuery(e,t){return Ic(e).put(function(e){return{name:e.name,readTime:mc(zl(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Tc(e){return Cs(e,"bundles")}function Ic(e){return Cs(e,"namedQueries")}class Dc{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){const n=t.uid||"";return new Dc(e,n)}getOverlay(e,t){return Ac(e).get(_c(this.userId,t)).next(e=>e?Ec(this.serializer,e):null)}getOverlays(e,t){const n=Sa();return Oi.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((n,i)=>{const s=new cl(t,i);r.push(this.we(e,s))}),Oi.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(e=>r.add(Yi(e.getCollectionPath())));const i=[];return r.forEach(t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(Ac(e).J("collectionPathOverlayIndex",r))}),Oi.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Sa(),i=Yi(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Ac(e).j("collectionPathOverlayIndex",s).next(e=>{for(const t of e){const e=Ec(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const i=Sa();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ac(e).X({index:"collectionGroupOverlayIndex",range:o},(e,t,n)=>{const o=Ec(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()}).next(()=>i)}we(e,t){return Ac(e).put(function(e,t,n){const[r,i,s]=_c(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Jl(e.fe,n.mutation)}}(this.serializer,this.userId,t))}}function Ac(e){return Cs(e,"documentOverlays")}class kc{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Bs(e.integerValue));else if("doubleValue"in e){const n=Bs(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),Qi(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(zs(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?uo(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Gr()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const r of Object.keys(n))this.Te(r,t),this.me(n[r],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const r of n)this.me(r,t)}ve(e,t){this.ye(t,37),bi.fromName(e).path.forEach(e=>{this.ye(t,60),this.be(e,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}function Nc(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function Rc(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Nc(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}kc.Ve=new kc;class Mc{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.De(n.value),n=t.next();this.Ce()}xe(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ne(n.value),n=t.next();this.ke()}Me(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.De(e);else if(e<2048)this.De(960|e>>>6),this.De(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.De(480|e>>>12),this.De(128|63&e>>>6),this.De(128|63&e);else{const e=t.codePointAt(0);this.De(240|e>>>18),this.De(128|63&e>>>12),this.De(128|63&e>>>6),this.De(128|63&e)}}this.Ce()}$e(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ne(e);else if(e<2048)this.Ne(960|e>>>6),this.Ne(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ne(480|e>>>12),this.Ne(128|63&e>>>6),this.Ne(128|63&e);else{const e=t.codePointAt(0);this.Ne(240|e>>>18),this.Ne(128|63&e>>>12),this.Ne(128|63&e>>>6),this.Ne(128|63&e)}}this.ke()}Oe(e){const t=this.Fe(e),n=Rc(t);this.Be(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Le(e){const t=this.Fe(e),n=Rc(t);this.Be(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}De(e){const t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){const t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Oc{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class Pc{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class Lc{constructor(){this.je=new Mc,this.ze=new Oc(this.je),this.We=new Pc(this.je)}seed(e){this.je.seed(e)}He(e){return 0===e?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}class jc{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Je(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new jc(this.indexId,this.documentKey,this.arrayValue,n)}}function Fc(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=Uc(e.arrayValue,t.arrayValue),0!==n?n:(n=Uc(e.directionalValue,t.directionalValue),0!==n?n:bi.comparator(e.documentKey,t.documentKey)))}function Uc(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class Bc{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const t of e.filters){const e=t;e.isInequality()?this.Ze=e:this.Xe.push(e)}}tn(e){Wr(e.collectionGroup===this.collectionId);const t=Si(e);if(void 0!==t&&!this.en(t))return!1;const n=Ei(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.en(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(void 0!==this.Ze){if(!r.has(this.Ze.field.canonicalString())){const e=n[i];if(!this.nn(this.Ze,e)||!this.sn(this.Ye[s++],e))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.Ye.length||!this.sn(this.Ye[s++],e))return!1}return!0}en(e){for(const t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function zc(e){var t,n;if(Wr(e instanceof xo||e instanceof To),e instanceof xo){if(e instanceof Bo){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(t=>xo.create(e.field,"==",t)))||[];return To.create(r,"or")}return e}const r=e.filters.map(e=>zc(e));return To.create(r,e.op)}function Vc(e){if(0===e.getFilters().length)return[];const t=Gc(zc(e));return Wr($c(t)),Hc(t)||qc(t)?[t]:t.getFilters()}function Hc(e){return e instanceof xo}function qc(e){return e instanceof To&&Ao(e)}function $c(e){return Hc(e)||qc(e)||function(e){if(e instanceof To&&Do(e)){for(const t of e.getFilters())if(!Hc(t)&&!qc(t))return!1;return!0}return!1}(e)}function Gc(e){if(Wr(e instanceof xo||e instanceof To),e instanceof xo)return e;if(1===e.filters.length)return Gc(e.filters[0]);const t=e.filters.map(e=>Gc(e));let n=To.create(t,e.op);return n=Kc(n),$c(n)?n:(Wr(n instanceof To),Wr(Io(n)),Wr(n.filters.length>1),n.filters.reduce((e,t)=>Wc(e,t)))}function Wc(e,t){let n;return Wr(e instanceof xo||e instanceof To),Wr(t instanceof xo||t instanceof To),n=e instanceof xo?t instanceof xo?function(e,t){return To.create([e,t],"and")}(e,t):Qc(e,t):t instanceof xo?Qc(t,e):function(e,t){if(Wr(e.filters.length>0&&t.filters.length>0),Io(e)&&Io(t))return Mo(e,t.getFilters());const n=Do(e)?e:t,r=Do(e)?t:e,i=n.filters.map(e=>Wc(e,r));return To.create(i,"or")}(e,t),Kc(n)}function Qc(e,t){if(Io(t))return Mo(t,e.getFilters());{const n=t.filters.map(t=>Wc(e,t));return To.create(n,"or")}}function Kc(e){if(Wr(e instanceof xo||e instanceof To),e instanceof xo)return e;const t=e.getFilters();if(1===t.length)return Kc(t[0]);if(ko(e))return e;const n=t.map(e=>Kc(e)),r=[];return n.forEach(t=>{t instanceof xo?r.push(t):t instanceof To&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:To.create(r,e.op)}class Yc{constructor(){this.rn=new Xc}addToCollectionParentIndex(e,t){return this.rn.add(t),Oi.resolve()}getCollectionParents(e,t){return Oi.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return Oi.resolve()}deleteFieldIndex(e,t){return Oi.resolve()}getDocumentsMatchingTarget(e,t){return Oi.resolve(null)}getIndexType(e,t){return Oi.resolve(0)}getFieldIndexes(e,t){return Oi.resolve([])}getNextCollectionGroupToUpdate(e){return Oi.resolve(null)}getMinOffset(e,t){return Oi.resolve(Ai.min())}getMinOffsetFromCollectionGroup(e,t){return Oi.resolve(Ai.min())}updateCollectionGroup(e,t,n){return Oi.resolve()}updateIndexEntries(e,t){return Oi.resolve()}}class Xc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ns(mi.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ns(mi.comparator)).toArray()}}const Jc=new Uint8Array(0);class Zc{constructor(e,t){this.user=e,this.databaseId=t,this.on=new Xc,this.un=new ga(e=>$o(e),(e,t)=>Go(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});const i={collectionId:n,parent:Yi(r)};return eu(e).put(i)}return Oi.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[hi(t),""],!1,!0);return eu(e).j(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Zi(r.parent))}return n})}addFieldIndex(e,t){const n=nu(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=ru(e);return i.next(e=>{n.put(Cc(e,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const n=nu(e),r=ru(e),i=tu(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const n=tu(e);let r=!0;const i=new Map;return Oi.forEach(this.cn(t),t=>this.an(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(r){let e=Ta();const r=[];return Oi.forEach(i,(i,s)=>{var o;Vr("IndexedDbIndexManager",`Using index ${o=i,`id=${o.indexId}|cg=${o.collectionGroup}|f=${o.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`} to execute ${$o(t)}`);const a=function(e,t){const n=Si(t);if(void 0===n)return null;for(const r of Qo(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),l=function(e,t){const n=new Map;for(const r of Ei(t))for(const t of Qo(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of Ei(t)){const t=0===i.kind?Ko(e,i.fieldPath,e.startAt):Yo(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new bo(n,r)}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of Ei(t)){const t=0===i.kind?Yo(e,i.fieldPath,e.endAt):Ko(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new bo(n,r)}(s,i),d=this.hn(i,s,c),h=this.hn(i,s,u),f=this.ln(i,s,l),p=this.fn(i.indexId,a,d,c.inclusive,h,u.inclusive,f);return Oi.forEach(p,i=>n.H(i,t.limit).next(t=>{t.forEach(t=>{const n=bi.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}return Oi.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:Vc(To.create(e.filters,"and")).map(t=>qo(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),c=[];for(let u=0;u<a;++u){const a=t?this.dn(t[u/l]):Jc,d=this.wn(e,a,n[u%l],r),h=this._n(e,a,i[u%l],s),f=o.map(t=>this.wn(e,a,t,!0));c.push(...this.createRange(d,h,f))}return c}wn(e,t,n,r){const i=new jc(e,bi.empty(),t,n);return r?i:i.Je()}_n(e,t,n,r){const i=new jc(e,bi.empty(),t,n);return r?i.Je():i}an(e,t){const n=new Bc(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(const r of e)n.tn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2;const r=this.cn(t);return Oi.forEach(r,t=>this.an(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new Ns(yi.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n)}mn(e,t){const n=new Lc;for(const r of Ei(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.He(r.kind);kc.Ve._e(e,i)}return n.Qe()}dn(e){const t=new Lc;return kc.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){const n=new Lc;return kc.Ve._e(ro(this.databaseId,t),n.He(function(e){const t=Ei(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Qe()}ln(e,t,n){if(null===n)return[];let r=[];r.push(new Lc);let i=0;for(const s of Ei(e)){const e=n[i++];for(const n of r)if(this.yn(t,s.fieldPath)&&so(e))r=this.pn(r,s,e);else{const t=n.He(s.kind);kc.Ve._e(e,t)}}return this.In(r)}hn(e,t,n){return this.ln(e,t,n.position)}In(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Qe();return t}pn(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new Lc;n.seed(e.Qe()),kc.Ve._e(s,n.He(t.kind)),i.push(n)}return i}yn(e,t){return!!e.filters.find(e=>e instanceof xo&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=nu(e),r=ru(e);return(t?n.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.j()).next(e=>{const t=[];return Oi.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){const n=t?new Ti(t.sequenceNumber,new Ai(vc(t.readTime),new bi(Zi(t.documentKey)),t.largestBatchId)):Ti.empty(),r=e.fields.map(e=>{let[t,n]=e;return new Ci(yi.fromServerFormat(t),n)});return new wi(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:ui(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=nu(e),i=ru(e);return this.Tn(e).next(e=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(t=>Oi.forEach(t,t=>i.put(Cc(t.indexId,this.user,e,n)))))}updateIndexEntries(e,t){const n=new Map;return Oi.forEach(t,(t,r)=>{const i=n.get(t.collectionGroup);return(i?Oi.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),Oi.forEach(i,n=>this.En(e,t,n).next(t=>{const i=this.An(r,n);return t.isEqual(i)?Oi.resolve():this.vn(e,r,n,t,i)}))))})}Rn(e,t,n,r){return tu(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(n,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,n,r){return tu(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(n,t.key),t.key.path.toArray()])}En(e,t,n){const r=tu(e);let i=new Ns(Fc);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.gn(n,t)])},(e,r)=>{i=i.add(new jc(n.indexId,t,r.arrayValue,r.directionalValue))}).next(()=>i)}An(e,t){let n=new Ns(Fc);const r=this.mn(t,e);if(null==r)return n;const i=Si(t);if(null!=i){const s=e.data.field(i.fieldPath);if(so(s))for(const i of s.arrayValue.values||[])n=n.add(new jc(t.indexId,e.key,this.dn(i),r))}else n=n.add(new jc(t.indexId,e.key,Jc,r));return n}vn(e,t,n,r,i){Vr("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=Ms(s),l=Ms(o);for(;a||l;){let e=!1,t=!1;if(a&&l){const r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=Ms(o)):t?(i(a),a=Ms(s)):(a=Ms(s),l=Ms(o))}}(r,i,Fc,r=>{s.push(this.Rn(e,t,n,r))},r=>{s.push(this.Pn(e,t,n,r))}),Oi.waitFor(s)}Tn(e){let t=1;return ru(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>Fc(e,t)).filter((e,t,n)=>!t||0!==Fc(e,n[t-1]));const r=[];r.push(e);for(const s of n){const n=Fc(s,e),i=Fc(s,t);if(0===n)r[0]=e.Je();else if(n>0&&i<0)r.push(s),r.push(s.Je());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.bn(r[s],r[s+1]))return[];const e=[r[s].indexId,this.uid,r[s].arrayValue,r[s].directionalValue,Jc,[]],t=[r[s+1].indexId,this.uid,r[s+1].arrayValue,r[s+1].directionalValue,Jc,[]];i.push(IDBKeyRange.bound(e,t))}return i}bn(e,t){return Fc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(iu)}getMinOffset(e,t){return Oi.mapArray(this.cn(t),t=>this.an(e,t).next(e=>e||Gr())).next(iu)}}function eu(e){return Cs(e,"collectionParents")}function tu(e){return Cs(e,"indexEntries")}function nu(e){return Cs(e,"indexConfiguration")}function ru(e){return Cs(e,"indexState")}function iu(e){Wr(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;ki(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Ai(t.readTime,t.documentKey,n)}const su={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ou{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ou(e,ou.DEFAULT_COLLECTION_PERCENTILE,ou.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function au(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.X({range:o},(e,t,n)=>(a++,n.delete()));s.push(l.next(()=>{Wr(1===a)}));const c=[];for(const u of n.mutations){const e=ns(t,u.key.path,n.batchId);s.push(i.delete(e)),c.push(u.key)}return Oi.waitFor(s).next(()=>c)}function lu(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Gr();t=e.noDocument}return JSON.stringify(t).length}ou.DEFAULT_COLLECTION_PERCENTILE=10,ou.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ou.DEFAULT=new ou(41943040,ou.DEFAULT_COLLECTION_PERCENTILE,ou.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ou.DISABLED=new ou(-1,0,0);class cu{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Vn={}}static de(e,t,n,r){Wr(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new cu(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return du(e).X({index:"userMutationsIndex",range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const i=hu(e),s=du(e);return s.add({}).next(o=>{Wr("number"==typeof o);const a=new al(o,t,n,r),l=function(e,t,n){const r=n.baseMutations.map(t=>Jl(e.fe,t)),i=n.mutations.map(t=>Jl(e.fe,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),c=[];let u=new Ns((e,t)=>ui(e.canonicalString(),t.canonicalString()));for(const e of r){const t=ns(this.userId,e.key.path,o);u=u.add(e.key.path.popLast()),c.push(s.put(l)),c.push(i.put(t,rs))}return u.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Vn[o]=a.keys()}),Oi.waitFor(c).next(()=>a)})}lookupMutationBatch(e,t){return du(e).get(t).next(e=>e?(Wr(e.userId===this.userId),yc(this.serializer,e)):null)}Sn(e,t){return this.Vn[t]?Oi.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Vn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return du(e).X({index:"userMutationsIndex",range:r},(e,t,r)=>{t.userId===this.userId&&(Wr(t.batchId>=n),i=yc(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return du(e).X({index:"userMutationsIndex",range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return du(e).j("userMutationsIndex",t).next(e=>e.map(e=>yc(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=ts(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return hu(e).X({range:r},(n,r,s)=>{const[o,a,l]=n,c=Zi(a);if(o===this.userId&&t.path.isEqual(c))return du(e).get(l).next(e=>{if(!e)throw Gr();Wr(e.userId===this.userId),i.push(yc(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ns(ui);const r=[];return t.forEach(t=>{const i=ts(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=hu(e).X({range:s},(e,r,i)=>{const[s,o,a]=e,l=Zi(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()});r.push(o)}),Oi.waitFor(r).next(()=>this.Dn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=ts(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new Ns(ui);return hu(e).X({range:s},(e,t,i)=>{const[s,a,l]=e,c=Zi(a);s===this.userId&&n.isPrefixOf(c)?c.length===r&&(o=o.add(l)):i.done()}).next(()=>this.Dn(e,o))}Dn(e,t){const n=[],r=[];return t.forEach(t=>{r.push(du(e).get(t).next(e=>{if(null===e)throw Gr();Wr(e.userId===this.userId),n.push(yc(this.serializer,e))}))}),Oi.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return au(e.ht,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),Oi.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Oi.resolve();const n=IDBKeyRange.lowerBound([this.userId]),r=[];return hu(e).X({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=Zi(e[1]);r.push(t)}else n.done()}).next(()=>{Wr(0===r.length)})})}containsKey(e,t){return uu(e,this.userId,t)}xn(e){return fu(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function uu(e,t,n){const r=ts(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return hu(e).X({range:s,Y:!0},(e,n,r)=>{const[s,a,l]=e;s===t&&a===i&&(o=!0),r.done()}).next(()=>o)}function du(e){return Cs(e,"mutations")}function hu(e){return Cs(e,"documentMutations")}function fu(e){return Cs(e,"mutationQueues")}class pu{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new pu(0)}static Mn(){return new pu(-1)}}class gu{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{const n=new pu(t.highestTargetId);return t.highestTargetId=n.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(e=>pi.fromTimestamp(new fi(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.$n(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.On(e,r)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(n=>(n.targetCount+=1,this.Bn(t,n),this.On(e,n))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>mu(e).delete(t.targetId)).next(()=>this.$n(e)).next(t=>(Wr(t.targetCount>0),t.targetCount-=1,this.On(e,t)))}removeTargets(e,t,n){let r=0;const i=[];return mu(e).X((s,o)=>{const a=bc(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))}).next(()=>Oi.waitFor(i)).next(()=>r)}forEachTarget(e,t){return mu(e).X((e,n)=>{const r=bc(n);t(r)})}$n(e){return vu(e).get("targetGlobalKey").next(e=>(Wr(null!==e),e))}On(e,t){return vu(e).put("targetGlobalKey",t)}Fn(e,t){return mu(e).put(wc(this.serializer,t))}Bn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.$n(e).next(e=>e.targetCount)}getTargetData(e,t){const n=$o(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return mu(e).X({range:r,index:"queryTargetsIndex"},(e,n,r)=>{const s=bc(n);Go(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){const r=[],i=yu(e);return t.forEach(t=>{const s=Yi(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),Oi.waitFor(r)}removeMatchingKeys(e,t,n){const r=yu(e);return Oi.forEach(t,t=>{const i=Yi(t.path);return Oi.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=yu(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=yu(e);let i=Ta();return r.X({range:n,Y:!0},(e,t,n)=>{const r=Zi(e[1]),s=new bi(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){const n=Yi(t.path),r=IDBKeyRange.bound([n],[hi(n)],!1,!0);let i=0;return yu(e).X({index:"documentTargetsIndex",Y:!0,range:r},(e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())}).next(()=>i>0)}le(e,t){return mu(e).get(t).next(e=>e?bc(e):null)}}function mu(e){return Cs(e,"targets")}function vu(e){return Cs(e,"targetGlobal")}function yu(e){return Cs(e,"targetDocuments")}function bu(e,t){let[n,r]=e,[i,s]=t;const o=ui(n,i);return 0===o?ui(r,s):o}class wu{constructor(e){this.Ln=e,this.buffer=new Ns(bu),this.qn=0}Un(){return++this.qn}Kn(e){const t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();bu(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Su{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(e){Vr("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ui(e)?Vr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await Mi(e)}await this.Qn(3e5)})}}class Eu{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Oi.resolve(Gi.ct);const n=new wu(t);return this.jn.forEachTarget(e,e=>n.Kn(e.sequenceNumber)).next(()=>this.jn.Wn(e,e=>n.Kn(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Vr("LruGarbageCollector","Garbage collection skipped; disabled"),Oi.resolve(su)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Vr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),su):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let n,r,i,s,o,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Vr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),Br()<=u.$b.DEBUG&&Vr("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-c}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-c}ms`),Oi.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function _u(e,t){return new Eu(e,t)}class Cu{constructor(e,t){this.db=e,this.garbageCollector=_u(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Jn(e){let t=0;return this.Wn(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(e,n)=>t(n))}addReference(e,t,n){return xu(e,n)}removeReference(e,t,n){return xu(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return xu(e,t)}Xn(e,t){return function(e,t){let n=!1;return fu(e).Z(r=>uu(e,r,t).next(e=>(e&&(n=!0),Oi.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Yn(e,(s,o)=>{if(o<=t){const t=this.Xn(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,pi.min()),yu(e).delete([0,Yi(s.path)])))});r.push(t)}}).next(()=>Oi.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return xu(e,t)}Yn(e,t){const n=yu(e);let r,i=Gi.ct;return n.X({index:"documentTargetsIndex"},(e,n)=>{let[s,o]=e,{path:a,sequenceNumber:l}=n;0===s?(i!==Gi.ct&&t(new bi(Zi(r)),i),i=l,r=a):i=Gi.ct}).next(()=>{i!==Gi.ct&&t(new bi(Zi(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function xu(e,t){return yu(e).put(function(e,t){return{targetId:0,path:Yi(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Tu{constructor(){this.changes=new ga(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Oi.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Iu{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Nu(e).put(n)}removeEntry(e,t,n){return Nu(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],gc(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Zn(e,n)))}getEntry(e,t){let n=yo.newInvalidDocument(t);return Nu(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ru(t))},(e,r)=>{n=this.ts(t,r)}).next(()=>n)}es(e,t){let n={size:0,document:yo.newInvalidDocument(t)};return Nu(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ru(t))},(e,r)=>{n={document:this.ts(t,r),size:lu(r)}}).next(()=>n)}getEntries(e,t){let n=va();return this.ns(e,t,(e,t)=>{const r=this.ts(e,t);n=n.insert(e,r)}).next(()=>n)}ss(e,t){let n=va(),r=new Ds(bi.comparator);return this.ns(e,t,(e,t)=>{const i=this.ts(e,t);n=n.insert(e,i),r=r.insert(e,lu(t))}).next(()=>({documents:n,rs:r}))}ns(e,t,n){if(t.isEmpty())return Oi.resolve();let r=new Ns(Ou);t.forEach(e=>r=r.add(e));const i=IDBKeyRange.bound(Ru(r.first()),Ru(r.last())),s=r.getIterator();let o=s.getNext();return Nu(e).X({index:"documentKeyIndex",range:i},(e,t,r)=>{const i=bi.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&Ou(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.G(Ru(o)):r.done()}).next(()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r){const i=t.path,s=[i.popLast().toArray(),i.lastSegment(),gc(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Nu(e).j(IDBKeyRange.bound(s,o,!0)).next(e=>{let n=va();for(const i of e){const e=this.ts(bi.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(da(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=va();const s=Mu(t,n),o=Mu(t,Ai.max());return Nu(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},(e,t,n)=>{const s=this.ts(bi.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new Au(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return ku(e).get("remoteDocumentGlobalKey").next(e=>(Wr(!!e),e))}Zn(e,t){return ku(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Xl(e.fe,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=bi.fromSegments(t.noDocument.path),r=vc(t.noDocument.readTime);n=yo.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Gr();{const e=bi.fromSegments(t.unknownDocument.path),r=vc(t.unknownDocument.version);n=yo.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new fi(e[0],e[1]);return pi.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(pi.min()))return e}return yo.newInvalidDocument(e)}}function Du(e){return new Iu(e)}class Au extends Tu{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new ga(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new Ns((e,t)=>ui(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{const o=this.us.get(i);if(t.push(this.os.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=pc(this.os.serializer,s);r=r.add(i.path.popLast());const l=lu(a);n+=l-o.size,t.push(this.os.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=pc(this.os.serializer,s.convertToNoDocument(pi.min()));t.push(this.os.addEntry(e,i,n))}}),r.forEach(n=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.os.updateMetadata(e,n)),Oi.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(e=>(this.us.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(e=>{let{documents:t,rs:n}=e;return n.forEach((e,n)=>{this.us.set(e,{size:n,readTime:t.get(e).readTime})}),t})}}function ku(e){return Cs(e,"remoteDocumentGlobal")}function Nu(e){return Cs(e,"remoteDocumentsV14")}function Ru(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Mu(e,t){const n=t.documentKey.path.toArray();return[e,gc(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Ou(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ui(n[s],r[s]),i)return i;return i=ui(n.length,r.length),i||(i=ui(n[n.length-2],r[r.length-2]),i||ui(n[n.length-1],r[r.length-1]))}class Pu{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Lu{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Xa(n.mutation,e,Os.empty(),fi.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Ta()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ta();const r=Sa();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=ba();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Sa();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Ta()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=va();const s=_a(),o=_a();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof tl)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Xa(o.mutation,t,o.mutation.getFieldMask(),fi.now())):s.set(t.key,Os.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new Pu(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=_a();let r=new Ds((e,t)=>e-t),i=Ta();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Os.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Ta()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=Ea();l.forEach(e=>{if(!i.has(e)){const r=Ka(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Oi.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return function(e){return bi.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ra(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Oi.resolve(Sa());let o=-1,a=i;return s.next(t=>Oi.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Oi.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,Ta())).next(e=>({batchId:o,changes:wa(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new bi(t)).next(e=>{let t=ba();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=ba();return this.indexManager.getCollectionParents(e,r).next(s=>Oi.forEach(s,s=>{const o=function(e,t){return new Xo(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.getDocumentsMatchingCollectionQuery(e,o,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r))).next(e=>{r.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,yo.newInvalidDocument(r)))});let n=ba();return e.forEach((e,i)=>{const s=r.get(e);void 0!==s&&Xa(s.mutation,i,Os.empty(),fi.now()),da(t,i)&&(n=n.insert(e,i))}),n})}}class ju{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return Oi.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:zl(n.createTime)}),Oi.resolve()}getNamedQuery(e,t){return Oi.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:Sc(e.bundledQuery),readTime:zl(e.readTime)}}(t)),Oi.resolve()}}class Fu{constructor(){this.overlays=new Ds(bi.comparator),this.ls=new Map}getOverlay(e,t){return Oi.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Sa();return Oi.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.we(e,t,r)}),Oi.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.ls.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.ls.delete(n)),Oi.resolve()}getOverlaysForCollection(e,t,n){const r=Sa(),i=t.length+1,s=new bi(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Oi.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Ds((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Sa(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Sa(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return Oi.resolve(o)}we(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new cl(t,n));let i=this.ls.get(t);void 0===i&&(i=Ta(),this.ls.set(t,i)),this.ls.set(t,i.add(n.key))}}class Uu{constructor(){this.fs=new Ns(Bu.ds),this.ws=new Ns(Bu._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new Bu(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.ys(new Bu(e,t))}ps(e,t){e.forEach(e=>this.removeReference(e,t))}Is(e){const t=new bi(new mi([])),n=new Bu(t,e),r=new Bu(t,e+1),i=[];return this.ws.forEachInRange([n,r],e=>{this.ys(e),i.push(e.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new bi(new mi([])),n=new Bu(t,e),r=new Bu(t,e+1);let i=Ta();return this.ws.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Bu(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Bu{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return bi.comparator(e.key,t.key)||ui(e.As,t.As)}static _s(e,t){return ui(e.As,t.As)||bi.comparator(e.key,t.key)}}class zu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Ns(Bu.ds)}checkEmpty(e){return Oi.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new al(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Rs=this.Rs.add(new Bu(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Oi.resolve(s)}lookupMutationBatch(e,t){return Oi.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.bs(n),i=r<0?0:r;return Oi.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Oi.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return Oi.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Bu(t,0),r=new Bu(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([n,r],e=>{const t=this.Ps(e.As);i.push(t)}),Oi.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ns(ui);return t.forEach(e=>{const t=new Bu(e,0),r=new Bu(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,r],e=>{n=n.add(e.As)})}),Oi.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;bi.isDocumentKey(i)||(i=i.child(""));const s=new Bu(new bi(i),0);let o=new Ns(ui);return this.Rs.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.As)),!0)},s),Oi.resolve(this.Vs(o))}Vs(e){const t=[];return e.forEach(e=>{const n=this.Ps(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Wr(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return Oi.forEach(t.mutations,r=>{const i=new Bu(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new Bu(t,0),r=this.Rs.firstAfterOrEqual(n);return Oi.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oi.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Vu{constructor(e){this.Ds=e,this.docs=new Ds(bi.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Oi.resolve(n?n.document.mutableCopy():yo.newInvalidDocument(t))}getEntries(e,t){let n=va();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():yo.newInvalidDocument(e))}),Oi.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=va();const s=t.path,o=new bi(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||ki(Di(o),n)<=0||(r.has(o.key)||da(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Oi.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Gr()}Cs(e,t){return Oi.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Hu(this)}getSize(e){return Oi.resolve(this.size)}}class Hu extends Tu{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(n)}),Oi.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class qu{constructor(e){this.persistence=e,this.xs=new ga(e=>$o(e),Go),this.lastRemoteSnapshotVersion=pi.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Uu,this.targetCount=0,this.Ms=pu.kn()}forEachTarget(e,t){return this.xs.forEach((e,n)=>t(n)),Oi.resolve()}getLastRemoteSnapshotVersion(e){return Oi.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oi.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),Oi.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),Oi.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new pu(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,Oi.resolve()}updateTargetData(e,t){return this.Fn(t),Oi.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,Oi.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.xs.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.xs.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Oi.waitFor(i).next(()=>r)}getTargetCount(e){return Oi.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return Oi.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),Oi.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Oi.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),Oi.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return Oi.resolve(n)}containsKey(e,t){return Oi.resolve(this.ks.containsKey(t))}}class $u{constructor(e,t){this.$s={},this.overlays={},this.Os=new Gi(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new qu(this),this.indexManager=new Yc,this.remoteDocumentCache=function(e){return new Vu(e)}(e=>this.referenceDelegate.Ls(e)),this.serializer=new fc(t),this.qs=new ju(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new zu(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Vr("MemoryPersistence","Starting transaction:",e);const r=new Gu(this.Os.next());return this.referenceDelegate.Us(),n(r).next(e=>this.referenceDelegate.Ks(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Gs(e,t){return Oi.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class Gu extends Ri{constructor(e){super(),this.currentSequenceNumber=e}}class Wu{constructor(e){this.persistence=e,this.Qs=new Uu,this.js=null}static zs(e){return new Wu(e)}get Ws(){if(this.js)return this.js;throw Gr()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),Oi.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),Oi.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),Oi.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(e=>this.Ws.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Ws.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oi.forEach(this.Ws,n=>{const r=bi.fromPath(n);return this.Hs(e,r).next(e=>{e||t.removeEntry(r,pi.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return Oi.or([()=>Oi.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class Qu{constructor(e,t){this.persistence=e,this.Js=new ga(e=>Yi(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=_u(this,t)}static zs(e,t){return new Qu(e,t)}Us(){}Ks(e){return Oi.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}zn(e){const t=this.Jn(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Jn(e){let t=0;return this.Wn(e,e=>{t++}).next(()=>t)}Wn(e,t){return Oi.forEach(this.Js,(n,r)=>this.Xn(e,n,r).next(e=>e?Oi.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.Cs(e,r=>this.Xn(e,r,t).next(e=>{e||(n++,i.removeEntry(r,pi.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.Js.set(t,e.currentSequenceNumber),Oi.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.Js.set(n,e.currentSequenceNumber),Oi.resolve()}removeReference(e,t,n){return this.Js.set(n,e.currentSequenceNumber),Oi.resolve()}updateLimboDocument(e,t){return this.Js.set(t,e.currentSequenceNumber),Oi.resolve()}Ls(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=no(e.data.value)),t}Xn(e,t,n){return Oi.or([()=>this.persistence.Gs(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.Js.get(t);return Oi.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ku{constructor(e){this.serializer=e}O(e,t,n,r){const i=new Pi("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",es,{unique:!0}),e.createObjectStore("documentMutations")}(e),Yu(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=Oi.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Yu(e)),s=s.next(()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pi.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>function(e,t){return t.store("mutations").j().next(n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",es,{unique:!0});const r=t.store("mutations"),i=n.map(e=>r.put(e));return Oi.waitFor(i)})}(e,i))),s=s.next(()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.Ys(i))),n<6&&r>=6&&(s=s.next(()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(i)))),n<7&&r>=7&&(s=s.next(()=>this.Zs(i))),n<8&&r>=8&&(s=s.next(()=>this.ti(e,i))),n<9&&r>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(s=s.next(()=>this.ei(i))),n<11&&r>=11&&(s=s.next(()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(s=s.next(()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:gs});t.createIndex("collectionPathOverlayIndex",ms,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",vs,{unique:!1})}(e)})),n<13&&r>=13&&(s=s.next(()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:is});t.createIndex("documentKeyIndex",ss),t.createIndex("collectionGroupIndex",os)}(e)).next(()=>this.ni(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(s=s.next(()=>this.si(e,i))),n<15&&r>=15&&(s=s.next(()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:ds}).createIndex("sequenceNumberIndex",hs,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:fs}).createIndex("documentKeyIndex",ps,{unique:!1})}(e))),s}Xs(e){let t=0;return e.store("remoteDocuments").X((e,n)=>{t+=lu(n)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Ys(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.j().next(t=>Oi.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.j("userMutationsIndex",r).next(n=>Oi.forEach(n,n=>{Wr(n.userId===t.userId);const r=yc(this.serializer,n);return au(e,t.userId,r).next(()=>{})}))}))}Zs(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(e=>{const r=[];return n.X((n,i)=>{const s=new mi(n),o=function(e){return[0,Yi(e)]}(s);r.push(t.get(o).next(n=>n?Oi.resolve():(n=>t.put({targetId:0,path:Yi(n),sequenceNumber:e.highestListenSequenceNumber}))(s)))}).next(()=>Oi.waitFor(r))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:us});const n=t.store("collectionParents"),r=new Xc,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Yi(r)})}};return t.store("remoteDocuments").X({Y:!0},(e,t)=>{const n=new mi(e);return i(n.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},(e,t)=>{let[n,r,s]=e;const o=Zi(r);return i(o.popLast())}))}ei(e){const t=e.store("targets");return t.X((e,n)=>{const r=bc(n),i=wc(this.serializer,r);return t.put(i)})}ni(e,t){const n=t.store("remoteDocuments"),r=[];return n.X((e,n)=>{const i=t.store("remoteDocumentsV14"),s=(o=n,o.document?new bi(mi.fromString(o.document.name).popFirst(5)):o.noDocument?bi.fromSegments(o.noDocument.path):o.unknownDocument?bi.fromSegments(o.unknownDocument.path):Gr()).path.toArray();var o;const a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(a))}).next(()=>Oi.waitFor(r))}si(e,t){const n=t.store("mutations"),r=Du(this.serializer),i=new $u(Wu.zs,this.serializer.fe);return n.j().next(e=>{const n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Ta();yc(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),Oi.forEach(n,(e,n)=>{const s=new jr(n),o=Dc.de(this.serializer,s),a=i.getIndexManager(s),l=cu.de(s,this.serializer,a,i.referenceDelegate);return new Lu(r,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new _s(t,Gi.ct),e).next()})})}}function Yu(e){e.createObjectStore("targetDocuments",{keyPath:ls}).createIndex("documentTargetsIndex",cs,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",as,{unique:!0}),e.createObjectStore("targetGlobal")}const Xu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Ju{constructor(e,t,n,r,i,s,o,a,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ii=i,this.window=s,this.document=o,this.ri=l,this.oi=c,this.ui=u,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=e=>Promise.resolve(),!Ju.D())throw new Xr(Yr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Cu(this,r),this.di=t+"main",this.serializer=new fc(a),this.wi=new Li(this.di,this.ui,new Ku(this.serializer)),this.Bs=new gu(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Du(this.serializer),this.qs=new xc,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===c&&Hr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Xr(Yr.FAILED_PRECONDITION,Xu);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new Gi(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ed(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(e=>{e||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(Ui(e))return Vr("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Vr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return Zu(e).get("owner").next(e=>Oi.resolve(this.Ri(e)))}Pi(e){return ed(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Vi(this.li,18e5)){this.li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=Cs(e,"clientMetadata");return t.j().next(e=>{const n=this.Si(e,18e5),r=e.filter(e=>-1===n.indexOf(e));return Oi.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this._i)for(const t of e)this._i.removeItem(this.Di(t.clientId))}}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?Oi.resolve(!0):Zu(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new Xr(Yr.FAILED_PRECONDITION,Xu);return!1}}return!(!this.networkEnabled||!this.inForeground)||ed(e).j().next(e=>void 0===this.Si(e,5e3).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&Vr("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),await this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new _s(e,Gi.ct);return this.Ai(t).next(()=>this.Pi(t))}),this.wi.close(),this.Mi()}Si(e,t){return e.filter(e=>this.Vi(e.updateTimeMs,t)&&!this.Ci(e.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>ed(e).j().next(e=>this.Si(e,18e5).map(e=>e.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return cu.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Zc(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return Dc.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,n){Vr("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=15===(s=this.ui)?Es:14===s?Ss:13===s?ws:12===s?bs:11===s?ys:void Gr();var s;let o;return this.wi.runTransaction(e,r,i,r=>(o=new _s(r,this.Os?this.Os.next():Gi.ct),"readwrite-primary"===t?this.Ti(o).next(e=>!!e||this.Ei(o)).next(t=>{if(!t)throw Hr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new Xr(Yr.FAILED_PRECONDITION,Ni);return n(o)}).next(e=>this.vi(o).next(()=>e)):this.Oi(o).next(()=>n(o)))).then(e=>(o.raiseOnCommittedEvent(),e))}Oi(e){return Zu(e).get("owner").next(e=>{if(null!==e&&this.Vi(e.leaseTimestampMs,5e3)&&!this.Ci(e.ownerId)&&!this.Ri(e)&&!(this.oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Xr(Yr.FAILED_PRECONDITION,Xu)})}vi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Zu(e).put("owner",t)}static D(){return Li.D()}Ai(e){const t=Zu(e);return t.get("owner").next(e=>this.Ri(e)?(Vr("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):Oi.resolve())}Vi(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Hr(`Detected an update time that is in the future: ${e} > ${n}`),!1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const e=/(?:Version|Mobile)\/1[456]/;(0,f.nr)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{const n=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return Vr("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return Hr("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(o){Hr("Failed to set zombie client id.",o)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch(o){}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Zu(e){return Cs(e,"owner")}function ed(e){return Cs(e,"clientMetadata")}function td(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class nd{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=r}static Li(e,t){let n=Ta(),r=Ta();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new nd(e,t.fromCache,n,r)}}class rd{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ki(e,t).next(i=>i||this.Gi(e,t,r,n)).next(n=>n||this.Qi(e,t))}Ki(e,t){if(ea(t))return Oi.resolve(null);let n=sa(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=aa(t,null,"F"),n=sa(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Ta(...r);return this.Ui.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ji(t,r);return this.zi(t,s,i,n.readTime)?this.Ki(e,aa(t,null,"F")):this.Wi(e,s,t,n)}))})))}Gi(e,t,n,r){return ea(t)||r.isEqual(pi.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(i=>{const s=this.ji(t,i);return this.zi(t,s,n,r)?this.Qi(e,t):(Br()<=u.$b.DEBUG&&Vr("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ua(t)),this.Wi(e,s,t,Ii(r,-1)))})}ji(e,t){let n=new Ns(fa(e));return t.forEach((t,r)=>{da(e,r)&&(n=n.add(r))}),n}zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Qi(e,t){return Br()<=u.$b.DEBUG&&Vr("QueryEngine","Using full collection scan to execute query:",ua(t)),this.Ui.getDocumentsMatchingQuery(e,t,Ai.min())}Wi(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class id{constructor(e,t,n,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new Ds(ui),this.Yi=new ga(e=>$o(e),Go),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Lu(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function sd(e,t,n,r){return new id(e,t,n,r)}async function od(e,t){const n=Kr(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.tr(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=Ta();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({er:e,removedBatchIds:i,addedBatchIds:s}))})})}function ad(e){const t=Kr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Bs.getLastRemoteSnapshotVersion(e))}function ld(e,t,n){let r=Ta(),i=Ta();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=va();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(pi.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Vr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{nr:r,sr:i}})}function cd(e,t){const n=Kr(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function ud(e,t){const n=Kr(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Bs.getTargetData(e,t).next(i=>i?(r=i,Oi.resolve(r)):n.Bs.allocateTargetId(e).next(i=>(r=new hc(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e})}async function dd(e,t,n){const r=Kr(e),i=r.Ji.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!Ui(e))throw e;Vr("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ji=r.Ji.remove(t),r.Yi.delete(i.target)}function hd(e,t,n){const r=Kr(e);let i=pi.min(),s=Ta();return r.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const r=Kr(e),i=r.Yi.get(n);return void 0!==i?Oi.resolve(r.Ji.get(i)):r.Bs.getTargetData(t,n)}(r,e,sa(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Hi.getDocumentsMatchingQuery(e,t,n?i:pi.min(),n?s:Ta())).next(e=>(gd(r,ha(t),e),{documents:e,ir:s})))}function fd(e,t){const n=Kr(e),r=Kr(n.Bs),i=n.Ji.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",e=>r.le(e,t).next(e=>e?e.target:null))}function pd(e,t){const n=Kr(e),r=n.Xi.get(t)||pi.min();return n.persistence.runTransaction("Get new document changes","readonly",e=>n.Zi.getAllFromCollectionGroup(e,t,Ii(r,-1),Number.MAX_SAFE_INTEGER)).then(e=>(gd(n,t,e),e))}function gd(e,t,n){let r=e.Xi.get(t)||pi.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Xi.set(t,r)}async function md(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ta();const r=await ud(e,sa(Sc(t.bundledQuery))),i=Kr(e);return i.persistence.runTransaction("Save named query","readwrite",e=>{const s=zl(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.qs.saveNamedQuery(e,t);const o=r.withResumeToken(js.EMPTY_BYTE_STRING,s);return i.Ji=i.Ji.insert(o.targetId,o),i.Bs.updateTargetData(e,o).next(()=>i.Bs.removeMatchingKeysForTargetId(e,r.targetId)).next(()=>i.Bs.addMatchingKeys(e,n,r.targetId)).next(()=>i.qs.saveNamedQuery(e,t))})}function vd(e,t){return`firestore_clients_${e}_${t}`}function yd(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function bd(e,t){return`firestore_targets_${e}_${t}`}class wd{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static ar(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new Xr(r.error.code,r.error.message))),s?new wd(e,t,r.state,i):(Hr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sd{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static ar(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new Xr(n.error.code,n.error.message))),i?new Sd(e,n.state,r):(Hr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ed{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Da();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=Ki(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new Ed(e,i):(Hr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class _d{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new _d(t.clientId,t.onlineState):(Hr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Cd{constructor(){this.activeTargetIds=Da()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xd{constructor(e,t,n,r,i){this.window=e,this.ii=t,this.persistenceKey=n,this.wr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new Ds(ui),this.started=!1,this.yr=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.pr=vd(this.persistenceKey,this.wr),this.Ir=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new Cd),this.Tr=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.vr=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Rr=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.$i();for(const n of e){if(n===this.wr)continue;const e=this.getItem(vd(this.persistenceKey,n));if(e){const t=Ed.ar(n,e);t&&(this.gr=this.gr.insert(t.clientId,t))}}this.Pr();const t=this.storage.getItem(this.vr);if(t){const e=this.br(t);e&&this.Vr(e)}for(const n of this.yr)this.mr(n);this.yr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,n){this.Dr(e,t,n),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(bd(this.persistenceKey,e));if(n){const r=Sd.ar(e,n);r&&(t=r.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(bd(this.persistenceKey,e))}updateQueryState(e,t,n){this.kr(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.Cr(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Vr("SharedClientState","READ",e,t),t}setItem(e,t){Vr("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Vr("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){const t=e;if(t.storageArea===this.storage){if(Vr("SharedClientState","EVENT",t.key,t.newValue),t.key===this.pr)return void Hr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.Tr.test(t.key)){if(null==t.newValue){const e=this.Or(t.key);return this.Fr(e,null)}{const e=this.Br(t.key,t.newValue);if(e)return this.Fr(e.clientId,e)}}else if(this.Er.test(t.key)){if(null!==t.newValue){const e=this.Lr(t.key,t.newValue);if(e)return this.qr(e)}}else if(this.Ar.test(t.key)){if(null!==t.newValue){const e=this.Ur(t.key,t.newValue);if(e)return this.Kr(e)}}else if(t.key===this.vr){if(null!==t.newValue){const e=this.br(t.newValue);if(e)return this.Vr(e)}}else if(t.key===this.Ir){const e=function(e){let t=Gi.ct;if(null!=e)try{const n=JSON.parse(e);Wr("number"==typeof n),t=n}catch(e){Hr("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==Gi.ct&&this.sequenceNumberHandler(e)}else if(t.key===this.Rr){const e=this.Gr(t.newValue);await Promise.all(e.map(e=>this.syncEngine.Qr(e)))}}else this.yr.push(t)})}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,n){const r=new wd(this.currentUser,e,t,n),i=yd(this.persistenceKey,this.currentUser,e);this.setItem(i,r.hr())}Cr(e){const t=yd(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){const t={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(t))}kr(e,t,n){const r=bd(this.persistenceKey,e),i=new Sd(e,t,n);this.setItem(r,i.hr())}$r(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){const t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){const n=this.Or(e);return Ed.ar(n,t)}Lr(e,t){const n=this.Er.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return wd.ar(new jr(i),r,t)}Ur(e,t){const n=this.Ar.exec(e),r=Number(n[1]);return Sd.ar(r,t)}br(e){return _d.ar(e)}Gr(e){return JSON.parse(e)}async qr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.jr(e.batchId,e.state,e.error);Vr("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){const n=t?this.gr.insert(e,t):this.gr.remove(e),r=this.Sr(this.gr),i=this.Sr(n),s=[],o=[];return i.forEach(e=>{r.has(e)||s.push(e)}),r.forEach(e=>{i.has(e)||o.push(e)}),this.syncEngine.Wr(s,o).then(()=>{this.gr=n})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=Da();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class Td{constructor(){this.Hr=new Cd,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Cd,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Id{Yr(e){}shutdown(){}}class Dd{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Vr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Vr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ad=null;function kd(){return null===Ad?Ad=268435456+Math.round(2147483648*Math.random()):Ad++,"0x"+Ad.toString(16)}const Nd={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Rd{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Md="WebChannelConnection";class Od extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,r,i){const s=kd(),o=this.To(e,t);Vr("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={};return this.Eo(a,r,i),this.Ao(e,o,a,n).then(t=>(Vr("RestConnection",`Received RPC '${e}' ${s}: `,t),t),t=>{throw qr("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}vo(e,t,n,r,i,s){return this.Io(e,t,n,r,i)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Fr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}To(e,t){const n=Nd[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,r){const i=kd();return new Promise((s,o)=>{const a=new Mr;a.setWithCredentials(!0),a.listenOnce(Dr.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Ir.NO_ERROR:const t=a.getResponseJson();Vr(Md,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Ir.TIMEOUT:Vr(Md,`RPC '${e}' ${i} timed out`),o(new Xr(Yr.DEADLINE_EXCEEDED,"Request time out"));break;case Ir.HTTP_ERROR:const n=a.getStatus();if(Vr(Md,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Yr).indexOf(t)>=0?t:Yr.UNKNOWN}(t.status);o(new Xr(e,t.message))}else o(new Xr(Yr.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Xr(Yr.UNAVAILABLE,"Connection failed."));break;default:Gr()}}finally{Vr(Md,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(r);Vr(Md,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)})}Ro(e,t,n){const r=kd(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=xr(),o=Tr(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.xmlHttpFactory=new Nr({})),this.Eo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");Vr(Md,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=s.createWebChannel(c,a);let d=!1,h=!1;const f=new Rd({ro:t=>{h?Vr(Md,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(Vr(Md,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),Vr(Md,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},oo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,Rr.EventType.OPEN,()=>{h||Vr(Md,`RPC '${e}' stream ${r} transport opened.`)}),p(u,Rr.EventType.CLOSE,()=>{h||(h=!0,Vr(Md,`RPC '${e}' stream ${r} transport closed`),f.wo())}),p(u,Rr.EventType.ERROR,t=>{h||(h=!0,qr(Md,`RPC '${e}' stream ${r} transport errored:`,t),f.wo(new Xr(Yr.UNAVAILABLE,"The operation could not be completed")))}),p(u,Rr.EventType.MESSAGE,t=>{var n;if(!h){const i=t.data[0];Wr(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Vr(Md,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=hl[e];if(void 0!==t)return gl(t)}(t),i=o.message;void 0===n&&(n=Yr.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),h=!0,f.wo(new Xr(n,i)),u.close()}else Vr(Md,`RPC '${e}' stream ${r} received:`,i),f._o(i)}}),p(o,Ar.STAT_EVENT,t=>{t.stat===kr.PROXY?Vr(Md,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===kr.NOPROXY&&Vr(Md,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.fo()},0),f}}function Pd(){return"undefined"!=typeof window?window:null}function Ld(){return"undefined"!=typeof document?document:null}function jd(e){return new Ll(e,!0)}class Fd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ii=e,this.timerId=t,this.Po=n,this.bo=r,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-n);r>0&&Vr("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class Ud{constructor(e,t,n,r,i,s,o,a){this.ii=e,this.$o=n,this.Oo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Fd(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===Yr.RESOURCE_EXHAUSTED?(Hr(t.toString()),Hr("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===Yr.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.Fo===t&&this.Zo(n,r)},t=>{e(()=>{const e=new Xr(Yr.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(e=>{n(()=>this.tu(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return Vr("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Vr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Bd extends Ud{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Gr()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Wr(void 0===t||"string"==typeof t),js.fromBase64String(t||"")):(Wr(void 0===t||t instanceof Uint8Array),js.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Yr.UNKNOWN:gl(e.code);return new Xr(t,e.message||"")}(o);n=new Dl(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=$l(e,r.document.name),s=zl(r.document.updateTime),o=r.document.createTime?zl(r.document.createTime):pi.min(),a=new mo({mapValue:{fields:r.document.fields}}),l=yo.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Tl(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=$l(e,r.document),s=r.readTime?zl(r.readTime):pi.min(),o=yo.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Tl([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=$l(e,r.document),s=r.removedTargetIds||[];n=new Tl([],s,i,null)}else{if(!("filter"in t))return Gr();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new dl(r,i),o=e.targetId;n=new Il(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return pi.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?pi.min():t.readTime?zl(t.readTime):pi.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=Ql(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Wo(r)?{documents:ec(e,r)}:{query:tc(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ul(e,t.resumeToken);const r=jl(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(pi.min())>0){n.readTime=Fl(e,t.snapshotVersion.toTimestamp());const r=jl(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Gr()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=Ql(this.serializer),t.removeTarget=e,this.Wo(t)}}class zd extends Ud{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(Wr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(Wr(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?zl(e.updateTime):zl(t);return n.isEqual(pi.min())&&(n=zl(t)),new $a(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=zl(e.commitTime);return this.listener.cu(n,t)}return Wr(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Ql(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Jl(this.serializer,e))};this.Wo(t)}}class Vd extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new Xr(Yr.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(r=>{let[i,s]=r;return this.connection.Io(e,t,n,i,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Yr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Xr(Yr.UNKNOWN,e.toString())})}vo(e,t,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.vo(e,t,n,s,o,r)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Yr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Xr(Yr.UNKNOWN,e.toString())})}terminate(){this.lu=!0}}class Hd{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Hr(t),this.mu=!1):Vr("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class qd{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(e=>{n.enqueueAndForget(async()=>{Zd(this)&&(Vr("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Kr(e);t.vu.add(4),await Gd(t),t.bu.set("Unknown"),t.vu.delete(4),await $d(t)}(this))})}),this.bu=new Hd(n,r)}}async function $d(e){if(Zd(e))for(const t of e.Ru)await t(!0)}async function Gd(e){for(const t of e.Ru)await t(!1)}function Wd(e,t){const n=Kr(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),Jd(n)?Xd(n):vh(n).Ko()&&Kd(n,t))}function Qd(e,t){const n=Kr(e),r=vh(n);n.Au.delete(t),r.Ko()&&Yd(n,t),0===n.Au.size&&(r.Ko()?r.jo():Zd(n)&&n.bu.set("Unknown"))}function Kd(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(pi.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}vh(e).su(t)}function Yd(e,t){e.Vu.qt(t),vh(e).iu(t)}function Xd(e){e.Vu=new kl({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),vh(e).start(),e.bu.gu()}function Jd(e){return Zd(e)&&!vh(e).Uo()&&e.Au.size>0}function Zd(e){return 0===Kr(e).vu.size}function eh(e){e.Vu=void 0}async function th(e){e.Au.forEach((t,n)=>{Kd(e,t)})}async function nh(e,t){eh(e),Jd(e)?(e.bu.Iu(t),Xd(e)):e.bu.set("Unknown")}async function rh(e,t,n){if(e.bu.set("Online"),t instanceof Dl&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Au.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Au.delete(r),e.Vu.removeTarget(r))}(e,t)}catch(n){Vr("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ih(e,n)}else if(t instanceof Tl?e.Vu.Ht(t):t instanceof Il?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(pi.min()))try{const t=await ad(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Au.get(r);i&&e.Au.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Au.get(t);if(!r)return;e.Au.set(t,r.withResumeToken(js.EMPTY_BYTE_STRING,r.snapshotVersion)),Yd(e,t);const i=new hc(r.target,t,n,r.sequenceNumber);Kd(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Vr("RemoteStore","Failed to raise snapshot:",t),await ih(e,t)}}async function ih(e,t,n){if(!Ui(t))throw t;e.vu.add(1),await Gd(e),e.bu.set("Offline"),n||(n=()=>ad(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Vr("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await $d(e)})}function sh(e,t){return t().catch(n=>ih(e,n,t))}async function oh(e){const t=Kr(e),n=yh(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;ah(t);)try{const e=await cd(t.localStore,r);if(null===e){0===t.Eu.length&&n.jo();break}r=e.batchId,lh(t,e)}catch(e){await ih(t,e)}ch(t)&&uh(t)}function ah(e){return Zd(e)&&e.Eu.length<10}function lh(e,t){e.Eu.push(t);const n=yh(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function ch(e){return Zd(e)&&!yh(e).Uo()&&e.Eu.length>0}function uh(e){yh(e).start()}async function dh(e){yh(e).hu()}async function hh(e){const t=yh(e);for(const n of e.Eu)t.uu(n.mutations)}async function fh(e,t,n){const r=e.Eu.shift(),i=ll.from(r,t,n);await sh(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await oh(e)}async function ph(e,t){t&&yh(e).ou&&await async function(e,t){if(pl(n=t.code)&&n!==Yr.ABORTED){const n=e.Eu.shift();yh(e).Qo(),await sh(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await oh(e)}var n}(e,t),ch(e)&&uh(e)}async function gh(e,t){const n=Kr(e);n.asyncQueue.verifyOperationInProgress(),Vr("RemoteStore","RemoteStore received new credentials");const r=Zd(n);n.vu.add(3),await Gd(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await $d(n)}async function mh(e,t){const n=Kr(e);t?(n.vu.delete(2),await $d(n)):t||(n.vu.add(2),await Gd(n),n.bu.set("Unknown"))}function vh(e){return e.Su||(e.Su=function(e,t,n){const r=Kr(e);return r.fu(),new Bd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:th.bind(null,e),ao:nh.bind(null,e),nu:rh.bind(null,e)}),e.Ru.push(async t=>{t?(e.Su.Qo(),Jd(e)?Xd(e):e.bu.set("Unknown")):(await e.Su.stop(),eh(e))})),e.Su}function yh(e){return e.Du||(e.Du=function(e,t,n){const r=Kr(e);return r.fu(),new zd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:dh.bind(null,e),ao:ph.bind(null,e),au:hh.bind(null,e),cu:fh.bind(null,e)}),e.Ru.push(async t=>{t?(e.Du.Qo(),await oh(e)):(await e.Du.stop(),e.Eu.length>0&&(Vr("RemoteStore",`Stopping write stream with ${e.Eu.length} pending writes`),e.Eu=[]))})),e.Du}class bh{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Jr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new bh(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Xr(Yr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wh(e,t){if(Hr("AsyncQueue",`${t}: ${e}`),Ui(e))return new Xr(Yr.UNAVAILABLE,`${t}: ${e}`);throw e}class Sh{constructor(e){this.comparator=e?(t,n)=>e(t,n)||bi.comparator(t.key,n.key):(e,t)=>bi.comparator(e.key,t.key),this.keyedMap=ba(),this.sortedSet=new Ds(this.comparator)}static emptySet(e){return new Sh(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Sh))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Sh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Eh{constructor(){this.Cu=new Ds(bi.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Gr():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class _h{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new _h(e,t,Sh.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&la(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Ch{constructor(){this.Nu=void 0,this.listeners=[]}}class xh{constructor(){this.queries=new ga(e=>ca(e),la),this.onlineState="Unknown",this.ku=new Set}}async function Th(e,t){const n=Kr(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Ch),i)try{s.Nu=await n.onListen(r)}catch(e){const n=wh(e,`Initialization of query '${ua(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.Mu(n.onlineState),s.Nu&&t.$u(s.Nu)&&kh(n)}async function Ih(e,t){const n=Kr(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function Dh(e,t){const n=Kr(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.$u(i)&&(r=!0);t.Nu=i}}r&&kh(n)}function Ah(e,t,n){const r=Kr(e),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(t)}function kh(e){e.ku.forEach(e=>{e.next()})}class Nh{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new _h(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=_h.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class Rh{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}}class Mh{constructor(e){this.serializer=e}rr(e){return $l(this.serializer,e)}ur(e){return e.metadata.exists?Xl(this.serializer,e.document,!1):yo.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return zl(e)}}class Oh{constructor(e,t,n){this.ju=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Ph(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;const n=mi.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){const t=new Map,n=new Mh(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.rr(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Ta()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=Kr(e);let s=Ta(),o=va();for(const c of n){const e=t.rr(c.metadata.name);c.document&&(s=s.add(e));const n=t.ur(c);n.setReadTime(t.cr(c.metadata.readTime)),o=o.insert(e,n)}const a=i.Zi.newChangeBuffer({trackRemovals:!0}),l=await ud(i,function(e){return sa(Zo(mi.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",e=>ld(e,a,o).next(t=>(a.apply(e),t)).next(t=>i.Bs.removeMatchingKeysForTargetId(e,l.targetId).next(()=>i.Bs.addMatchingKeys(e,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(e,t.nr,t.sr)).next(()=>t.nr)))}(this.localStore,new Mh(this.serializer),this.documents,this.ju.id),t=this.Wu(this.documents);for(const n of this.queries)await md(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:e}}}function Ph(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class Lh{constructor(e){this.key=e}}class jh{constructor(e){this.key=e}}class Fh{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Ta(),this.mutatedKeys=Ta(),this.tc=fa(e),this.ec=new Sh(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new Eh,r=t?t.ec:this.ec;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=da(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.rc(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.tc(u,a)>0||l&&this.tc(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{ec:s,ic:n,zi:o,mutatedKeys:i}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Gr()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc)),this.oc(n);const s=t?this.uc():[],o=0===this.Zu.size&&this.current?1:0,a=o!==this.Xu;return this.Xu=o,0!==i.length||a?{snapshot:new _h(this.query,e.ec,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Eh,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(e=>this.Yu=this.Yu.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Yu=this.Yu.delete(e)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Ta(),this.ec.forEach(e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))});const t=[];return e.forEach(e=>{this.Zu.has(e)||t.push(new jh(e))}),this.Zu.forEach(n=>{e.has(n)||t.push(new Lh(n))}),t}hc(e){this.Yu=e.ir,this.Zu=Ta();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return _h.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Uh{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Bh{constructor(e){this.key=e,this.fc=!1}}class zh{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new ga(e=>ca(e),la),this._c=new Map,this.mc=new Set,this.gc=new Ds(bi.comparator),this.yc=new Map,this.Ic=new Uu,this.Tc={},this.Ec=new Map,this.Ac=pu.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function Vh(e,t){const n=gf(e);let r,i;const s=n.wc.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{const e=await ud(n.localStore,sa(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await Hh(n,t,r,"current"===s,e.resumeToken),n.isPrimaryClient&&Wd(n.remoteStore,e)}return i}async function Hh(e,t,n,r,i){e.Rc=(t,n,r)=>async function(e,t,n,r){let i=t.view.sc(n);i.zi&&(i=await hd(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.sc(n,i)}));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return ef(e,t.targetId,o.cc),o.snapshot}(e,t,n,r);const s=await hd(e.localStore,t,!0),o=new Fh(t,s.ir),a=o.sc(s.documents),l=xl.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);ef(e,n,c.cc);const u=new Uh(t,n,o);return e.wc.set(t,u),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),c.snapshot}async function qh(e,t){const n=Kr(e),r=n.wc.get(t),i=n._c.get(r.targetId);if(i.length>1)return n._c.set(r.targetId,i.filter(e=>!la(e,t))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await dd(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Qd(n.remoteStore,r.targetId),Jh(n,r.targetId)}).catch(Mi)):(Jh(n,r.targetId),await dd(n.localStore,r.targetId,!0))}async function $h(e,t){const n=Kr(e);try{const e=await function(e,t){const n=Kr(e),r=t.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Bs.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Bs.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(js.EMPTY_BYTE_STRING,pi.min()).withLastLimboFreeSnapshotVersion(pi.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Bs.updateTargetData(e,c))});let a=va(),l=Ta();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(ld(e,s,t.documentUpdates).next(e=>{a=e.nr,l=e.sr})),!r.isEqual(pi.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next(t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Oi.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Ji=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.yc.get(t);r&&(Wr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.fc=!0:e.modifiedDocuments.size>0?Wr(r.fc):e.removedDocuments.size>0&&(Wr(r.fc),r.fc=!1))}),await rf(n,e,t)}catch(e){await Mi(e)}}function Gh(e,t,n){const r=Kr(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wc.forEach((n,r)=>{const i=r.view.Mu(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Kr(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.listeners)i.Mu(t)&&(r=!0)}),r&&kh(n)}(r.eventManager,t),e.length&&r.dc.nu(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Wh(e,t,n){const r=Kr(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.yc.get(t),s=i&&i.key;if(s){let e=new Ds(bi.comparator);e=e.insert(s,yo.newNoDocument(s,pi.min()));const n=Ta().add(s),i=new Cl(pi.min(),new Map,new Ds(ui),e,n);await $h(r,i),r.gc=r.gc.remove(s),r.yc.delete(t),nf(r)}else await dd(r.localStore,t,!1).then(()=>Jh(r,t,n)).catch(Mi)}async function Qh(e,t){const n=Kr(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Kr(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Oi.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);Wr(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Ta();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Xh(n,r,null),Yh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await rf(n,e)}catch(e){await Mi(e)}}async function Kh(e,t,n){const r=Kr(e);try{const e=await function(e,t){const n=Kr(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Wr(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Xh(r,t,n),Yh(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await rf(r,e)}catch(n){await Mi(n)}}function Yh(e,t){(e.Ec.get(t)||[]).forEach(e=>{e.resolve()}),e.Ec.delete(t)}function Xh(e,t,n){const r=Kr(e);let i=r.Tc[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Tc[r.currentUser.toKey()]=i}}function Jh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e._c.get(t))e.wc.delete(r),n&&e.dc.Pc(r,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach(t=>{e.Ic.containsKey(t)||Zh(e,t)})}function Zh(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(Qd(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),nf(e))}function ef(e,t,n){for(const r of n)r instanceof Lh?(e.Ic.addReference(r.key,t),tf(e,r)):r instanceof jh?(Vr("SyncEngine","Document no longer in limbo: "+r.key),e.Ic.removeReference(r.key,t),e.Ic.containsKey(r.key)||Zh(e,r.key)):Gr()}function tf(e,t){const n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(Vr("SyncEngine","New document in limbo: "+n),e.mc.add(r),nf(e))}function nf(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new bi(mi.fromString(t)),r=e.Ac.next();e.yc.set(r,new Bh(n)),e.gc=e.gc.insert(n,r),Wd(e.remoteStore,new hc(sa(Zo(n.path)),r,"TargetPurposeLimboResolution",Gi.ct))}}async function rf(e,t,n){const r=Kr(e),i=[],s=[],o=[];r.wc.isEmpty()||(r.wc.forEach((e,a)=>{o.push(r.Rc(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=nd.Li(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.dc.nu(i),await async function(e,t){const n=Kr(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Oi.forEach(t,t=>Oi.forEach(t.Fi,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Oi.forEach(t.Bi,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Ui(e))throw e;Vr("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ji.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ji=n.Ji.insert(e,i)}}}(r.localStore,s))}async function sf(e,t){const n=Kr(e);if(!n.currentUser.isEqual(t)){Vr("SyncEngine","User change. New user:",t.toKey());const e=await od(n.localStore,t);n.currentUser=t,function(e){e.Ec.forEach(e=>{e.forEach(e=>{e.reject(new Xr(Yr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Ec.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await rf(n,e.er)}}function of(e,t){const n=Kr(e),r=n.yc.get(t);if(r&&r.fc)return Ta().add(r.key);{let e=Ta();const r=n._c.get(t);if(!r)return e;for(const t of r){const r=n.wc.get(t);e=e.unionWith(r.view.nc)}return e}}async function af(e,t){const n=Kr(e),r=await hd(n.localStore,t.query,!0),i=t.view.hc(r);return n.isPrimaryClient&&ef(n,t.targetId,i.cc),i}async function lf(e,t){const n=Kr(e);return pd(n.localStore,t).then(e=>rf(n,e))}async function cf(e,t,n,r){const i=Kr(e),s=await function(e,t){const n=Kr(e),r=Kr(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>r.Sn(e,t).next(t=>t?n.localDocuments.getDocuments(e,t):Oi.resolve(null)))}(i.localStore,t);null!==s?("pending"===n?await oh(i.remoteStore):"acknowledged"===n||"rejected"===n?(Xh(i,t,r||null),Yh(i,t),function(e,t){Kr(Kr(e).mutationQueue).Cn(t)}(i.localStore,t)):Gr(),await rf(i,s)):Vr("SyncEngine","Cannot apply mutation batch with id: "+t)}async function uf(e,t,n){const r=Kr(e),i=[],s=[];for(const o of t){let e;const t=r._c.get(o);if(t&&0!==t.length){e=await ud(r.localStore,sa(t[0]));for(const e of t){const t=r.wc.get(e),n=await af(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await fd(r.localStore,o);e=await ud(r.localStore,t),await Hh(r,df(t),o,!1,e.resumeToken)}i.push(e)}return r.dc.nu(s),i}function df(e){return Jo(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function hf(e){const t=Kr(e);return Kr(Kr(t.localStore).persistence).$i()}async function ff(e,t,n,r){const i=Kr(e);if(i.vc)return void Vr("SyncEngine","Ignoring unexpected query state notification.");const s=i._c.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await pd(i.localStore,ha(s[0])),r=Cl.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,js.EMPTY_BYTE_STRING);await rf(i,e,r);break}case"rejected":await dd(i.localStore,t,!0),Jh(i,t,r);break;default:Gr()}}async function pf(e,t,n){const r=gf(e);if(r.vc){for(const e of t){if(r._c.has(e)){Vr("SyncEngine","Adding an already active target "+e);continue}const t=await fd(r.localStore,e),n=await ud(r.localStore,t);await Hh(r,df(t),n.targetId,!1,n.resumeToken),Wd(r.remoteStore,n)}for(const e of n)r._c.has(e)&&await dd(r.localStore,e,!1).then(()=>{Qd(r.remoteStore,e),Jh(r,e)}).catch(Mi)}}function gf(e){const t=Kr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=$h.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=of.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Wh.bind(null,t),t.dc.nu=Dh.bind(null,t.eventManager),t.dc.Pc=Ah.bind(null,t.eventManager),t}function mf(e){const t=Kr(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Qh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Kh.bind(null,t),t}class vf{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=jd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return sd(this.persistence,new rd,e.initialUser,this.serializer)}createPersistence(e){return new $u(Wu.zs,this.serializer)}createSharedClientState(e){return new Td}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class yf extends vf{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){Wr(this.persistence.referenceDelegate instanceof Qu);const n=this.persistence.referenceDelegate.garbageCollector;return new Su(n,e.asyncQueue,t)}createPersistence(e){const t=void 0!==this.cacheSizeBytes?ou.withCacheSize(this.cacheSizeBytes):ou.DEFAULT;return new $u(e=>Qu.zs(e,t),this.serializer)}}class bf extends vf{constructor(e,t,n){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Vc.initialize(this,e),await mf(this.Vc.syncEngine),await oh(this.Vc.remoteStore),await this.persistence.Ii(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return sd(this.persistence,new rd,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Su(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new $i(t,this.persistence);return new qi(e.asyncQueue,n)}createPersistence(e){const t=td(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ou.withCacheSize(this.cacheSizeBytes):ou.DEFAULT;return new Ju(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Pd(),Ld(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Td}}class wf extends bf{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Vc.syncEngine;this.sharedClientState instanceof xd&&(this.sharedClientState.syncEngine={jr:cf.bind(null,t),zr:ff.bind(null,t),Wr:pf.bind(null,t),$i:hf.bind(null,t),Qr:lf.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ii(async e=>{await async function(e,t){const n=Kr(e);if(gf(n),mf(n),!0===t&&!0!==n.vc){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await uf(n,e.toArray());n.vc=!0,await mh(n.remoteStore,!0);for(const r of t)Wd(n.remoteStore,r)}else if(!1===t&&!1!==n.vc){const e=[];let t=Promise.resolve();n._c.forEach((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then(()=>(Jh(n,i),dd(n.localStore,i,!0))),Qd(n.remoteStore,i)}),await t,await uf(n,e),function(e){const t=Kr(e);t.yc.forEach((e,n)=>{Qd(t.remoteStore,n)}),t.Ic.Ts(),t.yc=new Map,t.gc=new Ds(bi.comparator)}(n),n.vc=!1,await mh(n.remoteStore,!1)}}(this.Vc.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=Pd();if(!xd.D(t))throw new Xr(Yr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=td(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new xd(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Sf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Gh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=sf.bind(null,this.syncEngine),await mh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new xh}createDatastore(e){const t=jd(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Od(r));var r;return function(e,t,n,r){return new Vd(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>Gh(this.syncEngine,e,0),s=Dd.D()?new Dd:new Id,new qd(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new zh(e,t,n,r,i,s);return o&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Kr(e);Vr("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await Gd(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}function Ef(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class _f{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Hr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Cf{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new Jr,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(e=>{e&&e.Qu()?this.metadata.resolve(e.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.Gu)}`))},e=>this.metadata.reject(e))}close(){return this.Cc.cancel()}async getMetadata(){return this.metadata.promise}async bc(){return await this.getMetadata(),this.Nc()}async Nc(){const e=await this.kc();if(null===e)return null;const t=this.xc.decode(e),n=Number(t);isNaN(n)&&this.Mc(`length string (${t}) is not valid number`);const r=await this.$c(n);return new Rh(JSON.parse(r),e.length+n)}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async kc(){for(;this.Oc()<0&&!await this.Fc(););if(0===this.buffer.length)return null;const e=this.Oc();e<0&&this.Mc("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $c(e){for(;this.buffer.length<e;)await this.Fc()&&this.Mc("Reached the end of bundle when more is expected.");const t=this.xc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}async Fc(){const e=await this.Cc.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class xf{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Xr(Yr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=Kr(e),r=Ql(n.serializer)+"/documents",i={documents:t.map(e=>ql(n.serializer,e))},s=await n.vo("BatchGetDocuments",r,i,t.length),o=new Map;s.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){Wr(!!t.found),t.found.name,t.found.updateTime;const n=$l(e,t.found.name),r=zl(t.found.updateTime),i=t.found.createTime?zl(t.found.createTime):pi.min(),s=new mo({mapValue:{fields:t.found.fields}});return yo.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){Wr(!!t.missing),Wr(!!t.readTime);const n=$l(e,t.missing),r=zl(t.readTime);return yo.newNoDocument(n,r)}(e,t):Gr()}(n.serializer,e);o.set(t.key.toString(),t)});const a=[];return t.forEach(e=>{const t=o.get(e.toString());Wr(!!t),a.push(t)}),a}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new sl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=bi.fromPath(t);this.mutations.push(new ol(n,this.precondition(n)))}),await async function(e,t){const n=Kr(e),r=Ql(n.serializer)+"/documents",i={writes:t.map(e=>Jl(n.serializer,e))};await n.Io("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Gr();t=pi.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Xr(Yr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(pi.min())?Ga.exists(!1):Ga.updateTime(t):Ga.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(pi.min()))throw new Xr(Yr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ga.updateTime(t)}return Ga.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Tf{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Bc=n.maxAttempts,this.qo=new Fd(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){this.qo.No(async()=>{const e=new xf(this.datastore),t=this.qc(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Uc(e)}))}).catch(e=>{this.Uc(e)})})}qc(e){try{const t=this.updateFunction(e);return!Wi(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!pl(t)}return!1}}class If{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=jr.UNAUTHENTICATED,this.clientId=ci.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async e=>{Vr("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Vr("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Xr(Yr.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Jr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(s){const n=wh(s,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Df(e,t){e.asyncQueue.verifyOperationInProgress(),Vr("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await od(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Af(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Nf(e);Vr("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener(e=>gh(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>gh(t.remoteStore,n)),e._onlineComponents=t}function kf(e){return"FirebaseError"===e.name?e.code===Yr.FAILED_PRECONDITION||e.code===Yr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function Nf(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Vr("FirestoreClient","Using user provided OfflineComponentProvider");try{await Df(e,e._uninitializedComponentsProvider._offline)}catch(s){const n=s;if(!kf(n))throw n;qr("Error using user provided cache. Falling back to memory cache: "+n),await Df(e,new vf)}}else Vr("FirestoreClient","Using default OfflineComponentProvider"),await Df(e,new vf);return e._offlineComponents}async function Rf(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Vr("FirestoreClient","Using user provided OnlineComponentProvider"),await Af(e,e._uninitializedComponentsProvider._online)):(Vr("FirestoreClient","Using default OnlineComponentProvider"),await Af(e,new Sf))),e._onlineComponents}function Mf(e){return Nf(e).then(e=>e.persistence)}function Of(e){return Nf(e).then(e=>e.localStore)}function Pf(e){return Rf(e).then(e=>e.remoteStore)}function Lf(e){return Rf(e).then(e=>e.syncEngine)}function jf(e){return Rf(e).then(e=>e.datastore)}async function Ff(e){const t=await Rf(e),n=t.eventManager;return n.onListen=Vh.bind(null,t.syncEngine),n.onUnlisten=qh.bind(null,t.syncEngine),n}function Uf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Jr;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new _f({next:s=>{t.enqueueAndForget(()=>Ih(e,o));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Xr(Yr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Xr(Yr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new Nh(Zo(n.path),s,{includeMetadataChanges:!0,Ku:!0});return Th(e,o)}(await Ff(e),e.asyncQueue,t,n,r)),r.promise}function Bf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Jr;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new _f({next:n=>{t.enqueueAndForget(()=>Ih(e,o)),n.fromCache&&"server"===r.source?i.reject(new Xr(Yr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Nh(n,s,{includeMetadataChanges:!0,Ku:!0});return Th(e,o)}(await Ff(e),e.asyncQueue,t,n,r)),r.promise}function zf(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?yl().encode(e):e,function(e,t){return new Cf(e,t)}(function(e,t){if(e instanceof Uint8Array)return Ef(e,t);if(e instanceof ArrayBuffer)return Ef(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,jd(t));e.asyncQueue.enqueueAndForget(async()=>{!function(e,t,n){const r=Kr(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=Kr(e),r=zl(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.qs.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(r)>=0)}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(Ph(r));const i=new Oh(r,e.localStore,t.serializer);let s=await t.bc();for(;s;){const e=await i.zu(s);e&&n._updateProgress(e),s=await t.bc()}const o=await i.complete();return await rf(e,o.Ju,void 0),await function(e,t){const n=Kr(e);return n.persistence.runTransaction("Save bundle","readwrite",e=>n.qs.saveBundleMetadata(e,t))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.Hu)}catch(e){return qr("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then(e=>{r.sharedClientState.notifyBundleLoaded(e)})}(await Lf(e),i,r)})}function Vf(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Hf=new Map;function qf(e,t,n){if(!n)throw new Xr(Yr.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function $f(e,t,n,r){if(!0===t&&!0===r)throw new Xr(Yr.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Gf(e){if(!bi.isDocumentKey(e))throw new Xr(Yr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Wf(e){if(bi.isDocumentKey(e))throw new Xr(Yr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Qf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Gr()}function Kf(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Xr(Yr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Qf(e);throw new Xr(Yr.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Yf(e,t){if(t<=0)throw new Xr(Yr.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Xf{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Xr(Yr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Xr(Yr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$f("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vf(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Xr(Yr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Xr(Yr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Xr(Yr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Jf{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xf({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Xr(Yr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Xr(Yr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xf(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ei;switch(e.type){case"firstParty":return new ii(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Xr(Yr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Hf.get(e);t&&(Vr("ComponentProvider","Removing Datastore"),Hf.delete(e),t.terminate())}(this),Promise.resolve()}}function Zf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=Kf(e,Jf))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&qr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=jr.MOCK_USER;else{t=(0,f.Fy)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Xr(Yr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new jr(s)}e._authCredentials=new ti(new Zr(t,n))}}class ep{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new np(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ep(this.firestore,e,this._key)}}class tp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new tp(this.firestore,e,this._query)}}class np extends tp{constructor(e,t,n){super(e,t,Zo(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ep(this.firestore,null,new bi(e))}withConverter(e){return new np(this.firestore,e,this._path)}}function rp(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,f.Ku)(e),qf("collection","path",t),e instanceof Jf){const n=mi.fromString(t,...r);return Wf(n),new np(e,null,n)}{if(!(e instanceof ep||e instanceof np))throw new Xr(Yr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(mi.fromString(t,...r));return Wf(n),new np(e.firestore,null,n)}}function ip(e,t){if(e=Kf(e,Jf),qf("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Xr(Yr.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new tp(e,null,function(e){return new Xo(mi.emptyPath(),e)}(t))}function sp(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,f.Ku)(e),1===arguments.length&&(t=ci.A()),qf("doc","path",t),e instanceof Jf){const n=mi.fromString(t,...r);return Gf(n),new ep(e,null,new bi(n))}{if(!(e instanceof ep||e instanceof np))throw new Xr(Yr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(mi.fromString(t,...r));return Gf(n),new ep(e.firestore,e instanceof np?e.converter:null,new bi(n))}}function op(e,t){return e=(0,f.Ku)(e),t=(0,f.Ku)(t),(e instanceof ep||e instanceof np)&&(t instanceof ep||t instanceof np)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function ap(e,t){return e=(0,f.Ku)(e),t=(0,f.Ku)(t),e instanceof tp&&t instanceof tp&&e.firestore===t.firestore&&la(e._query,t._query)&&e.converter===t.converter}class lp{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Fd(this,"async_queue_retry"),this.Xc=()=>{const e=Ld();e&&Vr("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=Ld();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=Ld();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new Jr;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(o){if(!Ui(o))throw o;Vr("AsyncQueue","Operation failed with retryable error: "+o)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Hr("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.Hc=!1,e))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=bh.createAndSchedule(this,e,t,n,e=>this.na(e));return this.zc.push(r),r}Zc(){this.Wc&&Gr()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function cp(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const n of["next","error","complete"])if(n in t&&"function"==typeof t[n])return!0;return!1}(e)}class up{constructor(){this._progressObserver={},this._taskCompletionResolver=new Jr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const dp=-1;class hp extends Jf{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new lp,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||mp(this),this._firestoreClient.terminate()}}function fp(e,t,n){n||(n="(default)");const r=(0,i.j6)(e,"firestore");if(r.isInitialized(n)){const e=r.getImmediate({identifier:n}),i=r.getOptions(n);if((0,f.bD)(i,t))return e;throw new Xr(Yr.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new Xr(Yr.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Xr(Yr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:t,instanceIdentifier:n})}function pp(e,t){const n="object"==typeof e?e:(0,i.Sx)(),r="string"==typeof e?e:t||"(default)",s=(0,i.j6)(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const e=(0,f.yU)("firestore");e&&Zf(s,...e)}return s}function gp(e){return e._firestoreClient||mp(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function mp(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new $s(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Vf(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new If(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function vp(e,t){Ip(e=Kf(e,hp));const n=gp(e);if(n._uninitializedComponentsProvider)throw new Xr(Yr.FAILED_PRECONDITION,"SDK cache is already specified.");qr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new Sf;return bp(n,i,new bf(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function yp(e){Ip(e=Kf(e,hp));const t=gp(e);if(t._uninitializedComponentsProvider)throw new Xr(Yr.FAILED_PRECONDITION,"SDK cache is already specified.");qr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new Sf;return bp(t,r,new wf(r,n.cacheSizeBytes))}function bp(e,t,n){const r=new Jr;return e.asyncQueue.enqueue(async()=>{try{await Df(e,n),await Af(e,t),r.resolve()}catch(e){const n=e;if(!kf(n))throw n;qr("Error enabling indexeddb cache. Falling back to memory cache: "+n),r.reject(n)}}).then(()=>r.promise)}function wp(e){if(e._initialized&&!e._terminated)throw new Xr(Yr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new Jr;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!Li.D())return Promise.resolve();const t=e+"main";await Li.delete(t)}(td(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise}function Sp(e){return function(e){const t=new Jr;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t){const n=Kr(e);Zd(n.remoteStore)||Vr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=Kr(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))}(n.localStore);if(-1===e)return void t.resolve();const r=n.Ec.get(e)||[];r.push(t),n.Ec.set(e,r)}catch(e){const n=wh(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await Lf(e),t)),t.promise}(gp(e=Kf(e,hp)))}function Ep(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await Mf(e),n=await Pf(e);return t.setNetworkEnabled(!0),function(e){const t=Kr(e);return t.vu.delete(0),$d(t)}(n)})}(gp(e=Kf(e,hp)))}function _p(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await Mf(e),n=await Pf(e);return t.setNetworkEnabled(!1),async function(e){const t=Kr(e);t.vu.add(0),await Gd(t),t.bu.set("Offline")}(n)})}(gp(e=Kf(e,hp)))}function Cp(e){return(0,i.Us)(e.app,"firestore",e._databaseId.database),e._delete()}function xp(e,t){const n=gp(e=Kf(e,hp)),r=new up;return zf(n,e._databaseId,t,r),r}function Tp(e,t){return function(e,t){return e.asyncQueue.enqueue(async()=>function(e,t){const n=Kr(e);return n.persistence.runTransaction("Get named query","readonly",e=>n.qs.getNamedQuery(e,t))}(await Of(e),t))}(gp(e=Kf(e,hp)),t).then(t=>t?new tp(e,null,t.query):null)}function Ip(e){if(e._initialized||e._terminated)throw new Xr(Yr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Dp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"count",t=arguments.length>1?arguments[1]:void 0;this._aggregateType=e,this._internalFieldPath=t,this.type="AggregateField"}}class Ap{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class kp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new kp(js.fromBase64String(e))}catch(e){throw new Xr(Yr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new kp(js.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Np{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yi(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Rp(){return new Np("__name__")}class Mp{constructor(e){this._methodName=e}}class Op{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Xr(Yr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Xr(Yr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ui(this._lat,e._lat)||ui(this._long,e._long)}}const Pp=/^__.*__$/;class Lp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new tl(e,this.data,this.fieldMask,t,this.fieldTransforms):new el(e,this.data,t,this.fieldTransforms)}}class jp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new tl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Fp(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Gr()}}class Up{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Up(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return sg(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(Fp(this.ca)&&Pp.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Bp{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||jd(e)}ya(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Up({ca:e,methodName:t,ga:n,path:yi.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zp(e){const t=e._freezeSettings(),n=jd(e._databaseId);return new Bp(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Vp(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.ya(s.merge||s.mergeFields?2:0,t,n,i);tg("Data must be an object, but it was:",o,r);const a=Zp(r,o);let l,c;if(s.merge)l=new Os(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=ng(t,r,n);if(!o.contains(i))throw new Xr(Yr.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);og(e,i)||e.push(i)}l=new Os(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new Lp(new mo(a),l,c)}class Hp extends Mp{_toFieldTransform(e){if(2!==e.ca)throw 1===e.ca?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hp}}function qp(e,t,n){return new Up({ca:3,ga:t.settings.ga,methodName:e._methodName,la:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class $p extends Mp{_toFieldTransform(e){return new qa(e.path,new La)}isEqual(e){return e instanceof $p}}class Gp extends Mp{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=qp(this,e,!0),n=this.pa.map(e=>Jp(e,t)),r=new ja(n);return new qa(e.path,r)}isEqual(e){return this===e}}class Wp extends Mp{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=qp(this,e,!0),n=this.pa.map(e=>Jp(e,t)),r=new Ua(n);return new qa(e.path,r)}isEqual(e){return this===e}}class Qp extends Mp{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new za(e.serializer,Na(e.serializer,this.Ia));return new qa(e.path,t)}isEqual(e){return this===e}}function Kp(e,t,n,r){const i=e.ya(1,t,n);tg("Data must be an object, but it was:",i,r);const s=[],o=mo.empty();Ts(r,(e,r)=>{const a=ig(t,e,n);r=(0,f.Ku)(r);const l=i.da(a);if(r instanceof Hp)s.push(a);else{const e=Jp(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new Os(s);return new jp(o,a,i.fieldTransforms)}function Yp(e,t,n,r,i,s){const o=e.ya(1,t,n),a=[ng(t,r,n)],l=[i];if(s.length%2!=0)throw new Xr(Yr.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(ng(t,s[h])),l.push(s[h+1]);const c=[],u=mo.empty();for(let h=a.length-1;h>=0;--h)if(!og(c,a[h])){const e=a[h];let t=l[h];t=(0,f.Ku)(t);const n=o.da(e);if(t instanceof Hp)c.push(e);else{const r=Jp(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new Os(c);return new jp(u,d,o.fieldTransforms)}function Xp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Jp(n,e.ya(r?4:3,t))}function Jp(e,t){if(eg(e=(0,f.Ku)(e)))return tg("Unsupported field value:",t,e),Zp(e,t);if(e instanceof Mp)return function(e,t){if(!Fp(t.ca))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Jp(i,t.wa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,f.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Na(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=fi.fromDate(e);return{timestampValue:Fl(t.serializer,n)}}if(e instanceof fi){const n=new fi(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Fl(t.serializer,n)}}if(e instanceof Op)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof kp)return{bytesValue:Ul(t.serializer,e._byteString)};if(e instanceof ep){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t._a(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Vl(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${Qf(e)}`)}(e,t)}function Zp(e,t){const n={};return Is(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ts(e,(e,r)=>{const i=Jp(r,t.ha(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function eg(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof fi||e instanceof Op||e instanceof kp||e instanceof ep||e instanceof Mp)}function tg(e,t,n){if(!eg(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Qf(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function ng(e,t,n){if((t=(0,f.Ku)(t))instanceof Np)return t._internalPath;if("string"==typeof t)return ig(e,t);throw sg("Field path arguments must be of type string or ",e,!1,void 0,n)}const rg=new RegExp("[~\\*/\\[\\]]");function ig(e,t,n){if(t.search(rg)>=0)throw sg(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Np(...t.split("."))._internalPath}catch(h){throw sg(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function sg(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Xr(Yr.INVALID_ARGUMENT,a+e+l)}function og(e,t){return e.some(e=>e.isEqual(t))}class ag{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ep(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new lg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(cg("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class lg extends ag{data(){return super.data()}}function cg(e,t){return"string"==typeof t?ig(e,t):t instanceof Np?t._internalPath:t._delegate._internalPath}function ug(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Xr(Yr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dg{}class hg extends dg{}function fg(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof dg&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof mg).length,n=e.filter(e=>e instanceof pg).length;if(t>1||t>0&&n>0)throw new Xr(Yr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class pg extends hg{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new pg(e,t,n)}_apply(e){const t=this._parse(e);return Mg(e._query,t),new tp(e.firestore,e.converter,oa(e._query,t))}_parse(e){const t=zp(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Xr(Yr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Rg(o,s);const t=[];for(const n of o)t.push(Ng(r,e,n));a={arrayValue:{values:t}}}else a=Ng(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Rg(o,s),a=Xp(n,"where",o,"in"===s||"not-in"===s);return xo.create(i,s,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function gg(e,t,n){const r=t,i=cg("where",e);return pg._create(i,r,n)}class mg extends dg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new mg(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:To.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Mg(n,i),n=oa(n,i)}(e._query,t),new tp(e.firestore,e.converter,oa(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function vg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(e=>Pg("or",e)),mg._create("or",t)}function yg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(e=>Pg("and",e)),mg._create("and",t)}class bg extends hg{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new bg(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Eo(t,n);return function(e,t){if(null===ta(e)){const n=na(e);null!==n&&Og(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new tp(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Xo(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function wg(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=cg("orderBy",e);return bg._create(n,t)}class Sg extends hg{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Sg(e,t,n)}_apply(e){return new tp(e.firestore,e.converter,aa(e._query,this._limit,this._limitType))}}function Eg(e){return Yf("limit",e),Sg._create("limit",e,"F")}function _g(e){return Yf("limitToLast",e),Sg._create("limitToLast",e,"L")}class Cg extends hg{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Cg(e,t,n)}_apply(e){const t=kg(e,this.type,this._docOrFields,this._inclusive);return new tp(e.firestore,e.converter,function(e,t){return new Xo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function xg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Cg._create("startAt",t,!0)}function Tg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Cg._create("startAfter",t,!1)}class Ig extends hg{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Ig(e,t,n)}_apply(e){const t=kg(e,this.type,this._docOrFields,this._inclusive);return new tp(e.firestore,e.converter,function(e,t){return new Xo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function Dg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ig._create("endBefore",t,!1)}function Ag(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ig._create("endAt",t,!0)}function kg(e,t,n,r){if(n[0]=(0,f.Ku)(n[0]),n[0]instanceof ag)return function(e,t,n,r,i){if(!r)throw new Xr(Yr.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const o of ia(e))if(o.field.isKeyField())s.push(ro(t,r.key));else{const e=r.data.field(o.field);if(Vs(e))throw new Xr(Yr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new bo(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=zp(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new Xr(Yr.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let l=0;l<i.length;l++){const s=i[l];if(o[l].field.isKeyField()){if("string"!=typeof s)throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof s}`);if(!ra(e)&&-1!==s.indexOf("/"))throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${s}' contains a slash.`);const n=e.path.child(mi.fromString(s));if(!bi.isDocumentKey(n))throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new bi(n);a.push(ro(t,i))}else{const e=Xp(n,r,s);a.push(e)}}return new bo(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Ng(e,t,n){if("string"==typeof(n=(0,f.Ku)(n))){if(""===n)throw new Xr(Yr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ra(t)&&-1!==n.indexOf("/"))throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(mi.fromString(n));if(!bi.isDocumentKey(r))throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ro(e,new bi(r))}if(n instanceof ep)return ro(e,n._key);throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qf(n)}.`)}function Rg(e,t){if(!Array.isArray(e)||0===e.length)throw new Xr(Yr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Mg(e,t){if(t.isInequality()){const n=na(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);const i=ta(e);null!==i&&Og(e,r,i)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Xr(Yr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Xr(Yr.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Og(e,t,n){if(!n.isEqual(t))throw new Xr(Yr.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function Pg(e,t){if(!(t instanceof pg||t instanceof mg))throw new Xr(Yr.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Lg{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Gr()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Ts(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new Op(Bs(e.latitude),Bs(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Hs(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(qs(e));default:return null}}convertTimestamp(e){const t=Us(e);return new fi(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=mi.fromString(e);Wr(dc(n));const r=new Gs(n.get(1),n.get(3)),i=new bi(n.popFirst(5));return r.isEqual(t)||Hr(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function jg(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Fg extends Lg{constructor(e){super(),this.firestore=e}convertBytes(e){return new kp(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ep(this.firestore,null,t)}}function Ug(e){return new Dp("sum",ng("sum",e))}function Bg(e){return new Dp("avg",ng("average",e))}function zg(){return new Dp("count")}function Vg(e,t){var n,r;return e instanceof Dp&&t instanceof Dp&&e._aggregateType===t._aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())}function Hg(e,t){return ap(e.query,t.query)&&(0,f.bD)(e.data(),t.data())}class qg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $g extends ag{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Gg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(cg("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Gg extends $g{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Wg{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new qg(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Gg(this._firestore,this._userDataWriter,n.key,n,new qg(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Xr(Yr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Gg(e._firestore,e._userDataWriter,n.doc.key,n.doc,new qg(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Gg(e._firestore,e._userDataWriter,t.doc.key,t.doc,new qg(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Qg(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Qg(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Gr()}}function Kg(e,t){return e instanceof $g&&t instanceof $g?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Wg&&t instanceof Wg&&e._firestore===t._firestore&&ap(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function Yg(e){e=Kf(e,ep);const t=Kf(e.firestore,hp);return Uf(gp(t),e._key).then(n=>um(t,e,n))}class Xg extends Lg{constructor(e){super(),this.firestore=e}convertBytes(e){return new kp(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ep(this.firestore,null,t)}}function Jg(e){e=Kf(e,ep);const t=Kf(e.firestore,hp),n=gp(t),r=new Xg(t);return function(e,t){const n=new Jr;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const r=await function(e,t){const n=Kr(e);return n.persistence.runTransaction("read document","readonly",e=>n.localDocuments.getDocument(e,t))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new Xr(Yr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=wh(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await Of(e),t,n)),n.promise}(n,e._key).then(n=>new $g(t,r,e._key,n,new qg(null!==n&&n.hasLocalMutations,!0),e.converter))}function Zg(e){e=Kf(e,ep);const t=Kf(e.firestore,hp);return Uf(gp(t),e._key,{source:"server"}).then(n=>um(t,e,n))}function em(e){e=Kf(e,tp);const t=Kf(e.firestore,hp),n=gp(t),r=new Xg(t);return ug(e._query),Bf(n,e._query).then(n=>new Wg(t,r,e,n))}function tm(e){e=Kf(e,tp);const t=Kf(e.firestore,hp),n=gp(t),r=new Xg(t);return function(e,t){const n=new Jr;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const r=await hd(e,t,!0),i=new Fh(t,r.ir),s=i.sc(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=wh(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await Of(e),t,n)),n.promise}(n,e._query).then(n=>new Wg(t,r,e,n))}function nm(e){e=Kf(e,tp);const t=Kf(e.firestore,hp),n=gp(t),r=new Xg(t);return Bf(n,e._query,{source:"server"}).then(n=>new Wg(t,r,e,n))}function rm(e,t,n){e=Kf(e,ep);const r=Kf(e.firestore,hp),i=jg(e.converter,t,n);return cm(r,[Vp(zp(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Ga.none())])}function im(e,t,n){e=Kf(e,ep);const r=Kf(e.firestore,hp),i=zp(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=(0,f.Ku)(t))||t instanceof Np?Yp(i,"updateDoc",e._key,t,n,a):Kp(i,"updateDoc",e._key,t),cm(r,[s.toMutation(e._key,Ga.exists(!0))])}function sm(e){return cm(Kf(e.firestore,hp),[new sl(e._key,Ga.none())])}function om(e,t){const n=Kf(e.firestore,hp),r=sp(e),i=jg(e.converter,t);return cm(n,[Vp(zp(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Ga.exists(!1))]).then(()=>r)}function am(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=(0,f.Ku)(e);let a={includeMetadataChanges:!1},l=0;"object"!=typeof n[l]||cp(n[l])||(a=n[l],l++);const c={includeMetadataChanges:a.includeMetadataChanges};if(cp(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let u,d,h;if(e instanceof ep)d=Kf(e.firestore,hp),h=Zo(e._key.path),u={next:t=>{n[l]&&n[l](um(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Kf(e,tp);d=Kf(t.firestore,hp),h=t._query;const r=new Xg(d);u={next:e=>{n[l]&&n[l](new Wg(d,r,t,e))},error:n[l+1],complete:n[l+2]},ug(e._query)}return function(e,t,n,r){const i=new _f(r),s=new Nh(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>Th(await Ff(e),s)),()=>{i.Dc(),e.asyncQueue.enqueueAndForget(async()=>Ih(await Ff(e),s))}}(gp(d),h,c,u)}function lm(e,t){return function(e,t){const n=new _f(t);return e.asyncQueue.enqueueAndForget(async()=>function(e,t){Kr(e).ku.add(t),t.next()}(await Ff(e),n)),()=>{n.Dc(),e.asyncQueue.enqueueAndForget(async()=>function(e,t){Kr(e).ku.delete(t)}(await Ff(e),n))}}(gp(e=Kf(e,hp)),cp(t)?t:{next:t})}function cm(e,t){return function(e,t){const n=new Jr;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=mf(e);try{const e=await function(e,t){const n=Kr(e),r=fi.now(),i=t.reduce((e,t)=>e.add(t.key),Ta());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=va(),l=Ta();return n.Zi.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=Ja(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new tl(e.key,t,vo(t.value.mapValue),Ga.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:wa(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Tc[e.currentUser.toKey()];r||(r=new Ds(ui)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(r,e.batchId,n),await rf(r,e.changes),await oh(r.remoteStore)}catch(e){const t=wh(e,"Failed to persist write");n.reject(t)}}(await Lf(e),t,n)),n.promise}(gp(e),t)}function um(e,t,n){const r=n.docs.get(t._key),i=new Xg(e);return new $g(e,i,t._key,r,new qg(n.hasPendingWrites,n.fromCache),t.converter)}function dm(e){return hm(e,{count:zg()})}function hm(e,t){const n=Kf(e.firestore,hp),r=gp(n),i=function(e,t){const n=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r));return n}(t,(e,t)=>new ul(t,e._aggregateType,e._internalFieldPath));return function(e,t,n){const r=new Jr;return e.asyncQueue.enqueueAndForget(async()=>{try{const i=await jf(e);r.resolve(async function(e,t,n){var r;const i=Kr(e),{request:s,du:o}=function(e,t,n){const r=tc(e,t),i={},s=[];let o=0;return n.forEach(e=>{const t="aggregate_"+o++;i[t]=e.alias,"count"===e.yt?s.push({alias:t,count:{}}):"avg"===e.yt?s.push({alias:t,avg:{field:ac(e.fieldPath)}}):"sum"===e.yt&&s.push({alias:t,sum:{field:ac(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:s,structuredQuery:r.structuredQuery},parent:r.parent},du:i}}(i.serializer,sa(t),n),a=s.parent;i.connection.po||delete s.parent;const l=(await i.vo("RunAggregationQuery",a,s,1)).filter(e=>!!e.result);Wr(1===l.length);const c=null===(r=l[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(c).reduce((e,t)=>(e[o[t]]=c[t],e),{})}(i,t,n))}catch(e){r.reject(e)}}),r.promise}(r,e._query,i).then(t=>function(e,t,n){const r=new Xg(e);return new Ap(t,r,n)}(n,e,t))}class fm{constructor(e){this.kind="memory",this._onlineComponentProvider=new Sf,(null==e?void 0:e.garbageCollector)?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new vf}toJSON(){return{kind:this.kind}}}class pm{constructor(e){let t;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),t=e.tabManager):(t=_m(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class gm{constructor(){this.kind="memoryEager",this._offlineComponentProvider=new vf}toJSON(){return{kind:this.kind}}}class mm{constructor(e){this.kind="memoryLru",this._offlineComponentProvider=new yf(e)}toJSON(){return{kind:this.kind}}}function vm(){return new gm}function ym(e){return new mm(null==e?void 0:e.cacheSizeBytes)}function bm(e){return new fm(e)}function wm(e){return new pm(e)}class Sm{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Sf,this._offlineComponentProvider=new bf(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}class Em{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Sf,this._offlineComponentProvider=new wf(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes)}}function _m(e){return new Sm(null==e?void 0:e.forceOwnership)}function Cm(){return new Em}const xm={maxAttempts:5};class Tm{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zp(e)}set(e,t,n){this._verifyNotCommitted();const r=Im(e,this._firestore),i=jg(r.converter,t,n),s=Vp(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Ga.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Im(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=(0,f.Ku)(t))||t instanceof Np?Yp(this._dataReader,"WriteBatch.update",r._key,t,n,o):Kp(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,Ga.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Im(e,this._firestore);return this._mutations=this._mutations.concat(new sl(t._key,Ga.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Xr(Yr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Im(e,t){if((e=(0,f.Ku)(e)).firestore!==t)throw new Xr(Yr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Dm extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=zp(e)}get(e){const t=Im(e,this._firestore),n=new Fg(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return Gr();const r=e[0];if(r.isFoundDocument())return new ag(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new ag(this._firestore,n,t._key,null,t.converter);throw Gr()})}set(e,t,n){const r=Im(e,this._firestore),i=jg(r.converter,t,n),s=Vp(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n){const r=Im(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=(0,f.Ku)(t))||t instanceof Np?Yp(this._dataReader,"Transaction.update",r._key,t,n,o):Kp(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=Im(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Im(e,this._firestore),n=new Xg(this._firestore);return super.get(e).then(e=>new $g(this._firestore,n,t._key,e._document,new qg(!1,!1),t.converter))}}function Am(e,t,n){e=Kf(e,hp);const r=Object.assign(Object.assign({},xm),n);return function(e){if(e.maxAttempts<1)throw new Xr(Yr.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new Jr;return e.asyncQueue.enqueueAndForget(async()=>{const i=await jf(e);new Tf(e.asyncQueue,i,n,t,r).run()}),r.promise}(gp(e),n=>t(new Dm(e,n)),r)}function km(){return new Hp("deleteField")}function Nm(){return new $p("serverTimestamp")}function Rm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Gp("arrayUnion",t)}function Mm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Wp("arrayRemove",t)}function Om(e){return new Qp("increment",e)}function Pm(e){return gp(e=Kf(e,hp)),new Tm(e,t=>cm(e,t))}function Lm(e,t){var n;const r=gp(e=Kf(e,hp));if(!r._uninitializedComponentsProvider||"memory"===(null===(n=r._uninitializedComponentsProvider)||void 0===n?void 0:n._offlineKind))return qr("Cannot enable indexes when persistence is disabled"),Promise.resolve();const i=function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new Xr(Yr.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes))for(const r of t.indexes){const e=jm(r,"collectionGroup"),t=[];if(Array.isArray(r.fields))for(const n of r.fields){const e=ig("setIndexConfiguration",jm(n,"fieldPath"));"CONTAINS"===n.arrayConfig?t.push(new Ci(e,2)):"ASCENDING"===n.order?t.push(new Ci(e,0)):"DESCENDING"===n.order&&t.push(new Ci(e,1))}n.push(new wi(wi.UNKNOWN_ID,e,t,Ti.empty()))}return n}(t);return function(e,t){return e.asyncQueue.enqueue(async()=>async function(e,t){const n=Kr(e),r=n.indexManager,i=[];return n.persistence.runTransaction("Configure indexes","readwrite",e=>r.getFieldIndexes(e).next(n=>function(e,t,n,r,i){e=[...e],t=[...t],e.sort(n),t.sort(n);const s=e.length,o=t.length;let a=0,l=0;for(;a<o&&l<s;){const s=n(e[l],t[a]);s<0?i(e[l++]):s>0?r(t[a++]):(a++,l++)}for(;a<o;)r(t[a++]);for(;l<s;)i(e[l++])}(n,t,_i,t=>{i.push(r.addFieldIndex(e,t))},t=>{i.push(r.deleteFieldIndex(e,t))})).next(()=>Oi.waitFor(i)))}(await Of(e),t))}(r,i)}function jm(e,t){if("string"!=typeof e[t])throw new Xr(Yr.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Fr=e}(i.MF),(0,i.om)(new a.uA("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new hp(new ni(e.getProvider("auth-internal")),new oi(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Xr(Yr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gs(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(Lr,"3.13.0",e),(0,i.KO)(Lr,"3.13.0","esm2017")}()},43:(e,t,n)=>{e.exports=n(202)},150:(e,t,n)=>{n.d(t,{MF:()=>le,j6:()=>re,om:()=>ne,Us:()=>ie,Sx:()=>ue,Wp:()=>ce,KO:()=>de});var r=n(812),i=n(443),o=n(700);let a,l;const c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap;let p={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return v(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function g(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(y(this),n),v(c.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(e.apply(y(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(y(this),t,...r);return d.set(s,t.sort?t.sort():[t]),v(s)}}function m(e){return"function"===typeof e?g(e):(e instanceof IDBTransaction&&function(e){if(u.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});u.set(e,t)}(e),t=e,(a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,p):e);var t}function v(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(v(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&c.set(t,e)}).catch(()=>{}),f.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=m(e);return t!==e&&(h.set(e,t),f.set(t,e)),t}const y=e=>f.get(e);const b=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],S=new Map;function E(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(S.get(t))return S.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=w.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!b.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return S.set(t,s),s}p=(e=>({...e,get:(t,n,r)=>E(t,n)||e.get(t,n,r),has:(t,n)=>!!E(t,n)||e.has(t,n)}))(p);class _{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const C="@firebase/app",x="0.9.13",T=new i.Vy("@firebase/app"),I="@firebase/app-compat",D="@firebase/analytics-compat",A="@firebase/analytics",k="@firebase/app-check-compat",N="@firebase/app-check",R="@firebase/auth",M="@firebase/auth-compat",O="@firebase/database",P="@firebase/database-compat",L="@firebase/functions",j="@firebase/functions-compat",F="@firebase/installations",U="@firebase/installations-compat",B="@firebase/messaging",z="@firebase/messaging-compat",V="@firebase/performance",H="@firebase/performance-compat",q="@firebase/remote-config",$="@firebase/remote-config-compat",G="@firebase/storage",W="@firebase/storage-compat",Q="@firebase/firestore",K="@firebase/firestore-compat",Y="firebase",X="[DEFAULT]",J={[C]:"fire-core",[I]:"fire-core-compat",[A]:"fire-analytics",[D]:"fire-analytics-compat",[N]:"fire-app-check",[k]:"fire-app-check-compat",[R]:"fire-auth",[M]:"fire-auth-compat",[O]:"fire-rtdb",[P]:"fire-rtdb-compat",[L]:"fire-fn",[j]:"fire-fn-compat",[F]:"fire-iid",[U]:"fire-iid-compat",[B]:"fire-fcm",[z]:"fire-fcm-compat",[V]:"fire-perf",[H]:"fire-perf-compat",[q]:"fire-rc",[$]:"fire-rc-compat",[G]:"fire-gcs",[W]:"fire-gcs-compat",[Q]:"fire-fst",[K]:"fire-fst-compat","fire-js":"fire-js",[Y]:"fire-js-all"},Z=new Map,ee=new Map;function te(e,t){try{e.container.addComponent(t)}catch(s){T.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,s)}}function ne(e){const t=e.name;if(ee.has(t))return T.debug(`There were multiple attempts to register component ${t}.`),!1;ee.set(t,e);for(const n of Z.values())te(n,e);return!0}function re(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function ie(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X;re(e,t).clearInstance(n)}const se={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},oe=new o.FA("app","Firebase",se);class ae{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oe.create("app-deleted",{appName:this._name})}}const le="9.23.0";function ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:X,automaticDataCollectionEnabled:!1},t),s=i.name;if("string"!==typeof s||!s)throw oe.create("bad-app-name",{appName:String(s)});if(n||(n=(0,o.T9)()),!n)throw oe.create("no-options");const a=Z.get(s);if(a){if((0,o.bD)(n,a.options)&&(0,o.bD)(i,a.config))return a;throw oe.create("duplicate-app",{appName:s})}const l=new r.h1(s);for(const r of ee.values())l.addComponent(r);const c=new ae(n,i,l);return Z.set(s,c),c}function ue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X;const t=Z.get(e);if(!t&&e===X&&(0,o.T9)())return ce();if(!t)throw oe.create("no-app",{appName:e});return t}function de(e,t,n){var i;let s=null!==(i=J[e])&&void 0!==i?i:e;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=[`Unable to register library "${s}" with version "${t}":`];return o&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void T.warn(e.join(" "))}ne(new r.uA(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const he="firebase-heartbeat-store";let fe=null;function pe(){return fe||(fe=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=v(o);return r&&o.addEventListener("upgradeneeded",e=>{r(v(o.result),e.oldVersion,e.newVersion,v(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(he)}}).catch(e=>{throw oe.create("idb-open",{originalErrorMessage:e.message})})),fe}async function ge(e,t){try{const n=(await pe()).transaction(he,"readwrite"),r=n.objectStore(he);await r.put(t,me(e)),await n.done}catch(s){if(s instanceof o.g)T.warn(s.message);else{const t=oe.create("idb-set",{originalErrorMessage:null===s||void 0===s?void 0:s.message});T.warn(t.message)}}}function me(e){return`${e.name}!${e.options.appId}`}class ve{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new be(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=ye();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some(e=>e.date===t))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=ye(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),we(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),we(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=(0,o.Uj)(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function ye(){return(new Date).toISOString().substring(0,10)}class be{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,o.zW)()&&(0,o.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await pe();return await t.transaction(he).objectStore(he).get(me(e))}catch(s){if(s instanceof o.g)T.warn(s.message);else{const t=oe.create("idb-get",{originalErrorMessage:null===s||void 0===s?void 0:s.message});T.warn(t.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ge(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ge(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function we(e){return(0,o.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var Se;Se="",ne(new r.uA("platform-logger",e=>new _(e),"PRIVATE")),ne(new r.uA("heartbeat",e=>new ve(e),"PRIVATE")),de(C,x,Se),de(C,x,"esm2017"),de("fire-js","")},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,g(w,v.prototype),w.isPureReactComponent=!0;var S=Array.isArray,E=Object.prototype.hasOwnProperty,_={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)E.call(t,i)&&!C.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:_.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function D(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+D(l,0):s,S(o)?(i="",null!=e&&(i=e.replace(I,"$&/")+"/"),A(o,t,i,"",function(e){return e})):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(I,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",S(e))for(var c=0;c<e.length;c++){var u=s+D(a=e[c],c);l+=A(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=A(a=a.value,t,i,u=s+D(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function k(e,t,n){if(null==e)return e;var r=[],i=0;return A(e,r,"","",function(e){return t.call(n,e,i++)}),r}function N(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},M={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:M,ReactCurrentOwner:_};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:k,forEach:function(e,t,n){k(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return k(e,function(){t++}),t},toArray:function(e){return k(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=P,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=_.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!C.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(m=!1,w(e),!g)if(null!==r(c))g=!0,M(E);else{var t=r(u);null!==t&&O(S,t.startTime-e)}}function E(e,n){g=!1,m&&(m=!1,y(T),T=-1),p=!0;var s=f;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!A());){var o=h.callback;if("function"===typeof o){h.callback=null,f=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===r(c)&&i(c),w(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&O(S,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,C=!1,x=null,T=-1,I=5,D=-1;function A(){return!(t.unstable_now()-D<I)}function k(){if(null!==x){var e=t.unstable_now();D=e;var n=!0;try{n=x(!0,e)}finally{n?_():(C=!1,x=null)}}else C=!1}if("function"===typeof b)_=function(){b(k)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,R=N.port2;N.port1.onmessage=k,_=function(){R.postMessage(null)}}else _=function(){v(k,0)};function M(e){x=e,C||(C=!0,_())}function O(e,n){T=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,M(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(m?(y(T),T=-1):m=!0,O(S,s-o))):(e.sortIndex=a,n(c,e),g||p||(g=!0,M(E))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},443:(e,t,n)=>{n.d(t,{$b:()=>i,Vy:()=>c});const r=[];var i;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));const s={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},o=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=a[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r](`[${n}]  ${e.name}:`,...s)};class c{constructor(e){this.name=e,this._logLevel=o,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...t),this._logHandler(this,i.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...t),this._logHandler(this,i.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.INFO,...t),this._logHandler(this,i.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.WARN,...t),this._logHandler(this,i.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.ERROR,...t),this._logHandler(this,i.ERROR,...t)}}},558:(e,t,n)=>{n.r(t),n.d(t,{auth:()=>u,db:()=>c,default:()=>h,storageBucketName:()=>d});var r=n(150);(0,r.KO)("firebase","9.23.0","app");var i=n(32),s=n(619);function o(e){const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[e];return t?String(t):null}const a=function(){const e={apiKey:o("REACT_APP_FIREBASE_API_KEY"),authDomain:o("REACT_APP_FIREBASE_AUTH_DOMAIN"),projectId:o("REACT_APP_FIREBASE_PROJECT_ID"),storageBucket:o("REACT_APP_FIREBASE_STORAGE_BUCKET"),messagingSenderId:o("REACT_APP_FIREBASE_MESSAGING_SENDER_ID"),appId:o("REACT_APP_FIREBASE_APP_ID")};return e.apiKey&&e.authDomain&&e.projectId&&e.storageBucket&&e.messagingSenderId&&e.appId?e:null}()||function(){try{if("undefined"===typeof window)return null;const e="/__/firebase/init.json",t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(null),t.status>=200&&t.status<300){const e=JSON.parse(t.responseText);if(e&&e.apiKey&&e.projectId&&e.appId)return e}}catch{}return null}();if(!a)throw new Error("Firebase config is missing. Set REACT_APP_FIREBASE_* or host on Firebase Hosting.");const l=(0,r.Wp)(a),c=(0,i.initializeFirestore)(l,{localCache:(0,i.persistentLocalCache)({tabManager:(0,i.persistentMultipleTabManager)()})}),u=(0,s.xI)(l),d=a.storageBucket,h=l},579:(e,t,n)=>{e.exports=n(153)},619:(e,t,n)=>{n.d(t,{HF:()=>Fe,iM:()=>it,xI:()=>gn,hg:()=>Xe,oM:()=>Ye,zK:()=>qe,df:()=>kt,CI:()=>Je});var r=n(700),i=n(150);function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var a=n(443),l=n(812);function c(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const u=c,d=new r.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),h=new a.Vy("@firebase/auth");function f(e){if(h.logLevel<=a.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];h.error(`Auth (${i.MF}): ${e}`,...n)}}function p(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw y(e,...n)}function g(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return y(e,...n)}function m(e,t,n){const i=Object.assign(Object.assign({},u()),{[t]:n});return new r.FA("auth","Firebase",i).create(t,{appName:e.name})}function v(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&p(e,"argument-error"),m(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function y(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return d.create(e,...n)}function b(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw y(t,...r)}}function w(e){const t="INTERNAL ASSERTION FAILED: "+e;throw f(t),new Error(t)}function S(e,t){e||w(t)}function E(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function _(){return"http:"===C()||"https:"===C()}function C(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class x{constructor(e,t){this.shortDelay=e,this.longDelay=t,S(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,r.jZ)()||(0,r.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(_()||(0,r.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function T(e,t){S(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class I{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void w("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void w("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void w("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const D={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},k=new x(3e4,6e4);function N(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function R(e,t,n,i){return M(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let s={},o={};i&&("GET"===t?o=i:s={body:JSON.stringify(i)});const a=(0,r.Am)(Object.assign({key:e.config.apiKey},o)).slice(1),l=await e._getAdditionalHeaders();return l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode),I.fetch()(P(e,e.config.apiHost,n,a),Object.assign({method:t,headers:l,referrerPolicy:"no-referrer"},s))})}async function M(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},D),t);try{const t=new L(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw j(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw j(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw j(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw j(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw m(e,a,o);p(e,a)}}catch(s){if(s instanceof r.g)throw s;p(e,"network-request-failed",{message:String(s)})}}async function O(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await R(e,t,n,r,i);return"mfaPendingCredential"in s&&p(e,"multi-factor-auth-required",{_serverResponse:s}),s}function P(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?T(e.config,i):`${e.config.apiScheme}://${i}`}class L{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(g(this.auth,"network-request-failed")),k.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function j(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=g(e,t,r);return i.customData._tokenResponse=n,i}function F(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(s){}}function U(e){return 1e3*Number(e)}function B(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return f("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,r.u)(n);return e?JSON.parse(e):(f("Failed to decode base64 JWT payload"),null)}catch(s){return f("Caught error parsing JWT payload as JSON",null===s||void 0===s?void 0:s.toString()),null}}async function z(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(s){throw s instanceof r.g&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(s)&&e.auth.currentUser===e&&await e.auth.signOut(),s}}class V{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(s){return void("auth/network-request-failed"===(null===s||void 0===s?void 0:s.code)&&this.schedule(!0))}this.schedule()}}class H{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=F(this.lastLoginAt),this.creationTime=F(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function q(e){var t;const n=e.auth,r=await e.getIdToken(),i=await z(e,async function(e,t){return R(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));b(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map(e=>{var{providerId:t}=e,n=o(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[];const l=function(e,t){const n=e.filter(e=>!t.some(t=>t.providerId===e.providerId));return[...n,...t]}(e.providerData,a),c=e.isAnonymous,u=!(e.email&&s.passwordHash)&&!(null===l||void 0===l?void 0:l.length),d=!!c&&u,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new H(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,h)}class ${constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){b(e.idToken,"internal-error"),b("undefined"!==typeof e.idToken,"internal-error"),b("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){const t=B(e);return b(t,"internal-error"),b("undefined"!==typeof t.exp,"internal-error"),b("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return b(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(e,t){const n=await M(e,{},async()=>{const n=(0,r.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,o=P(e,i,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",I.fetch()(o,{method:"POST",headers:a,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new $;return n&&(b("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(b("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(b("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $,this.toJSON())}_performRefresh(){return w("not implemented")}}function G(e,t){b("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class W{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=o(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new V(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new H(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await z(this,this.stsTokenManager.getToken(this.auth,e));return b(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,r.Ku)(e),i=await n.getIdToken(t),s=B(i);b(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"===typeof s.firebase?s.firebase:void 0,a=null===o||void 0===o?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:F(U(s.auth_time)),issuedAtTime:F(U(s.iat)),expirationTime:F(U(s.exp)),signInProvider:a||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,r.Ku)(e);await q(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(b(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new W(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){b(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await q(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await z(this,async function(e,t){return R(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:w,isAnonymous:S,providerData:E,stsTokenManager:_}=t;b(y&&_,e,"internal-error");const C=$.fromJSON(this.name,_);b("string"===typeof y,e,"internal-error"),G(u,e.name),G(d,e.name),b("boolean"===typeof w,e,"internal-error"),b("boolean"===typeof S,e,"internal-error"),G(h,e.name),G(f,e.name),G(p,e.name),G(g,e.name),G(m,e.name),G(v,e.name);const x=new W({uid:y,auth:e,email:d,emailVerified:w,displayName:u,isAnonymous:S,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:C,createdAt:m,lastLoginAt:v});return E&&Array.isArray(E)&&(x.providerData=E.map(e=>Object.assign({},e))),g&&(x._redirectEventId=g),x}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new $;r.updateFromServerResponse(t);const i=new W({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await q(i),i}}const Q=new Map;function K(e){S(e instanceof Function,"Expected a class definition");let t=Q.get(e);return t?(S(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Q.set(e,t),t)}class Y{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Y.type="NONE";const X=Y;function J(e,t,n){return`firebase:${e}:${t}:${n}`}class Z{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=J(this.userKey,r.apiKey,i),this.fullPersistenceKey=J("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?W._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Z(K(X),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||K(X);const s=J(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){const n=W._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch(l){}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(l){}})),new Z(i,e,n)):new Z(i,e,n)}}function ee(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ie(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(te(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(oe(t))return"Blackberry";if(ae(t))return"Webos";if(ne(t))return"Safari";if((t.includes("chrome/")||re(t))&&!t.includes("edge/"))return"Chrome";if(se(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function te(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/firefox\//i.test(e)}function ne(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function re(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/crios\//i.test(e)}function ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/iemobile/i.test(e)}function se(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/android/i.test(e)}function oe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/blackberry/i.test(e)}function ae(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/webos/i.test(e)}function le(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ce(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return le(e)||se(e)||ae(e)||oe(e)||/windows phone/i.test(e)||ie(e)}function ue(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ee((0,r.ZQ)());break;case"Worker":t=`${ee((0,r.ZQ)())}-${e}`;break;default:t=e}const s=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${i.MF}/${s}`}async function de(e,t){return R(e,"GET","/v2/recaptchaConfig",N(e,t))}function he(e){return void 0!==e&&void 0!==e.enterprise}class fe{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState)}}function pe(e){return new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=g("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}function ge(e){return`__${e}${Math.floor(1e6*Math.random())}`}class me{constructor(e){this.type="recaptcha-enterprise",this.auth=we(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;he(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{de(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new fe(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&he(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));pe("https://www.google.com/recaptcha/enterprise.js?render="+i).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function ve(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new me(e);let s;try{s=await i.verify(n)}catch(a){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}class ye{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(s){r(s)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(s){t.reverse();for(const n of t)try{n()}catch(A){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===s||void 0===s?void 0:s.message})}}}class be{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Se(this),this.idTokenSubscription=new Se(this),this.beforeStateQueue=new ye(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=d,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=K(t)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Z.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return b(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(s){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await q(e)}catch(s){if("auth/network-request-failed"!==(null===s||void 0===s?void 0:s.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?(0,r.Ku)(e):null;return t&&b(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&b(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(K(e))})}async initializeRecaptchaConfig(){const e=await de(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new fe(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new me(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new r.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&K(e)||this._popupRedirectResolver;b(t,this,"argument-error"),this.redirectPersistenceManager=await Z.create(this,[K(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return b(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return b(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ue(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(h.logLevel<=a.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];h.warn(`Auth (${i.MF}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function we(e){return(0,r.Ku)(e)}class Se{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,r.tD)(e=>this.observer=e)}get next(){return b(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Ee(e,t,n){const r=we(e);b(r._canInitEmulator,r,"emulator-config-failed"),b(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=_e(t),{host:o,port:a}=function(e){const t=_e(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Ce(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Ce(t)}}}(t),l=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function _e(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ce(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class xe{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return w("not implemented")}_getIdTokenResponse(e){return w("not implemented")}_linkToIdToken(e,t){return w("not implemented")}_getReauthenticationResolver(e){return w("not implemented")}}async function Te(e,t){return R(e,"POST","/v1/accounts:update",t)}async function Ie(e,t){return O(e,"POST","/v1/accounts:signInWithPassword",N(e,t))}class De extends xe{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new De(e,t,"password")}static _fromEmailAndCode(e,t){return new De(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await ve(e,n,"signInWithPassword");return Ie(e,t)}return Ie(e,n).catch(async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await ve(e,n,"signInWithPassword");return Ie(e,t)}return Promise.reject(t)});case"emailLink":return async function(e,t){return O(e,"POST","/v1/accounts:signInWithEmailLink",N(e,t))}(e,{email:this._email,oobCode:this._password});default:p(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Te(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return O(e,"POST","/v1/accounts:signInWithEmailLink",N(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:p(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ae(e,t){return O(e,"POST","/v1/accounts:signInWithIdp",N(e,t))}class ke extends xe{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ke(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):p("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=o(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new ke(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Ae(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ae(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ae(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,r.Am)(t)}return e}}const Ne={USER_NOT_FOUND:"user-not-found"};class Re extends xe{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Re({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Re({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return O(e,"POST","/v1/accounts:signInWithPhoneNumber",N(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await O(e,"POST","/v1/accounts:signInWithPhoneNumber",N(e,t));if(n.temporaryProof)throw j(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return O(e,"POST","/v1/accounts:signInWithPhoneNumber",N(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Ne)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Re({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Me{constructor(e){var t,n,i,s,o,a;const l=(0,r.I9)((0,r.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,u=null!==(n=l.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=l.mode)&&void 0!==i?i:null);b(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=null!==(s=l.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=l.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=l.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=(0,r.I9)((0,r.hp)(e)).link,n=t?(0,r.I9)((0,r.hp)(t)).deep_link_id:null,i=(0,r.I9)((0,r.hp)(e)).deep_link_id;return(i?(0,r.I9)((0,r.hp)(i)).link:null)||i||n||t||e}(e);try{return new Me(t)}catch(n){return null}}}class Oe{constructor(){this.providerId=Oe.PROVIDER_ID}static credential(e,t){return De._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Me.parseLink(t);return b(n,"argument-error"),De._fromEmailAndCode(e,n.code,n.tenantId)}}Oe.PROVIDER_ID="password",Oe.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Oe.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Pe{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Le extends Pe{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class je extends Le{constructor(){super("facebook.com")}static credential(e){return ke._fromParams({providerId:je.PROVIDER_ID,signInMethod:je.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return je.credentialFromTaggedObject(e)}static credentialFromError(e){return je.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return je.credential(t.oauthAccessToken)}catch(n){return null}}}je.FACEBOOK_SIGN_IN_METHOD="facebook.com",je.PROVIDER_ID="facebook.com";class Fe extends Le{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ke._fromParams({providerId:Fe.PROVIDER_ID,signInMethod:Fe.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fe.credentialFromTaggedObject(e)}static credentialFromError(e){return Fe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Fe.credential(n,r)}catch(i){return null}}}Fe.GOOGLE_SIGN_IN_METHOD="google.com",Fe.PROVIDER_ID="google.com";class Ue extends Le{constructor(){super("github.com")}static credential(e){return ke._fromParams({providerId:Ue.PROVIDER_ID,signInMethod:Ue.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ue.credentialFromTaggedObject(e)}static credentialFromError(e){return Ue.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ue.credential(t.oauthAccessToken)}catch(n){return null}}}Ue.GITHUB_SIGN_IN_METHOD="github.com",Ue.PROVIDER_ID="github.com";class Be extends Le{constructor(){super("twitter.com")}static credential(e,t){return ke._fromParams({providerId:Be.PROVIDER_ID,signInMethod:Be.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Be.credentialFromTaggedObject(e)}static credentialFromError(e){return Be.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Be.credential(n,r)}catch(i){return null}}}async function ze(e,t){return O(e,"POST","/v1/accounts:signUp",N(e,t))}Be.TWITTER_SIGN_IN_METHOD="twitter.com",Be.PROVIDER_ID="twitter.com";class Ve{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await W._fromIdTokenResponse(e,n,r),s=He(n);return new Ve({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=He(n);return new Ve({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function He(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function qe(e){var t;const n=we(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Ve({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await ze(n,{returnSecureToken:!0}),i=await Ve._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}class $e extends r.g{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,$e.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new $e(e,t,n,r)}}function Ge(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw $e._fromErrorAndOperation(e,n,t,r);throw n})}async function We(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await z(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ve._forOperation(e,"link",r)}async function Qe(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e,i="reauthenticate";try{const s=await z(e,Ge(r,i,t,e),n);b(s.idToken,r,"internal-error");const o=B(s.idToken);b(o,r,"internal-error");const{sub:a}=o;return b(e.uid===a,r,"user-mismatch"),Ve._forOperation(e,i,s)}catch(s){throw"auth/user-not-found"===(null===s||void 0===s?void 0:s.code)&&p(r,"user-mismatch"),s}}async function Ke(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="signIn",i=await Ge(e,r,t),s=await Ve._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}function Ye(e,t){return(0,r.Ku)(e).setPersistence(t)}function Xe(e,t,n,i){return(0,r.Ku)(e).onAuthStateChanged(t,n,i)}function Je(e){return(0,r.Ku)(e).signOut()}new WeakMap;const Ze="__sak";class et{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ze,"1"),this.storage.removeItem(Ze),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class tt extends et{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=(0,r.ZQ)();return ne(e)||le(e)}()&&function(){try{return!(!window||window===window.top)}catch(s){return!1}}(),this.fallbackToPolling=ce(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);(0,r.lT)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tt.type="LOCAL";const nt=tt;class rt extends et{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}rt.type="SESSION";const it=rt;class st{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new st(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}st.receivers=[];class at{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const l=ot("",20);r.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function lt(){return window}function ct(){return"undefined"!==typeof lt().WorkerGlobalScope&&"function"===typeof lt().importScripts}const ut="firebaseLocalStorageDb",dt="firebaseLocalStorage",ht="fbase_key";class ft{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function pt(e,t){return e.transaction([dt],t?"readwrite":"readonly").objectStore(dt)}function gt(){const e=indexedDB.open(ut,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(dt,{keyPath:ht})}catch(s){n(s)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(dt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(ut);return new ft(e).toPromise()}(),t(await gt()))})})}async function mt(e,t,n){const r=pt(e,!0).put({[ht]:t,value:n});return new ft(r).toPromise()}function vt(e,t){const n=pt(e,!0).delete(t);return new ft(n).toPromise()}class yt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await gt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(s){if(t++>3)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ct()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=st._getInstance(ct()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new at(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gt();return await mt(e,Ze,"1"),await vt(e,Ze),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>mt(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=pt(e,!1).get(t),r=await new ft(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>vt(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=pt(e,!1).getAll();return new ft(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}yt.type="LOCAL";const bt=yt;ge("rcb"),new x(3e4,6e4);const wt="recaptcha";async function St(e,t,n){var r;const i=await n.verify();try{let s;if(b("string"===typeof i,e,"argument-error"),b(n.type===wt,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){b("enroll"===t.type,e,"internal-error");const n=await function(e,t){return R(e,"POST","/v2/accounts/mfaEnrollment:start",N(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{b("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;b(n,e,"missing-multi-factor-info");const o=await function(e,t){return R(e,"POST","/v2/accounts/mfaSignIn:start",N(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return R(e,"POST","/v1/accounts:sendVerificationCode",N(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Et{constructor(e){this.providerId=Et.PROVIDER_ID,this.auth=we(e)}verifyPhoneNumber(e,t){return St(this.auth,e,(0,r.Ku)(t))}static credential(e,t){return Re._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Et.credentialFromTaggedObject(t)}static credentialFromError(e){return Et.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Re._fromTokenResponse(n,r):null}}function _t(e,t){return t?K(t):(b(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Et.PROVIDER_ID="phone",Et.PHONE_SIGN_IN_METHOD="phone";class Ct extends xe{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ae(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ae(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ae(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function xt(e){return Ke(e.auth,new Ct(e),e.bypassAuthState)}function Tt(e){const{auth:t,user:n}=e;return b(n,t,"internal-error"),Qe(n,new Ct(e),e.bypassAuthState)}async function It(e){const{auth:t,user:n}=e;return b(n,t,"internal-error"),We(n,new Ct(e),e.bypassAuthState)}class Dt{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:o,type:a}=e;if(o)return void this.reject(o);const l={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(s){this.reject(s)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xt;case"linkViaPopup":case"linkViaRedirect":return It;case"reauthViaPopup":case"reauthViaRedirect":return Tt;default:p(this.auth,"internal-error")}}resolve(e){S(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){S(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const At=new x(2e3,1e4);async function kt(e,t,n){const r=we(e);v(e,t,Pe);const i=_t(r,n);return new Nt(r,"signInViaPopup",t,i).executeNotNull()}class Nt extends Dt{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Nt.currentPopupAction&&Nt.currentPopupAction.cancel(),Nt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return b(e,this.auth,"internal-error"),e}async onExecution(){S(1===this.filter.length,"Popup operations only handle one event");const e=ot();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(g(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(g(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Nt.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(g(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,At.get())};e()}}Nt.currentPopupAction=null;const Rt=new Map;class Mt extends Dt{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Rt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Lt(t),r=Pt(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(s){e=()=>Promise.reject(s)}Rt.set(this.auth._key(),e)}return this.bypassAuthState||Rt.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ot(e,t){Rt.set(e._key(),t)}function Pt(e){return K(e._redirectPersistence)}function Lt(e){return J("pendingRedirect",e.config.apiKey,e.name)}async function jt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=we(e),i=_t(r,t),s=new Mt(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Ft{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Bt(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Bt(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(g(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ut(e))}saveEventToCache(e){this.cachedEventUids.add(Ut(e)),this.lastProcessedEventTime=Date.now()}}function Ut(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Bt(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const zt=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Vt=/^https?/;async function Ht(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return R(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(qt(r))return}catch(n){}p(e,"unauthorized-domain")}function qt(e){const t=E(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Vt.test(n))return!1;if(zt.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const $t=new x(3e4,6e4);function Gt(){const e=lt().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let Wt=null;function Qt(e){return Wt=Wt||function(e){return new Promise((t,n)=>{var r,i,s;function o(){Gt(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Gt(),n(g(e,"network-request-failed"))},timeout:$t.get()})}if(null===(i=null===(r=lt().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=lt().gapi)||void 0===s?void 0:s.load)){const t=ge("iframefcb");return lt()[t]=()=>{gapi.load?o():n(g(e,"network-request-failed"))},pe(`https://apis.google.com/js/api.js?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw Wt=null,e})}(e),Wt}const Kt=new x(5e3,15e3),Yt={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Xt=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Jt(e){const t=e.config;b(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?T(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,s={apiKey:t.apiKey,appName:e.name,v:i.MF},o=Xt.get(e.config.apiHost);o&&(s.eid=o);const a=e._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${(0,r.Am)(s).slice(1)}`}const Zt={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class en{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(s){}}}function tn(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-o)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Zt),{width:i.toString(),height:o.toString(),top:a,left:l}),d=(0,r.ZQ)().toLowerCase();n&&(c=re(d)?"_blank":n),te(d)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`},"");if(function(){var e;return le(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(d)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new en(null);const f=window.open(t||"",c,h);b(f,e,"popup-blocked");try{f.focus()}catch(s){}return new en(f)}const nn="__/auth/handler",rn="emulator/auth/handler",sn=encodeURIComponent("fac");async function on(e,t,n,s,o,a){b(e.config.authDomain,e,"auth-domain-config-required"),b(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:s,v:i.MF,eventId:o};if(t instanceof Pe){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,r.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))l[e]=t}if(t instanceof Le){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const r of Object.keys(c))void 0===c[r]&&delete c[r];const u=await e._getAppCheckToken(),d=u?`#${sn}=${encodeURIComponent(u)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${nn}`;return T(t,rn)}(e)}?${(0,r.Am)(c).slice(1)}${d}`}const an="webStorageSupport";const ln=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=it,this._completeRedirectFn=jt,this._overrideRedirectResult=Ot}async _openPopup(e,t,n,r){var i;S(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return tn(e,await on(e,t,n,E(),r),ot())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){lt().location.href=e}(await on(e,t,n,E(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(S(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await async function(e){const t=await Qt(e),n=lt().gapi;return b(n,e,"internal-error"),t.open({where:document.body,url:Jt(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Yt,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=g(e,"network-request-failed"),s=lt().setTimeout(()=>{r(i)},Kt.get());function o(){lt().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}(e),n=new Ft(e);return t.register("authEvent",t=>{b(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(an,{type:an},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[an];void 0!==i&&t(!!i),p(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Ht(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ce()||ne()||le()}};var cn="@firebase/auth",un="0.23.2";class dn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){b(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const hn=(0,r.XA)("authIdTokenMaxAge")||300;let fn=null;const pn=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>hn)return;const i=null===n||void 0===n?void 0:n.token;fn!==i&&(fn=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function gn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.Sx)();const t=(0,i.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,i.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),i=n.getOptions();if((0,r.bD)(i,null!==t&&void 0!==t?t:{}))return e;p(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:ln,persistence:[bt,nt,it]}),s=(0,r.XA)("authTokenSyncURL");if(s){const e=pn(s);!function(e,t,n){(0,r.Ku)(e).beforeAuthStateChanged(t,n)}(n,e,()=>e(n.currentUser)),function(e,t,n,i){(0,r.Ku)(e).onIdTokenChanged(t,n,i)}(n,t=>e(t))}const o=(0,r.Tj)("auth");return o&&Ee(n,`http://${o}`),n}var mn;mn="Browser",(0,i.om)(new l.uA("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;b(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:mn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ue(mn)},c=new be(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(K);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,i.om)(new l.uA("auth-internal",e=>(e=>new dn(e))(we(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,i.KO)(cn,un,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(mn)),(0,i.KO)(cn,un,"esm2017")},700:(e,t,n)=>{n.d(t,{Am:()=>N,FA:()=>T,Fy:()=>m,I9:()=>R,Im:()=>D,Ku:()=>j,T9:()=>f,Tj:()=>d,Uj:()=>a,XA:()=>p,ZQ:()=>v,bD:()=>A,cY:()=>g,eX:()=>C,g:()=>x,hp:()=>M,jZ:()=>y,lT:()=>S,lV:()=>w,nr:()=>E,sr:()=>b,tD:()=>O,u:()=>l,yU:()=>h,zW:()=>_});const r=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let d=(15&o)<<2|l>>6,h=63&l;a||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(r(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const l=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==a||null==l)throw new o;const c=t<<2|s>>4;if(r.push(c),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==l){const e=a<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){return function(e){const t=r(e);return i.encodeByteArray(t,!0)}(e).replace(/\./g,"")},l=function(e){try{return i.decodeString(e,!0)}catch(s){console.error("base64Decode failed: ",s)}return null};const c=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,u=()=>{try{return c()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(s){return}const t=e&&l(e[1]);return t&&JSON.parse(t)})()}catch(s){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`)}},d=e=>{var t,n;return null===(n=null===(t=u())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},h=e=>{const t=d(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},f=()=>{var e;return null===(e=u())||void 0===e?void 0:e.config},p=e=>{var t;return null===(t=u())||void 0===t?void 0:t[`_${e}`]};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function m(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(s)),""].join(".")}function v(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())}function b(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function w(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function S(){const e=v();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function E(){return!function(){var e;const t=null===(e=u())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(s){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){try{return"object"===typeof indexedDB}catch(s){return!1}}function C(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}class x extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,x.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T.prototype.create)}}class T{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(I,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new x(n,s,t)}}const I=/\{\$([^}]+)}/g;function D(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function A(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(k(n)&&k(s)){if(!A(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function k(e){return null!==e&&"object"===typeof e}function N(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function R(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function M(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function O(e,t){const n=new P(e,t);return n.subscribe.bind(n)}class P{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=L),void 0===r.error&&(r.error=L),void 0===r.complete&&(r.complete=L);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(s){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(s){"undefined"!==typeof console&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function L(){}function j(e){return e&&e._delegate?e._delegate:e}},730:(e,t,n)=>{var r=n(43),i=n(853);function c(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,h={};function f(e,t){p(e,t),p(e+"Capture",t)}function p(e,t){for(h[e]=t,e=0;e<t.length;e++)u.add(t[e])}var v=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),b=Object.prototype.hasOwnProperty,w=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S={},E={};function C(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){x[e]=new C(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];x[t]=new C(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){x[e]=new C(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){x[e]=new C(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){x[e]=new C(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){x[e]=new C(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){x[e]=new C(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){x[e]=new C(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){x[e]=new C(e,5,!1,e.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function I(e){return e[1].toUpperCase()}function D(e,t,n,r){var i=x.hasOwnProperty(t)?x[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!b.call(E,e)||!b.call(S,e)&&(w.test(e)?E[e]=!0:(S[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(T,I);x[t]=new C(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(T,I);x[t]=new C(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(T,I);x[t]=new C(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){x[e]=new C(e,1,!1,e.toLowerCase(),null,!1,!1)}),x.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){x[e]=new C(e,1,!1,e.toLowerCase(),null,!0,!0)});var A=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),N=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),L=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),V=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var H=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var q=Symbol.iterator;function $(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=q&&e[q]||e["@@iterator"])?e:null}var G,W=Object.assign;function Q(e){if(void 0===G)try{throw Error()}catch(d){var t=d.stack.trim().match(/\n( *(at )?)/);G=t&&t[1]||""}return"\n"+G+e}var K=!1;function Y(e,t){if(!e||K)return"";K=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(a){var r=a}Reflect.construct(e,[],t)}else{try{t.call()}catch(a){r=a}e.call(t.prototype)}else{try{throw Error()}catch(a){r=a}e()}}catch(a){if(a&&r&&"string"===typeof a.stack){for(var i=a.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(1!==o||1!==l)do{if(o--,0>--l||i[o]!==s[l]){var c="\n"+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=o&&0<=l);break}}}finally{K=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Q(e):""}function X(e){switch(e.tag){case 5:return Q(e.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return e=Y(e.type,!1);case 11:return e=Y(e.type.render,!1);case 1:return e=Y(e.type,!0);default:return""}}function J(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case R:return"Fragment";case N:return"Portal";case O:return"Profiler";case M:return"StrictMode";case F:return"Suspense";case U:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case L:return(e.displayName||"Context")+".Consumer";case P:return(e._context.displayName||"Context")+".Provider";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case z:return null!==(t=e.displayName||null)?t:J(e.type)||"Memo";case V:t=e._payload,e=e._init;try{return J(e(t))}catch(d){}}return null}function Z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return J(t);case 8:return t===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function ee(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function te(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ne(e){e._valueTracker||(e._valueTracker=function(e){var t=te(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function re(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=te(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ie(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function se(e,t){var n=t.checked;return W({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function oe(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=ee(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function ae(e,t){null!=(t=t.checked)&&D(e,"checked",t,!1)}function le(e,t){ae(e,t);var n=ee(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ue(e,t.type,n):t.hasOwnProperty("defaultValue")&&ue(e,t.type,ee(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ce(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ue(e,t,n){"number"===t&&ie(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var de=Array.isArray;function he(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ee(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function fe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(c(91));return W({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function pe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(c(92));if(de(n)){if(1<n.length)throw Error(c(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:ee(n)}}function ge(e,t){var n=ee(t.value),r=ee(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function me(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ve(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ye(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ve(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var be,we=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((be=be||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=be.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Se(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ee={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_e=["Webkit","ms","Moz","O"];function Ce(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||Ee.hasOwnProperty(e)&&Ee[e]?(""+t).trim():t+"px"}function xe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=Ce(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(Ee).forEach(function(e){_e.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ee[t]=Ee[e]})});var Te=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ie(e,t){if(t){if(Te[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(c(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(c(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(c(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(c(62))}}function De(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ae=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ne=null,Re=null,Me=null;function Oe(e){if(e=Di(e)){if("function"!==typeof Ne)throw Error(c(280));var t=e.stateNode;t&&(t=ki(t),Ne(e.stateNode,e.type,t))}}function Pe(e){Re?Me?Me.push(e):Me=[e]:Re=e}function Le(){if(Re){var e=Re,t=Me;if(Me=Re=null,Oe(e),t)for(e=0;e<t.length;e++)Oe(t[e])}}function je(e,t){return e(t)}function Fe(){}var Ue=!1;function Be(e,t,n){if(Ue)return e(t,n);Ue=!0;try{return je(e,t,n)}finally{Ue=!1,(null!==Re||null!==Me)&&(Fe(),Le())}}function ze(e,t){var n=e.stateNode;if(null===n)return null;var r=ki(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(c(231,t,typeof n));return n}var Ve=!1;if(v)try{var He={};Object.defineProperty(He,"passive",{get:function(){Ve=!0}}),window.addEventListener("test",He,He),window.removeEventListener("test",He,He)}catch(l){Ve=!1}function qe(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var $e=!1,Ge=null,We=!1,Qe=null,Ke={onError:function(e){$e=!0,Ge=e}};function Ye(e,t,n,r,i,s,o,a,l){$e=!1,Ge=null,qe.apply(Ke,arguments)}function Xe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ze(e){if(Xe(e)!==e)throw Error(c(188))}function et(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Xe(e)))throw Error(c(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Ze(i),e;if(s===r)return Ze(i),t;s=s.sibling}throw Error(c(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(c(189))}}if(n.alternate!==r)throw Error(c(190))}if(3!==n.tag)throw Error(c(188));return n.stateNode.current===n?e:t}(e),null!==e?tt(e):null}function tt(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=tt(e);if(null!==t)return t;e=e.sibling}return null}var nt=i.unstable_scheduleCallback,rt=i.unstable_cancelCallback,it=i.unstable_shouldYield,st=i.unstable_requestPaint,ot=i.unstable_now,at=i.unstable_getCurrentPriorityLevel,lt=i.unstable_ImmediatePriority,ct=i.unstable_UserBlockingPriority,ut=i.unstable_NormalPriority,dt=i.unstable_LowPriority,ht=i.unstable_IdlePriority,ft=null,pt=null;var gt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(mt(e)/vt|0)|0},mt=Math.log,vt=Math.LN2;var yt=64,bt=4194304;function wt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function St(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=wt(a):0!==(s&=o)&&(r=wt(s))}else 0!==(o=n&~i)?r=wt(o):0!==s&&(r=wt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-gt(t)),r|=e[n],t&=~i;return r}function Et(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function _t(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Ct(){var e=yt;return 0===(4194240&(yt<<=1))&&(yt=64),e}function xt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Tt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-gt(t)]=n}function It(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-gt(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Dt=0;function At(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,Nt,Rt,Mt,Ot,Pt=!1,Lt=[],jt=null,Ft=null,Ut=null,Bt=new Map,zt=new Map,Vt=[],Ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qt(e,t){switch(e){case"focusin":case"focusout":jt=null;break;case"dragenter":case"dragleave":Ft=null;break;case"mouseover":case"mouseout":Ut=null;break;case"pointerover":case"pointerout":Bt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zt.delete(t.pointerId)}}function $t(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=Di(t))&&Nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Gt(e){var t=Ii(e.target);if(null!==t){var n=Xe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Je(n)))return e.blockedOn=t,void Ot(e.priority,function(){Rt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Wt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=sn(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Di(n))&&Nt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Ae=r,n.target.dispatchEvent(r),Ae=null,t.shift()}return!0}function Qt(e,t,n){Wt(e)&&n.delete(t)}function Kt(){Pt=!1,null!==jt&&Wt(jt)&&(jt=null),null!==Ft&&Wt(Ft)&&(Ft=null),null!==Ut&&Wt(Ut)&&(Ut=null),Bt.forEach(Qt),zt.forEach(Qt)}function Yt(e,t){e.blockedOn===t&&(e.blockedOn=null,Pt||(Pt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Kt)))}function Xt(e){function t(t){return Yt(t,e)}if(0<Lt.length){Yt(Lt[0],e);for(var n=1;n<Lt.length;n++){var r=Lt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==jt&&Yt(jt,e),null!==Ft&&Yt(Ft,e),null!==Ut&&Yt(Ut,e),Bt.forEach(t),zt.forEach(t),n=0;n<Vt.length;n++)(r=Vt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Vt.length&&null===(n=Vt[0]).blockedOn;)Gt(n),null===n.blockedOn&&Vt.shift()}var Jt=A.ReactCurrentBatchConfig,Zt=!0;function en(e,t,n,r){var i=Dt,s=Jt.transition;Jt.transition=null;try{Dt=1,nn(e,t,n,r)}finally{Dt=i,Jt.transition=s}}function tn(e,t,n,r){var i=Dt,s=Jt.transition;Jt.transition=null;try{Dt=4,nn(e,t,n,r)}finally{Dt=i,Jt.transition=s}}function nn(e,t,n,r){if(Zt){var i=sn(e,t,n,r);if(null===i)Zr(e,t,r,rn,n),qt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return jt=$t(jt,e,t,n,r,i),!0;case"dragenter":return Ft=$t(Ft,e,t,n,r,i),!0;case"mouseover":return Ut=$t(Ut,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Bt.set(s,$t(Bt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,zt.set(s,$t(zt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(qt(e,r),4&t&&-1<Ht.indexOf(e)){for(;null!==i;){var s=Di(i);if(null!==s&&kt(s),null===(s=sn(e,t,n,r))&&Zr(e,t,r,rn,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Zr(e,t,r,null,n)}}var rn=null;function sn(e,t,n,r){if(rn=null,null!==(e=Ii(e=ke(r))))if(null===(t=Xe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Je(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return rn=e,null}function on(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(at()){case lt:return 1;case ct:return 4;case ut:case dt:return 16;case ht:return 536870912;default:return 16}default:return 16}}var an=null,ln=null,cn=null;function un(){if(cn)return cn;var e,t,n=ln,r=n.length,i="value"in an?an.value:an.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return cn=i.slice(e,1<t?1-t:void 0)}function dn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function hn(){return!0}function fn(){return!1}function pn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?hn:fn,this.isPropagationStopped=fn,this}return W(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=hn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=hn)},persist:function(){},isPersistent:hn}),t}var gn,mn,vn,yn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bn=pn(yn),wn=W({},yn,{view:0,detail:0}),Sn=pn(wn),En=W({},wn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:On,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vn&&(vn&&"mousemove"===e.type?(gn=e.screenX-vn.screenX,mn=e.screenY-vn.screenY):mn=gn=0,vn=e),gn)},movementY:function(e){return"movementY"in e?e.movementY:mn}}),_n=pn(En),Cn=pn(W({},En,{dataTransfer:0})),xn=pn(W({},wn,{relatedTarget:0})),Tn=pn(W({},yn,{animationName:0,elapsedTime:0,pseudoElement:0})),In=W({},yn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Dn=pn(In),An=pn(W({},yn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Rn[e])&&!!t[e]}function On(){return Mn}var Pn=W({},wn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=dn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Nn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:On,charCode:function(e){return"keypress"===e.type?dn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?dn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ln=pn(Pn),jn=pn(W({},En,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Fn=pn(W({},wn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:On})),Un=pn(W({},yn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Bn=W({},En,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zn=pn(Bn),Vn=[9,13,27,32],Hn=v&&"CompositionEvent"in window,qn=null;v&&"documentMode"in document&&(qn=document.documentMode);var $n=v&&"TextEvent"in window&&!qn,Gn=v&&(!Hn||qn&&8<qn&&11>=qn),Wn=String.fromCharCode(32),Qn=!1;function Kn(e,t){switch(e){case"keyup":return-1!==Vn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Xn=!1;var Jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Jn[e.type]:"textarea"===t}function er(e,t,n,r){Pe(r),0<(t=ti(t,"onChange")).length&&(n=new bn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var tr=null,nr=null;function rr(e){Wr(e,0)}function ir(e){if(re(Ai(e)))return e}function sr(e,t){if("change"===e)return t}var or=!1;if(v){var ar;if(v){var lr="oninput"in document;if(!lr){var cr=document.createElement("div");cr.setAttribute("oninput","return;"),lr="function"===typeof cr.oninput}ar=lr}else ar=!1;or=ar&&(!document.documentMode||9<document.documentMode)}function ur(){tr&&(tr.detachEvent("onpropertychange",dr),nr=tr=null)}function dr(e){if("value"===e.propertyName&&ir(nr)){var t=[];er(t,nr,e,ke(e)),Be(rr,t)}}function hr(e,t,n){"focusin"===e?(ur(),nr=n,(tr=t).attachEvent("onpropertychange",dr)):"focusout"===e&&ur()}function fr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return ir(nr)}function pr(e,t){if("click"===e)return ir(t)}function gr(e,t){if("input"===e||"change"===e)return ir(t)}var mr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function vr(e,t){if(mr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!b.call(t,i)||!mr(e[i],t[i]))return!1}return!0}function yr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function br(e,t){var n,r=yr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=yr(r)}}function wr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?wr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Sr(){for(var e=window,t=ie();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(g){n=!1}if(!n)break;t=ie((e=t.contentWindow).document)}return t}function Er(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function _r(e){var t=Sr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&wr(n.ownerDocument.documentElement,n)){if(null!==r&&Er(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=br(n,s);var o=br(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Cr=v&&"documentMode"in document&&11>=document.documentMode,xr=null,Tr=null,Ir=null,Dr=!1;function Ar(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Dr||null==xr||xr!==ie(r)||("selectionStart"in(r=xr)&&Er(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},Ir&&vr(Ir,r)||(Ir=r,0<(r=ti(Tr,"onSelect")).length&&(t=new bn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=xr)))}function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Nr={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},Rr={},Mr={};function Or(e){if(Rr[e])return Rr[e];if(!Nr[e])return e;var t,n=Nr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Mr)return Rr[e]=n[t];return e}v&&(Mr=document.createElement("div").style,"AnimationEvent"in window||(delete Nr.animationend.animation,delete Nr.animationiteration.animation,delete Nr.animationstart.animation),"TransitionEvent"in window||delete Nr.transitionend.transition);var Pr=Or("animationend"),Lr=Or("animationiteration"),jr=Or("animationstart"),Fr=Or("transitionend"),Ur=new Map,Br="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zr(e,t){Ur.set(e,t),f(t,[e])}for(var Vr=0;Vr<Br.length;Vr++){var Hr=Br[Vr];zr(Hr.toLowerCase(),"on"+(Hr[0].toUpperCase()+Hr.slice(1)))}zr(Pr,"onAnimationEnd"),zr(Lr,"onAnimationIteration"),zr(jr,"onAnimationStart"),zr("dblclick","onDoubleClick"),zr("focusin","onFocus"),zr("focusout","onBlur"),zr(Fr,"onTransitionEnd"),p("onMouseEnter",["mouseout","mouseover"]),p("onMouseLeave",["mouseout","mouseover"]),p("onPointerEnter",["pointerout","pointerover"]),p("onPointerLeave",["pointerout","pointerover"]),f("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),f("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),f("onBeforeInput",["compositionend","keypress","textInput","paste"]),f("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$r=new Set("cancel close invalid load scroll toggle".split(" ").concat(qr));function Gr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,o,a,l){if(Ye.apply(this,arguments),$e){if(!$e)throw Error(c(198));var u=Ge;$e=!1,Ge=null,We||(We=!0,Qe=u)}}(r,t,void 0,e),e.currentTarget=null}function Wr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Gr(i,a,c),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Gr(i,a,c),s=l}}}if(We)throw e=Qe,We=!1,Qe=null,e}function Qr(e,t){var n=t[Ci];void 0===n&&(n=t[Ci]=new Set);var r=e+"__bubble";n.has(r)||(Jr(t,e,2,!1),n.add(r))}function Kr(e,t,n){var r=0;t&&(r|=4),Jr(n,e,r,t)}var Yr="_reactListening"+Math.random().toString(36).slice(2);function Xr(e){if(!e[Yr]){e[Yr]=!0,u.forEach(function(t){"selectionchange"!==t&&($r.has(t)||Kr(t,!1,e),Kr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Yr]||(t[Yr]=!0,Kr("selectionchange",!1,t))}}function Jr(e,t,n,r){switch(on(t)){case 1:var i=en;break;case 4:i=tn;break;default:i=nn}n=i.bind(null,t,n,e),i=void 0,!Ve||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Zr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=Ii(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Be(function(){var r=s,i=ke(n),o=[];e:{var a=Ur.get(e);if(void 0!==a){var l=bn,c=e;switch(e){case"keypress":if(0===dn(n))break e;case"keydown":case"keyup":l=Ln;break;case"focusin":c="focus",l=xn;break;case"focusout":c="blur",l=xn;break;case"beforeblur":case"afterblur":l=xn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=_n;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=Cn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Fn;break;case Pr:case Lr:case jr:l=Tn;break;case Fr:l=Un;break;case"scroll":l=Sn;break;case"wheel":l=zn;break;case"copy":case"cut":case"paste":l=Dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=jn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=ze(p,h))&&u.push(ei(p,g,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Ae||!(c=n.relatedTarget||n.fromElement)||!Ii(c)&&!c[_i])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?Ii(c):null)&&(c!==(d=Xe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=_n,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=jn,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:Ai(l),f=null==c?a:Ai(c),(a=new u(g,p+"leave",l,n,i)).target=d,a.relatedTarget=f,g=null,Ii(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,g=u),d=g,l&&c)e:{for(h=c,p=0,f=u=l;f;f=ni(f))p++;for(f=0,g=h;g;g=ni(g))f++;for(;0<p-f;)u=ni(u),p--;for(;0<f-p;)h=ni(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=ni(u),h=ni(h)}u=null}else u=null;null!==l&&ri(o,a,l,u,!1),null!==c&&null!==d&&ri(o,d,c,u,!0)}if("select"===(l=(a=r?Ai(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=sr;else if(Zn(a))if(or)m=gr;else{m=fr;var v=hr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=pr);switch(m&&(m=m(e,r))?er(o,m,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ue(a,"number",a.value)),v=r?Ai(r):window,e){case"focusin":(Zn(v)||"true"===v.contentEditable)&&(xr=v,Tr=r,Ir=null);break;case"focusout":Ir=Tr=xr=null;break;case"mousedown":Dr=!0;break;case"contextmenu":case"mouseup":case"dragend":Dr=!1,Ar(o,n,i);break;case"selectionchange":if(Cr)break;case"keydown":case"keyup":Ar(o,n,i)}var y;if(Hn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Xn?Kn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Gn&&"ko"!==n.locale&&(Xn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Xn&&(y=un()):(ln="value"in(an=i)?an.value:an.textContent,Xn=!0)),0<(v=ti(r,b)).length&&(b=new An(b,e,null,n,i),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Yn(n))&&(b.data=y))),(y=$n?function(e,t){switch(e){case"compositionend":return Yn(t);case"keypress":return 32!==t.which?null:(Qn=!0,Wn);case"textInput":return(e=t.data)===Wn&&Qn?null:e;default:return null}}(e,n):function(e,t){if(Xn)return"compositionend"===e||!Hn&&Kn(e,t)?(e=un(),cn=ln=an=null,Xn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Gn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=ti(r,"onBeforeInput")).length&&(i=new An("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}Wr(o,t)})}function ei(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ti(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=ze(e,n))&&r.unshift(ei(e,s,i)),null!=(s=ze(e,t))&&r.push(ei(e,s,i))),e=e.return}return r}function ni(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function ri(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=ze(n,s))&&o.unshift(ei(n,l,a)):i||null!=(l=ze(n,s))&&o.push(ei(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var ii=/\r\n?/g,si=/\u0000|\uFFFD/g;function oi(e){return("string"===typeof e?e:""+e).replace(ii,"\n").replace(si,"")}function ai(e,t,n){if(t=oi(t),oi(e)!==t&&n)throw Error(c(425))}function li(){}var ci=null,ui=null;function di(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var hi="function"===typeof setTimeout?setTimeout:void 0,fi="function"===typeof clearTimeout?clearTimeout:void 0,pi="function"===typeof Promise?Promise:void 0,gi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof pi?function(e){return pi.resolve(null).then(e).catch(mi)}:hi;function mi(e){setTimeout(function(){throw e})}function vi(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Xt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Xt(t)}function yi(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function bi(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var wi=Math.random().toString(36).slice(2),Si="__reactFiber$"+wi,Ei="__reactProps$"+wi,_i="__reactContainer$"+wi,Ci="__reactEvents$"+wi,xi="__reactListeners$"+wi,Ti="__reactHandles$"+wi;function Ii(e){var t=e[Si];if(t)return t;for(var n=e.parentNode;n;){if(t=n[_i]||n[Si]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=bi(e);null!==e;){if(n=e[Si])return n;e=bi(e)}return t}n=(e=n).parentNode}return null}function Di(e){return!(e=e[Si]||e[_i])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ai(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(c(33))}function ki(e){return e[Ei]||null}var Ni=[],Ri=-1;function Mi(e){return{current:e}}function Oi(e){0>Ri||(e.current=Ni[Ri],Ni[Ri]=null,Ri--)}function Pi(e,t){Ri++,Ni[Ri]=e.current,e.current=t}var Li={},ji=Mi(Li),Fi=Mi(!1),Ui=Li;function Bi(e,t){var n=e.type.contextTypes;if(!n)return Li;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function zi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Vi(){Oi(Fi),Oi(ji)}function Hi(e,t,n){if(ji.current!==Li)throw Error(c(168));Pi(ji,t),Pi(Fi,n)}function qi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(c(108,Z(e)||"Unknown",i));return W({},n,r)}function $i(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Li,Ui=ji.current,Pi(ji,e),Pi(Fi,Fi.current),!0}function Gi(e,t,n){var r=e.stateNode;if(!r)throw Error(c(169));n?(e=qi(e,t,Ui),r.__reactInternalMemoizedMergedChildContext=e,Oi(Fi),Oi(ji),Pi(ji,e)):Oi(Fi),Pi(Fi,n)}var Wi=null,Qi=!1,Ki=!1;function Yi(e){null===Wi?Wi=[e]:Wi.push(e)}function Xi(){if(!Ki&&null!==Wi){Ki=!0;var e=0,t=Dt;try{var n=Wi;for(Dt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Wi=null,Qi=!1}catch(s){throw null!==Wi&&(Wi=Wi.slice(e+1)),nt(lt,Xi),s}finally{Dt=t,Ki=!1}}return null}var Ji=[],Zi=0,es=null,ts=0,ns=[],rs=0,is=null,ss=1,os="";function as(e,t){Ji[Zi++]=ts,Ji[Zi++]=es,es=e,ts=t}function ls(e,t,n){ns[rs++]=ss,ns[rs++]=os,ns[rs++]=is,is=e;var r=ss;e=os;var i=32-gt(r)-1;r&=~(1<<i),n+=1;var s=32-gt(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ss=1<<32-gt(t)+i|n<<i|r,os=s+e}else ss=1<<s|n<<i|r,os=e}function cs(e){null!==e.return&&(as(e,1),ls(e,1,0))}function us(e){for(;e===es;)es=Ji[--Zi],Ji[Zi]=null,ts=Ji[--Zi],Ji[Zi]=null;for(;e===is;)is=ns[--rs],ns[rs]=null,os=ns[--rs],ns[rs]=null,ss=ns[--rs],ns[rs]=null}var ds=null,hs=null,fs=!1,ps=null;function gs(e,t){var n=Bc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ms(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ds=e,hs=yi(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ds=e,hs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==is?{id:ss,overflow:os}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Bc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ds=e,hs=null,!0);default:return!1}}function vs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ys(e){if(fs){var t=hs;if(t){var n=t;if(!ms(e,t)){if(vs(e))throw Error(c(418));t=yi(n.nextSibling);var r=ds;t&&ms(e,t)?gs(r,n):(e.flags=-4097&e.flags|2,fs=!1,ds=e)}}else{if(vs(e))throw Error(c(418));e.flags=-4097&e.flags|2,fs=!1,ds=e}}}function bs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ds=e}function ws(e){if(e!==ds)return!1;if(!fs)return bs(e),fs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!di(e.type,e.memoizedProps)),t&&(t=hs)){if(vs(e))throw Ss(),Error(c(418));for(;t;)gs(e,t),t=yi(t.nextSibling)}if(bs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(c(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){hs=yi(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}hs=null}}else hs=ds?yi(e.stateNode.nextSibling):null;return!0}function Ss(){for(var e=hs;e;)e=yi(e.nextSibling)}function Es(){hs=ds=null,fs=!1}function _s(e){null===ps?ps=[e]:ps.push(e)}var Cs=A.ReactCurrentBatchConfig;function xs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(c(309));var r=n.stateNode}if(!r)throw Error(c(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(c(284));if(!n._owner)throw Error(c(290,e))}return e}function Ts(e,t){throw e=Object.prototype.toString.call(t),Error(c(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Is(e){return(0,e._init)(e._payload)}function Ds(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Vc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function a(e,t,n,r){return null===t||6!==t.tag?((t=Gc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var s=n.type;return s===R?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===V&&Is(s)===t.type)?((r=i(t,n.props)).ref=xs(e,t,n),r.return=e,r):((r=Hc(n.type,n.key,n.props,null,e.mode,r)).ref=xs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Wc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=qc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Gc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Hc(t.type,t.key,t.props,null,e.mode,n)).ref=xs(e,null,t),n.return=e,n;case N:return(t=Wc(t,e.mode,n)).return=e,t;case V:return h(e,(0,t._init)(t._payload),n)}if(de(t)||$(t))return(t=qc(t,e.mode,n,null)).return=e,t;Ts(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:a(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===i?l(e,t,n,r):null;case N:return n.key===i?u(e,t,n,r):null;case V:return f(e,t,(i=n._init)(n._payload),r)}if(de(n)||$(n))return null!==i?null:d(e,t,n,r,null);Ts(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return a(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case N:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case V:return p(e,t,n,(0,r._init)(r._payload),i)}if(de(r)||$(r))return d(t,e=e.get(n)||null,r,i,null);Ts(t,r)}return null}function g(i,o,a,l){for(var c=null,u=null,d=o,g=o=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=f(i,d,a[g],l);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(i,d),o=s(v,o,g),null===u?c=v:u.sibling=v,u=v,d=m}if(g===a.length)return n(i,d),fs&&as(i,g),c;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],l))&&(o=s(d,o,g),null===u?c=d:u.sibling=d,u=d);return fs&&as(i,g),c}for(d=r(i,d);g<a.length;g++)null!==(m=p(d,i,g,a[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),o=s(m,o,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(i,e)}),fs&&as(i,g),c}function m(i,o,a,l){var u=$(a);if("function"!==typeof u)throw Error(c(150));if(null==(a=u.call(a)))throw Error(c(151));for(var d=u=null,g=o,m=o=0,v=null,y=a.next();null!==g&&!y.done;m++,y=a.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(i,g,y.value,l);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(i,g),o=s(b,o,m),null===d?u=b:d.sibling=b,d=b,g=v}if(y.done)return n(i,g),fs&&as(i,m),u;if(null===g){for(;!y.done;m++,y=a.next())null!==(y=h(i,y.value,l))&&(o=s(y,o,m),null===d?u=y:d.sibling=y,d=y);return fs&&as(i,m),u}for(g=r(i,g);!y.done;m++,y=a.next())null!==(y=p(g,i,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),o=s(y,o,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach(function(e){return t(i,e)}),fs&&as(i,m),u}return function e(r,s,a,l){if("object"===typeof a&&null!==a&&a.type===R&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case k:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===R){if(7===u.tag){n(r,u.sibling),(s=i(u,a.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===V&&Is(c)===u.type){n(r,u.sibling),(s=i(u,a.props)).ref=xs(r,u,a),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===R?((s=qc(a.props.children,r.mode,l,a.key)).return=r,r=s):((l=Hc(a.type,a.key,a.props,null,r.mode,l)).ref=xs(r,s,a),l.return=r,r=l)}return o(r);case N:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Wc(a,r.mode,l)).return=r,r=s}return o(r);case V:return e(r,s,(u=a._init)(a._payload),l)}if(de(a))return g(r,s,a,l);if($(a))return m(r,s,a,l);Ts(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=Gc(a,r.mode,l)).return=r,r=s),o(r)):n(r,s)}}var As=Ds(!0),ks=Ds(!1),Ns=Mi(null),Rs=null,Ms=null,Os=null;function Ps(){Os=Ms=Rs=null}function Ls(e){var t=Ns.current;Oi(Ns),e._currentValue=t}function js(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Fs(e,t){Rs=e,Os=Ms=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Da=!0),e.firstContext=null)}function Us(e){var t=e._currentValue;if(Os!==e)if(e={context:e,memoizedValue:t,next:null},null===Ms){if(null===Rs)throw Error(c(308));Ms=e,Rs.dependencies={lanes:0,firstContext:e}}else Ms=Ms.next=e;return t}var Bs=null;function zs(e){null===Bs?Bs=[e]:Bs.push(e)}function Vs(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,zs(t)):(n.next=i.next,i.next=n),t.interleaved=n,Hs(e,r)}function Hs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var qs=!1;function $s(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ws(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&jl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Hs(e,n)}return null===(i=r.interleaved)?(t.next=t,zs(r)):(t.next=i.next,i.next=t),r.interleaved=t,Hs(e,n)}function Ks(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,It(e,n)}}function Ys(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Xs(e,t,n,r){var i=e.updateQueue;qs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(o=0,u=c=l=null,a=s;;){var h=a.lane,f=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=W({},d,h);break e;case 2:qs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,o|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);$l|=o,e.lanes=o,e.memoizedState=d}}function Js(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(c(191,i));i.call(r)}}}var Zs={},eo=Mi(Zs),to=Mi(Zs),no=Mi(Zs);function ro(e){if(e===Zs)throw Error(c(174));return e}function io(e,t){switch(Pi(no,t),Pi(to,e),Pi(eo,Zs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ye(null,"");break;default:t=ye(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Oi(eo),Pi(eo,t)}function so(){Oi(eo),Oi(to),Oi(no)}function oo(e){ro(no.current);var t=ro(eo.current),n=ye(t,e.type);t!==n&&(Pi(to,e),Pi(eo,n))}function ao(e){to.current===e&&(Oi(eo),Oi(to))}var lo=Mi(0);function co(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var uo=[];function ho(){for(var e=0;e<uo.length;e++)uo[e]._workInProgressVersionPrimary=null;uo.length=0}var fo=A.ReactCurrentDispatcher,po=A.ReactCurrentBatchConfig,go=0,mo=null,vo=null,yo=null,bo=!1,wo=!1,So=0,Eo=0;function _o(){throw Error(c(321))}function Co(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!mr(e[n],t[n]))return!1;return!0}function xo(e,t,n,r,i,s){if(go=s,mo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fo.current=null===e||null===e.memoizedState?la:ca,e=n(r,i),wo){s=0;do{if(wo=!1,So=0,25<=s)throw Error(c(301));s+=1,yo=vo=null,t.updateQueue=null,fo.current=ua,e=n(r,i)}while(wo)}if(fo.current=aa,t=null!==vo&&null!==vo.next,go=0,yo=vo=mo=null,bo=!1,t)throw Error(c(300));return e}function To(){var e=0!==So;return So=0,e}function Io(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yo?mo.memoizedState=yo=e:yo=yo.next=e,yo}function Do(){if(null===vo){var e=mo.alternate;e=null!==e?e.memoizedState:null}else e=vo.next;var t=null===yo?mo.memoizedState:yo.next;if(null!==t)yo=t,vo=e;else{if(null===e)throw Error(c(310));e={memoizedState:(vo=e).memoizedState,baseState:vo.baseState,baseQueue:vo.baseQueue,queue:vo.queue,next:null},null===yo?mo.memoizedState=yo=e:yo=yo.next=e}return yo}function Ao(e,t){return"function"===typeof t?t(e):t}function ko(e){var t=Do(),n=t.queue;if(null===n)throw Error(c(311));n.lastRenderedReducer=e;var r=vo,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((go&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(a=l=h,o=r):l=l.next=h,mo.lanes|=d,$l|=d}u=u.next}while(null!==u&&u!==s);null===l?o=r:l.next=a,mr(r,t.memoizedState)||(Da=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,mo.lanes|=s,$l|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function No(e){var t=Do(),n=t.queue;if(null===n)throw Error(c(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);mr(s,t.memoizedState)||(Da=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ro(){}function Mo(e,t){var n=mo,r=Do(),i=t(),s=!mr(r.memoizedState,i);if(s&&(r.memoizedState=i,Da=!0),r=r.queue,$o(Lo.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==yo&&1&yo.memoizedState.tag){if(n.flags|=2048,Bo(9,Po.bind(null,n,r,i,t),void 0,null),null===Fl)throw Error(c(349));0!==(30&go)||Oo(n,t,i)}return i}function Oo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Po(e,t,n,r){t.value=n,t.getSnapshot=r,jo(t)&&Fo(e)}function Lo(e,t,n){return n(function(){jo(t)&&Fo(e)})}function jo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!mr(e,n)}catch(g){return!0}}function Fo(e){var t=Hs(e,1);null!==t&&dc(t,e,1,-1)}function Uo(e){var t=Io();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:e},t.queue=e,e=e.dispatch=ra.bind(null,mo,e),[t.memoizedState,e]}function Bo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function zo(){return Do().memoizedState}function Vo(e,t,n,r){var i=Io();mo.flags|=e,i.memoizedState=Bo(1|t,n,void 0,void 0===r?null:r)}function Ho(e,t,n,r){var i=Do();r=void 0===r?null:r;var s=void 0;if(null!==vo){var o=vo.memoizedState;if(s=o.destroy,null!==r&&Co(r,o.deps))return void(i.memoizedState=Bo(t,n,s,r))}mo.flags|=e,i.memoizedState=Bo(1|t,n,s,r)}function qo(e,t){return Vo(8390656,8,e,t)}function $o(e,t){return Ho(2048,8,e,t)}function Go(e,t){return Ho(4,2,e,t)}function Wo(e,t){return Ho(4,4,e,t)}function Qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ko(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ho(4,4,Qo.bind(null,t,e),n)}function Yo(){}function Xo(e,t){var n=Do();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Co(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Jo(e,t){var n=Do();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Co(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Zo(e,t,n){return 0===(21&go)?(e.baseState&&(e.baseState=!1,Da=!0),e.memoizedState=n):(mr(n,t)||(n=Ct(),mo.lanes|=n,$l|=n,e.baseState=!0),t)}function ea(e,t){var n=Dt;Dt=0!==n&&4>n?n:4,e(!0);var r=po.transition;po.transition={};try{e(!1),t()}finally{Dt=n,po.transition=r}}function ta(){return Do().memoizedState}function na(e,t,n){var r=uc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ia(e))sa(t,n);else if(null!==(n=Vs(e,t,n,r))){dc(n,e,r,cc()),oa(n,t,r)}}function ra(e,t,n){var r=uc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ia(e))sa(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,mr(l,o)){var c=t.interleaved;return null===c?(i.next=i,zs(t)):(i.next=c.next,c.next=i),void(t.interleaved=i)}}catch(a){}null!==(n=Vs(e,t,i,r))&&(dc(n,e,r,i=cc()),oa(n,t,r))}}function ia(e){var t=e.alternate;return e===mo||null!==t&&t===mo}function sa(e,t){wo=bo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function oa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,It(e,n)}}var aa={readContext:Us,useCallback:_o,useContext:_o,useEffect:_o,useImperativeHandle:_o,useInsertionEffect:_o,useLayoutEffect:_o,useMemo:_o,useReducer:_o,useRef:_o,useState:_o,useDebugValue:_o,useDeferredValue:_o,useTransition:_o,useMutableSource:_o,useSyncExternalStore:_o,useId:_o,unstable_isNewReconciler:!1},la={readContext:Us,useCallback:function(e,t){return Io().memoizedState=[e,void 0===t?null:t],e},useContext:Us,useEffect:qo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Vo(4194308,4,Qo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vo(4,2,e,t)},useMemo:function(e,t){var n=Io();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Io();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=na.bind(null,mo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Io().memoizedState=e},useState:Uo,useDebugValue:Yo,useDeferredValue:function(e){return Io().memoizedState=e},useTransition:function(){var e=Uo(!1),t=e[0];return e=ea.bind(null,e[1]),Io().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=mo,i=Io();if(fs){if(void 0===n)throw Error(c(407));n=n()}else{if(n=t(),null===Fl)throw Error(c(349));0!==(30&go)||Oo(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,qo(Lo.bind(null,r,s,e),[e]),r.flags|=2048,Bo(9,Po.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Io(),t=Fl.identifierPrefix;if(fs){var n=os;t=":"+t+"R"+(n=(ss&~(1<<32-gt(ss)-1)).toString(32)+n),0<(n=So++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Eo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ca={readContext:Us,useCallback:Xo,useContext:Us,useEffect:$o,useImperativeHandle:Ko,useInsertionEffect:Go,useLayoutEffect:Wo,useMemo:Jo,useReducer:ko,useRef:zo,useState:function(){return ko(Ao)},useDebugValue:Yo,useDeferredValue:function(e){return Zo(Do(),vo.memoizedState,e)},useTransition:function(){return[ko(Ao)[0],Do().memoizedState]},useMutableSource:Ro,useSyncExternalStore:Mo,useId:ta,unstable_isNewReconciler:!1},ua={readContext:Us,useCallback:Xo,useContext:Us,useEffect:$o,useImperativeHandle:Ko,useInsertionEffect:Go,useLayoutEffect:Wo,useMemo:Jo,useReducer:No,useRef:zo,useState:function(){return No(Ao)},useDebugValue:Yo,useDeferredValue:function(e){var t=Do();return null===vo?t.memoizedState=e:Zo(t,vo.memoizedState,e)},useTransition:function(){return[No(Ao)[0],Do().memoizedState]},useMutableSource:Ro,useSyncExternalStore:Mo,useId:ta,unstable_isNewReconciler:!1};function da(e,t){if(e&&e.defaultProps){for(var n in t=W({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ha(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:W({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fa={isMounted:function(e){return!!(e=e._reactInternals)&&Xe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=cc(),i=uc(e),s=Ws(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Qs(e,s,i))&&(dc(t,e,i,r),Ks(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=cc(),i=uc(e),s=Ws(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Qs(e,s,i))&&(dc(t,e,i,r),Ks(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cc(),r=uc(e),i=Ws(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Qs(e,i,r))&&(dc(t,e,r,n),Ks(t,e,r))}};function pa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!vr(n,r)||!vr(i,s))}function ga(e,t,n){var r=!1,i=Li,s=t.contextType;return"object"===typeof s&&null!==s?s=Us(s):(i=zi(t)?Ui:ji.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Bi(e,i):Li),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=fa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function ma(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fa.enqueueReplaceState(t,t.state,null)}function va(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},$s(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Us(s):(s=zi(t)?Ui:ji.current,i.context=Bi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ha(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&fa.enqueueReplaceState(i,i.state,null),Xs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ya(e,t){try{var n="",r=t;do{n+=X(r),r=r.return}while(r);var i=n}catch(m){i="\nError generating stack: "+m.message+"\n"+m.stack}return{value:e,source:t,stack:i,digest:null}}function ba(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function wa(e,t){try{console.error(t.value)}catch(d){setTimeout(function(){throw d})}}var Sa="function"===typeof WeakMap?WeakMap:Map;function Ea(e,t,n){(n=Ws(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Zl||(Zl=!0,ec=r),wa(0,t)},n}function _a(e,t,n){(n=Ws(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){wa(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){wa(0,t),"function"!==typeof r&&(null===tc?tc=new Set([this]):tc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Ca(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Sa;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Oc.bind(null,e,t,n),t.then(e,e))}function xa(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Ta(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ws(-1,1)).tag=2,Qs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var Ia=A.ReactCurrentOwner,Da=!1;function Aa(e,t,n,r){t.child=null===e?ks(t,null,n,r):As(t,e.child,n,r)}function ka(e,t,n,r,i){n=n.render;var s=t.ref;return Fs(t,i),r=xo(e,t,n,r,s,i),n=To(),null===e||Da?(fs&&n&&cs(t),t.flags|=1,Aa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Za(e,t,i))}function Na(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||zc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Hc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ra(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:vr)(o,r)&&e.ref===t.ref)return Za(e,t,i)}return t.flags|=1,(e=Vc(s,r)).ref=t.ref,e.return=t,t.child=e}function Ra(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(vr(s,r)&&e.ref===t.ref){if(Da=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Za(e,t,i);0!==(131072&e.flags)&&(Da=!0)}}return Pa(e,t,n,r,i)}function Ma(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pi(Vl,zl),zl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pi(Vl,zl),zl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Pi(Vl,zl),zl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Pi(Vl,zl),zl|=r;return Aa(e,t,i,n),t.child}function Oa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Pa(e,t,n,r,i){var s=zi(n)?Ui:ji.current;return s=Bi(t,s),Fs(t,i),n=xo(e,t,n,r,s,i),r=To(),null===e||Da?(fs&&r&&cs(t),t.flags|=1,Aa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Za(e,t,i))}function La(e,t,n,r,i){if(zi(n)){var s=!0;$i(t)}else s=!1;if(Fs(t,i),null===t.stateNode)Ja(e,t),ga(t,n,r),va(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Us(c):c=Bi(t,c=zi(n)?Ui:ji.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==c)&&ma(t,o,r,c),qs=!1;var h=t.memoizedState;o.state=h,Xs(t,r,o,i),l=t.memoizedState,a!==r||h!==l||Fi.current||qs?("function"===typeof u&&(ha(t,n,u,r),l=t.memoizedState),(a=qs||pa(t,n,a,r,h,l,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Gs(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:da(t.type,a),o.props=c,d=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Us(l):l=Bi(t,l=zi(n)?Ui:ji.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==l)&&ma(t,o,r,l),qs=!1,h=t.memoizedState,o.state=h,Xs(t,r,o,i);var p=t.memoizedState;a!==d||h!==p||Fi.current||qs?("function"===typeof f&&(ha(t,n,f,r),p=t.memoizedState),(c=qs||pa(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return ja(e,t,n,r,s,i)}function ja(e,t,n,r,i,s){Oa(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Gi(t,n,!1),Za(e,t,s);r=t.stateNode,Ia.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=As(t,e.child,null,s),t.child=As(t,null,a,s)):Aa(e,t,a,s),t.memoizedState=r.state,i&&Gi(t,n,!0),t.child}function Fa(e){var t=e.stateNode;t.pendingContext?Hi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Hi(0,t.context,!1),io(e,t.containerInfo)}function Ua(e,t,n,r,i){return Es(),_s(i),t.flags|=256,Aa(e,t,n,r),t.child}var Ba,za,Va,Ha,qa={dehydrated:null,treeContext:null,retryLane:0};function $a(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ga(e,t,n){var r,i=t.pendingProps,s=lo.current,o=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Pi(lo,1&s),null===e)return ys(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(a=i.children,e=i.fallback,o?(i=t.mode,o=t.child,a={mode:"hidden",children:a},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=a):o=$c(a,i,0,null),e=qc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=$a(n),t.memoizedState=qa,e):Wa(t,a));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,o){if(n)return 256&t.flags?(t.flags&=-257,Qa(e,t,o,r=ba(Error(c(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=$c({mode:"visible",children:r.children},i,0,null),(s=qc(s,i,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&As(t,e.child,null,o),t.child.memoizedState=$a(o),t.memoizedState=qa,s);if(0===(1&t.mode))return Qa(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var a=r.dgst;return r=a,Qa(e,t,o,r=ba(s=Error(c(419)),r,void 0))}if(a=0!==(o&e.childLanes),Da||a){if(null!==(r=Fl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Hs(e,i),dc(r,e,i,-1))}return Cc(),Qa(e,t,o,r=ba(Error(c(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Lc.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,hs=yi(i.nextSibling),ds=t,fs=!0,ps=null,null!==e&&(ns[rs++]=ss,ns[rs++]=os,ns[rs++]=is,ss=e.id,os=e.overflow,is=t),t=Wa(t,r.children),t.flags|=4096,t)}(e,t,a,i,r,s,n);if(o){o=i.fallback,a=t.mode,r=(s=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&a)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Vc(s,l)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Vc(r,o):(o=qc(o,a,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,a=null===(a=e.child.memoizedState)?$a(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~n,t.memoizedState=qa,i}return e=(o=e.child).sibling,i=Vc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Wa(e,t){return(t=$c({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Qa(e,t,n,r){return null!==r&&_s(r),As(t,e.child,null,n),(e=Wa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ka(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),js(e.return,t,n)}function Ya(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Xa(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Aa(e,t,r.children,n),0!==(2&(r=lo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ka(e,n,t);else if(19===e.tag)Ka(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Pi(lo,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===co(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ya(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===co(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ya(t,!0,n,null,s);break;case"together":Ya(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ja(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Za(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),$l|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(c(153));if(null!==t.child){for(n=Vc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Vc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function el(e,t){if(!fs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function tl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function nl(e,t,n){var r=t.pendingProps;switch(us(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tl(t),null;case 1:case 17:return zi(t.type)&&Vi(),tl(t),null;case 3:return r=t.stateNode,so(),Oi(Fi),Oi(ji),ho(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ws(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ps&&(gc(ps),ps=null))),za(e,t),tl(t),null;case 5:ao(t);var i=ro(no.current);if(n=t.type,null!==e&&null!=t.stateNode)Va(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(c(166));return tl(t),null}if(e=ro(eo.current),ws(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Si]=t,r[Ei]=s,e=0!==(1&t.mode),n){case"dialog":Qr("cancel",r),Qr("close",r);break;case"iframe":case"object":case"embed":Qr("load",r);break;case"video":case"audio":for(i=0;i<qr.length;i++)Qr(qr[i],r);break;case"source":Qr("error",r);break;case"img":case"image":case"link":Qr("error",r),Qr("load",r);break;case"details":Qr("toggle",r);break;case"input":oe(r,s),Qr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Qr("invalid",r);break;case"textarea":pe(r,s),Qr("invalid",r)}for(var o in Ie(n,s),i=null,s)if(s.hasOwnProperty(o)){var a=s[o];"children"===o?"string"===typeof a?r.textContent!==a&&(!0!==s.suppressHydrationWarning&&ai(r.textContent,a,e),i=["children",a]):"number"===typeof a&&r.textContent!==""+a&&(!0!==s.suppressHydrationWarning&&ai(r.textContent,a,e),i=["children",""+a]):h.hasOwnProperty(o)&&null!=a&&"onScroll"===o&&Qr("scroll",r)}switch(n){case"input":ne(r),ce(r,s,!0);break;case"textarea":ne(r),me(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=li)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{o=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ve(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),"select"===n&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Si]=t,e[Ei]=r,Ba(e,t,!1,!1),t.stateNode=e;e:{switch(o=De(n,r),n){case"dialog":Qr("cancel",e),Qr("close",e),i=r;break;case"iframe":case"object":case"embed":Qr("load",e),i=r;break;case"video":case"audio":for(i=0;i<qr.length;i++)Qr(qr[i],e);i=r;break;case"source":Qr("error",e),i=r;break;case"img":case"image":case"link":Qr("error",e),Qr("load",e),i=r;break;case"details":Qr("toggle",e),i=r;break;case"input":oe(e,r),i=se(e,r),Qr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=W({},r,{value:void 0}),Qr("invalid",e);break;case"textarea":pe(e,r),i=fe(e,r),Qr("invalid",e)}for(s in Ie(n,i),a=i)if(a.hasOwnProperty(s)){var l=a[s];"style"===s?xe(e,l):"dangerouslySetInnerHTML"===s?null!=(l=l?l.__html:void 0)&&we(e,l):"children"===s?"string"===typeof l?("textarea"!==n||""!==l)&&Se(e,l):"number"===typeof l&&Se(e,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(h.hasOwnProperty(s)?null!=l&&"onScroll"===s&&Qr("scroll",e):null!=l&&D(e,s,l,o))}switch(n){case"input":ne(e),ce(e,r,!1);break;case"textarea":ne(e),me(e);break;case"option":null!=r.value&&e.setAttribute("value",""+ee(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?he(e,!!r.multiple,s,!1):null!=r.defaultValue&&he(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=li)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return tl(t),null;case 6:if(e&&null!=t.stateNode)Ha(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(c(166));if(n=ro(no.current),ro(eo.current),ws(t)){if(r=t.stateNode,n=t.memoizedProps,r[Si]=t,(s=r.nodeValue!==n)&&null!==(e=ds))switch(e.tag){case 3:ai(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&ai(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Si]=t,t.stateNode=r}return tl(t),null;case 13:if(Oi(lo),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(fs&&null!==hs&&0!==(1&t.mode)&&0===(128&t.flags))Ss(),Es(),t.flags|=98560,s=!1;else if(s=ws(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(c(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(c(317));s[Si]=t}else Es(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;tl(t),s=!1}else null!==ps&&(gc(ps),ps=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&lo.current)?0===Hl&&(Hl=3):Cc())),null!==t.updateQueue&&(t.flags|=4),tl(t),null);case 4:return so(),za(e,t),null===e&&Xr(t.stateNode.containerInfo),tl(t),null;case 10:return Ls(t.type._context),tl(t),null;case 19:if(Oi(lo),null===(s=t.memoizedState))return tl(t),null;if(r=0!==(128&t.flags),null===(o=s.rendering))if(r)el(s,!1);else{if(0!==Hl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=co(e))){for(t.flags|=128,el(s,!1),null!==(r=o.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(o=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Pi(lo,1&lo.current|2),t.child}e=e.sibling}null!==s.tail&&ot()>Xl&&(t.flags|=128,r=!0,el(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=co(o))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),el(s,!0),null===s.tail&&"hidden"===s.tailMode&&!o.alternate&&!fs)return tl(t),null}else 2*ot()-s.renderingStartTime>Xl&&1073741824!==n&&(t.flags|=128,r=!0,el(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(null!==(n=s.last)?n.sibling=o:t.child=o,s.last=o)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ot(),t.sibling=null,n=lo.current,Pi(lo,r?1&n|2:1&n),t):(tl(t),null);case 22:case 23:return wc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&zl)&&(tl(t),6&t.subtreeFlags&&(t.flags|=8192)):tl(t),null;case 24:case 25:return null}throw Error(c(156,t.tag))}function rl(e,t){switch(us(t),t.tag){case 1:return zi(t.type)&&Vi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return so(),Oi(Fi),Oi(ji),ho(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ao(t),null;case 13:if(Oi(lo),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(c(340));Es()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Oi(lo),null;case 4:return so(),null;case 10:return Ls(t.type._context),null;case 22:case 23:return wc(),null;default:return null}}Ba=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},za=function(){},Va=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ro(eo.current);var s,o=null;switch(n){case"input":i=se(e,i),r=se(e,r),o=[];break;case"select":i=W({},i,{value:void 0}),r=W({},r,{value:void 0}),o=[];break;case"textarea":i=fe(e,i),r=fe(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=li)}for(c in Ie(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(h.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(null!=l||null!=a))if("style"===c)if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(o=o||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(h.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Qr("scroll",e),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Ha=function(e,t,n,r){n!==r&&(t.flags|=4)};var il=!1,sl=!1,ol="function"===typeof WeakSet?WeakSet:Set,al=null;function ll(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(g){Mc(e,t,g)}else n.current=null}function cl(e,t,n){try{n()}catch(g){Mc(e,t,g)}}var ul=!1;function dl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&cl(t,n,s)}i=i.next}while(i!==r)}}function hl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function fl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function pl(e){var t=e.alternate;null!==t&&(e.alternate=null,pl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[Si],delete t[Ei],delete t[Ci],delete t[xi],delete t[Ti])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function gl(e){return 5===e.tag||3===e.tag||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||gl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=li));else if(4!==r&&null!==(e=e.child))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}var bl=null,wl=!1;function Sl(e,t,n){for(n=n.child;null!==n;)El(e,t,n),n=n.sibling}function El(e,t,n){if(pt&&"function"===typeof pt.onCommitFiberUnmount)try{pt.onCommitFiberUnmount(ft,n)}catch(y){}switch(n.tag){case 5:sl||ll(n,t);case 6:var r=bl,i=wl;bl=null,Sl(e,t,n),wl=i,null!==(bl=r)&&(wl?(e=bl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):bl.removeChild(n.stateNode));break;case 18:null!==bl&&(wl?(e=bl,n=n.stateNode,8===e.nodeType?vi(e.parentNode,n):1===e.nodeType&&vi(e,n),Xt(e)):vi(bl,n.stateNode));break;case 4:r=bl,i=wl,bl=n.stateNode.containerInfo,wl=!0,Sl(e,t,n),bl=r,wl=i;break;case 0:case 11:case 14:case 15:if(!sl&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&cl(n,t,o),i=i.next}while(i!==r)}Sl(e,t,n);break;case 1:if(!sl&&(ll(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(y){Mc(n,t,y)}Sl(e,t,n);break;case 21:Sl(e,t,n);break;case 22:1&n.mode?(sl=(r=sl)||null!==n.memoizedState,Sl(e,t,n),sl=r):Sl(e,t,n);break;default:Sl(e,t,n)}}function _l(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ol),t.forEach(function(t){var r=jc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function Cl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:bl=l.stateNode,wl=!1;break e;case 3:case 4:bl=l.stateNode.containerInfo,wl=!0;break e}l=l.return}if(null===bl)throw Error(c(160));El(s,o,i),bl=null,wl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(a){Mc(i,t,a)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)xl(t,e),t=t.sibling}function xl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Cl(t,e),Tl(e),4&r){try{dl(3,e,e.return),hl(3,e)}catch(o){Mc(e,e.return,o)}try{dl(5,e,e.return)}catch(o){Mc(e,e.return,o)}}break;case 1:Cl(t,e),Tl(e),512&r&&null!==n&&ll(n,n.return);break;case 5:if(Cl(t,e),Tl(e),512&r&&null!==n&&ll(n,n.return),32&e.flags){var i=e.stateNode;try{Se(i,"")}catch(o){Mc(e,e.return,o)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===s.type&&null!=s.name&&ae(i,s),De(l,a);var d=De(l,s);for(a=0;a<u.length;a+=2){var h=u[a],f=u[a+1];"style"===h?xe(i,f):"dangerouslySetInnerHTML"===h?we(i,f):"children"===h?Se(i,f):D(i,h,f,d)}switch(l){case"input":le(i,s);break;case"textarea":ge(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;null!=g?he(i,!!s.multiple,g,!1):p!==!!s.multiple&&(null!=s.defaultValue?he(i,!!s.multiple,s.defaultValue,!0):he(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ei]=s}catch(o){Mc(e,e.return,o)}}break;case 6:if(Cl(t,e),Tl(e),4&r){if(null===e.stateNode)throw Error(c(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(o){Mc(e,e.return,o)}}break;case 3:if(Cl(t,e),Tl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Xt(t.containerInfo)}catch(o){Mc(e,e.return,o)}break;case 4:default:Cl(t,e),Tl(e);break;case 13:Cl(t,e),Tl(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Yl=ot())),4&r&&_l(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(sl=(d=sl)||h,Cl(t,e),sl=d):Cl(t,e),Tl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!h&&0!==(1&e.mode))for(al=e,h=e.child;null!==h;){for(f=al=h;null!==al;){switch(g=(p=al).child,p.tag){case 0:case 11:case 14:case 15:dl(4,p,p.return);break;case 1:ll(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(o){Mc(r,n,o)}}break;case 5:ll(p,p.return);break;case 22:if(null!==p.memoizedState){kl(f);continue}}null!==g?(g.return=p,al=g):kl(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{i=f.stateNode,d?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=f.stateNode,a=void 0!==(u=f.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=Ce("display",a))}catch(o){Mc(e,e.return,o)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(o){Mc(e,e.return,o)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Cl(t,e),Tl(e),4&r&&_l(e);case 21:}}function Tl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(gl(n)){var r=n;break e}n=n.return}throw Error(c(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(Se(i,""),r.flags&=-33),yl(e,ml(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;vl(e,ml(e),s);break;default:throw Error(c(161))}}catch(_){Mc(e,e.return,_)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Il(e,t,n){al=e,Dl(e,t,n)}function Dl(e,t,n){for(var r=0!==(1&e.mode);null!==al;){var i=al,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||il;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||sl;a=il;var c=sl;if(il=o,(sl=l)&&!c)for(al=i;null!==al;)l=(o=al).child,22===o.tag&&null!==o.memoizedState?Nl(i):null!==l?(l.return=o,al=l):Nl(i);for(;null!==s;)al=s,Dl(s,t,n),s=s.sibling;al=i,il=a,sl=c}Al(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,al=s):Al(e)}}function Al(e){for(;null!==al;){var t=al;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:sl||hl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!sl)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:da(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Js(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Js(t,o,n)}break;case 5:var a=t.stateNode;if(null===n&&4&t.flags){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Xt(h)}}}break;default:throw Error(c(163))}sl||512&t.flags&&fl(t)}catch(f){Mc(t,t.return,f)}}if(t===e){al=null;break}if(null!==(n=t.sibling)){n.return=t.return,al=n;break}al=t.return}}function kl(e){for(;null!==al;){var t=al;if(t===e){al=null;break}var n=t.sibling;if(null!==n){n.return=t.return,al=n;break}al=t.return}}function Nl(e){for(;null!==al;){var t=al;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{hl(4,t)}catch(_){Mc(t,n,_)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(_){Mc(t,i,_)}}var s=t.return;try{fl(t)}catch(_){Mc(t,s,_)}break;case 5:var o=t.return;try{fl(t)}catch(_){Mc(t,o,_)}}}catch(_){Mc(t,t.return,_)}if(t===e){al=null;break}var a=t.sibling;if(null!==a){a.return=t.return,al=a;break}al=t.return}}var Rl,Ml=Math.ceil,Ol=A.ReactCurrentDispatcher,Pl=A.ReactCurrentOwner,Ll=A.ReactCurrentBatchConfig,jl=0,Fl=null,Ul=null,Bl=0,zl=0,Vl=Mi(0),Hl=0,ql=null,$l=0,Gl=0,Wl=0,Ql=null,Kl=null,Yl=0,Xl=1/0,Jl=null,Zl=!1,ec=null,tc=null,nc=!1,rc=null,ic=0,sc=0,oc=null,ac=-1,lc=0;function cc(){return 0!==(6&jl)?ot():-1!==ac?ac:ac=ot()}function uc(e){return 0===(1&e.mode)?1:0!==(2&jl)&&0!==Bl?Bl&-Bl:null!==Cs.transition?(0===lc&&(lc=Ct()),lc):0!==(e=Dt)?e:e=void 0===(e=window.event)?16:on(e.type)}function dc(e,t,n,r){if(50<sc)throw sc=0,oc=null,Error(c(185));Tt(e,n,r),0!==(2&jl)&&e===Fl||(e===Fl&&(0===(2&jl)&&(Gl|=n),4===Hl&&mc(e,Bl)),hc(e,r),1===n&&0===jl&&0===(1&t.mode)&&(Xl=ot()+500,Qi&&Xi()))}function hc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-gt(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=Et(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=St(e,e===Fl?Bl:0);if(0===r)null!==n&&rt(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&rt(n),1===t)0===e.tag?function(e){Qi=!0,Yi(e)}(vc.bind(null,e)):Yi(vc.bind(null,e)),gi(function(){0===(6&jl)&&Xi()}),n=null;else{switch(At(r)){case 1:n=lt;break;case 4:n=ct;break;case 16:default:n=ut;break;case 536870912:n=ht}n=Fc(n,fc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function fc(e,t){if(ac=-1,lc=0,0!==(6&jl))throw Error(c(327));var n=e.callbackNode;if(Nc()&&e.callbackNode!==n)return null;var r=St(e,e===Fl?Bl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=xc(e,r);else{t=r;var i=jl;jl|=2;var s=_c();for(Fl===e&&Bl===t||(Jl=null,Xl=ot()+500,Sc(e,t));;)try{Ic();break}catch(y){Ec(e,y)}Ps(),Ol.current=s,jl=i,null!==Ul?t=0:(Fl=null,Bl=0,t=Hl)}if(0!==t){if(2===t&&(0!==(i=_t(e))&&(r=i,t=pc(e,i))),1===t)throw n=ql,Sc(e,0),mc(e,r),hc(e,ot()),n;if(6===t)mc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!mr(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=xc(e,r))&&(0!==(s=_t(e))&&(r=s,t=pc(e,s))),1===t))throw n=ql,Sc(e,0),mc(e,r),hc(e,ot()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(c(345));case 2:case 5:kc(e,Kl,Jl);break;case 3:if(mc(e,r),(130023424&r)===r&&10<(t=Yl+500-ot())){if(0!==St(e,0))break;if(((i=e.suspendedLanes)&r)!==r){cc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=hi(kc.bind(null,e,Kl,Jl),t);break}kc(e,Kl,Jl);break;case 4:if(mc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-gt(r);s=1<<o,(o=t[o])>i&&(i=o),r&=~s}if(r=i,10<(r=(120>(r=ot()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ml(r/1960))-r)){e.timeoutHandle=hi(kc.bind(null,e,Kl,Jl),r);break}kc(e,Kl,Jl);break;default:throw Error(c(329))}}}return hc(e,ot()),e.callbackNode===n?fc.bind(null,e):null}function pc(e,t){var n=Ql;return e.current.memoizedState.isDehydrated&&(Sc(e,t).flags|=256),2!==(e=xc(e,t))&&(t=Kl,Kl=n,null!==t&&gc(t)),e}function gc(e){null===Kl?Kl=e:Kl.push.apply(Kl,e)}function mc(e,t){for(t&=~Wl,t&=~Gl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-gt(t),r=1<<n;e[n]=-1,t&=~r}}function vc(e){if(0!==(6&jl))throw Error(c(327));Nc();var t=St(e,0);if(0===(1&t))return hc(e,ot()),null;var n=xc(e,t);if(0!==e.tag&&2===n){var r=_t(e);0!==r&&(t=r,n=pc(e,r))}if(1===n)throw n=ql,Sc(e,0),mc(e,t),hc(e,ot()),n;if(6===n)throw Error(c(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e,Kl,Jl),hc(e,ot()),null}function yc(e,t){var n=jl;jl|=1;try{return e(t)}finally{0===(jl=n)&&(Xl=ot()+500,Qi&&Xi())}}function bc(e){null!==rc&&0===rc.tag&&0===(6&jl)&&Nc();var t=jl;jl|=1;var n=Ll.transition,r=Dt;try{if(Ll.transition=null,Dt=1,e)return e()}finally{Dt=r,Ll.transition=n,0===(6&(jl=t))&&Xi()}}function wc(){zl=Vl.current,Oi(Vl)}function Sc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,fi(n)),null!==Ul)for(n=Ul.return;null!==n;){var r=n;switch(us(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Vi();break;case 3:so(),Oi(Fi),Oi(ji),ho();break;case 5:ao(r);break;case 4:so();break;case 13:case 19:Oi(lo);break;case 10:Ls(r.type._context);break;case 22:case 23:wc()}n=n.return}if(Fl=e,Ul=e=Vc(e.current,null),Bl=zl=t,Hl=0,ql=null,Wl=Gl=$l=0,Kl=Ql=null,null!==Bs){for(t=0;t<Bs.length;t++)if(null!==(r=(n=Bs[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Bs=null}return e}function Ec(e,t){for(;;){var n=Ul;try{if(Ps(),fo.current=aa,bo){for(var r=mo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}bo=!1}if(go=0,yo=vo=mo=null,wo=!1,So=0,Pl.current=null,null===n||null===n.return){Hl=1,ql=t,Ul=null;break}e:{var s=e,o=n.return,a=n,l=t;if(t=Bl,a.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=a,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=xa(o);if(null!==p){p.flags&=-257,Ta(p,o,a,0,t),1&p.mode&&Ca(s,u,t),l=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(0===(1&t)){Ca(s,u,t),Cc();break e}l=Error(c(426))}else if(fs&&1&a.mode){var v=xa(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),Ta(v,o,a,0,t),_s(ya(l,a));break e}}s=l=ya(l,a),4!==Hl&&(Hl=2),null===Ql?Ql=[s]:Ql.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ys(s,Ea(0,l,t));break e;case 1:a=l;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===tc||!tc.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Ys(s,_a(s,a,t));break e}}s=s.return}while(null!==s)}Ac(n)}catch(w){t=w,Ul===n&&null!==n&&(Ul=n=n.return);continue}break}}function _c(){var e=Ol.current;return Ol.current=aa,null===e?aa:e}function Cc(){0!==Hl&&3!==Hl&&2!==Hl||(Hl=4),null===Fl||0===(268435455&$l)&&0===(268435455&Gl)||mc(Fl,Bl)}function xc(e,t){var n=jl;jl|=2;var r=_c();for(Fl===e&&Bl===t||(Jl=null,Sc(e,t));;)try{Tc();break}catch(s){Ec(e,s)}if(Ps(),jl=n,Ol.current=r,null!==Ul)throw Error(c(261));return Fl=null,Bl=0,Hl}function Tc(){for(;null!==Ul;)Dc(Ul)}function Ic(){for(;null!==Ul&&!it();)Dc(Ul)}function Dc(e){var t=Rl(e.alternate,e,zl);e.memoizedProps=e.pendingProps,null===t?Ac(e):Ul=t,Pl.current=null}function Ac(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=nl(n,t,zl)))return void(Ul=n)}else{if(null!==(n=rl(n,t)))return n.flags&=32767,void(Ul=n);if(null===e)return Hl=6,void(Ul=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ul=t);Ul=t=e}while(null!==t);0===Hl&&(Hl=5)}function kc(e,t,n){var r=Dt,i=Ll.transition;try{Ll.transition=null,Dt=1,function(e,t,n,r){do{Nc()}while(null!==rc);if(0!==(6&jl))throw Error(c(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(c(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-gt(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,s),e===Fl&&(Ul=Fl=null,Bl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||nc||(nc=!0,Fc(ut,function(){return Nc(),null})),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Ll.transition,Ll.transition=null;var o=Dt;Dt=1;var a=jl;jl|=4,Pl.current=null,function(e,t){if(ci=Zt,Er(e=Sr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(B){n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(a=o+i),h!==s||0!==r&&3!==h.nodeType||(l=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(a=o),f===s&&++d===r&&(l=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===a||-1===l?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ui={focusedElem:e,selectionRange:n},Zt=!1,al=t;null!==al;)if(e=(t=al).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,al=e;else for(;null!==al;){t=al;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:da(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(c(163))}}catch(B){Mc(t,t.return,B)}if(null!==(e=t.sibling)){e.return=t.return,al=e;break}al=t.return}g=ul,ul=!1}(e,n),xl(n,e),_r(ui),Zt=!!ci,ui=ci=null,e.current=n,Il(n,e,i),st(),jl=a,Dt=o,Ll.transition=s}else e.current=n;if(nc&&(nc=!1,rc=e,ic=i),s=e.pendingLanes,0===s&&(tc=null),function(e){if(pt&&"function"===typeof pt.onCommitFiberRoot)try{pt.onCommitFiberRoot(ft,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),hc(e,ot()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Zl)throw Zl=!1,e=ec,ec=null,e;0!==(1&ic)&&0!==e.tag&&Nc(),s=e.pendingLanes,0!==(1&s)?e===oc?sc++:(sc=0,oc=e):sc=0,Xi()}(e,t,n,r)}finally{Ll.transition=i,Dt=r}return null}function Nc(){if(null!==rc){var e=At(ic),t=Ll.transition,n=Dt;try{if(Ll.transition=null,Dt=16>e?16:e,null===rc)var r=!1;else{if(e=rc,rc=null,ic=0,0!==(6&jl))throw Error(c(331));var i=jl;for(jl|=4,al=e.current;null!==al;){var s=al,o=s.child;if(0!==(16&al.flags)){var a=s.deletions;if(null!==a){for(var l=0;l<a.length;l++){var u=a[l];for(al=u;null!==al;){var d=al;switch(d.tag){case 0:case 11:case 15:dl(8,d,s)}var h=d.child;if(null!==h)h.return=d,al=h;else for(;null!==al;){var f=(d=al).sibling,p=d.return;if(pl(d),d===u){al=null;break}if(null!==f){f.return=p,al=f;break}al=p}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}al=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,al=o;else e:for(;null!==al;){if(0!==(2048&(s=al).flags))switch(s.tag){case 0:case 11:case 15:dl(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,al=y;break e}al=s.return}}var b=e.current;for(al=b;null!==al;){var w=(o=al).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,al=w;else e:for(o=b;null!==al;){if(0!==(2048&(a=al).flags))try{switch(a.tag){case 0:case 11:case 15:hl(9,a)}}catch(E){Mc(a,a.return,E)}if(a===o){al=null;break e}var S=a.sibling;if(null!==S){S.return=a.return,al=S;break e}al=a.return}}if(jl=i,Xi(),pt&&"function"===typeof pt.onPostCommitFiberRoot)try{pt.onPostCommitFiberRoot(ft,e)}catch(E){}r=!0}return r}finally{Dt=n,Ll.transition=t}}return!1}function Rc(e,t,n){e=Qs(e,t=Ea(0,t=ya(n,t),1),1),t=cc(),null!==e&&(Tt(e,1,t),hc(e,t))}function Mc(e,t,n){if(3===e.tag)Rc(e,e,n);else for(;null!==t;){if(3===t.tag){Rc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===tc||!tc.has(r))){t=Qs(t,e=_a(t,e=ya(n,e),1),1),e=cc(),null!==t&&(Tt(t,1,e),hc(t,e));break}}t=t.return}}function Oc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=cc(),e.pingedLanes|=e.suspendedLanes&n,Fl===e&&(Bl&n)===n&&(4===Hl||3===Hl&&(130023424&Bl)===Bl&&500>ot()-Yl?Sc(e,0):Wl|=n),hc(e,t)}function Pc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=bt,0===(130023424&(bt<<=1))&&(bt=4194304)));var n=cc();null!==(e=Hs(e,t))&&(Tt(e,t,n),hc(e,n))}function Lc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Pc(e,n)}function jc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(c(314))}null!==r&&r.delete(t),Pc(e,n)}function Fc(e,t){return nt(e,t)}function Uc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bc(e,t,n,r){return new Uc(e,t,n,r)}function zc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Vc(e,t){var n=e.alternate;return null===n?((n=Bc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Hc(e,t,n,r,i,s){var o=2;if(r=e,"function"===typeof e)zc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case R:return qc(n.children,i,s,t);case M:o=8,i|=8;break;case O:return(e=Bc(12,n,t,2|i)).elementType=O,e.lanes=s,e;case F:return(e=Bc(13,n,t,i)).elementType=F,e.lanes=s,e;case U:return(e=Bc(19,n,t,i)).elementType=U,e.lanes=s,e;case H:return $c(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case P:o=10;break e;case L:o=9;break e;case j:o=11;break e;case z:o=14;break e;case V:o=16,r=null;break e}throw Error(c(130,null==e?e:typeof e,""))}return(t=Bc(o,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function qc(e,t,n,r){return(e=Bc(7,e,r,t)).lanes=n,e}function $c(e,t,n,r){return(e=Bc(22,e,r,t)).elementType=H,e.lanes=n,e.stateNode={isHidden:!1},e}function Gc(e,t,n){return(e=Bc(6,e,null,t)).lanes=n,e}function Wc(e,t,n){return(t=Bc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xt(0),this.expirationTimes=xt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Kc(e,t,n,r,i,s,o,a,l){return e=new Qc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Bc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$s(s),e}function Yc(e){if(!e)return Li;e:{if(Xe(e=e._reactInternals)!==e||1!==e.tag)throw Error(c(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(c(171))}if(1===e.tag){var n=e.type;if(zi(n))return qi(e,n,t)}return t}function Xc(e,t,n,r,i,s,o,a,l){return(e=Kc(n,r,!0,e,0,s,0,a,l)).context=Yc(null),n=e.current,(s=Ws(r=cc(),i=uc(n))).callback=void 0!==t&&null!==t?t:null,Qs(n,s,i),e.current.lanes=i,Tt(e,i,r),hc(e,r),e}function Jc(e,t,n,r){var i=t.current,s=cc(),o=uc(i);return n=Yc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ws(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Qs(i,t,o))&&(dc(e,i,o,s),Ks(e,i,o)),o}function Zc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function eu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function tu(e,t){eu(e,t),(e=e.alternate)&&eu(e,t)}Rl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Fi.current)Da=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Da=!1,function(e,t,n){switch(t.tag){case 3:Fa(t),Es();break;case 5:oo(t);break;case 1:zi(t.type)&&$i(t);break;case 4:io(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Pi(Ns,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Pi(lo,1&lo.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ga(e,t,n):(Pi(lo,1&lo.current),null!==(e=Za(e,t,n))?e.sibling:null);Pi(lo,1&lo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Xa(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Pi(lo,lo.current),r)break;return null;case 22:case 23:return t.lanes=0,Ma(e,t,n)}return Za(e,t,n)}(e,t,n);Da=0!==(131072&e.flags)}else Da=!1,fs&&0!==(1048576&t.flags)&&ls(t,ts,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ja(e,t),e=t.pendingProps;var i=Bi(t,ji.current);Fs(t,n),i=xo(null,t,r,e,i,n);var s=To();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zi(r)?(s=!0,$i(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,$s(t),i.updater=fa,t.stateNode=i,i._reactInternals=t,va(t,r,e,n),t=ja(null,t,r,!0,s,n)):(t.tag=0,fs&&s&&cs(t),Aa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ja(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return zc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===j)return 11;if(e===z)return 14}return 2}(r),e=da(r,e),i){case 0:t=Pa(null,t,r,e,n);break e;case 1:t=La(null,t,r,e,n);break e;case 11:t=ka(null,t,r,e,n);break e;case 14:t=Na(null,t,r,da(r.type,e),n);break e}throw Error(c(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Pa(e,t,r,i=t.elementType===r?i:da(r,i),n);case 1:return r=t.type,i=t.pendingProps,La(e,t,r,i=t.elementType===r?i:da(r,i),n);case 3:e:{if(Fa(t),null===e)throw Error(c(387));r=t.pendingProps,i=(s=t.memoizedState).element,Gs(e,t),Xs(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ua(e,t,r,n,i=ya(Error(c(423)),t));break e}if(r!==i){t=Ua(e,t,r,n,i=ya(Error(c(424)),t));break e}for(hs=yi(t.stateNode.containerInfo.firstChild),ds=t,fs=!0,ps=null,n=ks(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Es(),r===i){t=Za(e,t,n);break e}Aa(e,t,r,n)}t=t.child}return t;case 5:return oo(t),null===e&&ys(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,di(r,i)?o=null:null!==s&&di(r,s)&&(t.flags|=32),Oa(e,t),Aa(e,t,o,n),t.child;case 6:return null===e&&ys(t),null;case 13:return Ga(e,t,n);case 4:return io(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=As(t,null,r,n):Aa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ka(e,t,r,i=t.elementType===r?i:da(r,i),n);case 7:return Aa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Aa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Pi(Ns,r._currentValue),r._currentValue=o,null!==s)if(mr(s.value,o)){if(s.children===i.children&&!Fi.current){t=Za(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var a=s.dependencies;if(null!==a){o=s.child;for(var l=a.firstContext;null!==l;){if(l.context===r){if(1===s.tag){(l=Ws(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),js(s.return,n,t),a.lanes|=n;break}l=l.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(c(341));o.lanes|=n,null!==(a=o.alternate)&&(a.lanes|=n),js(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}Aa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Fs(t,n),r=r(i=Us(i)),t.flags|=1,Aa(e,t,r,n),t.child;case 14:return i=da(r=t.type,t.pendingProps),Na(e,t,r,i=da(r.type,i),n);case 15:return Ra(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:da(r,i),Ja(e,t),t.tag=1,zi(r)?(e=!0,$i(t)):e=!1,Fs(t,n),ga(t,r,i),va(t,r,i,n),ja(null,t,r,!0,e,n);case 19:return Xa(e,t,n);case 22:return Ma(e,t,n)}throw Error(c(156,t.tag))};var nu="function"===typeof reportError?reportError:function(e){console.error(e)};function ru(e){this._internalRoot=e}function iu(e){this._internalRoot=e}function su(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function ou(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function au(){}function lu(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Zc(o);a.call(e)}}Jc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Zc(o);s.call(e)}}var o=Xc(t,r,e,0,null,!1,0,"",au);return e._reactRootContainer=o,e[_i]=o.current,Xr(8===e.nodeType?e.parentNode:e),bc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Zc(l);a.call(e)}}var l=Kc(e,0,!1,null,0,!1,0,"",au);return e._reactRootContainer=l,e[_i]=l.current,Xr(8===e.nodeType?e.parentNode:e),bc(function(){Jc(t,l,n,r)}),l}(n,t,e,i,r);return Zc(o)}iu.prototype.render=ru.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(c(409));Jc(e,t,null,null)},iu.prototype.unmount=ru.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;bc(function(){Jc(null,e,null,null)}),t[_i]=null}},iu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Mt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Vt.length&&0!==t&&t<Vt[n].priority;n++);Vt.splice(n,0,e),0===n&&Gt(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=wt(t.pendingLanes);0!==n&&(It(t,1|n),hc(t,ot()),0===(6&jl)&&(Xl=ot()+500,Xi()))}break;case 13:bc(function(){var t=Hs(e,1);if(null!==t){var n=cc();dc(t,e,1,n)}}),tu(e,1)}},Nt=function(e){if(13===e.tag){var t=Hs(e,134217728);if(null!==t)dc(t,e,134217728,cc());tu(e,134217728)}},Rt=function(e){if(13===e.tag){var t=uc(e),n=Hs(e,t);if(null!==n)dc(n,e,t,cc());tu(e,t)}},Mt=function(){return Dt},Ot=function(e,t){var n=Dt;try{return Dt=e,t()}finally{Dt=n}},Ne=function(e,t,n){switch(t){case"input":if(le(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ki(r);if(!i)throw Error(c(90));re(r),le(r,i)}}}break;case"textarea":ge(e,n);break;case"select":null!=(t=n.value)&&he(e,!!n.multiple,t,!1)}},je=yc,Fe=bc;var cu={usingClientEntryPoint:!1,Events:[Di,Ai,ki,Pe,Le,yc]},uu={findFiberByHostInstance:Ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},du={bundleType:uu.bundleType,version:uu.version,rendererPackageName:uu.rendererPackageName,rendererConfig:uu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=et(e))?null:e.stateNode},findFiberByHostInstance:uu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hu.isDisabled&&hu.supportsFiber)try{ft=hu.inject(du),pt=hu}catch(l){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!su(t))throw Error(c(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:N,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!su(e))throw Error(c(299));var n=!1,r="",i=nu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Kc(e,1,!1,null,0,n,0,r,i),e[_i]=t.current,Xr(8===e.nodeType?e.parentNode:e),new ru(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(c(188));throw e=Object.keys(e).join(","),Error(c(268,e))}return e=null===(e=et(t))?null:e.stateNode},t.flushSync=function(e){return bc(e)},t.hydrate=function(e,t,n){if(!ou(t))throw Error(c(200));return lu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!su(e))throw Error(c(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",o=nu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Xc(t,null,e,1,null!=n?n:null,i,0,s,o),e[_i]=t.current,Xr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new iu(t)},t.render=function(e,t,n){if(!ou(t))throw Error(c(200));return lu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!ou(e))throw Error(c(40));return!!e._reactRootContainer&&(bc(function(){lu(null,null,e,!1,function(){e._reactRootContainer=null,e[_i]=null})}),!0)},t.unstable_batchedUpdates=yc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ou(n))throw Error(c(200));if(null==e||void 0===e._reactInternals)throw Error(c(38));return lu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},812:(e,t,n)=>{n.d(t,{h1:()=>l,uA:()=>i});var r=n(700);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const o="[DEFAULT]";class a{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(s){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(s){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(s){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===o?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return this.component?this.component.multipleInstances?e:o:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class l{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".16f06f22.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(s){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="classroom-reservation:";n.l=(r,i,s,o)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+s){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[i];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach(e=>e(n)),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise((n,r)=>i=e[t]=[n,r]);r.push(i[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}},"chunk-"+t,t)}};var t=(t,r)=>{var i,s,o=r[0],a=r[1],l=r[2],c=0;if(o.some(t=>0!==e[t])){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkclassroom_reservation=self.webpackChunkclassroom_reservation||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(43),i=n(391);let s={data:""},o=e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||s},a=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,l=/\/\*[^]*?\*\/|  +/g,c=/\n+/g,u=(e,t)=>{let n="",r="",i="";for(let s in e){let o=e[s];"@"==s[0]?"i"==s[1]?n=s+" "+o+";":r+="f"==s[1]?u(o,s):s+"{"+u(o,"k"==s[1]?"":t)+"}":"object"==typeof o?r+=u(o,t?t.replace(/([^,])+/g,e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):s):null!=o&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=u.p?u.p(s,o):s+":"+o+";")}return n+(t&&i?t+"{"+i+"}":i)+r},d={},h=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+h(e[n]);return t}return e},f=(e,t,n,r,i)=>{let s=h(e),o=d[s]||(d[s]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(s));if(!d[o]){let t=s!==e?e:(e=>{let t,n,r=[{}];for(;t=a.exec(e.replace(l,""));)t[4]?r.shift():t[3]?(n=t[3].replace(c," ").trim(),r.unshift(r[0][n]=r[0][n]||{})):r[0][t[1]]=t[2].replace(c," ").trim();return r[0]})(e);d[o]=u(i?{["@keyframes "+o]:t}:t,n?"":"."+o)}let f=n&&d.g?d.g:null;return n&&(d.g=d[o]),((e,t,n,r)=>{r?t.data=t.data.replace(r,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(d[o],t,r,f),o};function p(e){let t=this||{},n=e.call?e(t.p):e;return f(n.unshift?n.raw?((e,t,n)=>e.reduce((e,r,i)=>{let s=t[i];if(s&&s.call){let e=s(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":u(e,""):!1===e?"":e}return e+r+(null==s?"":s)},""))(n,[].slice.call(arguments,1),t.p):n.reduce((e,n)=>Object.assign(e,n&&n.call?n(t.p):n),{}):n,o(t.target),t.g,t.o,t.k)}p.bind({g:1});let g,m,v,y=p.bind({k:1});function b(e,t){let n=this||{};return function(){let r=arguments;function i(s,o){let a=Object.assign({},s),l=a.className||i.className;n.p=Object.assign({theme:m&&m()},a),n.o=/ *go\d+/.test(l),a.className=p.apply(n,r)+(l?" "+l:""),t&&(a.ref=o);let c=e;return e[0]&&(c=a.as||e,delete a.as),v&&c[0]&&v(a),g(c,a)}return t?t(i):i}}var w=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,S=(()=>{let e=0;return()=>(++e).toString()})(),E=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),_="default",C=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case 2:let{toast:r}=t;return C(e,{type:e.toasts.find(e=>e.id===r.id)?1:0,toast:r});case 3:let{toastId:i}=t;return{...e,toasts:e.toasts.map(e=>e.id===i||void 0===i?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+s}))}}},x=[],T={toasts:[],pausedAt:void 0,settings:{toastLimit:20}},I={},D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;I[t]=C(I[t]||T,e),x.forEach(e=>{let[n,r]=e;n===t&&r(I[t])})},A=e=>Object.keys(I).forEach(t=>D(e,t)),k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_;return t=>{D(t,e)}},N={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},R=e=>(t,n)=>{let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",n=arguments.length>2?arguments[2]:void 0;return{createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||S()}}(t,e,n);return k(r.toasterId||(e=>Object.keys(I).find(t=>I[t].toasts.some(t=>t.id===e)))(r.id))({type:2,toast:r}),r.id},M=(e,t)=>R("blank")(e,t);M.error=R("error"),M.success=R("success"),M.loading=R("loading"),M.custom=R("custom"),M.dismiss=(e,t)=>{let n={type:3,toastId:e};t?k(t)(n):A(n)},M.dismissAll=e=>M.dismiss(void 0,e),M.remove=(e,t)=>{let n={type:4,toastId:e};t?k(t)(n):A(n)},M.removeAll=e=>M.remove(void 0,e),M.promise=(e,t,n)=>{let r=M.loading(t.loading,{...n,...null==n?void 0:n.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let i=t.success?w(t.success,e):void 0;return i?M.success(i,{id:r,...n,...null==n?void 0:n.success}):M.dismiss(r),e}).catch(e=>{let i=t.error?w(t.error,e):void 0;i?M.error(i,{id:r,...n,...null==n?void 0:n.error}):M.dismiss(r)}),e};var O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",{toasts:n,pausedAt:i}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_,[n,i]=(0,r.useState)(I[t]||T),s=(0,r.useRef)(I[t]);(0,r.useEffect)(()=>(s.current!==I[t]&&i(I[t]),x.push([t,i]),()=>{let e=x.findIndex(e=>{let[n]=e;return n===t});e>-1&&x.splice(e,1)}),[t]);let o=n.toasts.map(t=>{var n,r,i;return{...e,...e[t.type],...t,removeDelay:t.removeDelay||(null==(n=e[t.type])?void 0:n.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(r=e[t.type])?void 0:r.duration)||(null==e?void 0:e.duration)||N[t.type],style:{...e.style,...null==(i=e[t.type])?void 0:i.style,...t.style}}});return{...n,toasts:o}}(e,t),s=(0,r.useRef)(new Map).current,o=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(s.has(e))return;let n=setTimeout(()=>{s.delete(e),a({type:4,toastId:e})},t);s.set(e,n)},[]);(0,r.useEffect)(()=>{if(i)return;let e=Date.now(),r=n.map(n=>{if(n.duration===1/0)return;let r=(n.duration||0)+n.pauseDuration-(e-n.createdAt);if(!(r<0))return setTimeout(()=>M.dismiss(n.id,t),r);n.visible&&M.dismiss(n.id)});return()=>{r.forEach(e=>e&&clearTimeout(e))}},[n,i,t]);let a=(0,r.useCallback)(k(t),[t]),l=(0,r.useCallback)(()=>{a({type:5,time:Date.now()})},[a]),c=(0,r.useCallback)((e,t)=>{a({type:1,toast:{id:e,height:t}})},[a]),u=(0,r.useCallback)(()=>{i&&a({type:6,time:Date.now()})},[i,a]),d=(0,r.useCallback)((e,t)=>{let{reverseOrder:r=!1,gutter:i=8,defaultPosition:s}=t||{},o=n.filter(t=>(t.position||s)===(e.position||s)&&t.height),a=o.findIndex(t=>t.id===e.id),l=o.filter((e,t)=>t<a&&e.visible).length;return o.filter(e=>e.visible).slice(...r?[l+1]:[0,l]).reduce((e,t)=>e+(t.height||0)+i,0)},[n]);return(0,r.useEffect)(()=>{n.forEach(e=>{if(e.dismissed)o(e.id,e.removeDelay);else{let t=s.get(e.id);t&&(clearTimeout(t),s.delete(e.id))}})},[n,o]),{toasts:n,handlers:{updateHeight:c,startPause:l,endPause:u,calculateOffset:d}}},P=y`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,L=y`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,j=y`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,F=b("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${P} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${L} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${j} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,U=y`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,B=b("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${U} 1s linear infinite;
`,z=y`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,V=y`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,H=b("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${z} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${V} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,q=b("div")`
  position: absolute;
`,$=b("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,G=y`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,W=b("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${G} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Q=e=>{let{toast:t}=e,{icon:n,type:i,iconTheme:s}=t;return void 0!==n?"string"==typeof n?r.createElement(W,null,n):n:"blank"===i?null:r.createElement($,null,r.createElement(B,{...s}),"loading"!==i&&r.createElement(q,null,"error"===i?r.createElement(F,{...s}):r.createElement(H,{...s})))},K=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,Y=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,X=b("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,J=b("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Z=r.memo(e=>{let{toast:t,position:n,style:i,children:s}=e,o=t.height?((e,t)=>{let n=e.includes("top")?1:-1,[r,i]=E()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[K(n),Y(n)];return{animation:t?`${y(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${y(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(t.position||n||"top-center",t.visible):{opacity:0},a=r.createElement(Q,{toast:t}),l=r.createElement(J,{...t.ariaProps},w(t.message,t));return r.createElement(X,{className:t.className,style:{...o,...i,...t.style}},"function"==typeof s?s({icon:a,message:l}):r.createElement(r.Fragment,null,a,l))});!function(e,t,n,r){u.p=t,g=e,m=n,v=r}(r.createElement);var ee,te,ne,re,ie,se,oe,ae,le,ce=e=>{let{id:t,className:n,style:i,onHeightUpdate:s,children:o}=e,a=r.useCallback(e=>{if(e){let n=()=>{let n=e.getBoundingClientRect().height;s(t,n)};n(),new MutationObserver(n).observe(e,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return r.createElement("div",{ref:a,className:n,style:i},o)},ue=p`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,de=e=>{let{reverseOrder:t,position:n="top-center",toastOptions:i,gutter:s,children:o,toasterId:a,containerStyle:l,containerClassName:c}=e,{toasts:u,handlers:d}=O(i,a);return r.createElement("div",{"data-rht-toaster":a||"",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...l},className:c,onMouseEnter:d.startPause,onMouseLeave:d.endPause},u.map(e=>{let i=e.position||n,a=((e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},i=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:E()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...i}})(i,d.calculateOffset(e,{reverseOrder:t,gutter:s,defaultPosition:n}));return r.createElement(ce,{id:e.id,key:e.id,onHeightUpdate:d.updateHeight,className:e.visible?ue:"",style:a},"custom"===e.type?w(e.message,e):o?o(e):r.createElement(Z,{toast:e,position:i}))}))},he=M,fe=n(950),pe={},ge=[],me=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ve(e,t){for(var n in t)e[n]=t[n];return e}function ye(e){var t=e.parentNode;t&&t.removeChild(e)}function be(e,t,n){var r,i,s,o={};for(s in t)"key"==s?r=t[s]:"ref"==s?i=t[s]:o[s]=t[s];if(arguments.length>2&&(o.children=arguments.length>3?ee.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===o[s]&&(o[s]=e.defaultProps[s]);return we(e,o,r,i,null)}function we(e,t,n,r,i){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++ne:i};return null==i&&null!=te.vnode&&te.vnode(s),s}function Se(e){return e.children}function Ee(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||me.test(t)?n:n+"px"}function _e(e,t,n,r,i){var s;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||Ee(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||Ee(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?r||e.addEventListener(t,s?xe:Ce,s):e.removeEventListener(t,s?xe:Ce,s);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,n))}}function Ce(e){ie=!0;try{return this.l[e.type+!1](te.event?te.event(e):e)}finally{ie=!1}}function xe(e){ie=!0;try{return this.l[e.type+!0](te.event?te.event(e):e)}finally{ie=!1}}function Te(e,t){this.props=e,this.context=t}function Ie(e,t){if(null==t)return e.__?Ie(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?Ie(e):null}function De(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return De(e)}}function Ae(e){ie?setTimeout(e):ae(e)}function ke(e){(!e.__d&&(e.__d=!0)&&se.push(e)&&!Ne.__r++||oe!==te.debounceRendering)&&((oe=te.debounceRendering)||Ae)(Ne)}function Ne(){var e,t,n,r,i,s,o,a;for(se.sort(function(e,t){return e.__v.__b-t.__v.__b});e=se.shift();)e.__d&&(t=se.length,r=void 0,i=void 0,o=(s=(n=e).__v).__e,(a=n.__P)&&(r=[],(i=ve({},s)).__v=s.__v+1,je(a,s,i,n.__n,void 0!==a.ownerSVGElement,null!=s.__h?[o]:null,r,null==o?Ie(s):o,s.__h),Fe(r,s),s.__e!=o&&De(s)),se.length>t&&se.sort(function(e,t){return e.__v.__b-t.__v.__b}));Ne.__r=0}function Re(e,t,n,r,i,s,o,a,l,c){var u,d,h,f,p,g,m,v=r&&r.__k||ge,y=v.length;for(n.__k=[],u=0;u<t.length;u++)if(null!=(f=n.__k[u]=null==(f=t[u])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?we(null,f,null,null,f):Array.isArray(f)?we(Se,{children:f},null,null,null):f.__b>0?we(f.type,f.props,f.key,f.ref?f.ref:null,f.__v):f)){if(f.__=n,f.__b=n.__b+1,null===(h=v[u])||h&&f.key==h.key&&f.type===h.type)v[u]=void 0;else for(d=0;d<y;d++){if((h=v[d])&&f.key==h.key&&f.type===h.type){v[d]=void 0;break}h=null}je(e,f,h=h||pe,i,s,o,a,l,c),p=f.__e,(d=f.ref)&&h.ref!=d&&(m||(m=[]),h.ref&&m.push(h.ref,null,f),m.push(d,f.__c||p,f)),null!=p?(null==g&&(g=p),"function"==typeof f.type&&f.__k===h.__k?f.__d=l=Me(f,l,e):l=Pe(e,f,h,v,p,l),"function"==typeof n.type&&(n.__d=l)):l&&h.__e==l&&l.parentNode!=e&&(l=Ie(h))}for(n.__e=g,u=y;u--;)null!=v[u]&&("function"==typeof n.type&&null!=v[u].__e&&v[u].__e==n.__d&&(n.__d=Le(r).nextSibling),ze(v[u],v[u]));if(m)for(u=0;u<m.length;u++)Be(m[u],m[++u],m[++u])}function Me(e,t,n){for(var r,i=e.__k,s=0;i&&s<i.length;s++)(r=i[s])&&(r.__=e,t="function"==typeof r.type?Me(r,t,n):Pe(n,r,r,i,r.__e,t));return t}function Oe(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some(function(e){Oe(e,t)}):t.push(e)),t}function Pe(e,t,n,r,i,s){var o,a,l;if(void 0!==t.__d)o=t.__d,t.__d=void 0;else if(null==n||i!=s||null==i.parentNode)e:if(null==s||s.parentNode!==e)e.appendChild(i),o=null;else{for(a=s,l=0;(a=a.nextSibling)&&l<r.length;l+=1)if(a==i)break e;e.insertBefore(i,s),o=s}return void 0!==o?o:i.nextSibling}function Le(e){var t,n,r;if(null==e.type||"string"==typeof e.type)return e.__e;if(e.__k)for(t=e.__k.length-1;t>=0;t--)if((n=e.__k[t])&&(r=Le(n)))return r;return null}function je(e,t,n,r,i,s,o,a,l){var c,u,d,h,f,p,g,m,v,y,b,w,S,E,_,C=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(l=n.__h,a=t.__e=n.__e,t.__h=null,s=[a]),(c=te.__b)&&c(t);try{e:if("function"==typeof C){if(m=t.props,v=(c=C.contextType)&&r[c.__c],y=c?v?v.props.value:c.__:r,n.__c?g=(u=t.__c=n.__c).__=u.__E:("prototype"in C&&C.prototype.render?t.__c=u=new C(m,y):(t.__c=u=new Te(m,y),u.constructor=C,u.render=Ve),v&&v.sub(u),u.props=m,u.state||(u.state={}),u.context=y,u.__n=r,d=u.__d=!0,u.__h=[],u._sb=[]),null==u.__s&&(u.__s=u.state),null!=C.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=ve({},u.__s)),ve(u.__s,C.getDerivedStateFromProps(m,u.__s))),h=u.props,f=u.state,u.__v=t,d)null==C.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==C.getDerivedStateFromProps&&m!==h&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(m,y),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(m,u.__s,y)||t.__v===n.__v){for(t.__v!==n.__v&&(u.props=m,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(e){e&&(e.__=t)}),b=0;b<u._sb.length;b++)u.__h.push(u._sb[b]);u._sb=[],u.__h.length&&o.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(m,u.__s,y),null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(h,f,p)})}if(u.context=y,u.props=m,u.__P=e,w=te.__r,S=0,"prototype"in C&&C.prototype.render){for(u.state=u.__s,u.__d=!1,w&&w(t),c=u.render(u.props,u.state,u.context),E=0;E<u._sb.length;E++)u.__h.push(u._sb[E]);u._sb=[]}else do{u.__d=!1,w&&w(t),c=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++S<25);u.state=u.__s,null!=u.getChildContext&&(r=ve(ve({},r),u.getChildContext())),d||null==u.getSnapshotBeforeUpdate||(p=u.getSnapshotBeforeUpdate(h,f)),_=null!=c&&c.type===Se&&null==c.key?c.props.children:c,Re(e,Array.isArray(_)?_:[_],t,n,r,i,s,o,a,l),u.base=t.__e,t.__h=null,u.__h.length&&o.push(u),g&&(u.__E=u.__=null),u.__e=!1}else null==s&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Ue(n.__e,t,n,r,i,s,o,l);(c=te.diffed)&&c(t)}catch(e){t.__v=null,(l||null!=s)&&(t.__e=a,t.__h=!!l,s[s.indexOf(a)]=null),te.__e(e,t,n)}}function Fe(e,t){te.__c&&te.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){te.__e(e,t.__v)}})}function Ue(e,t,n,r,i,s,o,a){var l,c,u,d=n.props,h=t.props,f=t.type,p=0;if("svg"===f&&(i=!0),null!=s)for(;p<s.length;p++)if((l=s[p])&&"setAttribute"in l==!!f&&(f?l.localName===f:3===l.nodeType)){e=l,s[p]=null;break}if(null==e){if(null===f)return document.createTextNode(h);e=i?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,h.is&&h),s=null,a=!1}if(null===f)d===h||a&&e.data===h||(e.data=h);else{if(s=s&&ee.call(e.childNodes),c=(d=n.props||pe).dangerouslySetInnerHTML,u=h.dangerouslySetInnerHTML,!a){if(null!=s)for(d={},p=0;p<e.attributes.length;p++)d[e.attributes[p].name]=e.attributes[p].value;(u||c)&&(u&&(c&&u.__html==c.__html||u.__html===e.innerHTML)||(e.innerHTML=u&&u.__html||""))}if(function(e,t,n,r,i){var s;for(s in n)"children"===s||"key"===s||s in t||_e(e,s,null,n[s],r);for(s in t)i&&"function"!=typeof t[s]||"children"===s||"key"===s||"value"===s||"checked"===s||n[s]===t[s]||_e(e,s,t[s],n[s],r)}(e,h,d,i,a),u)t.__k=[];else if(p=t.props.children,Re(e,Array.isArray(p)?p:[p],t,n,r,i&&"foreignObject"!==f,s,o,s?s[0]:n.__k&&Ie(n,0),a),null!=s)for(p=s.length;p--;)null!=s[p]&&ye(s[p]);a||("value"in h&&void 0!==(p=h.value)&&(p!==e.value||"progress"===f&&!p||"option"===f&&p!==d.value)&&_e(e,"value",p,d.value,!1),"checked"in h&&void 0!==(p=h.checked)&&p!==e.checked&&_e(e,"checked",p,d.checked,!1))}return e}function Be(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){te.__e(e,n)}}function ze(e,t,n){var r,i;if(te.unmount&&te.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||Be(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){te.__e(e,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&ze(r[i],t,n||"function"!=typeof e.type);n||null==e.__e||ye(e.__e),e.__=e.__e=e.__d=void 0}function Ve(e,t,n){return this.constructor(e,n)}function He(e,t,n){var r,i,s;te.__&&te.__(e,t),i=(r="function"==typeof n)?null:n&&n.__k||t.__k,s=[],je(t,e=(!r&&n||t).__k=be(Se,null,[e]),i||pe,pe,void 0!==t.ownerSVGElement,!r&&n?[n]:i?null:t.firstChild?ee.call(t.childNodes):null,s,!r&&n?n:i?i.__e:t.firstChild,r),Fe(s,e)}function qe(e,t){var n={__c:t="__cC"+le++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(function(e){e.__e=!0,ke(e)})},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}ee=ge.slice,te={__e:function(e,t,n,r){for(var i,s,o;t=t.__;)if((i=t.__c)&&!i.__)try{if((s=i.constructor)&&null!=s.getDerivedStateFromError&&(i.setState(s.getDerivedStateFromError(e)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),o=i.__d),o)return i.__E=i}catch(t){e=t}throw e}},ne=0,re=function(e){return null!=e&&void 0===e.constructor},ie=!1,Te.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=ve({},this.state),"function"==typeof e&&(e=e(ve({},n),this.props)),e&&ve(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),ke(this))},Te.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ke(this))},Te.prototype.render=Se,se=[],ae="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ne.__r=0,le=0;var $e,Ge,We,Qe=[],Ke=[],Ye=te.__b,Xe=te.__r,Je=te.diffed,Ze=te.__c,et=te.unmount;function tt(){for(var e;e=Qe.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(it),e.__H.__h.forEach(st),e.__H.__h=[]}catch(t){e.__H.__h=[],te.__e(t,e.__v)}}te.__b=function(e){$e=null,Ye&&Ye(e)},te.__r=function(e){Xe&&Xe(e);var t=($e=e.__c).__H;t&&(Ge===$e?(t.__h=[],$e.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.__V=Ke,e.__N=e.i=void 0})):(t.__h.forEach(it),t.__h.forEach(st),t.__h=[])),Ge=$e},te.diffed=function(e){Je&&Je(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Qe.push(t)&&We===te.requestAnimationFrame||((We=te.requestAnimationFrame)||rt)(tt)),t.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.__V!==Ke&&(e.__=e.__V),e.i=void 0,e.__V=Ke})),Ge=$e=null},te.__c=function(e,t){t.some(function(e){try{e.__h.forEach(it),e.__h=e.__h.filter(function(e){return!e.__||st(e)})}catch(p){t.some(function(e){e.__h&&(e.__h=[])}),t=[],te.__e(p,e.__v)}}),Ze&&Ze(e,t)},te.unmount=function(e){et&&et(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{it(e)}catch(e){t=e}}),n.__H=void 0,t&&te.__e(t,n.__v))};var nt="function"==typeof requestAnimationFrame;function rt(e){var t,n=function(){clearTimeout(r),nt&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);nt&&(t=requestAnimationFrame(n))}function it(e){var t=$e,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),$e=t}function st(e){var t=$e;e.__c=e.__(),$e=t}function ot(e,t){for(var n in t)e[n]=t[n];return e}function at(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function lt(e){this.props=e}(lt.prototype=new Te).isPureReactComponent=!0,lt.prototype.shouldComponentUpdate=function(e,t){return at(this.props,e)||at(this.state,t)};var ct=te.__b;te.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),ct&&ct(e)};"undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref");var ut=te.__e;te.__e=function(e,t,n,r){if(e.then)for(var i,s=t;s=s.__;)if((i=s.__c)&&i.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),i.__c(e,t);ut(e,t,n,r)};var dt=te.unmount;function ht(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(e){"function"==typeof e.__c&&e.__c()}),e.__c.__H=null),null!=(e=ot({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(e){return ht(e,t,n)})),e}function ft(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(e){return ft(e,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function pt(){this.__u=0,this.t=null,this.__b=null}function gt(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function mt(){this.u=null,this.o=null}te.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),dt&&dt(e)},(pt.prototype=new Te).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var i=gt(r.__v),s=!1,o=function(){s||(s=!0,n.__R=null,i?i(a):a())};n.__R=o;var a=function(){if(! --r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=ft(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},pt.prototype.componentWillUnmount=function(){this.t=[]},pt.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=ht(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__a&&be(Se,null,e.fallback);return i&&(i.__h=null),[be(Se,null,t.__a?null:e.children),i]};var vt=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function yt(e){return this.getChildContext=function(){return e.context},e.children}function bt(e){var t=this,n=e.i;t.componentWillUnmount=function(){He(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,n){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),He(be(yt,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function wt(e,t){var n=be(bt,{__v:e,i:t});return n.containerInfo=t,n}(mt.prototype=new Te).__a=function(e){var t=this,n=gt(t.__v),r=t.o.get(e);return r[0]++,function(i){var s=function(){t.props.revealOrder?(r.push(i),vt(t,e,r)):i()};n?n(s):s()}},mt.prototype.render=function(e){this.u=null,this.o=new Map;var t=Oe(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},mt.prototype.componentDidUpdate=mt.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){vt(e,n,t)})};var St="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Et=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,_t="undefined"!=typeof document,Ct=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};Te.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Te.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var xt=te.event;function Tt(){}function It(){return this.cancelBubble}function Dt(){return this.defaultPrevented}te.event=function(e){return xt&&(e=xt(e)),e.persist=Tt,e.isPropagationStopped=It,e.isDefaultPrevented=Dt,e.nativeEvent=e};var At={configurable:!0,get:function(){return this.class}},kt=te.vnode;te.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var i=-1===t.indexOf("-");for(var s in r={},n){var o=n[s];_t&&"children"===s&&"noscript"===t||"value"===s&&"defaultValue"in n&&null==o||("defaultValue"===s&&"value"in n&&null==n.value?s="value":"download"===s&&!0===o?o="":/ondoubleclick/i.test(s)?s="ondblclick":/^onchange(textarea|input)/i.test(s+t)&&!Ct(n.type)?s="oninput":/^onfocus$/i.test(s)?s="onfocusin":/^onblur$/i.test(s)?s="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(s)?s=s.toLowerCase():i&&Et.test(s)?s=s.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(s)&&(s=s.toLowerCase(),r[s]&&(s="oninputCapture")),r[s]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=Oe(n.children).forEach(function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)})),"select"==t&&null!=r.defaultValue&&(r.value=Oe(n.children).forEach(function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value})),e.props=r,n.class!=n.className&&(At.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",At))}e.$$typeof=St,kt&&kt(e)};var Nt=te.__r;te.__r=function(e){Nt&&Nt(e),e.__c};const Rt=[],Mt=new Map;function Ot(e){Rt.push(e),Mt.forEach(t=>{Lt(t,e)})}function Pt(e){let t=Mt.get(e);if(!t||!t.isConnected){if(t=e.querySelector("style[data-fullcalendar]"),!t){t=document.createElement("style"),t.setAttribute("data-fullcalendar","");const n=function(){void 0===jt&&(jt=function(){const e=document.querySelector('meta[name="csp-nonce"]');if(e&&e.hasAttribute("content"))return e.getAttribute("content");const t=document.querySelector("script[nonce]");if(t)return t.nonce||"";return""}());return jt}();n&&(t.nonce=n);const r=e===document?document.head:e,i=e===document?r.querySelector("script,link[rel=stylesheet],link[as=style],style"):r.firstChild;r.insertBefore(t,i)}Mt.set(e,t),function(e){for(const t of Rt)Lt(e,t)}(t)}}function Lt(e,t){const{sheet:n}=e,r=n.cssRules.length;t.split("}").forEach((e,t)=>{(e=e.trim())&&n.insertRule(e+"}",r+t)})}let jt;"undefined"!==typeof document&&Pt(document);Ot(':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}');class Ft{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),null==e?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{pauseDepths:t}=this;t[e]=(t[e]||0)+1,this.clearTimeout()}resume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,{pauseDepths:n}=this;if(e in n){if(t)delete n[e];else{n[e]-=1,n[e]<=0&&delete n[e]}this.tryDrain()}}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}}function Ut(e){e.parentNode&&e.parentNode.removeChild(e)}function Bt(e,t){if(e.closest)return e.closest(t);if(!document.documentElement.contains(e))return null;do{if(zt(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}function zt(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector).call(e,t)}const Vt=/(top|left|right|bottom|width|height)$/i;function Ht(e,t){for(let n in t)qt(e,n,t[n])}function qt(e,t,n){null==n?e.style[t]="":"number"===typeof n&&Vt.test(t)?e.style[t]=`${n}px`:e.style[t]=n}function $t(e){var t,n;return null!==(n=null===(t=e.composedPath)||void 0===t?void 0:t.call(e)[0])&&void 0!==n?n:e.target}let Gt=0;function Wt(){return Gt+=1,"fc-dom-"+Gt}function Qt(e){e.preventDefault()}function Kt(e,t,n,r){let i=function(e,t){return n=>{let r=Bt(n.target,e);r&&t.call(r,n,r)}}(n,r);return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}const Yt=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function Xt(e){return Object.assign({onClick:e},Jt(e))}function Jt(e){return{tabIndex:0,onKeyDown(t){"Enter"!==t.key&&" "!==t.key||(e(t),t.preventDefault())}}}let Zt=0;function en(){return Zt+=1,String(Zt)}function tn(){document.body.classList.add("fc-not-allowed")}function nn(){document.body.classList.remove("fc-not-allowed")}function rn(e,t,n){return n.func?n.func(e,t):function(e,t){if(!e&&!t)return 0;if(null==t)return-1;if(null==e)return 1;if("string"===typeof e||"string"===typeof t)return String(e).localeCompare(String(t));return e-t}(e[n.field],t[n.field])*(n.order||1)}function sn(e,t){let n=String(e);return"000".substr(0,t-n.length)+n}function on(e,t,n){return"function"===typeof e?e(...t):"string"===typeof e?t.reduce((e,t,n)=>e.replace("$"+n,t||""),e):n}function an(e,t){return e-t}function ln(e){return e%1===0}function cn(e){let t=e.querySelector(".fc-scrollgrid-shrink-frame"),n=e.querySelector(".fc-scrollgrid-shrink-cushion");if(!t)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!n)throw new Error("needs fc-scrollgrid-shrink-cushion className");return e.getBoundingClientRect().width-t.getBoundingClientRect().width+n.getBoundingClientRect().width}const un=["years","months","days","milliseconds"],dn=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function hn(e,t){return"string"===typeof e?function(e){let t=dn.exec(e);if(t){let e=t[1]?-1:1;return{years:0,months:0,days:e*(t[2]?parseInt(t[2],10):0),milliseconds:e*(60*(t[3]?parseInt(t[3],10):0)*60*1e3+60*(t[4]?parseInt(t[4],10):0)*1e3+1e3*(t[5]?parseInt(t[5],10):0)+(t[6]?parseInt(t[6],10):0))}}return null}(e):"object"===typeof e&&e?fn(e):"number"===typeof e?fn({[t||"milliseconds"]:e}):null}function fn(e){let t={years:e.years||e.year||0,months:e.months||e.month||0,days:e.days||e.day||0,milliseconds:60*(e.hours||e.hour||0)*60*1e3+60*(e.minutes||e.minute||0)*1e3+1e3*(e.seconds||e.second||0)+(e.milliseconds||e.millisecond||e.ms||0)},n=e.weeks||e.week;return n&&(t.days+=7*n,t.specifiedWeeks=!0),t}function pn(e,t){return{years:e.years+t.years,months:e.months+t.months,days:e.days+t.days,milliseconds:e.milliseconds+t.milliseconds}}function gn(e){return mn(e)/864e5}function mn(e){return 31536e6*e.years+2592e6*e.months+864e5*e.days+e.milliseconds}function vn(e,t){let n=null;for(let r=0;r<un.length;r+=1){let i=un[r];if(t[i]){let r=e[i]/t[i];if(!ln(r)||null!==n&&n!==r)return null;n=r}else if(e[i])return null}return n}function yn(e){let t=e.milliseconds;if(t){if(t%1e3!==0)return{unit:"millisecond",value:t};if(t%6e4!==0)return{unit:"second",value:t/1e3};if(t%36e5!==0)return{unit:"minute",value:t/6e4};if(t)return{unit:"hour",value:t/36e5}}return e.days?e.specifiedWeeks&&e.days%7===0?{unit:"week",value:e.days/7}:{unit:"day",value:e.days}:e.months?{unit:"month",value:e.months}:e.years?{unit:"year",value:e.years}:{unit:"millisecond",value:0}}function bn(e,t,n){if(e===t)return!0;let r,i=e.length;if(i!==t.length)return!1;for(r=0;r<i;r+=1)if(!(n?n(e[r],t[r]):e[r]===t[r]))return!1;return!0}const wn=["sun","mon","tue","wed","thu","fri","sat"];function Sn(e,t){let n=Nn(e);return n[2]+=7*t,Rn(n)}function En(e,t){let n=Nn(e);return n[2]+=t,Rn(n)}function _n(e,t){let n=Nn(e);return n[6]+=t,Rn(n)}function Cn(e,t){return(t.valueOf()-e.valueOf())/864e5}function xn(e,t){return On(e)===On(t)?Math.round(Cn(e,t)):null}function Tn(e){return Rn([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()])}function In(e,t,n,r){let i=Rn([t,0,1+Dn(t,n,r)]),s=Tn(e),o=Math.round(Cn(i,s));return Math.floor(o/7)+1}function Dn(e,t,n){let r=7+t-n;return-((7+Rn([e,0,r]).getUTCDay()-t)%7)+r-1}function An(e){return[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]}function kn(e){return new Date(e[0],e[1]||0,null==e[2]?1:e[2],e[3]||0,e[4]||0,e[5]||0)}function Nn(e){return[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()]}function Rn(e){return 1===e.length&&(e=e.concat([0])),new Date(Date.UTC(...e))}function Mn(e){return!isNaN(e.valueOf())}function On(e){return 1e3*e.getUTCHours()*60*60+1e3*e.getUTCMinutes()*60+1e3*e.getUTCSeconds()+e.getUTCMilliseconds()}function Pn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.toISOString();return r=r.replace(".000",""),n&&(r=r.replace("T00:00:00Z","")),r.length>10&&(null==t?r=r.replace("Z",""):0!==t&&(r=r.replace("Z",Fn(t,!0)))),r}function Ln(e){return e.toISOString().replace(/T.*$/,"")}function jn(e){return sn(e.getUTCHours(),2)+":"+sn(e.getUTCMinutes(),2)+":"+sn(e.getUTCSeconds(),2)}function Fn(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e<0?"-":"+",r=Math.abs(e),i=Math.floor(r/60),s=Math.round(r%60);return t?`${n+sn(i,2)}:${sn(s,2)}`:`GMT${n}${i}${s?`:${sn(s,2)}`:""}`}function Un(e,t,n){let r,i;return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];if(r){if(!bn(r,o)){n&&n(i);let r=e.apply(this,o);t&&t(r,i)||(i=r)}}else i=e.apply(this,o);return r=o,i}}function Bn(e,t,n){let r,i;return s=>{if(r){if(!yr(r,s)){n&&n(i);let r=e.call(this,s);t&&t(r,i)||(i=r)}}else i=e.call(this,s);return r=s,i}}const zn={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},Vn={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},Hn=/\s*([ap])\.?m\.?/i,qn=/,/g,$n=/\s+/g,Gn=/\u200e/g,Wn=/UTC|GMT/;class Qn{constructor(e){let t={},n={},r=9;for(let i in e)if(i in zn){n[i]=e[i];zn[i]<9&&(r=Math.min(zn[i],r))}else t[i]=e[i],i in Vn&&(r=Math.min(Vn[i],r));this.standardDateProps=t,this.extendedSettings=n,this.smallestUnitNum=r,this.buildFormattingFunc=Un(Kn)}format(e,t){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,t)(e)}formatRange(e,t,n,r){let{standardDateProps:i,extendedSettings:s}=this,o=function(e,t,n){if(n.getMarkerYear(e)!==n.getMarkerYear(t))return 5;if(n.getMarkerMonth(e)!==n.getMarkerMonth(t))return 4;if(n.getMarkerDay(e)!==n.getMarkerDay(t))return 2;if(On(e)!==On(t))return 1;return 0}(e.marker,t.marker,n.calendarSystem);if(!o)return this.format(e,n);let a=o;!(a>1)||"numeric"!==i.year&&"2-digit"!==i.year||"numeric"!==i.month&&"2-digit"!==i.month||"numeric"!==i.day&&"2-digit"!==i.day||(a=1);let l=this.format(e,n),c=this.format(t,n);if(l===c)return l;let u=Kn(function(e,t){let n={};for(let r in e)(!(r in Vn)||Vn[r]<=t)&&(n[r]=e[r]);return n}(i,a),s,n),d=u(e),h=u(t),f=function(e,t,n,r){let i=0;for(;i<e.length;){let s=e.indexOf(t,i);if(-1===s)break;let o=e.substr(0,s);i=s+t.length;let a=e.substr(i),l=0;for(;l<n.length;){let e=n.indexOf(r,l);if(-1===e)break;let t=n.substr(0,e);l=e+r.length;let i=n.substr(l);if(o===t&&a===i)return{before:o,after:a}}}return null}(l,d,c,h),p=s.separator||r||n.defaultSeparator||"";return f?f.before+d+p+h+f.after:l+p+c}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}}function Kn(e,t,n){let r=Object.keys(e).length;return 1===r&&"short"===e.timeZoneName?e=>Fn(e.timeZoneOffset):0===r&&t.week?e=>function(e,t,n,r,i){let s=[];"long"===i?s.push(n):"short"!==i&&"narrow"!==i||s.push(t);"long"!==i&&"short"!==i||s.push(" ");s.push(r.simpleNumberFormat.format(e)),"rtl"===r.options.direction&&s.reverse();return s.join("")}(n.computeWeekNumber(e.marker),n.weekText,n.weekTextLong,n.locale,t.week):function(e,t,n){e=Object.assign({},e),t=Object.assign({},t),function(e,t){e.timeZoneName&&(e.hour||(e.hour="2-digit"),e.minute||(e.minute="2-digit"));"long"===e.timeZoneName&&(e.timeZoneName="short");t.omitZeroMinute&&(e.second||e.millisecond)&&delete t.omitZeroMinute}(e,t),e.timeZone="UTC";let r,i=new Intl.DateTimeFormat(n.locale.codes,e);if(t.omitZeroMinute){let t=Object.assign({},e);delete t.minute,r=new Intl.DateTimeFormat(n.locale.codes,t)}return s=>{let o,{marker:a}=s;return o=r&&!a.getUTCMinutes()?r:i,function(e,t,n,r,i){e=e.replace(Gn,""),"short"===n.timeZoneName&&(e=function(e,t){let n=!1;e=e.replace(Wn,()=>(n=!0,t)),n||(e+=` ${t}`);return e}(e,"UTC"===i.timeZone||null==t.timeZoneOffset?"UTC":Fn(t.timeZoneOffset)));r.omitCommas&&(e=e.replace(qn,"").trim());r.omitZeroMinute&&(e=e.replace(":00",""));!1===r.meridiem?e=e.replace(Hn,"").trim():"narrow"===r.meridiem?e=e.replace(Hn,(e,t)=>t.toLocaleLowerCase()):"short"===r.meridiem?e=e.replace(Hn,(e,t)=>`${t.toLocaleLowerCase()}m`):"lowercase"===r.meridiem&&(e=e.replace(Hn,e=>e.toLocaleLowerCase()));return e=e.replace($n," "),e=e.trim(),e}(o.format(a),s,e,t,n)}}(e,t,n)}function Yn(e,t){let n=t.markerToArray(e.marker);return{marker:e.marker,timeZoneOffset:e.timeZoneOffset,array:n,year:n[0],month:n[1],day:n[2],hour:n[3],minute:n[4],second:n[5],millisecond:n[6]}}function Xn(e,t,n,r){let i=Yn(e,n.calendarSystem);return{date:i,start:i,end:t?Yn(t,n.calendarSystem):null,timeZone:n.timeZone,localeCodes:n.locale.codes,defaultSeparator:r||n.defaultSeparator}}class Jn{constructor(e){this.cmdStr=e}format(e,t,n){return t.cmdFormatter(this.cmdStr,Xn(e,null,t,n))}formatRange(e,t,n,r){return n.cmdFormatter(this.cmdStr,Xn(e,t,n,r))}}class Zn{constructor(e){this.func=e}format(e,t,n){return this.func(Xn(e,null,t,n))}formatRange(e,t,n,r){return this.func(Xn(e,t,n,r))}}function er(e){return"object"===typeof e&&e?new Qn(e):"string"===typeof e?new Jn(e):"function"===typeof e?new Zn(e):null}const tr={navLinkDayClick:dr,navLinkWeekClick:dr,duration:hn,bootstrapFontAwesome:dr,buttonIcons:dr,customButtons:dr,defaultAllDayEventDuration:hn,defaultTimedEventDuration:hn,nextDayThreshold:hn,scrollTime:hn,scrollTimeReset:Boolean,slotMinTime:hn,slotMaxTime:hn,dayPopoverFormat:er,slotDuration:hn,snapDuration:hn,headerToolbar:dr,footerToolbar:dr,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:er,dayHeaderClassNames:dr,dayHeaderContent:dr,dayHeaderDidMount:dr,dayHeaderWillUnmount:dr,dayCellClassNames:dr,dayCellContent:dr,dayCellDidMount:dr,dayCellWillUnmount:dr,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:dr,weekNumbers:Boolean,weekNumberClassNames:dr,weekNumberContent:dr,weekNumberDidMount:dr,weekNumberWillUnmount:dr,editable:Boolean,viewClassNames:dr,viewDidMount:dr,viewWillUnmount:dr,nowIndicator:Boolean,nowIndicatorSnap:dr,nowIndicatorClassNames:dr,nowIndicatorContent:dr,nowIndicatorDidMount:dr,nowIndicatorWillUnmount:dr,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:dr,locale:dr,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:dr,eventOrder:function(e){let t,n,r=[],i=[];for("string"===typeof e?i=e.split(/\s*,\s*/):"function"===typeof e?i=[e]:Array.isArray(e)&&(i=e),t=0;t<i.length;t+=1)n=i[t],"string"===typeof n?r.push("-"===n.charAt(0)?{field:n.substring(1),order:-1}:{field:n,order:1}):"function"===typeof n&&r.push({func:n});return r},eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:dr,contentHeight:dr,direction:String,weekNumberFormat:er,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:dr,initialDate:dr,now:dr,eventDataTransform:dr,stickyHeaderDates:dr,stickyFooterScrollbar:dr,viewHeight:dr,defaultAllDay:Boolean,eventSourceFailure:dr,eventSourceSuccess:dr,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:dr,eventConstraint:dr,eventAllow:dr,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:dr,eventContent:dr,eventDidMount:dr,eventWillUnmount:dr,selectConstraint:dr,selectOverlap:dr,selectAllow:dr,droppable:Boolean,unselectCancel:String,slotLabelFormat:dr,slotLaneClassNames:dr,slotLaneContent:dr,slotLaneDidMount:dr,slotLaneWillUnmount:dr,slotLabelClassNames:dr,slotLabelContent:dr,slotLabelDidMount:dr,slotLabelWillUnmount:dr,dayMaxEvents:dr,dayMaxEventRows:dr,dayMinWidth:Number,slotLabelInterval:hn,allDayText:String,allDayClassNames:dr,allDayContent:dr,allDayDidMount:dr,allDayWillUnmount:dr,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:er,rerenderDelay:Number,moreLinkText:dr,moreLinkHint:dr,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:dr,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:hn,hiddenDays:dr,fixedWeekCount:Boolean,validRange:dr,visibleRange:dr,titleFormat:dr,eventInteractive:Boolean,noEventsText:String,viewHint:dr,navLinkHint:dr,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:dr,moreLinkClassNames:dr,moreLinkContent:dr,moreLinkDidMount:dr,moreLinkWillUnmount:dr,monthStartFormat:er,handleCustomRendering:dr,customRenderingMetaMap:dr,customRenderingReplaces:Boolean},nr={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:" \u2013 ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"},nowIndicatorSnap:"auto"},rr={datesSet:dr,eventsSet:dr,eventAdd:dr,eventChange:dr,eventRemove:dr,windowResize:dr,eventClick:dr,eventMouseEnter:dr,eventMouseLeave:dr,select:dr,unselect:dr,loading:dr,_unmount:dr,_beforeprint:dr,_afterprint:dr,_noEventDrop:dr,_noEventResize:dr,_resize:dr,_scrollRequest:dr},ir={buttonText:dr,buttonHints:dr,views:dr,plugins:dr,initialEvents:dr,events:dr,eventSources:dr},sr={headerToolbar:or,footerToolbar:or,buttonText:or,buttonHints:or,buttonIcons:or,dateIncrement:or,plugins:ar,events:ar,eventSources:ar,resources:ar};function or(e,t){return"object"===typeof e&&"object"===typeof t&&e&&t?yr(e,t):e===t}function ar(e,t){return Array.isArray(e)&&Array.isArray(t)?bn(e,t):e===t}const lr={type:String,component:dr,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:dr,usesMinMaxTime:Boolean,classNames:dr,content:dr,didMount:dr,willUnmount:dr};function cr(e){return fr(e,sr)}function ur(e,t){let n={},r={};for(let i in t)i in e&&(n[i]=t[i](e[i]));for(let i in e)i in t||(r[i]=e[i]);return{refined:n,extra:r}}function dr(e){return e}const{hasOwnProperty:hr}=Object.prototype;function fr(e,t){let n={};if(t)for(let r in t)if(t[r]===or){let t=[];for(let i=e.length-1;i>=0;i-=1){let s=e[i][r];if("object"===typeof s&&s)t.unshift(s);else if(void 0!==s){n[r]=s;break}}t.length&&(n[r]=fr(t))}for(let r=e.length-1;r>=0;r-=1){let t=e[r];for(let e in t)e in n||(n[e]=t[e])}return n}function pr(e,t){let n={};for(let r in e)t(e[r],r)&&(n[r]=e[r]);return n}function gr(e,t){let n={};for(let r in e)n[r]=t(e[r],r);return n}function mr(e){let t={};for(let n of e)t[n]=!0;return t}function vr(e){let t=[];for(let n in e)t.push(e[n]);return t}function yr(e,t){if(e===t)return!0;for(let n in e)if(hr.call(e,n)&&!(n in t))return!1;for(let n in t)if(hr.call(t,n)&&e[n]!==t[n])return!1;return!0}const br=/^on[A-Z]/;function wr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;for(let r in t)if(!(r in e)||!Sr(e[r],t[r],n[r]))return!1;for(let r in e)if(!(r in t))return!1;return!0}function Sr(e,t,n){return e===t||!0===n||!!n&&n(e,t)}let Er={};var _r,Cr;_r="gregory",Cr=class{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return Rn(e)}markerToArray(e){return Nn(e)}},Er[_r]=Cr;const xr=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;class Tr{constructor(e){let t=this.timeZone=e.timeZone,n="local"!==t&&"UTC"!==t;e.namedTimeZoneImpl&&n&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(t)),this.canComputeOffset=Boolean(!n||this.namedTimeZoneImpl),this.calendarSystem=function(e){return new Er[e]}(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,"ISO"===e.weekNumberCalculation&&(this.weekDow=1,this.weekDoy=4),"number"===typeof e.firstDay&&(this.weekDow=e.firstDay),"function"===typeof e.weekNumberCalculation&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=null!=e.weekText?e.weekText:e.locale.options.weekText,this.weekTextLong=(null!=e.weekTextLong?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let t=this.createMarkerMeta(e);return null===t?null:t.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker((new Date).valueOf()):Rn(An(new Date))}createMarkerMeta(e){if("string"===typeof e)return this.parse(e);let t=null;return"number"===typeof e?t=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(t=this.timestampToMarker(e))):Array.isArray(e)&&(t=Rn(e)),null!==t&&Mn(t)?{marker:t,isTimeUnspecified:!1,forcedTzo:null}:null}parse(e){let t=function(e){let t=xr.exec(e);if(t){let e=new Date(Date.UTC(Number(t[1]),t[3]?Number(t[3])-1:0,Number(t[5]||1),Number(t[7]||0),Number(t[8]||0),Number(t[10]||0),t[12]?1e3*Number(`0.${t[12]}`):0));if(Mn(e)){let n=null;return t[13]&&(n=("-"===t[15]?-1:1)*(60*Number(t[16]||0)+Number(t[18]||0))),{marker:e,isTimeUnspecified:!t[6],timeZoneOffset:n}}}return null}(e);if(null===t)return null;let{marker:n}=t,r=null;return null!==t.timeZoneOffset&&(this.canComputeOffset?n=this.timestampToMarker(n.valueOf()-60*t.timeZoneOffset*1e3):r=t.timeZoneOffset),{marker:n,isTimeUnspecified:t.isTimeUnspecified,forcedTzo:r}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]+=t.years,n[1]+=t.months,n[2]+=t.days,n[6]+=t.milliseconds,this.calendarSystem.arrayToMarker(n)}subtract(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]-=t.years,n[1]-=t.months,n[2]-=t.days,n[6]-=t.milliseconds,this.calendarSystem.arrayToMarker(n)}addYears(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]+=t,this.calendarSystem.arrayToMarker(n)}addMonths(e,t){let n=this.calendarSystem.markerToArray(e);return n[1]+=t,this.calendarSystem.arrayToMarker(n)}diffWholeYears(e,t){let{calendarSystem:n}=this;return On(e)===On(t)&&n.getMarkerDay(e)===n.getMarkerDay(t)&&n.getMarkerMonth(e)===n.getMarkerMonth(t)?n.getMarkerYear(t)-n.getMarkerYear(e):null}diffWholeMonths(e,t){let{calendarSystem:n}=this;return On(e)===On(t)&&n.getMarkerDay(e)===n.getMarkerDay(t)?n.getMarkerMonth(t)-n.getMarkerMonth(e)+12*(n.getMarkerYear(t)-n.getMarkerYear(e)):null}greatestWholeUnit(e,t){let n=this.diffWholeYears(e,t);return null!==n?{unit:"year",value:n}:(n=this.diffWholeMonths(e,t),null!==n?{unit:"month",value:n}:(n=function(e,t){let n=xn(e,t);return null!==n&&n%7===0?n/7:null}(e,t),null!==n?{unit:"week",value:n}:(n=xn(e,t),null!==n?{unit:"day",value:n}:(n=function(e,t){return(t.valueOf()-e.valueOf())/36e5}(e,t),ln(n)?{unit:"hour",value:n}:(n=function(e,t){return(t.valueOf()-e.valueOf())/6e4}(e,t),ln(n)?{unit:"minute",value:n}:(n=function(e,t){return(t.valueOf()-e.valueOf())/1e3}(e,t),ln(n)?{unit:"second",value:n}:{unit:"millisecond",value:t.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,t,n){let r;return n.years&&(r=this.diffWholeYears(e,t),null!==r)?r/(gn(n)/365):n.months&&(r=this.diffWholeMonths(e,t),null!==r)?r/function(e){return gn(e)/30}(n):n.days&&(r=xn(e,t),null!==r)?r/gn(n):(t.valueOf()-e.valueOf())/mn(n)}startOf(e,t){return"year"===t?this.startOfYear(e):"month"===t?this.startOfMonth(e):"week"===t?this.startOfWeek(e):"day"===t?Tn(e):"hour"===t?function(e){return Rn([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours()])}(e):"minute"===t?function(e){return Rn([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes()])}(e):"second"===t?function(e){return Rn([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()])}(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):function(e,t,n){let r=e.getUTCFullYear(),i=In(e,r,t,n);if(i<1)return In(e,r-1,t,n);let s=In(e,r+1,t,n);return s>=1?Math.min(i,s):i}(e,this.weekDow,this.weekDoy)}format(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.format({marker:e,timeZoneOffset:null!=n.forcedTzo?n.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r.isEndExclusive&&(t=_n(t,-1)),n.formatRange({marker:e,timeZoneOffset:null!=r.forcedStartTzo?r.forcedStartTzo:this.offsetForMarker(e)},{marker:t,timeZoneOffset:null!=r.forcedEndTzo?r.forcedEndTzo:this.offsetForMarker(t)},this,r.defaultSeparator)}formatIso(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null;return t.omitTimeZoneOffset||(n=null!=t.forcedTzo?t.forcedTzo:this.offsetForMarker(e)),Pn(e,n,t.omitTime)}timestampToMarker(e){return"local"===this.timeZone?Rn(An(new Date(e))):"UTC"!==this.timeZone&&this.namedTimeZoneImpl?Rn(this.namedTimeZoneImpl.timestampToArray(e)):new Date(e)}offsetForMarker(e){return"local"===this.timeZone?-kn(Nn(e)).getTimezoneOffset():"UTC"===this.timeZone?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(Nn(e)):null}toDate(e,t){return"local"===this.timeZone?kn(Nn(e)):"UTC"===this.timeZone?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-1e3*this.namedTimeZoneImpl.offsetForArray(Nn(e))*60):new Date(e.valueOf()-(t||0))}}class Ir{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let t,n;if("object"===typeof e&&e){for(n in t=Object.assign({},this.iconClasses),e)t[n]=this.applyIconOverridePrefix(e[n]);this.iconClasses=t}else!1===e&&(this.iconClasses={})}applyIconOverridePrefix(e){let t=this.iconOverridePrefix;return t&&0!==e.indexOf(t)&&(e=t+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,t){let n;return n=t&&this.rtlIconClasses&&this.rtlIconClasses[e]||this.iconClasses[e],n?`${this.baseIconClass} ${n}`:""}getCustomButtonIconClass(e){let t;return this.iconOverrideCustomButtonOption&&(t=e[this.iconOverrideCustomButtonOption],t)?`${this.baseIconClass} ${this.applyIconOverridePrefix(t)}`:""}}function Dr(e){e();let t=te.debounceRendering,n=[];for(te.debounceRendering=function(e){n.push(e)},He(be(Ar,{}),document.createElement("div"));n.length;)n.shift()();te.debounceRendering=t}Ir.prototype.classes={},Ir.prototype.iconClasses={},Ir.prototype.baseIconClass="",Ir.prototype.iconOverridePrefix="";class Ar extends Te{render(){return be("div",{})}componentDidMount(){this.setState({})}}function kr(e){let t=qe(e),n=t.Provider;return t.Provider=function(){let e=!this.getChildContext,t=n.apply(this,arguments);if(e){let e=[];this.shouldComponentUpdate=t=>{this.props.value!==t.value&&e.forEach(e=>{e.context=t.value,e.forceUpdate()})},this.sub=t=>{e.push(t);let n=t.componentWillUnmount;t.componentWillUnmount=()=>{e.splice(e.indexOf(t),1),n&&n.call(t)}}}return t},t}class Nr{constructor(e,t,n,r){this.execFunc=e,this.emitter=t,this.scrollTime=n,this.scrollTimeReset=r,this.handleScrollRequest=e=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},e),this.drain()},t.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}}const Rr=kr({});function Mr(e,t,n,r,i,s,o,a,l,c,u,d,h,f){return{dateEnv:i,nowManager:s,options:n,pluginHooks:a,emitter:u,dispatch:l,getCurrentData:c,calendarApi:d,viewSpec:e,viewApi:t,dateProfileGenerator:r,theme:o,isRtl:"rtl"===n.direction,addResizeHandler(e){u.on("_resize",e)},removeResizeHandler(e){u.off("_resize",e)},createScrollResponder:e=>new Nr(e,u,hn(n.scrollTime),n.scrollTimeReset),registerInteractiveComponent:h,unregisterInteractiveComponent:f}}class Or extends Te{shouldComponentUpdate(e,t){return!wr(this.props,e,this.propEquality)||!wr(this.state,t,this.stateEquality)}safeSetState(e){wr(this.state,Object.assign(Object.assign({},this.state),e),this.stateEquality)||this.setState(e)}}Or.addPropsEquality=function(e){let t=Object.create(this.prototype.propEquality);Object.assign(t,e),this.prototype.propEquality=t},Or.addStateEquality=function(e){let t=Object.create(this.prototype.stateEquality);Object.assign(t,e),this.prototype.stateEquality=t},Or.contextType=Rr,Or.prototype.propEquality={},Or.prototype.stateEquality={};class Pr extends Or{}function Lr(e,t){"function"===typeof e?e(t):e&&(e.current=t)}Pr.contextType=Rr;class jr extends Pr{constructor(){super(...arguments),this.id=en(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{const{options:t}=this.context,{generatorName:n}=this.props;t.customRenderingReplaces&&Fr(n,t)||this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&Lr(this.props.elRef,e)}}render(){const{props:e,context:t}=this,{options:n}=t,{customGenerator:r,defaultGenerator:i,renderProps:s}=e,o=Ur(e,[],this.handleEl);let a,l,c=!1,u=[];if(null!=r){const e="function"===typeof r?r(s,be):r;if(!0===e)c=!0;else{const t=e&&"object"===typeof e;t&&"html"in e?o.dangerouslySetInnerHTML={__html:e.html}:t&&"domNodes"in e?u=Array.prototype.slice.call(e.domNodes):(t?re(e):"function"!==typeof e)?a=e:l=e}}else c=!Fr(e.generatorName,n);return c&&i&&(a=i(s)),this.queuedDomNodes=u,this.currentGeneratorMeta=l,be(e.elTag,o,a)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var t;const{props:n,context:r}=this,{handleCustomRendering:i,customRenderingMetaMap:s}=r.options;if(i){const r=null!==(t=this.currentGeneratorMeta)&&void 0!==t?t:null===s||void 0===s?void 0:s[n.generatorName];r&&i(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:r},n),{elClasses:(n.elClasses||[]).filter(Br)}))}}applyQueueudDomNodes(){const{queuedDomNodes:e,currentDomNodes:t}=this,n=this.base;if(!bn(e,t)){t.forEach(Ut);for(let t of e)n.appendChild(t);this.currentDomNodes=e}}}function Fr(e,t){var n;return Boolean(t.handleCustomRendering&&e&&(null===(n=t.customRenderingMetaMap)||void 0===n?void 0:n[e]))}function Ur(e,t,n){const r=Object.assign(Object.assign({},e.elAttrs),{ref:n});return(e.elClasses||t)&&(r.className=(e.elClasses||[]).concat(t||[]).concat(r.className||[]).filter(Boolean).join(" ")),e.elStyle&&(r.style=e.elStyle),r}function Br(e){return Boolean(e)}jr.addPropsEquality({elClasses:bn,elStyle:yr,elAttrs:function(e,t){const n=function(e,t){let n=[];for(let r in e)hr.call(e,r)&&(r in t||n.push(r));for(let r in t)hr.call(t,r)&&e[r]!==t[r]&&n.push(r);return n}(e,t);for(let r of n)if(!br.test(r))return!1;return!0},renderProps:yr});const zr=kr(0);class Vr extends Te{constructor(){super(...arguments),this.InnerContent=Hr.bind(void 0,this),this.handleEl=e=>{this.el=e,this.props.elRef&&(Lr(this.props.elRef,e),e&&this.didMountMisfire&&this.componentDidMount())}}render(){const{props:e}=this,t=function(e,t){const n="function"===typeof e?e(t):e||[];return"string"===typeof n?[n]:n}(e.classNameGenerator,e.renderProps);if(e.children){const n=Ur(e,t,this.handleEl),r=e.children(this.InnerContent,e.renderProps,n);return e.elTag?be(e.elTag,n,r):r}return be(jr,Object.assign(Object.assign({},e),{elRef:this.handleEl,elTag:e.elTag||"div",elClasses:(e.elClasses||[]).concat(t),renderId:this.context}))}componentDidMount(){var e,t;this.el?null===(t=(e=this.props).didMount)||void 0===t||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var e,t;null===(t=(e=this.props).willUnmount)||void 0===t||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}}function Hr(e,t){const n=e.props;return be(jr,Object.assign({renderProps:n.renderProps,generatorName:n.generatorName,customGenerator:n.customGenerator,defaultGenerator:n.defaultGenerator,renderId:e.context},t))}Vr.contextType=zr;class qr extends Pr{render(){let{props:e,context:t}=this,{options:n}=t,r={view:t.viewApi};return be(Vr,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:[...$r(e.viewSpec),...e.elClasses||[]],elStyle:e.elStyle,renderProps:r,classNameGenerator:n.viewClassNames,generatorName:void 0,didMount:n.viewDidMount,willUnmount:n.viewWillUnmount},()=>e.children)}}function $r(e){return[`fc-${e.type}-view`,"fc-view"]}function Gr(e,t){let n,r,i=[],{start:s}=t;for(e.sort(Wr),n=0;n<e.length;n+=1)r=e[n],r.start>s&&i.push({start:s,end:r.start}),r.end>s&&(s=r.end);return s<t.end&&i.push({start:s,end:t.end}),i}function Wr(e,t){return e.start.valueOf()-t.start.valueOf()}function Qr(e,t){let{start:n,end:r}=e,i=null;return null!==t.start&&(n=null===n?t.start:new Date(Math.max(n.valueOf(),t.start.valueOf()))),null!=t.end&&(r=null===r?t.end:new Date(Math.min(r.valueOf(),t.end.valueOf()))),(null===n||null===r||n<r)&&(i={start:n,end:r}),i}function Kr(e,t){return(null===e.end||null===t.start||e.end>t.start)&&(null===e.start||null===t.end||e.start<t.end)}function Yr(e,t){return(null===e.start||null!==t.start&&t.start>=e.start)&&(null===e.end||null!==t.end&&t.end<=e.end)}function Xr(e,t){return(null===e.start||t>=e.start)&&(null===e.end||t<e.end)}function Jr(e){let t=Math.floor(Cn(e.start,e.end))||1,n=Tn(e.start);return{start:n,end:En(n,t)}}function Zr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hn(0),n=null,r=null;if(e.end){r=Tn(e.end);let n=e.end.valueOf()-r.valueOf();n&&n>=mn(t)&&(r=En(r,1))}return e.start&&(n=Tn(e.start),r&&r<=n&&(r=En(n,1))),{start:n,end:r}}function ei(e,t,n,r){return"year"===r?hn(n.diffWholeYears(e,t),"year"):"month"===r?hn(n.diffWholeMonths(e,t),"month"):function(e,t){let n=Tn(e),r=Tn(t);return{years:0,months:0,days:Math.round(Cn(n,r)),milliseconds:t.valueOf()-r.valueOf()-(e.valueOf()-n.valueOf())}}(e,t)}class ti{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,t,n){let{dateEnv:r}=this.props,i=r.subtract(r.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(i,-1,n)}buildNext(e,t,n){let{dateEnv:r}=this.props,i=r.add(r.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(i,1,n)}build(e,t){let n,r,i,s,o,a,l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],{props:c}=this;var u,d;return n=this.buildValidRange(),n=this.trimHiddenDays(n),l&&(u=e,e=null!=(d=n).start&&u<d.start?d.start:null!=d.end&&u>=d.end?new Date(d.end.valueOf()-1):u),r=this.buildCurrentRangeInfo(e,t),i=/^(year|month|week|day)$/.test(r.unit),s=this.buildRenderRange(this.trimHiddenDays(r.range),r.unit,i),s=this.trimHiddenDays(s),o=s,c.showNonCurrentDates||(o=Qr(o,r.range)),o=this.adjustActiveRange(o),o=Qr(o,n),a=Kr(r.range,n),Xr(s,e)||(e=s.start),{currentDate:e,validRange:n,currentRange:r.range,currentRangeUnit:r.unit,isRangeAllDay:i,activeRange:o,renderRange:s,slotMinTime:c.slotMinTime,slotMaxTime:c.slotMaxTime,isValid:a,dateIncrement:this.buildDateIncrement(r.duration)}}buildValidRange(){let e=this.props.validRangeInput,t="function"===typeof e?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(t)||{start:null,end:null}}buildCurrentRangeInfo(e,t){let n,{props:r}=this,i=null,s=null,o=null;return r.duration?(i=r.duration,s=r.durationUnit,o=this.buildRangeFromDuration(e,t,i,s)):(n=this.props.dayCount)?(s="day",o=this.buildRangeFromDayCount(e,t,n)):(o=this.buildCustomVisibleRange(e))?s=r.dateEnv.greatestWholeUnit(o.start,o.end).unit:(i=this.getFallbackDuration(),s=yn(i).unit,o=this.buildRangeFromDuration(e,t,i,s)),{duration:i,unit:s,range:o}}getFallbackDuration(){return hn({day:1})}adjustActiveRange(e){let{dateEnv:t,usesMinMaxTime:n,slotMinTime:r,slotMaxTime:i}=this.props,{start:s,end:o}=e;return n&&(gn(r)<0&&(s=Tn(s),s=t.add(s,r)),gn(i)>1&&(o=Tn(o),o=En(o,-1),o=t.add(o,i))),{start:s,end:o}}buildRangeFromDuration(e,t,n,r){let i,s,o,{dateEnv:a,dateAlignment:l}=this.props;if(!l){let{dateIncrement:e}=this.props;l=e&&mn(e)<mn(n)?yn(e).unit:r}function c(){i=a.startOf(e,l),s=a.add(i,n),o={start:i,end:s}}return gn(n)<=1&&this.isHiddenDay(i)&&(i=this.skipHiddenDays(i,t),i=Tn(i)),c(),this.trimHiddenDays(o)||(e=this.skipHiddenDays(e,t),c()),o}buildRangeFromDayCount(e,t,n){let r,{dateEnv:i,dateAlignment:s}=this.props,o=0,a=e;s&&(a=i.startOf(a,s)),a=Tn(a),a=this.skipHiddenDays(a,t),r=a;do{r=En(r,1),this.isHiddenDay(r)||(o+=1)}while(o<n);return{start:a,end:r}}buildCustomVisibleRange(e){let{props:t}=this,n=t.visibleRangeInput,r="function"===typeof n?n.call(t.calendarApi,t.dateEnv.toDate(e)):n,i=this.refineRange(r);return!i||null!=i.start&&null!=i.end?i:null}buildRenderRange(e,t,n){return e}buildDateIncrement(e){let t,{dateIncrement:n}=this.props;return n||((t=this.props.dateAlignment)?hn(1,t):e||hn({days:1}))}refineRange(e){if(e){let t=function(e,t){let n=null,r=null;return e.start&&(n=t.createMarker(e.start)),e.end&&(r=t.createMarker(e.end)),n||r?n&&r&&r<n?null:{start:n,end:r}:null}(e,this.props.dateEnv);return t&&(t=Zr(t)),t}return null}initHiddenDays(){let e,t=this.props.hiddenDays||[],n=[],r=0;for(!1===this.props.weekends&&t.push(0,6),e=0;e<7;e+=1)(n[e]=-1!==t.indexOf(e))||(r+=1);if(!r)throw new Error("invalid hiddenDays");this.isHiddenDayHash=n}trimHiddenDays(e){let{start:t,end:n}=e;return t&&(t=this.skipHiddenDays(t)),n&&(n=this.skipHiddenDays(n,-1,!0)),null==t||null==n||t<n?{start:t,end:n}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(;this.isHiddenDayHash[(e.getUTCDay()+(n?t:0)+7)%7];)e=En(e,t);return e}}function ni(e,t,n,r){return{instanceId:en(),defId:e,range:t,forcedStartTzo:null==n?null:n,forcedEndTzo:null==r?null:r}}function ri(e,t,n){let{dateEnv:r,pluginHooks:i,options:s}=n,{defs:o,instances:a}=e;a=pr(a,e=>!o[e.defId].recurringDef);for(let l in o){let e=o[l];if(e.recurringDef){let{duration:n}=e.recurringDef;n||(n=e.allDay?s.defaultAllDayEventDuration:s.defaultTimedEventDuration);let o=ii(e,n,t,r,i.recurringTypes);for(let e of o){let t=ni(l,{start:e,end:r.add(e,n)});a[t.instanceId]=t}}}return{defs:o,instances:a}}function ii(e,t,n,r,i){let s=i[e.recurringDef.typeId].expand(e.recurringDef.typeData,{start:r.subtract(n.start,t),end:n.end},r);return e.allDay&&(s=s.map(Tn)),s}const si={id:String,groupId:String,title:String,url:String,interactive:Boolean},oi={start:dr,end:dr,date:dr,allDay:Boolean},ai=Object.assign(Object.assign(Object.assign({},si),oi),{extendedProps:dr});function li(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ui(n),s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,{refined:a,extra:l}=ci(e,n,i),c=function(e,t){let n=null;e&&(n=e.defaultAllDay);null==n&&(n=t.options.defaultAllDay);return n}(t,n),u=function(e,t,n,r){for(let i=0;i<r.length;i+=1){let s=r[i].parse(e,n);if(s){let{allDay:n}=e;return null==n&&(n=t,null==n&&(n=s.allDayGuess,null==n&&(n=!1))),{allDay:n,duration:s.duration,typeData:s.typeData,typeId:i}}}return null}(a,c,n.dateEnv,n.pluginHooks.recurringTypes);if(u){let e=di(a,l,t?t.sourceId:"",u.allDay,Boolean(u.duration),n,s);return e.recurringDef={typeId:u.typeId,typeData:u.typeData,duration:u.duration},{def:e,instance:null}}let d=function(e,t,n,r){let i,s,{allDay:o}=e,a=null,l=!1,c=null,u=null!=e.start?e.start:e.date;if(i=n.dateEnv.createMarkerMeta(u),i)a=i.marker;else if(!r)return null;null!=e.end&&(s=n.dateEnv.createMarkerMeta(e.end));null==o&&(o=null!=t?t:(!i||i.isTimeUnspecified)&&(!s||s.isTimeUnspecified));o&&a&&(a=Tn(a));s&&(c=s.marker,o&&(c=Tn(c)),a&&c<=a&&(c=null));c?l=!0:r||(l=n.options.forceEventDuration||!1,c=n.dateEnv.add(a,o?n.options.defaultAllDayEventDuration:n.options.defaultTimedEventDuration));return{allDay:o,hasEnd:l,range:{start:a,end:c},forcedStartTzo:i?i.forcedTzo:null,forcedEndTzo:s?s.forcedTzo:null}}(a,c,n,r);if(d){let e=di(a,l,t?t.sourceId:"",d.allDay,d.hasEnd,n,s),r=ni(e.defId,d.range,d.forcedStartTzo,d.forcedEndTzo);return o&&e.publicId&&o[e.publicId]&&(r.instanceId=o[e.publicId]),{def:e,instance:r}}return null}function ci(e,t){return ur(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:ui(t))}function ui(e){return Object.assign(Object.assign(Object.assign({},bi),ai),e.pluginHooks.eventRefiners)}function di(e,t,n,r,i,s,o){let a={title:e.title||"",groupId:e.groupId||"",publicId:e.id||"",url:e.url||"",recurringDef:null,defId:(o&&e.id?o[e.id]:"")||en(),sourceId:n,allDay:r,hasEnd:i,interactive:e.interactive,ui:Si(e,s),extendedProps:Object.assign(Object.assign({},e.extendedProps||{}),t)};for(let l of s.pluginHooks.eventDefMemberAdders)Object.assign(a,l(e));return Object.freeze(a.ui.classNames),Object.freeze(a.extendedProps),a}function hi(e,t,n,r,i,s){let o={defs:{},instances:{}},a=ui(n);for(let l of e){let e=li(l,t,n,r,a,i,s);e&&fi(e,o)}return o}function fi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{defs:{},instances:{}};return t.defs[e.def.defId]=e.def,e.instance&&(t.instances[e.instance.instanceId]=e.instance),t}function pi(e,t){let n=e.instances[t];if(n){let t=e.defs[n.defId],r=vi(e,e=>{return n=t,r=e,Boolean(n.groupId&&n.groupId===r.groupId);var n,r});return r.defs[t.defId]=t,r.instances[n.instanceId]=n,r}return{defs:{},instances:{}}}function gi(){return{defs:{},instances:{}}}function mi(e,t){return{defs:Object.assign(Object.assign({},e.defs),t.defs),instances:Object.assign(Object.assign({},e.instances),t.instances)}}function vi(e,t){let n=pr(e.defs,t),r=pr(e.instances,e=>n[e.defId]);return{defs:n,instances:r}}function yi(e){return Array.isArray(e)?e:"string"===typeof e?e.split(/\s+/):[]}const bi={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:dr,overlap:dr,allow:dr,className:yi,classNames:yi,color:String,backgroundColor:String,borderColor:String,textColor:String},wi={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function Si(e,t){let n=function(e,t){return Array.isArray(e)?hi(e,null,t,!0):"object"===typeof e&&e?hi([e],null,t,!0):null!=e?String(e):null}(e.constraint,t);return{display:e.display||null,startEditable:null!=e.startEditable?e.startEditable:e.editable,durationEditable:null!=e.durationEditable?e.durationEditable:e.editable,constraints:null!=n?[n]:[],overlap:null!=e.overlap?e.overlap:null,allows:null!=e.allow?[e.allow]:[],backgroundColor:e.backgroundColor||e.color||"",borderColor:e.borderColor||e.color||"",textColor:e.textColor||"",classNames:(e.className||[]).concat(e.classNames||[])}}function Ei(e){return e.reduce(_i,wi)}function _i(e,t){return{display:null!=t.display?t.display:e.display,startEditable:null!=t.startEditable?t.startEditable:e.startEditable,durationEditable:null!=t.durationEditable?t.durationEditable:e.durationEditable,constraints:e.constraints.concat(t.constraints),overlap:"boolean"===typeof t.overlap?t.overlap:e.overlap,allows:e.allows.concat(t.allows),backgroundColor:t.backgroundColor||e.backgroundColor,borderColor:t.borderColor||e.borderColor,textColor:t.textColor||e.textColor,classNames:e.classNames.concat(t.classNames)}}const Ci={id:String,defaultAllDay:Boolean,url:String,format:String,events:dr,eventDataTransform:dr,success:dr,failure:dr};function xi(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ti(t);if("string"===typeof e?n={url:e}:"function"===typeof e||Array.isArray(e)?n={events:e}:"object"===typeof e&&e&&(n=e),n){let{refined:i,extra:s}=ur(n,r),o=function(e,t){let n=t.pluginHooks.eventSourceDefs;for(let r=n.length-1;r>=0;r-=1){let t=n[r].parseMeta(e);if(t)return{sourceDefId:r,meta:t}}return null}(i,t);if(o)return{_raw:e,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:i.defaultAllDay,eventDataTransform:i.eventDataTransform,success:i.success,failure:i.failure,publicId:i.id||"",sourceId:en(),sourceDefId:o.sourceDefId,meta:o.meta,ui:Si(i,t),extendedProps:s}}return null}function Ti(e){return Object.assign(Object.assign(Object.assign({},bi),Ci),e.pluginHooks.eventSourceRefiners)}function Ii(e,t,n,r,i){switch(t.type){case"RECEIVE_EVENTS":return function(e,t,n,r,i,s){if(t&&n===t.latestFetchId){let n=hi(Di(i,t,s),t,s);return r&&(n=ri(n,r,s)),mi(Ni(e,t.sourceId),n)}return e}(e,n[t.sourceId],t.fetchId,t.fetchRange,t.rawEvents,i);case"RESET_RAW_EVENTS":return function(e,t,n,r,i){const{defIdMap:s,instanceIdMap:o}=function(e){const{defs:t,instances:n}=e,r={},i={};for(let s in t){const e=t[s],{publicId:n}=e;n&&(r[n]=s)}for(let s in n){const e=t[n[s].defId],{publicId:r}=e;r&&(i[r]=s)}return{defIdMap:r,instanceIdMap:i}}(e);let a=hi(Di(n,t,i),t,i,!1,s,o);return ri(a,r,i)}(e,n[t.sourceId],t.rawEvents,r.activeRange,i);case"ADD_EVENTS":return function(e,t,n,r){n&&(t=ri(t,n,r));return mi(e,t)}(e,t.eventStore,r?r.activeRange:null,i);case"RESET_EVENTS":return t.eventStore;case"MERGE_EVENTS":return mi(e,t.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return r?ri(e,r.activeRange,i):e;case"REMOVE_EVENTS":return function(e,t){let{defs:n,instances:r}=e,i={},s={};for(let o in n)t.defs[o]||(i[o]=n[o]);for(let o in r)!t.instances[o]&&i[r[o].defId]&&(s[o]=r[o]);return{defs:i,instances:s}}(e,t.eventStore);case"REMOVE_EVENT_SOURCE":return Ni(e,t.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return vi(e,e=>!e.sourceId);case"REMOVE_ALL_EVENTS":return{defs:{},instances:{}};default:return e}}function Di(e,t,n){let r=n.options.eventDataTransform,i=t?t.eventDataTransform:null;return i&&(e=Ai(e,i)),r&&(e=Ai(e,r)),e}function Ai(e,t){let n;if(t){n=[];for(let r of e){let e=t(r);e?n.push(e):null==e&&n.push(r)}}else n=e;return n}function ki(e,t,n){let{defs:r}=e,i=gr(e.instances,e=>r[e.defId].allDay?e:Object.assign(Object.assign({},e),{range:{start:n.createMarker(t.toDate(e.range.start,e.forcedStartTzo)),end:n.createMarker(t.toDate(e.range.end,e.forcedEndTzo))},forcedStartTzo:n.canComputeOffset?null:e.forcedStartTzo,forcedEndTzo:n.canComputeOffset?null:e.forcedEndTzo}));return{defs:r,instances:i}}function Ni(e,t){return vi(e,e=>e.sourceId!==t)}class Ri{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,t){!function(e,t,n){(e[t]||(e[t]=[])).push(n)}(this.handlers,e,t)}off(e,t){!function(e,t,n){n?e[t]&&(e[t]=e[t].filter(e=>e!==n)):delete e[t]}(this.handlers,e,t)}trigger(e){let t=this.handlers[e]||[],n=this.options&&this.options[e],r=[].concat(n||[],t);for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];for(let a of r)a.apply(this.thisContext,s)}hasHandlers(e){return Boolean(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}}const Mi={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function Oi(e,t){return hi(function(e){let t;t=!0===e?[{}]:Array.isArray(e)?e.filter(e=>e.daysOfWeek):"object"===typeof e&&e?[e]:[];return t=t.map(e=>Object.assign(Object.assign({},Mi),e)),t}(e),null,t)}function Pi(e,t,n){n.emitter.trigger("select",Object.assign(Object.assign({},Li(e,n)),{jsEvent:t?t.origEvent:null,view:n.viewApi||n.calendarApi.view}))}function Li(e,t){let n={};for(let s of t.pluginHooks.dateSpanTransforms)Object.assign(n,s(e,t));var r,i;return Object.assign(n,(r=e,i=t.dateEnv,Object.assign(Object.assign({},cs(r.range,i,r.allDay)),{allDay:r.allDay}))),n}function ji(e,t,n){let{dateEnv:r,options:i}=n,s=t;return e?(s=Tn(s),s=r.add(s,i.defaultAllDayEventDuration)):s=r.add(s,i.defaultTimedEventDuration),s}function Fi(e,t,n,r){let i=Qi(e.defs,t),s={defs:{},instances:{}};for(let o in e.defs){let t=e.defs[o];s.defs[o]=Ui(t,i[o],n,r)}for(let o in e.instances){let t=e.instances[o],a=s.defs[t.defId];s.instances[o]=Bi(t,a,i[t.defId],n,r)}return s}function Ui(e,t,n,r){let i=n.standardProps||{};null==i.hasEnd&&t.durationEditable&&(n.startDelta||n.endDelta)&&(i.hasEnd=!0);let s=Object.assign(Object.assign(Object.assign({},e),i),{ui:Object.assign(Object.assign({},e.ui),i.ui)});n.extendedProps&&(s.extendedProps=Object.assign(Object.assign({},s.extendedProps),n.extendedProps));for(let o of r.pluginHooks.eventDefMutationAppliers)o(s,n,r);return!s.hasEnd&&r.options.forceEventDuration&&(s.hasEnd=!0),s}function Bi(e,t,n,r,i){let{dateEnv:s}=i,o=r.standardProps&&!0===r.standardProps.allDay,a=r.standardProps&&!1===r.standardProps.hasEnd,l=Object.assign({},e);return o&&(l.range=Jr(l.range)),r.datesDelta&&n.startEditable&&(l.range={start:s.add(l.range.start,r.datesDelta),end:s.add(l.range.end,r.datesDelta)}),r.startDelta&&n.durationEditable&&(l.range={start:s.add(l.range.start,r.startDelta),end:l.range.end}),r.endDelta&&n.durationEditable&&(l.range={start:l.range.start,end:s.add(l.range.end,r.endDelta)}),a&&(l.range={start:l.range.start,end:ji(t.allDay,l.range.start,i)}),t.allDay&&(l.range={start:Tn(l.range.start),end:Tn(l.range.end)}),l.range.end<l.range.start&&(l.range.end=ji(t.allDay,l.range.start,i)),l}class zi{constructor(e,t){this.context=e,this.internalEventSource=t}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}}class Vi{constructor(e,t,n){this._context=e,this._def=t,this._instance=n||null}setProp(e,t){if(e in oi)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if("id"===e)t=si[e](t),this.mutate({standardProps:{publicId:t}});else if(e in si)t=si[e](t),this.mutate({standardProps:{[e]:t}});else if(e in bi){let n=bi[e](t);n="color"===e?{backgroundColor:t,borderColor:t}:"editable"===e?{startEditable:t,durationEditable:t}:{[e]:t},this.mutate({standardProps:{ui:n}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,t){this.mutate({extendedProps:{[e]:t}})}setStart(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{dateEnv:n}=this._context,r=n.createMarker(e);if(r&&this._instance){let e=ei(this._instance.range.start,r,n,t.granularity);t.maintainDuration?this.mutate({datesDelta:e}):this.mutate({startDelta:e})}}setEnd(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{dateEnv:r}=this._context;if((null==e||(t=r.createMarker(e),t))&&this._instance)if(t){let e=ei(this._instance.range.end,t,r,n.granularity);this.mutate({endDelta:e})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{dateEnv:i}=this._context,s={allDay:r.allDay},o=i.createMarker(e);var a,l;if(o&&((null==t||(n=i.createMarker(t),n))&&this._instance)){let e=this._instance.range;!0===r.allDay&&(e=Jr(e));let t=ei(e.start,o,i,r.granularity);if(n){let o=ei(e.end,n,i,r.granularity);l=o,(a=t).years===l.years&&a.months===l.months&&a.days===l.days&&a.milliseconds===l.milliseconds?this.mutate({datesDelta:t,standardProps:s}):this.mutate({startDelta:t,endDelta:o,standardProps:s})}else s.hasEnd=!1,this.mutate({datesDelta:t,standardProps:s})}}moveStart(e){let t=hn(e);t&&this.mutate({startDelta:t})}moveEnd(e){let t=hn(e);t&&this.mutate({endDelta:t})}moveDates(e){let t=hn(e);t&&this.mutate({datesDelta:t})}setAllDay(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={allDay:e},{maintainDuration:r}=t;null==r&&(r=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(n.hasEnd=r),this.mutate({standardProps:n})}formatRange(e){let{dateEnv:t}=this._context,n=this._instance,r=er(e);return this._def.hasEnd?t.formatRange(n.range.start,n.range.end,r,{forcedStartTzo:n.forcedStartTzo,forcedEndTzo:n.forcedEndTzo}):t.format(n.range.start,r,{forcedTzo:n.forcedStartTzo})}mutate(e){let t=this._instance;if(t){let n=this._def,r=this._context,{eventStore:i}=r.getCurrentData(),s=pi(i,t.instanceId);s=Fi(s,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,r);let o=new Vi(r,n,t);this._def=s.defs[n.defId],this._instance=s.instances[t.instanceId],r.dispatch({type:"MERGE_EVENTS",eventStore:s}),r.emitter.trigger("eventChange",{oldEvent:o,event:this,relatedEvents:qi(s,r,t),revert(){r.dispatch({type:"RESET_EVENTS",eventStore:i})}})}}remove(){let e=this._context,t=Hi(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:t}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:t})}})}get source(){let{sourceId:e}=this._def;return e?new zi(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._def,{ui:n}=t,{startStr:r,endStr:i}=this,s={allDay:t.allDay};return t.title&&(s.title=t.title),r&&(s.start=r),i&&(s.end=i),t.publicId&&(s.id=t.publicId),t.groupId&&(s.groupId=t.groupId),t.url&&(s.url=t.url),n.display&&"auto"!==n.display&&(s.display=n.display),e.collapseColor&&n.backgroundColor&&n.backgroundColor===n.borderColor?s.color=n.backgroundColor:(n.backgroundColor&&(s.backgroundColor=n.backgroundColor),n.borderColor&&(s.borderColor=n.borderColor)),n.textColor&&(s.textColor=n.textColor),n.classNames.length&&(s.classNames=n.classNames),Object.keys(t.extendedProps).length&&(e.collapseExtendedProps?Object.assign(s,t.extendedProps):s.extendedProps=t.extendedProps),s}toJSON(){return this.toPlainObject()}}function Hi(e){let t=e._def,n=e._instance;return{defs:{[t.defId]:t},instances:n?{[n.instanceId]:n}:{}}}function qi(e,t,n){let{defs:r,instances:i}=e,s=[],o=n?n.instanceId:"";for(let a in i){let e=i[a],n=r[e.defId];e.instanceId!==o&&s.push(new Vi(t,n,e))}return s}function $i(e,t,n,r){let i={},s={},o={},a=[],l=[],c=Qi(e.defs,t);for(let u in e.defs){let t=e.defs[u];"inverse-background"===c[t.defId].display&&(t.groupId?(i[t.groupId]=[],o[t.groupId]||(o[t.groupId]=t)):s[u]=[])}for(let u in e.instances){let t=e.instances[u],o=e.defs[t.defId],d=c[o.defId],h=t.range,f=!o.allDay&&r?Zr(h,r):h,p=Qr(f,n);p&&("inverse-background"===d.display?o.groupId?i[o.groupId].push(p):s[t.defId].push(p):"none"!==d.display&&("background"===d.display?a:l).push({def:o,ui:d,instance:t,range:p,isStart:f.start&&f.start.valueOf()===p.start.valueOf(),isEnd:f.end&&f.end.valueOf()===p.end.valueOf()}))}for(let u in i){let e=Gr(i[u],n);for(let t of e){let e=o[u],n=c[e.defId];a.push({def:e,ui:n,instance:null,range:t,isStart:!1,isEnd:!1})}}for(let u in s){let t=Gr(s[u],n);for(let n of t)a.push({def:e.defs[u],ui:c[u],instance:null,range:n,isStart:!1,isEnd:!1})}return{bg:a,fg:l}}function Gi(e,t){e.fcSeg=t}function Wi(e){return e.fcSeg||e.parentNode.fcSeg||null}function Qi(e,t){return gr(e,e=>Ki(e,t))}function Ki(e,t){let n=[];return t[""]&&n.push(t[""]),t[e.defId]&&n.push(t[e.defId]),n.push(e.ui),Ei(n)}function Yi(e,t){let n=e.map(Xi);return n.sort((e,n)=>function(e,t,n){let r,i;for(r=0;r<n.length;r+=1)if(i=rn(e,t,n[r]),i)return i;return 0}(e,n,t)),n.map(e=>e._seg)}function Xi(e){let{eventRange:t}=e,n=t.def,r=t.instance?t.instance.range:t.range,i=r.start?r.start.valueOf():0,s=r.end?r.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},n.extendedProps),n),{id:n.publicId,start:i,end:s,duration:s-i,allDay:Number(n.allDay),_seg:e})}function Ji(e,t){let{pluginHooks:n}=t,r=n.isDraggableTransformers,{def:i,ui:s}=e.eventRange,o=s.startEditable;for(let a of r)o=a(o,i,s,t);return o}function Zi(e,t){return e.isStart&&e.eventRange.ui.durationEditable&&t.options.eventResizableFromStart}function es(e,t){return e.isEnd&&e.eventRange.ui.durationEditable}function ts(e,t,n,r,i,s,o){let{dateEnv:a,options:l}=n,{displayEventTime:c,displayEventEnd:u}=l,d=e.eventRange.def,h=e.eventRange.instance;null==c&&(c=!1!==r),null==u&&(u=!1!==i);let f=h.range.start,p=h.range.end,g=s||e.start||e.eventRange.range.start,m=o||e.end||e.eventRange.range.end,v=Tn(f).valueOf()===Tn(g).valueOf(),y=Tn(_n(p,-1)).valueOf()===Tn(_n(m,-1)).valueOf();return c&&!d.allDay&&(v||y)?(g=v?f:g,m=y?p:m,u&&d.hasEnd?a.formatRange(g,m,t,{forcedStartTzo:s?null:h.forcedStartTzo,forcedEndTzo:o?null:h.forcedEndTzo}):a.format(g,t,{forcedTzo:s?null:h.forcedStartTzo})):""}function ns(e,t,n){let r=e.eventRange.range;return{isPast:r.end<=(n||t.start),isFuture:r.start>=(n||t.end),isToday:t&&Xr(t,r.start)}}function rs(e){let t=["fc-event"];return e.isMirror&&t.push("fc-event-mirror"),e.isDraggable&&t.push("fc-event-draggable"),(e.isStartResizable||e.isEndResizable)&&t.push("fc-event-resizable"),e.isDragging&&t.push("fc-event-dragging"),e.isResizing&&t.push("fc-event-resizing"),e.isSelected&&t.push("fc-event-selected"),e.isStart&&t.push("fc-event-start"),e.isEnd&&t.push("fc-event-end"),e.isPast&&t.push("fc-event-past"),e.isToday&&t.push("fc-event-today"),e.isFuture&&t.push("fc-event-future"),t}function is(e){return e.instance?e.instance.instanceId:`${e.def.defId}:${e.range.start.toISOString()}`}function ss(e,t){let{def:n,instance:r}=e.eventRange,{url:i}=n;if(i)return{href:i};let{emitter:s,options:o}=t,{eventInteractive:a}=o;return null==a&&(a=n.interactive,null==a&&(a=Boolean(s.hasHandlers("eventClick")))),a?Jt(e=>{s.trigger("eventClick",{el:e.target,event:new Vi(t,n,r),jsEvent:e,view:t.viewApi})}):{}}const os={start:dr,end:dr,allDay:Boolean};function as(e,t,n){let r=function(e,t){let{refined:n,extra:r}=ur(e,os),i=n.start?t.createMarkerMeta(n.start):null,s=n.end?t.createMarkerMeta(n.end):null,{allDay:o}=n;null==o&&(o=i&&i.isTimeUnspecified&&(!s||s.isTimeUnspecified));return Object.assign({range:{start:i?i.marker:null,end:s?s.marker:null},allDay:o},r)}(e,t),{range:i}=r;if(!i.start)return null;if(!i.end){if(null==n)return null;i.end=t.add(i.start,n)}return r}function ls(e,t,n){return Object.assign(Object.assign({},cs(e,t,n)),{timeZone:t.timeZone})}function cs(e,t,n){return{start:t.toDate(e.start),end:t.toDate(e.end),startStr:t.formatIso(e.start,{omitTime:n}),endStr:t.formatIso(e.end,{omitTime:n})}}class us extends Error{constructor(e,t){super(e),this.response=t}}let ds;function hs(){return null==ds&&(ds=function(){if("undefined"===typeof document)return!0;let e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.innerHTML="<table><tr><td><div></div></td></tr></table>",e.querySelector("table").style.height="100px",e.querySelector("div").style.height="100%",document.body.appendChild(e);let t=e.querySelector("div").offsetHeight>0;return document.body.removeChild(e),t}()),ds}class fs extends Pr{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{Dr(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{Dr(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:t}=e,{forPrint:n}=this.state,r=n||"auto"===t.height||"auto"===t.contentHeight,i=r||null==t.height?"":t.height,s=["fc",n?"fc-media-print":"fc-media-screen",`fc-direction-${t.direction}`,e.theme.getClass("root")];return hs()||s.push("fc-liquid-hack"),e.children(s,i,r,n)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}}class ps{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}}function gs(e){return{[e.component.uid]:e}}const ms={};class vs extends Te{constructor(e,t){super(e,t),this.handleRefresh=()=>{let e=this.computeTiming();e.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(e.state),this.clearTimeout(),this.setTimeout(e.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:e,state:t}=this;return e.children(t.nowDate,t.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(e){e.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let e,t,{props:n,context:r}=this,i=r.nowManager.getDateMarker(),{nowIndicatorSnap:s}=r.options;if("auto"===s&&(s=/year|month|week|day/.test(n.unit)||1===(n.unitValue||1)),s){e=r.dateEnv.startOf(i,n.unit),t=r.dateEnv.add(e,hn(1,n.unit)).valueOf()-i.valueOf()}else e=i,t=6e4;return t=Math.min(864e5,t),{state:{nowDate:e,todayRange:ys(e)},waitMs:t}}setTimeout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeTiming().waitMs;this.timeoutId=setTimeout(()=>{const e=this.computeTiming();this.setState(e.state,()=>{this.setTimeout(e.waitMs)})},e)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}}function ys(e){let t=Tn(e);return{start:t,end:En(t,1)}}vs.contextType=Rr;class bs{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,t){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:t})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,t){let{currentDataManager:n}=this;n.currentCalendarOptionsRefiners[e]?n.emitter.on(e,t):console.warn(`Unknown listener name '${e}'`)}off(e,t){this.currentDataManager.emitter.off(e,t)}trigger(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.currentDataManager.emitter.trigger(e,...n)}changeView(e,t){this.batchRendering(()=>{if(this.unselect(),t)if(t.start&&t.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:t});else{let{dateEnv:n}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:n.createMarker(t)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,t){let n;t=t||"day",n=this.getCurrentData().viewSpecs[t]||this.getUnitViewSpec(t),this.unselect(),n?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:n.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let t,n,{viewSpecs:r,toolbarConfig:i}=this.getCurrentData(),s=[].concat(i.header?i.header.viewsWithButtons:[],i.footer?i.footer.viewsWithButtons:[]);for(let o in r)s.push(o);for(t=0;t<s.length;t+=1)if(n=r[s[t]],n&&n.singleUnit===e)return n;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let t=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.createMarker(e)})}incrementDate(e){let t=this.getCurrentData(),n=hn(e);n&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.add(t.currentDate,n)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,t){let{dateEnv:n}=this.getCurrentData();return n.format(n.createMarker(e),er(t))}formatRange(e,t,n){let{dateEnv:r}=this.getCurrentData();return r.formatRange(r.createMarker(e),r.createMarker(t),er(n),n)}formatIso(e,t){let{dateEnv:n}=this.getCurrentData();return n.formatIso(n.createMarker(e),{omitTime:t})}select(e,t){let n;n=null==t?null!=e.start?e:{start:e,end:null}:{start:e,end:t};let r=this.getCurrentData(),i=as(n,r.dateEnv,hn({days:1}));i&&(this.dispatch({type:"SELECT_DATES",selection:i}),Pi(i,null,r))}unselect(e){let t=this.getCurrentData();t.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),function(e,t){t.emitter.trigger("unselect",{jsEvent:e?e.origEvent:null,view:t.viewApi||t.calendarApi.view})}(e,t))}addEvent(e,t){if(e instanceof Vi){let t=e._def,n=e._instance;return this.getCurrentData().eventStore.defs[t.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:fi({def:t,instance:n})}),this.triggerEventAdd(e)),e}let n,r=this.getCurrentData();if(t instanceof zi)n=t.internalEventSource;else if("boolean"===typeof t)t&&([n]=vr(r.eventSources));else if(null!=t){let e=this.getEventSourceById(t);if(!e)return console.warn(`Could not find an event source with ID "${t}"`),null;n=e.internalEventSource}let i=li(e,n,r,!1);if(i){let e=new Vi(r,i.def,i.def.recurringDef?null:i.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:fi(i)}),this.triggerEventAdd(e),e}return null}triggerEventAdd(e){let{emitter:t}=this.getCurrentData();t.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:Hi(e)})}})}getEventById(e){let t=this.getCurrentData(),{defs:n,instances:r}=t.eventStore;e=String(e);for(let i in n){let s=n[i];if(s.publicId===e){if(s.recurringDef)return new Vi(t,s,null);for(let e in r){let n=r[e];if(n.defId===s.defId)return new Vi(t,s,n)}}}return null}getEvents(){let e=this.getCurrentData();return qi(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),t=e.eventSources,n=[];for(let r in t)n.push(new zi(e,t[r]));return n}getEventSourceById(e){let t=this.getCurrentData(),n=t.eventSources;e=String(e);for(let r in n)if(n[r].publicId===e)return new zi(t,n[r]);return null}addEventSource(e){let t=this.getCurrentData();if(e instanceof zi)return t.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let n=xi(e,t);return n?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[n]}),new zi(t,n)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let t=hn(e);t&&this.trigger("_scrollRequest",{time:t})}}function ws(e,t){return e.left>=t.left&&e.left<t.right&&e.top>=t.top&&e.top<t.bottom}function Ss(e,t){let n={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)};return n.left<n.right&&n.top<n.bottom&&n}const Es={defs:{},instances:{}};class _s{constructor(){this.getKeysForEventDefs=Un(this._getKeysForEventDefs),this.splitDateSelection=Un(this._splitDateSpan),this.splitEventStore=Un(this._splitEventStore),this.splitIndividualUi=Un(this._splitIndividualUi),this.splitEventDrag=Un(this._splitInteraction),this.splitEventResize=Un(this._splitInteraction),this.eventUiBuilders={}}splitProps(e){let t=this.getKeyInfo(e),n=this.getKeysForEventDefs(e.eventStore),r=this.splitDateSelection(e.dateSelection),i=this.splitIndividualUi(e.eventUiBases,n),s=this.splitEventStore(e.eventStore,n),o=this.splitEventDrag(e.eventDrag),a=this.splitEventResize(e.eventResize),l={};this.eventUiBuilders=gr(t,(e,t)=>this.eventUiBuilders[t]||Un(Cs));for(let c in t){let n=t[c],u=s[c]||Es,d=this.eventUiBuilders[c];l[c]={businessHours:n.businessHours||e.businessHours,dateSelection:r[c]||null,eventStore:u,eventUiBases:d(e.eventUiBases[""],n.ui,i[c]),eventSelection:u.instances[e.eventSelection]?e.eventSelection:"",eventDrag:o[c]||null,eventResize:a[c]||null}}return l}_splitDateSpan(e){let t={};if(e){let n=this.getKeysForDateSpan(e);for(let r of n)t[r]=e}return t}_getKeysForEventDefs(e){return gr(e.defs,e=>this.getKeysForEventDef(e))}_splitEventStore(e,t){let{defs:n,instances:r}=e,i={};for(let s in n)for(let e of t[s])i[e]||(i[e]=gi()),i[e].defs[s]=n[s];for(let s in r){let e=r[s];for(let n of t[e.defId])i[n]&&(i[n].instances[s]=e)}return i}_splitIndividualUi(e,t){let n={};for(let r in e)if(r)for(let i of t[r])n[i]||(n[i]={}),n[i][r]=e[r];return n}_splitInteraction(e){let t={};if(e){let n=this._splitEventStore(e.affectedEvents,this._getKeysForEventDefs(e.affectedEvents)),r=this._getKeysForEventDefs(e.mutatedEvents),i=this._splitEventStore(e.mutatedEvents,r),s=r=>{t[r]||(t[r]={affectedEvents:n[r]||Es,mutatedEvents:i[r]||Es,isEvent:e.isEvent})};for(let e in n)s(e);for(let e in i)s(e)}return t}}function Cs(e,t,n){let r=[];e&&r.push(e),t&&r.push(t);let i={"":Ei(r)};return n&&Object.assign(i,n),i}function xs(e,t,n,r){return{dow:e.getUTCDay(),isDisabled:Boolean(r&&(!r.activeRange||!Xr(r.activeRange,e))),isOther:Boolean(r&&!Xr(r.currentRange,e)),isToday:Boolean(t&&Xr(t,e)),isPast:Boolean(n?e<n:!!t&&e<t.start),isFuture:Boolean(n?e>n:!!t&&e>=t.end)}}function Ts(e,t){let n=["fc-day",`fc-day-${wn[e.dow]}`];return e.isDisabled?n.push("fc-day-disabled"):(e.isToday&&(n.push("fc-day-today"),n.push(t.getClass("today"))),e.isPast&&n.push("fc-day-past"),e.isFuture&&n.push("fc-day-future"),e.isOther&&n.push("fc-day-other")),n}const Is=er({year:"numeric",month:"long",day:"numeric"}),Ds=er({week:"long"});function As(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day",r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{dateEnv:i,options:s,calendarApi:o}=e;let a=i.format(t,"week"===n?Ds:Is);if(s.navLinks){let e=i.toDate(t);const l=e=>{let r="day"===n?s.navLinkDayClick:"week"===n?s.navLinkWeekClick:null;"function"===typeof r?r.call(o,i.toDate(t),e):("string"===typeof r&&(n=r),o.zoomTo(t,n))};return Object.assign({title:on(s.navLinkHint,[a,e],a),"data-navlink":""},r?Xt(l):{onClick:l})}return{"aria-label":a}}let ks,Ns=null;function Rs(){return null===Ns&&(Ns=function(){let e=document.createElement("div");Ht(e,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),e.innerHTML="<div></div>",document.body.appendChild(e);let t=e.firstChild.getBoundingClientRect().left>e.getBoundingClientRect().left;return Ut(e),t}()),Ns}function Ms(){return ks||(ks=function(){let e=document.createElement("div");e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",e.style.left="-9999px",document.body.appendChild(e);let t=Os(e);return document.body.removeChild(e),t}()),ks}function Os(e){return{x:e.offsetHeight-e.clientHeight,y:e.offsetWidth-e.clientWidth}}function Ps(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(arguments.length>2?arguments[2]:void 0)?e.getBoundingClientRect():Ls(e),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window.getComputedStyle(e),r=parseInt(n.borderLeftWidth,10)||0,i=parseInt(n.borderRightWidth,10)||0,s=parseInt(n.borderTopWidth,10)||0,o=parseInt(n.borderBottomWidth,10)||0,a=Os(e),l=a.y-r-i,c={borderLeft:r,borderRight:i,borderTop:s,borderBottom:o,scrollbarBottom:a.x-s-o,scrollbarLeft:0,scrollbarRight:0};return Rs()&&"rtl"===n.direction?c.scrollbarLeft=l:c.scrollbarRight=l,t&&(c.paddingLeft=parseInt(n.paddingLeft,10)||0,c.paddingRight=parseInt(n.paddingRight,10)||0,c.paddingTop=parseInt(n.paddingTop,10)||0,c.paddingBottom=parseInt(n.paddingBottom,10)||0),c}(e,t),i={left:n.left+r.borderLeft+r.scrollbarLeft,right:n.right-r.borderRight-r.scrollbarRight,top:n.top+r.borderTop,bottom:n.bottom-r.borderBottom-r.scrollbarBottom};return t&&(i.left+=r.paddingLeft,i.right-=r.paddingRight,i.top+=r.paddingTop,i.bottom-=r.paddingBottom),i}function Ls(e){let t=e.getBoundingClientRect();return{left:t.left+window.scrollX,top:t.top+window.scrollY,right:t.right+window.scrollX,bottom:t.bottom+window.scrollY}}function js(e){let t=[];for(;e instanceof HTMLElement;){let n=window.getComputedStyle(e);if("fixed"===n.position)break;/(auto|scroll)/.test(n.overflow+n.overflowY+n.overflowX)&&t.push(e),e=e.parentNode}return t}class Fs{constructor(e,t,n,r){this.els=t;let i=this.originClientRect=e.getBoundingClientRect();n&&this.buildElHorizontals(i.left),r&&this.buildElVerticals(i.top)}buildElHorizontals(e){let t=[],n=[];for(let r of this.els){let i=r.getBoundingClientRect();t.push(i.left-e),n.push(i.right-e)}this.lefts=t,this.rights=n}buildElVerticals(e){let t=[],n=[];for(let r of this.els){let i=r.getBoundingClientRect();t.push(i.top-e),n.push(i.bottom-e)}this.tops=t,this.bottoms=n}leftToIndex(e){let t,{lefts:n,rights:r}=this,i=n.length;for(t=0;t<i;t+=1)if(e>=n[t]&&e<r[t])return t}topToIndex(e){let t,{tops:n,bottoms:r}=this,i=n.length;for(t=0;t<i;t+=1)if(e>=n[t]&&e<r[t])return t}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return Us(this.tops||[],e.tops||[])&&Us(this.bottoms||[],e.bottoms||[])&&Us(this.lefts||[],e.lefts||[])&&Us(this.rights||[],e.rights||[])}}function Us(e,t){const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(Math.round(e[r])!==Math.round(t[r]))return!1;return!0}class Bs{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}}class zs extends Bs{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}}class Vs extends Bs{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}}class Hs extends Pr{constructor(){super(...arguments),this.uid=en()}prepareHits(){}queryHit(e,t,n,r){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!Bt(e,".fc-event-mirror")}isValidDateDownEl(e){return!Bt(e,".fc-event:not(.fc-bg-event)")&&!Bt(e,".fc-more-link")&&!Bt(e,"a[data-navlink]")&&!Bt(e,".fc-popover")}}class qs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e.thickness||1;this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let t=[];for(let n of e)this.insertEntry(n,t);return t}insertEntry(e,t){let n=this.findInsertion(e);this.isInsertionValid(n,e)?this.insertEntryAt(e,n):this.handleInvalidInsertion(n,e,t)}isInsertionValid(e,t){return(-1===this.maxCoord||e.levelCoord+this.getEntryThickness(t)<=this.maxCoord)&&(-1===this.maxStackCnt||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,t,n){if(this.allowReslicing&&e.touchingEntry){const r=Object.assign(Object.assign({},t),{span:Qs(t.span,e.touchingEntry.span)});n.push(r),this.splitEntry(t,e.touchingEntry,n)}else n.push(t)}splitEntry(e,t,n){let r=e.span,i=t.span;r.start<i.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:r.start,end:i.start}},n),r.end>i.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:i.end,end:r.end}},n)}insertEntryAt(e,t){let{entriesByLevel:n,levelCoords:r}=this;-1===t.lateral?(Ks(r,t.level,t.levelCoord),Ks(n,t.level,[e])):Ks(n[t.level],t.lateral,e),this.stackCnts[Gs(e)]=t.stackCnt}findInsertion(e){let{levelCoords:t,entriesByLevel:n,strictOrder:r,stackCnts:i}=this,s=t.length,o=0,a=-1,l=-1,c=null,u=0;for(let f=0;f<s;f+=1){const s=t[f];if(!r&&s>=o+this.getEntryThickness(e))break;let d,h=n[f],p=Ys(h,e.span.start,$s),g=p[0]+p[1];for(;(d=h[g])&&d.span.start<e.span.end;){let e=s+this.getEntryThickness(d);e>o&&(o=e,c=d,a=f,l=g),e===o&&(u=Math.max(u,i[Gs(d)]+1)),g+=1}}let d=0;if(c)for(d=a+1;d<s&&t[d]<o;)d+=1;let h=-1;return d<s&&t[d]===o&&(h=Ys(n[d],e.span.end,$s)[0]),{touchingLevel:a,touchingLateral:l,touchingEntry:c,stackCnt:u,levelCoord:o,level:d,lateral:h}}toRects(){let{entriesByLevel:e,levelCoords:t}=this,n=e.length,r=[];for(let i=0;i<n;i+=1){let n=e[i],s=t[i];for(let e of n)r.push(Object.assign(Object.assign({},e),{thickness:this.getEntryThickness(e),levelCoord:s}))}return r}}function $s(e){return e.span.end}function Gs(e){return e.index+":"+e.span.start}function Ws(e,t){return{start:Math.min(e.start,t.start),end:Math.max(e.end,t.end)}}function Qs(e,t){let n=Math.max(e.start,t.start),r=Math.min(e.end,t.end);return n<r?{start:n,end:r}:null}function Ks(e,t,n){e.splice(t,0,n)}function Ys(e,t,n){let r=0,i=e.length;if(!i||t<n(e[r]))return[0,0];if(t>n(e[i-1]))return[i,0];for(;r<i;){let s=Math.floor(r+(i-r)/2),o=n(e[s]);if(t<o)i=s;else{if(!(t>o))return[s,1];r=s+1}}return[r,0]}class Xs{constructor(e,t){this.emitter=new Ri}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}}const Js={};Boolean;const Zs="fc-col-header-cell";function eo(e){return e.text}class to extends Pr{render(){let{dateEnv:e,options:t,theme:n,viewApi:r}=this.context,{props:i}=this,{date:s,dateProfile:o}=i,a=xs(s,i.todayRange,null,o),l=[Zs].concat(Ts(a,n)),c=e.format(s,i.dayHeaderFormat),u=!a.isDisabled&&i.colCnt>1?As(this.context,s):{},d=e.toDate(s);e.namedTimeZoneImpl&&(d=_n(d,36e5));let h=Object.assign(Object.assign(Object.assign({date:d,view:r},i.extraRenderProps),{text:c}),a);return be(Vr,{elTag:"th",elClasses:l,elAttrs:Object.assign({role:"columnheader",colSpan:i.colSpan,"data-date":a.isDisabled?void 0:Ln(s)},i.extraDataAttrs),renderProps:h,generatorName:"dayHeaderContent",customGenerator:t.dayHeaderContent,defaultGenerator:eo,classNameGenerator:t.dayHeaderClassNames,didMount:t.dayHeaderDidMount,willUnmount:t.dayHeaderWillUnmount},e=>be("div",{className:"fc-scrollgrid-sync-inner"},!a.isDisabled&&be(e,{elTag:"a",elAttrs:u,elClasses:["fc-col-header-cell-cushion",i.isSticky&&"fc-sticky"]})))}}const no=er({weekday:"long"});class ro extends Pr{render(){let{props:e}=this,{dateEnv:t,theme:n,viewApi:r,options:i}=this.context,s=En(new Date(2592e5),e.dow),o={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},a=t.format(s,e.dayHeaderFormat),l=Object.assign(Object.assign(Object.assign(Object.assign({date:s},o),{view:r}),e.extraRenderProps),{text:a});return be(Vr,{elTag:"th",elClasses:[Zs,...Ts(o,n),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:l,generatorName:"dayHeaderContent",customGenerator:i.dayHeaderContent,defaultGenerator:eo,classNameGenerator:i.dayHeaderClassNames,didMount:i.dayHeaderDidMount,willUnmount:i.dayHeaderWillUnmount},n=>be("div",{className:"fc-scrollgrid-sync-inner"},be(n,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":t.format(s,no)}})))}}class io extends Pr{constructor(){super(...arguments),this.createDayHeaderFormatter=Un(so)}render(){let{context:e}=this,{dates:t,dateProfile:n,datesRepDistinctDays:r,renderIntro:i}=this.props,s=this.createDayHeaderFormatter(e.options.dayHeaderFormat,r,t.length);return be(vs,{unit:"day"},(e,o)=>be("tr",{role:"row"},i&&i("day"),t.map(e=>r?be(to,{key:e.toISOString(),date:e,dateProfile:n,todayRange:o,colCnt:t.length,dayHeaderFormat:s}):be(ro,{key:e.getUTCDay(),dow:e.getUTCDay(),dayHeaderFormat:s}))))}}function so(e,t,n){return e||function(e,t){return er(!e||t>10?{weekday:"short"}:t>1?{weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}:{weekday:"long"})}(t,n)}class oo{constructor(e,t){let n=e.start,{end:r}=e,i=[],s=[],o=-1;for(;n<r;)t.isHiddenDay(n)?i.push(o+.5):(o+=1,i.push(o),s.push(n)),n=En(n,1);this.dates=s,this.indices=i,this.cnt=s.length}sliceRange(e){let t=this.getDateDayIndex(e.start),n=this.getDateDayIndex(En(e.end,-1)),r=Math.max(0,t),i=Math.min(this.cnt-1,n);return r=Math.ceil(r),i=Math.floor(i),r<=i?{firstIndex:r,lastIndex:i,isStart:t===r,isEnd:n===i}:null}getDateDayIndex(e){let{indices:t}=this,n=Math.floor(Cn(this.dates[0],e));return n<0?t[0]-1:n>=t.length?t[t.length-1]+1:t[n]}}class ao{constructor(e,t){let n,r,i,{dates:s}=e;if(t){for(r=s[0].getUTCDay(),n=1;n<s.length&&s[n].getUTCDay()!==r;n+=1);i=Math.ceil(s.length/n)}else i=1,n=s.length;this.rowCnt=i,this.colCnt=n,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let t=0;t<this.rowCnt;t+=1){let n=[];for(let e=0;e<this.colCnt;e+=1)n.push(this.buildCell(t,e));e.push(n)}return e}buildCell(e,t){let n=this.daySeries.dates[e*this.colCnt+t];return{key:n.toISOString(),date:n}}buildHeaderDates(){let e=[];for(let t=0;t<this.colCnt;t+=1)e.push(this.cells[0][t].date);return e}sliceRange(e){let{colCnt:t}=this,n=this.daySeries.sliceRange(e),r=[];if(n){let{firstIndex:e,lastIndex:i}=n,s=e;for(;s<=i;){let o=Math.floor(s/t),a=Math.min((o+1)*t,i+1);r.push({row:o,firstCol:s%t,lastCol:(a-1)%t,isStart:n.isStart&&s===e,isEnd:n.isEnd&&a-1===i}),s=a}}return r}}class lo{constructor(){this.sliceBusinessHours=Un(this._sliceBusinessHours),this.sliceDateSelection=Un(this._sliceDateSpan),this.sliceEventStore=Un(this._sliceEventStore),this.sliceEventDrag=Un(this._sliceInteraction),this.sliceEventResize=Un(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,t,n,r){let{eventUiBases:i}=e;for(var s=arguments.length,o=new Array(s>4?s-4:0),a=4;a<s;a++)o[a-4]=arguments[a];let l=this.sliceEventStore(e.eventStore,i,t,n,...o);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,t,n,i,r,...o),businessHourSegs:this.sliceBusinessHours(e.businessHours,t,n,r,...o),fgEventSegs:l.fg,bgEventSegs:l.bg,eventDrag:this.sliceEventDrag(e.eventDrag,i,t,n,...o),eventResize:this.sliceEventResize(e.eventResize,i,t,n,...o),eventSelection:e.eventSelection}}sliceNowDate(e,t,n,r){for(var i=arguments.length,s=new Array(i>4?i-4:0),o=4;o<i;o++)s[o-4]=arguments[o];return this._sliceDateSpan({range:{start:e,end:_n(e,1)},allDay:!1},t,n,{},r,...s)}_sliceBusinessHours(e,t,n,r){if(!e)return[];for(var i=arguments.length,s=new Array(i>4?i-4:0),o=4;o<i;o++)s[o-4]=arguments[o];return this._sliceEventStore(ri(e,co(t,Boolean(n)),r),{},t,n,...s).bg}_sliceEventStore(e,t,n,r){if(e){let a=$i(e,t,co(n,Boolean(r)),r);for(var i=arguments.length,s=new Array(i>4?i-4:0),o=4;o<i;o++)s[o-4]=arguments[o];return{bg:this.sliceEventRanges(a.bg,s),fg:this.sliceEventRanges(a.fg,s)}}return{bg:[],fg:[]}}_sliceInteraction(e,t,n,r){if(!e)return null;let i=$i(e.mutatedEvents,t,co(n,Boolean(r)),r);for(var s=arguments.length,o=new Array(s>4?s-4:0),a=4;a<s;a++)o[a-4]=arguments[a];return{segs:this.sliceEventRanges(i.fg,o),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,t,n,r,i){if(!e)return[];let s=co(t,Boolean(n)),o=Qr(e.range,s);if(o){let t=function(e,t,n){let r=ci({editable:!1},n),i=di(r.refined,r.extra,"",e.allDay,!0,n);return{def:i,ui:Ki(i,t),instance:ni(i.defId,e.range),range:e.range,isStart:!0,isEnd:!0}}(e=Object.assign(Object.assign({},e),{range:o}),r,i);for(var a=arguments.length,l=new Array(a>5?a-5:0),c=5;c<a;c++)l[c-5]=arguments[c];let n=this.sliceRange(e.range,...l);for(let e of n)e.eventRange=t;return n}return[]}sliceEventRanges(e,t){let n=[];for(let r of e)n.push(...this.sliceEventRange(r,t));return n}sliceEventRange(e,t){let n=e.range;this.forceDayIfListItem&&"list-item"===e.ui.display&&(n={start:n.start,end:En(n.start,1)});let r=this.sliceRange(n,...t);for(let i of r)i.eventRange=e,i.isStart=e.isStart&&i.isStart,i.isEnd=e.isEnd&&i.isEnd;return r}}function co(e,t){let n=e.activeRange;return t?n:{start:_n(n.start,e.slotMinTime.milliseconds),end:_n(n.end,e.slotMaxTime.milliseconds-864e5)}}function uo(e,t,n){let{instances:r}=e.mutatedEvents;for(let i in r)if(!Yr(t.validRange,r[i].range))return!1;return ho({eventDrag:e},n)}function ho(e,t){let n=t.getCurrentData(),r=Object.assign({businessHours:n.businessHours,dateSelection:"",eventStore:n.eventStore,eventUiBases:n.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},e);return(t.pluginHooks.isPropsValid||fo)(r,t)}function fo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;return!(e.eventDrag&&!function(e,t,n,r){let i=t.getCurrentData(),s=e.eventDrag,o=s.mutatedEvents,a=o.defs,l=o.instances,c=Qi(a,s.isEvent?e.eventUiBases:{"":i.selectionConfig});r&&(c=gr(c,r));let u=(p=e.eventStore,g=s.affectedEvents.instances,{defs:p.defs,instances:pr(p.instances,e=>!g[e.instanceId])}),d=u.defs,h=u.instances,f=Qi(d,e.eventUiBases);var p,g;for(let m in l){let r=l[m],o=r.range,p=c[r.defId],g=a[r.defId];if(!po(p.constraints,o,u,e.businessHours,t))return!1;let{eventOverlap:v}=t.options,y="function"===typeof v?v:null;for(let e in h){let n=h[e];if(Kr(o,n.range)){if(!1===f[n.defId].overlap&&s.isEvent)return!1;if(!1===p.overlap)return!1;if(y&&!y(new Vi(t,d[n.defId],n),new Vi(t,g,r)))return!1}}let b=i.eventStore;for(let e of p.allows){let i,s=Object.assign(Object.assign({},n),{range:r.range,allDay:g.allDay}),o=b.defs[g.defId],a=b.instances[m];if(i=o?new Vi(t,o,a):new Vi(t,g),!e(Li(s,t),i))return!1}}return!0}(e,t,n,r))&&!(e.dateSelection&&!function(e,t,n,r){let i=e.eventStore,s=i.defs,o=i.instances,a=e.dateSelection,l=a.range,{selectionConfig:c}=t.getCurrentData();r&&(c=r(c));if(!po(c.constraints,l,i,e.businessHours,t))return!1;let{selectOverlap:u}=t.options,d="function"===typeof u?u:null;for(let h in o){let e=o[h];if(Kr(l,e.range)){if(!1===c.overlap)return!1;if(d&&!d(new Vi(t,s[e.defId],e),null))return!1}}for(let h of c.allows){if(!h(Li(Object.assign(Object.assign({},n),a),t),null))return!1}return!0}(e,t,n,r))}function po(e,t,n,r,i){for(let s of e)if(!vo(go(s,t,n,r,i),t))return!1;return!0}function go(e,t,n,r,i){return"businessHours"===e?mo(ri(r,t,i)):"string"===typeof e?mo(vi(n,t=>t.groupId===e)):"object"===typeof e&&e?mo(ri(e,t,i)):[]}function mo(e){let{instances:t}=e,n=[];for(let r in t)n.push(t[r].range);return n}function vo(e,t){for(let n of e)if(Yr(n,t))return!0;return!1}const yo=/^(visible|hidden)$/;class bo extends Pr{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,Lr(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:t,liquidIsAbsolute:n}=e,r=t&&n,i=["fc-scroller"];return t&&(n?i.push("fc-scroller-liquid-absolute"):i.push("fc-scroller-liquid")),be("div",{ref:this.handleEl,className:i.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:r&&-(e.overcomeLeft||0)||"",right:r&&-(e.overcomeRight||0)||"",bottom:r&&-(e.overcomeBottom||0)||"",marginLeft:!r&&-(e.overcomeLeft||0)||"",marginRight:!r&&-(e.overcomeRight||0)||"",marginBottom:!r&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(yo.test(this.props.overflowX))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:n}=e;for(let r=0;r<n.length;r+=1){if(n[r].getBoundingClientRect().width>t)return!0}return!1}needsYScrolling(){if(yo.test(this.props.overflowY))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:n}=e;for(let r=0;r<n.length;r+=1){if(n[r].getBoundingClientRect().height>t)return!0}return!1}getXScrollbarWidth(){return yo.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return yo.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}}class wo{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(e,t)=>{let{depths:n,currentMap:r}=this,i=!1,s=!1;null!==e?(i=t in r,r[t]=e,n[t]=(n[t]||0)+1,s=!0):(n[t]-=1,n[t]||(delete r[t],delete this.callbackMap[t],i=!0)),this.masterCallback&&(i&&this.masterCallback(null,String(t)),s&&this.masterCallback(e,String(t)))}}createRef(e){let t=this.callbackMap[e];return t||(t=this.callbackMap[e]=t=>{this.handleValue(t,String(e))}),t}collect(e,t,n){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=[];null==n&&(n=Object.keys(e).length);for(let s=t;s<n;s+=r){let t=e[s];void 0!==t&&i.push(t)}return i}(this.currentMap,e,t,n)}getAll(){return vr(this.currentMap)}}function So(e){let t=function(e,t){let n=e instanceof HTMLElement?[e]:e,r=[];for(let i=0;i<n.length;i+=1){let e=n[i].querySelectorAll(t);for(let t=0;t<e.length;t+=1)r.push(e[t])}return r}(e,".fc-scrollgrid-shrink"),n=0;for(let r of t)n=Math.max(n,cn(r));return Math.ceil(n)}function Eo(e,t){return e.liquid&&t.liquid}function _o(e,t){return bn(e,t,yr)}function Co(e,t){let n=[];for(let r of e){let e=r.span||1;for(let i=0;i<e;i+=1)n.push(be("col",{style:{width:"shrink"===r.width?xo(t):r.width||"",minWidth:r.minWidth||""}}))}return be("colgroup",{},...n)}function xo(e){return null==e?4:e}function To(e,t){let n=["fc-scrollgrid-section",`fc-scrollgrid-section-${e.type}`,e.className];return t&&e.liquid&&null==e.maxHeight&&n.push("fc-scrollgrid-section-liquid"),e.isSticky&&n.push("fc-scrollgrid-section-sticky"),n}function Io(e){return be("div",{className:"fc-scrollgrid-sticky-shim",style:{width:e.clientWidth,minWidth:e.tableMinWidth}})}function Do(e){let{stickyHeaderDates:t}=e;return null!=t&&"auto"!==t||(t="auto"===e.height||"auto"===e.viewHeight),t}function Ao(e){let{stickyFooterScrollbar:t}=e;return null!=t&&"auto"!==t||(t="auto"===e.height||"auto"===e.viewHeight),t}class ko extends Pr{constructor(){super(...arguments),this.processCols=Un(e=>e,_o),this.renderMicroColGroup=Un(Co),this.scrollerRefs=new wo,this.scrollerElRefs=new wo(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:t,context:n}=this,r=e.sections||[],i=this.processCols(e.cols),s=this.renderMicroColGroup(i,t.shrinkWidth),o=function(e,t){let n=["fc-scrollgrid",t.theme.getClass("table")];return e&&n.push("fc-scrollgrid-liquid"),n}(e.liquid,n);e.collapsibleWidth&&o.push("fc-scrollgrid-collapsible");let a,l=r.length,c=0,u=[],d=[],h=[];for(;c<l&&"header"===(a=r[c]).type;)u.push(this.renderSection(a,s,!0)),c+=1;for(;c<l&&"body"===(a=r[c]).type;)d.push(this.renderSection(a,s,!1)),c+=1;for(;c<l&&"footer"===(a=r[c]).type;)h.push(this.renderSection(a,s,!0)),c+=1;let f=!hs();const p={role:"rowgroup"};return be("table",{role:"grid",className:o.join(" "),style:{height:e.height}},Boolean(!f&&u.length)&&be("thead",p,...u),Boolean(!f&&d.length)&&be("tbody",p,...d),Boolean(!f&&h.length)&&be("tfoot",p,...h),f&&be("tbody",p,...u,...d,...h))}renderSection(e,t,n){return"outerContent"in e?be(Se,{key:e.key},e.outerContent):be("tr",{key:e.key,role:"presentation",className:To(e,this.props.liquid).join(" ")},this.renderChunkTd(e,t,e.chunk,n))}renderChunkTd(e,t,n,r){if("outerContent"in n)return n.outerContent;let{props:i}=this,{forceYScrollbars:s,scrollerClientWidths:o,scrollerClientHeights:a}=this.state,l=function(e,t){return null!=t.maxHeight||Eo(e,t)}(i,e),c=Eo(i,e),u=i.liquid?s?"scroll":l?"auto":"hidden":"visible",d=e.key,h=function(e,t,n,r){let{expandRows:i}=n;return"function"===typeof t.content?t.content(n):be("table",{role:"presentation",className:[t.tableClassName,e.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:n.tableMinWidth,width:n.clientWidth,height:i?n.clientHeight:""}},n.tableColGroupNode,be(r?"thead":"tbody",{role:"presentation"},"function"===typeof t.rowContent?t.rowContent(n):t.rowContent))}(e,n,{tableColGroupNode:t,tableMinWidth:"",clientWidth:i.collapsibleWidth||void 0===o[d]?null:o[d],clientHeight:void 0!==a[d]?a[d]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},r);return be(r?"th":"td",{ref:n.elRef,role:"presentation"},be("div",{className:"fc-scroller-harness"+(c?" fc-scroller-harness-liquid":"")},be(bo,{ref:this.scrollerRefs.createRef(d),elRef:this.scrollerElRefs.createRef(d),overflowY:u,overflowX:i.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:c,liquidIsAbsolute:!0},h)))}_handleScrollerEl(e,t){let n=function(e,t){for(let n of e)if(n.key===t)return n;return null}(this.props.sections,t);n&&Lr(n.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return function(e){for(let t of e)if("shrink"===t.width)return!0;return!1}(this.props.cols)?So(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=Ms(),{scrollerRefs:t,scrollerElRefs:n}=this,r=!1,i={},s={};for(let o in t.currentMap){let e=t.currentMap[o];if(e&&e.needsYScrolling()){r=!0;break}}for(let o of this.props.sections){let t=o.key,a=n.currentMap[t];if(a){let n=a.parentNode;i[t]=Math.floor(n.getBoundingClientRect().width-(r?e.y:0)),s[t]=Math.floor(n.getBoundingClientRect().height)}}return{forceYScrollbars:r,scrollerClientWidths:i,scrollerClientHeights:s}}}ko.addStateEquality({scrollerClientWidths:yr,scrollerClientHeights:yr});class No extends Pr{constructor(){super(...arguments),this.buildPublicEvent=Un((e,t,n)=>new Vi(e,t,n)),this.handleEl=e=>{this.el=e,Lr(this.props.elRef,e),e&&Gi(e,this.props.seg)}}render(){const{props:e,context:t}=this,{options:n}=t,{seg:r}=e,{eventRange:i}=r,{ui:s}=i,o={event:this.buildPublicEvent(t,i.def,i.instance),view:t.viewApi,timeText:e.timeText,textColor:s.textColor,backgroundColor:s.backgroundColor,borderColor:s.borderColor,isDraggable:!e.disableDragging&&Ji(r,t),isStartResizable:!e.disableResizing&&Zi(r,t),isEndResizable:!e.disableResizing&&es(r),isMirror:Boolean(e.isDragging||e.isResizing||e.isDateSelecting),isStart:Boolean(r.isStart),isEnd:Boolean(r.isEnd),isPast:Boolean(e.isPast),isFuture:Boolean(e.isFuture),isToday:Boolean(e.isToday),isSelected:Boolean(e.isSelected),isDragging:Boolean(e.isDragging),isResizing:Boolean(e.isResizing)};return be(Vr,{elRef:this.handleEl,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:[...rs(o),...r.eventRange.ui.classNames,...e.elClasses||[]],elStyle:e.elStyle,renderProps:o,generatorName:"eventContent",customGenerator:n.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:n.eventClassNames,didMount:n.eventDidMount,willUnmount:n.eventWillUnmount},e.children)}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&Gi(this.el,this.props.seg)}}class Ro extends Pr{render(){let{props:e,context:t}=this,{options:n}=t,{seg:r}=e,{ui:i}=r.eventRange,s=ts(r,n.eventTimeFormat||e.defaultTimeFormat,t,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return be(No,Object.assign({},e,{elTag:"a",elStyle:{borderColor:i.borderColor,backgroundColor:i.backgroundColor},elAttrs:ss(r,t),defaultGenerator:Mo,timeText:s}),(e,t)=>be(Se,null,be(e,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:t.textColor}}),Boolean(t.isStartResizable)&&be("div",{className:"fc-event-resizer fc-event-resizer-start"}),Boolean(t.isEndResizable)&&be("div",{className:"fc-event-resizer fc-event-resizer-end"})))}}function Mo(e){return be("div",{className:"fc-event-main-frame"},e.timeText&&be("div",{className:"fc-event-time"},e.timeText),be("div",{className:"fc-event-title-container"},be("div",{className:"fc-event-title fc-sticky"},e.event.title||be(Se,null,"\xa0"))))}Ro.addPropsEquality({seg:yr});const Oo=e=>be(Rr.Consumer,null,t=>{let{options:n}=t,r={isAxis:e.isAxis,date:t.dateEnv.toDate(e.date),view:t.viewApi};return be(Vr,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:e.elClasses,elStyle:e.elStyle,renderProps:r,generatorName:"nowIndicatorContent",customGenerator:n.nowIndicatorContent,classNameGenerator:n.nowIndicatorClassNames,didMount:n.nowIndicatorDidMount,willUnmount:n.nowIndicatorWillUnmount},e.children)}),Po=er({day:"numeric"});class Lo extends Pr{constructor(){super(...arguments),this.refineRenderProps=Bn(Fo)}render(){let{props:e,context:t}=this,{options:n}=t,r=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:t.viewApi,dateEnv:t.dateEnv,monthStartFormat:n.monthStartFormat});return be(Vr,{elRef:e.elRef,elTag:e.elTag,elAttrs:Object.assign(Object.assign({},e.elAttrs),r.isDisabled?{}:{"data-date":Ln(e.date)}),elClasses:[...Ts(r,t.theme),...e.elClasses||[]],elStyle:e.elStyle,renderProps:r,generatorName:"dayCellContent",customGenerator:n.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:r.isDisabled?void 0:n.dayCellClassNames,didMount:n.dayCellDidMount,willUnmount:n.dayCellWillUnmount},e.children)}}function jo(e){return Boolean(e.dayCellContent||Fr("dayCellContent",e))}function Fo(e){let{date:t,dateEnv:n,dateProfile:r,isMonthStart:i}=e,s=xs(t,e.todayRange,null,r),o=e.showDayNumber?n.format(t,i?e.monthStartFormat:Po):"";return Object.assign(Object.assign(Object.assign({date:n.toDate(t),view:e.viewApi},s),{isMonthStart:i,dayNumberText:o}),e.extraRenderProps)}class Uo extends Pr{render(){let{props:e}=this,{seg:t}=e;return be(No,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:t.eventRange.ui.backgroundColor},defaultGenerator:Bo,seg:t,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}}function Bo(e){let{title:t}=e.event;return t&&be("div",{className:"fc-event-title"},e.event.title)}function zo(e){return be("div",{className:`fc-${e}`})}const Vo=e=>be(Rr.Consumer,null,t=>{let{dateEnv:n,options:r}=t,{date:i}=e,s=r.weekNumberFormat||e.defaultFormat,o={num:n.computeWeekNumber(i),text:n.format(i,s),date:i};return be(Vr,{elRef:e.elRef,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:e.elClasses,elStyle:e.elStyle,renderProps:o,generatorName:"weekNumberContent",customGenerator:r.weekNumberContent,defaultGenerator:Ho,classNameGenerator:r.weekNumberClassNames,didMount:r.weekNumberDidMount,willUnmount:r.weekNumberWillUnmount},e.children)});function Ho(e){return e.text}class qo extends Pr{constructor(){super(...arguments),this.state={titleId:Wt()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&Lr(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{const t=$t(e);this.rootEl.contains(t)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{"Escape"===e.key&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:t}=this.context,{props:n,state:r}=this,i=["fc-popover",e.getClass("popover")].concat(n.extraClassNames||[]);return wt(be("div",Object.assign({},n.extraAttrs,{id:n.id,className:i.join(" "),"aria-labelledby":r.titleId,ref:this.handleRootEl}),be("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},be("span",{className:"fc-popover-title",id:r.titleId},n.title),be("span",{className:"fc-popover-close "+e.getIconClass("close"),title:t.closeHint,onClick:this.handleCloseClick})),be("div",{className:"fc-popover-body "+e.getClass("popoverContent")},n.children)),n.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:t,alignGridTop:n}=this.props,{rootEl:r}=this,i=function(e){let t=js(e),n=e.getBoundingClientRect();for(let r of t){let e=Ss(n,r.getBoundingClientRect());if(!e)return null;n=e}return n}(t);if(i){let s=r.getBoundingClientRect(),o=n?Bt(t,".fc-scrollgrid").getBoundingClientRect().top:i.top,a=e?i.right-s.width:i.left;o=Math.max(o,10),a=Math.min(a,document.documentElement.clientWidth-10-s.width),a=Math.max(a,10);let l=r.offsetParent.getBoundingClientRect();Ht(r,{top:o-l.top,left:a-l.left})}}}class $o extends Hs{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:t}=this.context,{props:n}=this,{startDate:r,todayRange:i,dateProfile:s}=n,o=t.format(r,e.dayPopoverFormat);return be(Lo,{elRef:this.handleRootEl,date:r,dateProfile:s,todayRange:i},(t,r,i)=>be(qo,{elRef:i.ref,id:n.id,title:o,extraClassNames:["fc-more-popover"].concat(i.className||[]),extraAttrs:i,parentEl:n.parentEl,alignmentEl:n.alignmentEl,alignGridTop:n.alignGridTop,onClose:n.onClose},jo(e)&&be(t,{elTag:"div",elClasses:["fc-more-popover-misc"]}),n.children))}queryHit(e,t,n,r){let{rootEl:i,props:s}=this;return e>=0&&e<n&&t>=0&&t<r?{dateProfile:s.dateProfile,dateSpan:Object.assign({allDay:!s.forceTimed,range:{start:s.startDate,end:s.endDate}},s.extraDateSpan),dayEl:i,rect:{left:0,top:0,right:n,bottom:r},layer:1}:null}}class Go extends Pr{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:Wt()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&Lr(this.props.elRef,e)},this.handleClick=e=>{let{props:t,context:n}=this,{moreLinkClick:r}=n.options,i=Qo(t).start;function s(e){let{def:t,instance:r,range:i}=e.eventRange;return{event:new Vi(n,t,r),start:n.dateEnv.toDate(i.start),end:n.dateEnv.toDate(i.end),isStart:e.isStart,isEnd:e.isEnd}}"function"===typeof r&&(r=r({date:i,allDay:Boolean(t.allDayDate),allSegs:t.allSegs.map(s),hiddenSegs:t.hiddenSegs.map(s),jsEvent:e,view:n.viewApi})),r&&"popover"!==r?"string"===typeof r&&n.calendarApi.zoomTo(i,r):this.setState({isPopoverOpen:!0})},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:t}=this;return be(Rr.Consumer,null,n=>{let{viewApi:r,options:i,calendarApi:s}=n,{moreLinkText:o}=i,{moreCnt:a}=e,l=Qo(e),c="function"===typeof o?o.call(s,a):`+${a} ${o}`,u=on(i.moreLinkHint,[a],c),d={num:a,shortText:`+${a}`,text:c,view:r};return be(Se,null,Boolean(e.moreCnt)&&be(Vr,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),Xt(this.handleClick)),{title:u,"aria-expanded":t.isPopoverOpen,"aria-controls":t.isPopoverOpen?t.popoverId:""}),renderProps:d,generatorName:"moreLinkContent",customGenerator:i.moreLinkContent,defaultGenerator:e.defaultGenerator||Wo,classNameGenerator:i.moreLinkClassNames,didMount:i.moreLinkDidMount,willUnmount:i.moreLinkWillUnmount},e.children),t.isPopoverOpen&&be($o,{id:t.popoverId,startDate:l.start,endDate:l.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=Bt(this.linkEl,".fc-view-harness"))}}function Wo(e){return e.text}function Qo(e){if(e.allDayDate)return{start:e.allDayDate,end:En(e.allDayDate,1)};let{hiddenSegs:t}=e;return{start:Ko(t),end:(n=t,n.reduce(Xo).eventRange.range.end)};var n}function Ko(e){return e.reduce(Yo).eventRange.range.start}function Yo(e,t){return e.eventRange.range.start<t.eventRange.range.start?e:t}function Xo(e,t){return e.eventRange.range.end>t.eventRange.range.end?e:t}class Jo{constructor(){this.handlers=[]}set(e){this.currentValue=e;for(let t of this.handlers)t(e)}subscribe(e){this.handlers.push(e),void 0!==this.currentValue&&e(this.currentValue)}}class Zo extends Jo{constructor(){super(...arguments),this.map=new Map}handle(e){const{map:t}=this;let n=!1;e.isActive?(t.set(e.id,e),n=!0):t.has(e.id)&&(t.delete(e.id),n=!0),n&&this.set(t)}}const ea=[],ta={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},na=Object.assign(Object.assign({},ta),{buttonHints:{prev:"Previous $0",next:"Next $0",today:(e,t)=>"day"===t?"Today":`This ${e}`},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint:e=>`Show ${e} more event${1===e?"":"s"}`});function ra(e){let t=e.length>0?e[0].code:"en",n=ea.concat(e),r={en:na};for(let i of n)r[i.code]=i;return{map:r,defaultCode:t}}function ia(e,t){return"object"!==typeof e||Array.isArray(e)?function(e,t){let n=[].concat(e||[]),r=function(e,t){for(let n=0;n<e.length;n+=1){let r=e[n].toLocaleLowerCase().split("-");for(let e=r.length;e>0;e-=1){let n=r.slice(0,e).join("-");if(t[n])return t[n]}}return null}(n,t)||na;return sa(e,n,r)}(e,t):sa(e.code,[e.code],e)}function sa(e,t,n){let r=fr([ta,n],["buttonText"]);delete r.code;let{week:i}=r;return delete r.week,{codeArg:e,codes:t,week:i,simpleNumberFormat:new Intl.NumberFormat(e),options:r}}function oa(e){return{id:en(),name:e.name,premiumReleaseDate:e.premiumReleaseDate?new Date(e.premiumReleaseDate):void 0,deps:e.deps||[],reducers:e.reducers||[],isLoadingFuncs:e.isLoadingFuncs||[],contextInit:[].concat(e.contextInit||[]),eventRefiners:e.eventRefiners||{},eventDefMemberAdders:e.eventDefMemberAdders||[],eventSourceRefiners:e.eventSourceRefiners||{},isDraggableTransformers:e.isDraggableTransformers||[],eventDragMutationMassagers:e.eventDragMutationMassagers||[],eventDefMutationAppliers:e.eventDefMutationAppliers||[],dateSelectionTransformers:e.dateSelectionTransformers||[],datePointTransforms:e.datePointTransforms||[],dateSpanTransforms:e.dateSpanTransforms||[],views:e.views||{},viewPropsTransformers:e.viewPropsTransformers||[],isPropsValid:e.isPropsValid||null,externalDefTransforms:e.externalDefTransforms||[],viewContainerAppends:e.viewContainerAppends||[],eventDropTransformers:e.eventDropTransformers||[],componentInteractions:e.componentInteractions||[],calendarInteractions:e.calendarInteractions||[],themeClasses:e.themeClasses||{},eventSourceDefs:e.eventSourceDefs||[],cmdFormatter:e.cmdFormatter,recurringTypes:e.recurringTypes||[],namedTimeZonedImpl:e.namedTimeZonedImpl,initialView:e.initialView||"",elementDraggingImpl:e.elementDraggingImpl,optionChangeHandlers:e.optionChangeHandlers||{},scrollGridImpl:e.scrollGridImpl||null,listenerRefiners:e.listenerRefiners||{},optionRefiners:e.optionRefiners||{},propSetHandlers:e.propSetHandlers||{}}}function aa(){let e,t=[],n=[];return(r,i)=>(e&&bn(r,t)&&bn(i,n)||(e=function(e,t){let n={},r={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function i(e){for(let t of e){const e=t.name,s=n[e];void 0===s?(n[e]=t.id,i(t.deps),r=la(r,t)):s!==t.id&&console.warn(`Duplicate plugin '${e}'`)}}return e&&i(e),i(t),r}(r,i)),t=r,n=i,e)}function la(e,t){return{premiumReleaseDate:ca(e.premiumReleaseDate,t.premiumReleaseDate),reducers:e.reducers.concat(t.reducers),isLoadingFuncs:e.isLoadingFuncs.concat(t.isLoadingFuncs),contextInit:e.contextInit.concat(t.contextInit),eventRefiners:Object.assign(Object.assign({},e.eventRefiners),t.eventRefiners),eventDefMemberAdders:e.eventDefMemberAdders.concat(t.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},e.eventSourceRefiners),t.eventSourceRefiners),isDraggableTransformers:e.isDraggableTransformers.concat(t.isDraggableTransformers),eventDragMutationMassagers:e.eventDragMutationMassagers.concat(t.eventDragMutationMassagers),eventDefMutationAppliers:e.eventDefMutationAppliers.concat(t.eventDefMutationAppliers),dateSelectionTransformers:e.dateSelectionTransformers.concat(t.dateSelectionTransformers),datePointTransforms:e.datePointTransforms.concat(t.datePointTransforms),dateSpanTransforms:e.dateSpanTransforms.concat(t.dateSpanTransforms),views:Object.assign(Object.assign({},e.views),t.views),viewPropsTransformers:e.viewPropsTransformers.concat(t.viewPropsTransformers),isPropsValid:t.isPropsValid||e.isPropsValid,externalDefTransforms:e.externalDefTransforms.concat(t.externalDefTransforms),viewContainerAppends:e.viewContainerAppends.concat(t.viewContainerAppends),eventDropTransformers:e.eventDropTransformers.concat(t.eventDropTransformers),calendarInteractions:e.calendarInteractions.concat(t.calendarInteractions),componentInteractions:e.componentInteractions.concat(t.componentInteractions),themeClasses:Object.assign(Object.assign({},e.themeClasses),t.themeClasses),eventSourceDefs:e.eventSourceDefs.concat(t.eventSourceDefs),cmdFormatter:t.cmdFormatter||e.cmdFormatter,recurringTypes:e.recurringTypes.concat(t.recurringTypes),namedTimeZonedImpl:t.namedTimeZonedImpl||e.namedTimeZonedImpl,initialView:e.initialView||t.initialView,elementDraggingImpl:e.elementDraggingImpl||t.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},e.optionChangeHandlers),t.optionChangeHandlers),scrollGridImpl:t.scrollGridImpl||e.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},e.listenerRefiners),t.listenerRefiners),optionRefiners:Object.assign(Object.assign({},e.optionRefiners),t.optionRefiners),propSetHandlers:Object.assign(Object.assign({},e.propSetHandlers),t.propSetHandlers)}}function ca(e,t){return void 0===e?t:void 0===t?e:new Date(Math.max(e.valueOf(),t.valueOf()))}class ua extends Ir{}function da(e,t,n,r){if(t[e])return t[e];let i=function(e,t,n,r){let i=n[e],s=r[e],o=e=>i&&null!==i[e]?i[e]:s&&null!==s[e]?s[e]:null,a=o("component"),l=o("superType"),c=null;if(l){if(l===e)throw new Error("Can't have a custom view type that references itself");c=da(l,t,n,r)}!a&&c&&(a=c.component);if(!a)return null;return{type:e,component:a,defaults:Object.assign(Object.assign({},c?c.defaults:{}),i?i.rawOptions:{}),overrides:Object.assign(Object.assign({},c?c.overrides:{}),s?s.rawOptions:{})}}(e,t,n,r);return i&&(t[e]=i),i}function ha(e){return gr(e,fa)}function fa(e){let t="function"===typeof e?{component:e}:e,{component:n}=t;return t.content?n=pa(t):!n||n.prototype instanceof Pr||(n=pa(Object.assign(Object.assign({},t),{content:n}))),{superType:t.type,component:n,rawOptions:t}}function pa(e){return t=>be(Rr.Consumer,null,n=>be(Vr,{elTag:"div",elClasses:$r(n.viewSpec),renderProps:Object.assign(Object.assign({},t),{nextDayThreshold:n.options.nextDayThreshold}),generatorName:void 0,customGenerator:e.content,classNameGenerator:e.classNames,didMount:e.didMount,willUnmount:e.willUnmount}))}function ga(e,t,n,r){let i=ha(e),s=ha(t.views),o=function(e,t){let n,r={};for(n in e)da(n,r,e,t);for(n in t)da(n,r,e,t);return r}(i,s);return gr(o,e=>function(e,t,n,r,i){let s=e.overrides.duration||e.defaults.duration||r.duration||n.duration,o=null,a="",l="",c={};if(s&&(o=function(e){let t=JSON.stringify(e),n=ma[t];void 0===n&&(n=hn(e),ma[t]=n);return n}(s),o)){let e=yn(o);a=e.unit,1===e.value&&(l=a,c=t[a]?t[a].rawOptions:{})}let u=t=>{let n=t.buttonText||{},r=e.defaults.buttonTextKey;return null!=r&&null!=n[r]?n[r]:null!=n[e.type]?n[e.type]:null!=n[l]?n[l]:null},d=t=>{let n=t.buttonHints||{},r=e.defaults.buttonTextKey;return null!=r&&null!=n[r]?n[r]:null!=n[e.type]?n[e.type]:null!=n[l]?n[l]:null};return{type:e.type,component:e.component,duration:o,durationUnit:a,singleUnit:l,optionDefaults:e.defaults,optionOverrides:Object.assign(Object.assign({},c),e.overrides),buttonTextOverride:u(r)||u(n)||e.overrides.buttonText,buttonTextDefault:u(i)||e.defaults.buttonText||u(nr)||e.type,buttonTitleOverride:d(r)||d(n)||e.overrides.buttonHint,buttonTitleDefault:d(i)||e.defaults.buttonHint||d(nr)}}(e,s,t,n,r))}ua.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"},ua.prototype.baseIconClass="fc-icon",ua.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"},ua.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"},ua.prototype.iconOverrideOption="buttonIcons",ua.prototype.iconOverrideCustomButtonOption="icon",ua.prototype.iconOverridePrefix="fc-icon-";let ma={};function va(e,t,n){let r=t?t.activeRange:null;return wa({},function(e,t){let n=Ti(t),r=[].concat(e.eventSources||[]),i=[];e.initialEvents&&r.unshift(e.initialEvents);e.events&&r.unshift(e.events);for(let s of r){let e=xi(s,t,n);e&&i.push(e)}return i}(e,n),r,n)}function ya(e,t,n,r){let i=n?n.activeRange:null;switch(t.type){case"ADD_EVENT_SOURCES":return wa(e,t.sources,i,r);case"REMOVE_EVENT_SOURCE":return s=e,o=t.sourceId,pr(s,e=>e.sourceId!==o);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return n?Sa(e,i,r):e;case"FETCH_EVENT_SOURCES":return Ea(e,t.sourceIds?mr(t.sourceIds):Ca(e,r),i,t.isRefetch||!1,r);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return function(e,t,n,r){let i=e[t];if(i&&n===i.latestFetchId)return Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},i),{isFetching:!1,fetchRange:r})});return e}(e,t.sourceId,t.fetchId,t.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return e}var s,o}function ba(e){for(let t in e)if(e[t].isFetching)return!0;return!1}function wa(e,t,n,r){let i={};for(let s of t)i[s.sourceId]=s;return n&&(i=Sa(i,n,r)),Object.assign(Object.assign({},e),i)}function Sa(e,t,n){return Ea(e,pr(e,e=>function(e,t,n){if(!xa(e,n))return!e.latestFetchId;return!n.options.lazyFetching||!e.fetchRange||e.isFetching||t.start<e.fetchRange.start||t.end>e.fetchRange.end}(e,t,n)),t,!1,n)}function Ea(e,t,n,r,i){let s={};for(let o in e){let a=e[o];t[o]?s[o]=_a(a,n,r,i):s[o]=a}return s}function _a(e,t,n,r){let{options:i,calendarApi:s}=r,o=r.pluginHooks.eventSourceDefs[e.sourceDefId],a=en();return o.fetch({eventSource:e,range:t,isRefetch:n,context:r},n=>{let{rawEvents:o}=n;i.eventSourceSuccess&&(o=i.eventSourceSuccess.call(s,o,n.response)||o),e.success&&(o=e.success.call(s,o,n.response)||o),r.dispatch({type:"RECEIVE_EVENTS",sourceId:e.sourceId,fetchId:a,fetchRange:t,rawEvents:o})},n=>{let o=!1;i.eventSourceFailure&&(i.eventSourceFailure.call(s,n),o=!0),e.failure&&(e.failure(n),o=!0),o||console.warn(n.message,n),r.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:e.sourceId,fetchId:a,fetchRange:t,error:n})}),Object.assign(Object.assign({},e),{isFetching:!0,latestFetchId:a})}function Ca(e,t){return pr(e,e=>xa(e,t))}function xa(e,t){return!t.pluginHooks.eventSourceDefs[e.sourceDefId].ignoreRange}function Ta(e,t){switch(t.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return t.selection;default:return e}}function Ia(e,t){switch(t.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return t.eventInstanceId;default:return e}}function Da(e,t){let n;switch(t.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return n=t.state,{affectedEvents:n.affectedEvents,mutatedEvents:n.mutatedEvents,isEvent:n.isEvent};default:return e}}function Aa(e,t){let n;switch(t.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return n=t.state,{affectedEvents:n.affectedEvents,mutatedEvents:n.mutatedEvents,isEvent:n.isEvent};default:return e}}function ka(e,t,n,r,i){return{header:e.headerToolbar?Na(e.headerToolbar,e,t,n,r,i):null,footer:e.footerToolbar?Na(e.footerToolbar,e,t,n,r,i):null}}function Na(e,t,n,r,i,s){let o={},a=[],l=!1;for(let c in e){let u=Ra(e[c],t,n,r,i,s);o[c]=u.widgets,a.push(...u.viewsWithButtons),l=l||u.hasTitle}return{sectionWidgets:o,viewsWithButtons:a,hasTitle:l}}function Ra(e,t,n,r,i,s){let o="rtl"===t.direction,a=t.customButtons||{},l=n.buttonText||{},c=t.buttonText||{},u=n.buttonHints||{},d=t.buttonHints||{},h=e?e.split(" "):[],f=[],p=!1;return{widgets:h.map(e=>e.split(",").map(e=>{if("title"===e)return p=!0,{buttonName:e};let n,h,g,m,v,y;if(n=a[e])g=e=>{n.click&&n.click.call(e.target,e,e.target)},(m=r.getCustomButtonIconClass(n))||(m=r.getIconClass(e,o))||(v=n.text),y=n.hint||n.text;else if(h=i[e]){f.push(e),g=()=>{s.changeView(e)},(v=h.buttonTextOverride)||(m=r.getIconClass(e,o))||(v=h.buttonTextDefault);let n=h.buttonTextOverride||h.buttonTextDefault;y=on(h.buttonTitleOverride||h.buttonTitleDefault||t.viewHint,[n,e],n)}else if(s[e])if(g=()=>{s[e]()},(v=l[e])||(m=r.getIconClass(e,o))||(v=c[e]),"prevYear"===e||"nextYear"===e){let t="prevYear"===e?"prev":"next";y=on(u[t]||d[t],[c.year||"year","year"],c[e])}else y=t=>on(u[e]||d[e],[c[t]||t,t],c[e]);return{buttonName:e,buttonClick:g,buttonIcon:m,buttonText:v,buttonHint:y}})),viewsWithButtons:f,hasTitle:p}}class Ma{constructor(e,t,n){this.type=e,this.getCurrentData=t,this.dateEnv=n}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}}const Oa={daysOfWeek:dr,startTime:hn,endTime:hn,duration:hn,startRecur:dr,endRecur:dr};function Pa(e,t){let n=vr(t.getCurrentData().eventSources);if(1===n.length&&1===e.length&&Array.isArray(n[0]._raw)&&Array.isArray(e[0]))return void t.dispatch({type:"RESET_RAW_EVENTS",sourceId:n[0].sourceId,rawEvents:e[0]});let r=[];for(let i of e){let e=!1;for(let t=0;t<n.length;t+=1)if(n[t]._raw===i){n.splice(t,1),e=!0;break}e||r.push(i)}for(let i of n)t.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:i.sourceId});for(let i of r)t.calendarApi.addEventSource(i)}const La=[oa({name:"array-event-source",eventSourceDefs:[{ignoreRange:!0,parseMeta:e=>Array.isArray(e.events)?e.events:null,fetch(e,t){t({rawEvents:e.eventSource.meta})}}]}),oa({name:"func-event-source",eventSourceDefs:[{parseMeta:e=>"function"===typeof e.events?e.events:null,fetch(e,t,n){const{dateEnv:r}=e.context;!function(e,t,n){let r=!1,i=function(e){r||(r=!0,t(e))},s=function(e){r||(r=!0,n(e))},o=e(i,s);o&&"function"===typeof o.then&&o.then(i,s)}(e.eventSource.meta.bind(null,ls(e.range,r)),e=>t({rawEvents:e}),n)}}]}),oa({name:"json-event-source",eventSourceRefiners:{method:String,extraParams:dr,startParam:String,endParam:String,timeZoneParam:String},eventSourceDefs:[{parseMeta:e=>!e.url||"json"!==e.format&&e.format?null:{url:e.url,format:"json",method:(e.method||"GET").toUpperCase(),extraParams:e.extraParams,startParam:e.startParam,endParam:e.endParam,timeZoneParam:e.timeZoneParam},fetch(e,t,n){const{meta:r}=e.eventSource,i=function(e,t,n){let r,i,s,o,{dateEnv:a,options:l}=n,c={};r=e.startParam,null==r&&(r=l.startParam);i=e.endParam,null==i&&(i=l.endParam);s=e.timeZoneParam,null==s&&(s=l.timeZoneParam);o="function"===typeof e.extraParams?e.extraParams():e.extraParams||{};Object.assign(c,o),c[r]=a.formatIso(t.start),c[i]=a.formatIso(t.end),"local"!==a.timeZone&&(c[s]=a.timeZone);return c}(r,e.range,e.context);(function(e,t,n){const r={method:e=e.toUpperCase()};return"GET"===e?t+=(-1===t.indexOf("?")?"?":"&")+new URLSearchParams(n):(r.body=new URLSearchParams(n),r.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(t,r).then(e=>{if(e.ok)return e.json().then(t=>[t,e],()=>{throw new us("Failure parsing JSON",e)});throw new us("Request failed",e)})})(r.method,r.url,i).then(e=>{let[n,r]=e;t({rawEvents:n,response:r})},n)}}]}),oa({name:"simple-recurring-event",recurringTypes:[{parse(e,t){if(e.daysOfWeek||e.startTime||e.endTime||e.startRecur||e.endRecur){let i,s={daysOfWeek:e.daysOfWeek||null,startTime:e.startTime||null,endTime:e.endTime||null,startRecur:e.startRecur?t.createMarker(e.startRecur):null,endRecur:e.endRecur?t.createMarker(e.endRecur):null,dateEnv:t};return e.duration&&(i=e.duration),!i&&e.startTime&&e.endTime&&(n=e.endTime,r=e.startTime,i={years:n.years-r.years,months:n.months-r.months,days:n.days-r.days,milliseconds:n.milliseconds-r.milliseconds}),{allDayGuess:Boolean(!e.startTime&&!e.endTime),duration:i,typeData:s}}var n,r;return null},expand(e,t,n){let r=Qr(t,{start:e.startRecur,end:e.endRecur});return r?function(e,t,n,r,i){let s=e?mr(e):null,o=Tn(i.start),a=i.end,l=[];t&&(t.milliseconds<0?a=En(a,1):t.milliseconds>=864e5&&(o=En(o,-1)));for(;o<a;){let e;s&&!s[o.getUTCDay()]||(e=t?r.add(o,t):o,l.push(r.createMarker(n.toDate(e)))),o=En(o,1)}return l}(e.daysOfWeek,e.startTime,e.dateEnv,n,r):[]}}],eventRefiners:Oa}),oa({name:"change-handler",optionChangeHandlers:{events(e,t){Pa([e],t)},eventSources:Pa}}),oa({name:"misc",isLoadingFuncs:[e=>ba(e.eventSources)],propSetHandlers:{dateProfile:function(e,t){t.emitter.trigger("datesSet",Object.assign(Object.assign({},ls(e.activeRange,t.dateEnv)),{view:t.viewApi}))},eventStore:function(e,t){let{emitter:n}=t;n.hasHandlers("eventsSet")&&n.trigger("eventsSet",qi(e,t))}}})];class ja{constructor(e,t){this.runTaskOption=e,this.drainedOption=t,this.queue=[],this.delayedRunner=new Ft(this.drain.bind(this))}request(e,t){this.queue.push(e),this.delayedRunner.request(t)}pause(e){this.delayedRunner.pause(e)}resume(e,t){this.delayedRunner.resume(e,t)}drain(){let{queue:e}=this;for(;e.length;){let t,n=[];for(;t=e.shift();)this.runTask(t),n.push(t);this.drained(n)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}}function Fa(e,t,n){let r;return r=/^(year|month)$/.test(e.currentRangeUnit)?e.currentRange:e.activeRange,n.formatRange(r.start,r.end,er(t.titleFormat||function(e){let{currentRangeUnit:t}=e;if("year"===t)return{year:"numeric"};if("month"===t)return{year:"numeric",month:"long"};let n=xn(e.currentRange.start,e.currentRange.end);if(null!==n&&n>1)return{year:"numeric",month:"short",day:"numeric"};return{year:"numeric",month:"long",day:"numeric"}}(e)),{isEndExclusive:e.isRangeAllDay,defaultSeparator:t.titleRangeSeparator})}class Ua{constructor(){this.resetListeners=new Set}handleInput(e,t){const n=this.dateEnv;if(e!==n&&("function"===typeof t?this.nowFn=t:n||(this.nowAnchorDate=e.toDate(t?e.createMarker(t):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,n))for(const r of this.resetListeners.values())r()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}}class Ba{constructor(e){this.computeCurrentViewData=Un(this._computeCurrentViewData),this.organizeRawLocales=Un(ra),this.buildLocale=Un(ia),this.buildPluginHooks=aa(),this.buildDateEnv=Un(za),this.buildTheme=Un(Va),this.parseToolbars=Un(ka),this.buildViewSpecs=Un(ga),this.buildDateProfileGenerator=Bn(Ha),this.buildViewApi=Un(qa),this.buildViewUiProps=Bn(Wa),this.buildEventUiBySource=Un($a,yr),this.buildEventUiBases=Un(Ga),this.parseContextBusinessHours=Bn(Ka),this.buildTitle=Un(Fa),this.nowManager=new Ua,this.emitter=new Ri,this.actionRunner=new ja(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=e=>{this.actionRunner.request(e)},this.props=e,this.actionRunner.pause(),this.nowManager=new Ua;let t={},n=this.computeOptionsData(e.optionOverrides,t,e.calendarApi),r=n.calendarOptions.initialView||n.pluginHooks.initialView,i=this.computeCurrentViewData(r,n,e.optionOverrides,t);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(i.options);let s={nowManager:this.nowManager,dateEnv:n.dateEnv,options:n.calendarOptions,pluginHooks:n.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},o=function(e,t,n){let r=e.initialDate;return null!=r?t.createMarker(r):n.getDateMarker()}(n.calendarOptions,n.dateEnv,this.nowManager),a=i.dateProfileGenerator.build(o);Xr(a.activeRange,o)||(o=a.currentRange.start);for(let d of n.pluginHooks.contextInit)d(s);let l=va(n.calendarOptions,a,s),c={dynamicOptionOverrides:t,currentViewType:r,currentDate:o,dateProfile:a,businessHours:this.parseContextBusinessHours(s),eventSources:l,eventUiBases:{},eventStore:{defs:{},instances:{}},renderableEventStore:{defs:{},instances:{}},dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(s).selectionConfig},u=Object.assign(Object.assign({},s),c);for(let d of n.pluginHooks.reducers)Object.assign(c,d(null,null,u));Qa(c,s)&&this.emitter.trigger("loading",!0),this.state=c,this.updateData(),this.actionRunner.resume()}resetOptions(e,t){let{props:n}=this;void 0===t?n.optionOverrides=e:(n.optionOverrides=Object.assign(Object.assign({},n.optionOverrides||{}),e),this.optionsForRefining.push(...t)),(void 0===t||t.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:t,state:n,emitter:r}=this,i=function(e,t){return"SET_OPTION"===t.type?Object.assign(Object.assign({},e),{[t.optionName]:t.rawOptionValue}):e}(n.dynamicOptionOverrides,e),s=this.computeOptionsData(t.optionOverrides,i,t.calendarApi),o=function(e,t){"CHANGE_VIEW_TYPE"===t.type&&(e=t.viewType);return e}(n.currentViewType,e),a=this.computeCurrentViewData(o,s,t.optionOverrides,i);t.calendarApi.currentDataManager=this,r.setThisContext(t.calendarApi),r.setOptions(a.options);let l={nowManager:this.nowManager,dateEnv:s.dateEnv,options:s.calendarOptions,pluginHooks:s.pluginHooks,calendarApi:t.calendarApi,dispatch:this.dispatch,emitter:r,getCurrentData:this.getCurrentData},{currentDate:c,dateProfile:u}=n;this.data&&this.data.dateProfileGenerator!==a.dateProfileGenerator&&(u=a.dateProfileGenerator.build(c)),c=function(e,t){return"CHANGE_DATE"===t.type?t.dateMarker:e}(c,e),u=function(e,t,n,r){let i;switch(t.type){case"CHANGE_VIEW_TYPE":return r.build(t.dateMarker||n);case"CHANGE_DATE":return r.build(t.dateMarker);case"PREV":if(i=r.buildPrev(e,n),i.isValid)return i;break;case"NEXT":if(i=r.buildNext(e,n),i.isValid)return i}return e}(u,e,c,a.dateProfileGenerator),"PREV"!==e.type&&"NEXT"!==e.type&&Xr(u.currentRange,c)||(c=u.currentRange.start);let d=ya(n.eventSources,e,u,l),h=Ii(n.eventStore,e,d,u,l),f=ba(d)&&!a.options.progressiveEventRendering&&n.renderableEventStore||h,{eventUiSingleBase:p,selectionConfig:g}=this.buildViewUiProps(l),m=this.buildEventUiBySource(d),v={dynamicOptionOverrides:i,currentViewType:o,currentDate:c,dateProfile:u,eventSources:d,eventStore:h,renderableEventStore:f,selectionConfig:g,eventUiBases:this.buildEventUiBases(f.defs,p,m),businessHours:this.parseContextBusinessHours(l),dateSelection:Ta(n.dateSelection,e),eventSelection:Ia(n.eventSelection,e),eventDrag:Da(n.eventDrag,e),eventResize:Aa(n.eventResize,e)},y=Object.assign(Object.assign({},l),v);for(let S of s.pluginHooks.reducers)Object.assign(v,S(n,e,y));let b=Qa(n,l),w=Qa(v,l);!b&&w?r.trigger("loading",!0):b&&!w&&r.trigger("loading",!1),this.state=v,t.onAction&&t.onAction(e)}updateData(){let{props:e,state:t}=this,n=this.data,r=this.computeOptionsData(e.optionOverrides,t.dynamicOptionOverrides,e.calendarApi),i=this.computeCurrentViewData(t.currentViewType,r,e.optionOverrides,t.dynamicOptionOverrides),s=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(t.dateProfile,i.options,r.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},r),i),t),o=r.pluginHooks.optionChangeHandlers,a=n&&n.calendarOptions,l=r.calendarOptions;if(a&&a!==l){a.timeZone!==l.timeZone&&(t.eventSources=s.eventSources=function(e,t,n){let r=t?t.activeRange:null;return Ea(e,Ca(e,n),r,!0,n)}(s.eventSources,t.dateProfile,s),t.eventStore=s.eventStore=ki(s.eventStore,n.dateEnv,s.dateEnv),t.renderableEventStore=s.renderableEventStore=ki(s.renderableEventStore,n.dateEnv,s.dateEnv));for(let e in o)-1===this.optionsForHandling.indexOf(e)&&a[e]===l[e]||o[e](l[e],s)}this.optionsForHandling=[],e.onData&&e.onData(s)}computeOptionsData(e,t,n){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&t===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:r,pluginHooks:i,localeDefaults:s,availableLocaleData:o,extra:a}=this.processRawCalendarOptions(e,t);Ya(a);let l=this.buildDateEnv(r.timeZone,r.locale,r.weekNumberCalculation,r.firstDay,r.weekText,i,o,r.defaultRangeSeparator),c=this.buildViewSpecs(i.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,s),u=this.buildTheme(r,i),d=this.parseToolbars(r,this.stableOptionOverrides,u,c,n);return this.stableCalendarOptionsData={calendarOptions:r,pluginHooks:i,dateEnv:l,viewSpecs:c,theme:u,toolbarConfig:d,localeDefaults:s,availableRawLocales:o.map}}processRawCalendarOptions(e,t){let{locales:n,locale:r}=cr([nr,e,t]),i=this.organizeRawLocales(n),s=i.map,o=this.buildLocale(r||i.defaultCode,s).options,a=this.buildPluginHooks(e.plugins||[],La),l=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},tr),rr),ir),a.listenerRefiners),a.optionRefiners),c={},u=cr([nr,o,e,t]),d={},h=this.currentCalendarOptionsInput,f=this.currentCalendarOptionsRefined,p=!1;for(let g in u)-1===this.optionsForRefining.indexOf(g)&&(u[g]===h[g]||sr[g]&&g in h&&sr[g](h[g],u[g]))?d[g]=f[g]:l[g]?(d[g]=l[g](u[g]),p=!0):c[g]=h[g];return p&&(this.currentCalendarOptionsInput=u,this.currentCalendarOptionsRefined=d,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=t),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:a,availableLocaleData:i,localeDefaults:o,extra:c}}_computeCurrentViewData(e,t,n,r){let i=t.viewSpecs[e];if(!i)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:s,extra:o}=this.processRawViewOptions(i,t.pluginHooks,t.localeDefaults,n,r);return Ya(o),this.nowManager.handleInput(t.dateEnv,s.now),{viewSpec:i,options:s,dateProfileGenerator:this.buildDateProfileGenerator({dateProfileGeneratorClass:i.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:i.duration,durationUnit:i.durationUnit,usesMinMaxTime:i.optionDefaults.usesMinMaxTime,dateEnv:t.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:s.slotMinTime,slotMaxTime:s.slotMaxTime,showNonCurrentDates:s.showNonCurrentDates,dayCount:s.dayCount,dateAlignment:s.dateAlignment,dateIncrement:s.dateIncrement,hiddenDays:s.hiddenDays,weekends:s.weekends,validRangeInput:s.validRange,visibleRangeInput:s.visibleRange,fixedWeekCount:s.fixedWeekCount}),viewApi:this.buildViewApi(e,this.getCurrentData,t.dateEnv)}}processRawViewOptions(e,t,n,r,i){let s=cr([nr,e.optionDefaults,n,r,e.optionOverrides,i]),o=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},tr),rr),ir),lr),t.listenerRefiners),t.optionRefiners),a={},l=this.currentViewOptionsInput,c=this.currentViewOptionsRefined,u=!1,d={};for(let h in s)s[h]===l[h]||sr[h]&&sr[h](s[h],l[h])?a[h]=c[h]:(s[h]===this.currentCalendarOptionsInput[h]||sr[h]&&sr[h](s[h],this.currentCalendarOptionsInput[h])?h in this.currentCalendarOptionsRefined&&(a[h]=this.currentCalendarOptionsRefined[h]):o[h]?a[h]=o[h](s[h]):d[h]=s[h],u=!0);return u&&(this.currentViewOptionsInput=s,this.currentViewOptionsRefined=a),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:d}}}function za(e,t,n,r,i,s,o,a){let l=ia(t||o.defaultCode,o.map);return new Tr({calendarSystem:"gregory",timeZone:e,namedTimeZoneImpl:s.namedTimeZonedImpl,locale:l,weekNumberCalculation:n,firstDay:r,weekText:i,cmdFormatter:s.cmdFormatter,defaultSeparator:a})}function Va(e,t){return new(t.themeClasses[e.themeSystem]||ua)(e)}function Ha(e){return new(e.dateProfileGeneratorClass||ti)(e)}function qa(e,t,n){return new Ma(e,t,n)}function $a(e){return gr(e,e=>e.ui)}function Ga(e,t,n){let r={"":t};for(let i in e){let t=e[i];t.sourceId&&n[t.sourceId]&&(r[i]=n[t.sourceId])}return r}function Wa(e){let{options:t}=e;return{eventUiSingleBase:Si({display:t.eventDisplay,editable:t.editable,startEditable:t.eventStartEditable,durationEditable:t.eventDurationEditable,constraint:t.eventConstraint,overlap:"boolean"===typeof t.eventOverlap?t.eventOverlap:void 0,allow:t.eventAllow,backgroundColor:t.eventBackgroundColor,borderColor:t.eventBorderColor,textColor:t.eventTextColor,color:t.eventColor},e),selectionConfig:Si({constraint:t.selectConstraint,overlap:"boolean"===typeof t.selectOverlap?t.selectOverlap:void 0,allow:t.selectAllow},e)}}function Qa(e,t){for(let n of t.pluginHooks.isLoadingFuncs)if(n(e))return!0;return!1}function Ka(e){return Oi(e.options.businessHours,e)}function Ya(e,t){for(let n in e)console.warn(`Unknown option '${n}'`+(t?` for view '${t}'`:""))}class Xa extends Pr{render(){return be("div",{className:"fc-toolbar-chunk"},...this.props.widgetGroups.map(e=>this.renderWidgetGroup(e)))}renderWidgetGroup(e){let{props:t}=this,{theme:n}=this.context,r=[],i=!0;for(let s of e){let{buttonName:e,buttonClick:o,buttonText:a,buttonIcon:l,buttonHint:c}=s;if("title"===e)i=!1,r.push(be("h2",{className:"fc-toolbar-title",id:t.titleId},t.title));else{let i=e===t.activeButton,s=!t.isTodayEnabled&&"today"===e||!t.isPrevEnabled&&"prev"===e||!t.isNextEnabled&&"next"===e,u=[`fc-${e}-button`,n.getClass("button")];i&&u.push(n.getClass("buttonActive")),r.push(be("button",{type:"button",title:"function"===typeof c?c(t.navUnit):c,disabled:s,"aria-pressed":i,className:u.join(" "),onClick:o},a||(l?be("span",{className:l,role:"img"}):"")))}}if(r.length>1){return be("div",{className:i&&n.getClass("buttonGroup")||""},...r)}return r[0]}}class Ja extends Pr{render(){let e,t,{model:n,extraClassName:r}=this.props,i=!1,s=n.sectionWidgets,o=s.center;return s.left?(i=!0,e=s.left):e=s.start,s.right?(i=!0,t=s.right):t=s.end,be("div",{className:[r||"","fc-toolbar",i?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",e||[]),this.renderSection("center",o||[]),this.renderSection("end",t||[]))}renderSection(e,t){let{props:n}=this;return be(Xa,{key:e,widgetGroups:t,title:n.title,navUnit:n.navUnit,activeButton:n.activeButton,isTodayEnabled:n.isTodayEnabled,isPrevEnabled:n.isPrevEnabled,isNextEnabled:n.isNextEnabled,titleId:n.titleId})}}class Za extends Pr{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,Lr(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:t}=this,{aspectRatio:n}=e,r=["fc-view-harness",n||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],i="",s="";return n?null!==t.availableWidth?i=t.availableWidth/n:s=1/n*100+"%":i=e.height||"",be("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:r.join(" "),style:{height:i,paddingBottom:s}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}}class el extends ps{constructor(e){super(e),this.handleSegClick=(e,t)=>{let{component:n}=this,{context:r}=n,i=Wi(t);if(i&&n.isValidSegDownEl(e.target)){let s=Bt(e.target,".fc-event-forced-url"),o=s?s.querySelector("a[href]").href:"";r.emitter.trigger("eventClick",{el:t,event:new Vi(n.context,i.eventRange.def,i.eventRange.instance),jsEvent:e,view:r.viewApi}),o&&!e.defaultPrevented&&(window.location.href=o)}},this.destroy=Kt(e.el,"click",".fc-event",this.handleSegClick)}}class tl extends ps{constructor(e){super(e),this.handleEventElRemove=e=>{e===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(e,t)=>{Wi(t)&&(this.currentSegEl=t,this.triggerEvent("eventMouseEnter",e,t))},this.handleSegLeave=(e,t)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",e,t))},this.removeHoverListeners=function(e,t,n,r){let i;return Kt(e,"mouseover",t,(e,t)=>{if(t!==i){i=t,n(e,t);let s=e=>{i=null,r(e,t),t.removeEventListener("mouseleave",s)};t.addEventListener("mouseleave",s)}})}(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,t,n){let{component:r}=this,{context:i}=r,s=Wi(n);t&&!r.isValidSegDownEl(t.target)||i.emitter.trigger(e,{el:n,event:new Vi(i,s.eventRange.def,s.eventRange.instance),jsEvent:t,view:i.viewApi})}}class nl extends Or{constructor(){super(...arguments),this.buildViewContext=Un(Mr),this.buildViewPropTransformers=Un(il),this.buildToolbarProps=Un(rl),this.headerRef={current:null},this.footerRef={current:null},this.interactionsStore={},this.state={viewLabelId:Wt()},this.registerInteractiveComponent=(e,t)=>{let n=function(e,t){return{component:e,el:t.el,useEventCenter:null==t.useEventCenter||t.useEventCenter,isHitComboAllowed:t.isHitComboAllowed||null}}(e,t),r=[el,tl].concat(this.props.pluginHooks.componentInteractions).map(e=>new e(n));this.interactionsStore[e.uid]=r,ms[e.uid]=n},this.unregisterInteractiveComponent=e=>{let t=this.interactionsStore[e.uid];if(t){for(let e of t)e.destroy();delete this.interactionsStore[e.uid]}delete ms[e.uid]},this.resizeRunner=new Ft(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:t}=this.props;t.handleWindowResize&&e.target===window&&this.resizeRunner.request(t.windowResizeDelay)}}render(){let e,{props:t}=this,{toolbarConfig:n,options:r}=t,i=!1,s="";t.isHeightAuto||t.forPrint?s="":null!=r.height?i=!0:null!=r.contentHeight?s=r.contentHeight:e=Math.max(r.aspectRatio,.5);let o=this.buildViewContext(t.viewSpec,t.viewApi,t.options,t.dateProfileGenerator,t.dateEnv,t.nowManager,t.theme,t.pluginHooks,t.dispatch,t.getCurrentData,t.emitter,t.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),a=n.header&&n.header.hasTitle?this.state.viewLabelId:void 0;return be(Rr.Provider,{value:o},be(vs,{unit:"day"},r=>{let o=this.buildToolbarProps(t.viewSpec,t.dateProfile,t.dateProfileGenerator,t.currentDate,r,t.viewTitle);return be(Se,null,n.header&&be(Ja,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:n.header,titleId:a},o)),be(Za,{liquid:i,height:s,aspectRatio:e,labeledById:a},this.renderView(t),this.buildAppendContent()),n.footer&&be(Ja,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:n.footer,titleId:""},o)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(t=>new t(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:t}=e.pluginHooks;for(let n in t)t[n](e[n],e)}componentDidUpdate(e){let{props:t}=this,{propSetHandlers:n}=t.pluginHooks;for(let r in n)t[r]!==e[r]&&n[r](t[r],t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this;return be(Se,{},...e.pluginHooks.viewContainerAppends.map(t=>t(e)))}renderView(e){let{pluginHooks:t}=e,{viewSpec:n}=e,r={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},i=this.buildViewPropTransformers(t.viewPropsTransformers);for(let s of i)Object.assign(r,s.transform(r,e));return be(n.component,Object.assign({},r))}}function rl(e,t,n,r,i,s){let o=n.build(i,void 0,!1),a=n.buildPrev(t,r,!1),l=n.buildNext(t,r,!1);return{title:s,activeButton:e.type,navUnit:e.singleUnit,isTodayEnabled:o.isValid&&!Xr(t.currentRange,i),isPrevEnabled:a.isValid,isNextEnabled:l.isValid}}function il(e){return e.map(e=>new e)}class sl extends bs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=e=>{switch(e.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=e=>{this.currentData=e,this.renderRunner.request(e.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:e}=this;Dr(()=>{He(be(fs,{options:e.calendarOptions,theme:e.theme,emitter:e.emitter},(t,n,r,i)=>(this.setClassNames(t),this.setHeight(n),be(zr.Provider,{value:this.customContentRenderId},be(nl,Object.assign({isHeightAuto:r,forPrint:i},e))))),this.el)})}else this.isRendered&&(this.isRendered=!1,He(null,this.el),this.setClassNames([]),this.setHeight(""))},function(e){e.isConnected&&e.getRootNode&&Pt(e.getRootNode())}(e),this.el=e,this.renderRunner=new Ft(this.handleRenderRequest),new Ba({optionOverrides:t,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){Dr(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,t){this.currentDataManager.resetOptions(e,t)}setClassNames(e){if(!bn(e,this.currentClassNames)){let{classList:t}=this.el;for(let e of this.currentClassNames)t.remove(e);for(let n of e)t.add(n);this.currentClassNames=e}}setHeight(e){qt(this.el,"height",e)}}const ol=parseInt(String(r.version).split(".")[0])<18;class al extends r.Component{constructor(){super(...arguments),this.elRef=(0,r.createRef)(),this.isUpdating=!1,this.isUnmounting=!1,this.state={customRenderingMap:new Map},this.requestResize=()=>{this.isUnmounting||(this.cancelResize(),this.resizeId=requestAnimationFrame(()=>{this.doResize()}))}}render(){const e=[];for(const t of this.state.customRenderingMap.values())e.push(r.createElement(ll,{key:t.id,customRendering:t}));return r.createElement("div",{ref:this.elRef},e)}componentDidMount(){this.isUnmounting=!1;const e=new Zo;let t;this.handleCustomRendering=e.handle.bind(e),this.calendar=new sl(this.elRef.current,Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.calendar.render(),this.calendar.on("_beforeprint",()=>{(0,fe.flushSync)(()=>{})}),e.subscribe(e=>{const n=Date.now(),r=!t;(ol||r||this.isUpdating||this.isUnmounting||n-t<100?cl:fe.flushSync)(()=>{this.setState({customRenderingMap:e},()=>{t=n,r?this.doResize():this.requestResize()})})})}componentDidUpdate(){this.isUpdating=!0,this.calendar.resetOptions(Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.isUpdating=!1}componentWillUnmount(){this.isUnmounting=!0,this.cancelResize(),this.calendar.destroy()}doResize(){this.calendar.updateSize()}cancelResize(){void 0!==this.resizeId&&(cancelAnimationFrame(this.resizeId),this.resizeId=void 0)}getApi(){return this.calendar}}al.act=cl;class ll extends r.PureComponent{render(){const{customRendering:e}=this.props,{generatorMeta:t}=e,n="function"===typeof t?t(e.renderProps):t;return(0,fe.createPortal)(n,e.containerEl)}}function cl(e){e()}class ul extends Hs{constructor(){super(...arguments),this.headerElRef={current:null}}renderSimpleLayout(e,t){let{props:n,context:r}=this,i=[],s=Do(r.options);return e&&i.push({type:"header",key:"header",isSticky:s,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),i.push({type:"body",key:"body",liquid:!0,chunk:{content:t}}),be(qr,{elClasses:["fc-daygrid"],viewSpec:r.viewSpec},be(ko,{liquid:!n.isHeightAuto&&!n.forPrint,collapsibleWidth:n.forPrint,cols:[],sections:i}))}renderHScrollLayout(e,t,n,r){let i=this.context.pluginHooks.scrollGridImpl;if(!i)throw new Error("No ScrollGrid implementation");let{props:s,context:o}=this,a=!s.forPrint&&Do(o.options),l=!s.forPrint&&Ao(o.options),c=[];return e&&c.push({type:"header",key:"header",isSticky:a,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),c.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:t}]}),l&&c.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:Io}]}),be(qr,{elClasses:["fc-daygrid"],viewSpec:o.viewSpec},be(i,{liquid:!s.isHeightAuto&&!s.forPrint,forPrint:s.forPrint,collapsibleWidth:s.forPrint,colGroups:[{cols:[{span:n,minWidth:r}]}],sections:c}))}}function dl(e,t){let n=[];for(let r=0;r<t;r+=1)n[r]=[];for(let r of e)n[r.row].push(r);return n}function hl(e,t){let n=[];for(let r=0;r<t;r+=1)n[r]=[];for(let r of e)n[r.firstCol].push(r);return n}function fl(e,t){let n=[];if(e){for(let r=0;r<t;r+=1)n[r]={affectedInstances:e.affectedInstances,isEvent:e.isEvent,segs:[]};for(let t of e.segs)n[t.row].segs.push(t)}else for(let r=0;r<t;r+=1)n[r]=null;return n}const pl=er({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function gl(e){let{display:t}=e.eventRange.ui;return"list-item"===t||"auto"===t&&!e.eventRange.def.allDay&&e.firstCol===e.lastCol&&e.isStart&&e.isEnd}class ml extends Pr{render(){let{props:e}=this;return be(Ro,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:pl,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class vl extends Pr{render(){let{props:e,context:t}=this,{options:n}=t,{seg:r}=e,i=ts(r,n.eventTimeFormat||pl,t,!0,e.defaultDisplayEventEnd);return be(No,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:ss(e.seg,t),defaultGenerator:yl,timeText:i,isResizing:!1,isDateSelecting:!1}))}}function yl(e){return be(Se,null,be("div",{className:"fc-daygrid-event-dot",style:{borderColor:e.borderColor||e.backgroundColor}}),e.timeText&&be("div",{className:"fc-event-time"},e.timeText),be("div",{className:"fc-event-title"},e.event.title||be(Se,null,"\xa0")))}class bl extends Pr{constructor(){super(...arguments),this.compileSegs=Un(wl)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:n}=this.compileSegs(e.singlePlacements);return be(Go,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:n,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let n=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return be(Se,null,t.map(t=>{let r=t.eventRange.instance.instanceId;return be("div",{className:"fc-daygrid-event-harness",key:r,style:{visibility:n[r]?"hidden":""}},gl(t)?be(vl,Object.assign({seg:t,isDragging:!1,isSelected:r===e.eventSelection,defaultDisplayEventEnd:!1},ns(t,e.todayRange))):be(ml,Object.assign({seg:t,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:r===e.eventSelection,defaultDisplayEventEnd:!1},ns(t,e.todayRange))))}))}})}}function wl(e){let t=[],n=[];for(let r of e)t.push(r.seg),r.isVisible||n.push(r.seg);return{allSegs:t,invisibleSegs:n}}const Sl=er({week:"narrow"});class El extends Hs{constructor(){super(...arguments),this.rootElRef={current:null},this.state={dayNumberId:Wt()},this.handleRootEl=e=>{Lr(this.rootElRef,e),Lr(this.props.elRef,e)}}render(){let{context:e,props:t,state:n,rootElRef:r}=this,{options:i,dateEnv:s}=e,{date:o,dateProfile:a}=t;const l=t.showDayNumber&&function(e,t,n){const{start:r,end:i}=t,s=_n(i,-1),o=n.getYear(r),a=n.getMonth(r),l=n.getYear(s),c=n.getMonth(s);return!(o===l&&a===c)&&Boolean(e.valueOf()===r.valueOf()||1===n.getDay(e)&&e.valueOf()<i.valueOf())}(o,a.currentRange,s);return be(Lo,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":n.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:_l,date:o,dateProfile:a,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:l,extraRenderProps:t.extraRenderProps},(s,a)=>be("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&be(Vo,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:As(e,o,"week"),date:o,defaultFormat:Sl}),!a.isDisabled&&(t.showDayNumber||jo(i)||t.forceDayTop)?be("div",{className:"fc-daygrid-day-top"},be(s,{elTag:"a",elClasses:["fc-daygrid-day-number",l&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},As(e,o)),{id:n.dayNumberId})})):t.showDayNumber?be("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},be("a",{className:"fc-daygrid-day-number"},"\xa0")):void 0,be("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,be("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},be(bl,{allDayDate:o,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:r,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),be("div",{className:"fc-daygrid-day-bg"},t.bgContent)))}}function _l(e){return e.dayNumberText||be(Se,null,"\xa0")}function Cl(e){return e.eventRange.instance.instanceId+":"+e.firstCol}function xl(e){return Cl(e)+":"+e.lastCol}function Tl(e,t,n,r,i,s,o){let a=new Dl(t=>{let n=e[t.index].eventRange.instance.instanceId+":"+t.span.start+":"+(t.span.end-1);return i[n]||1});a.allowReslicing=!0,a.strictOrder=r,!0===t||!0===n?(a.maxCoord=s,a.hiddenConsumes=!0):"number"===typeof t?a.maxStackCnt=t:"number"===typeof n&&(a.maxStackCnt=n,a.hiddenConsumes=!0);let l=[],c=[];for(let v=0;v<e.length;v+=1){let t=e[v],n=xl(t);null!=i[n]?l.push({index:v,span:{start:t.firstCol,end:t.lastCol+1}}):c.push(t)}let u=a.addSegs(l),d=a.toRects(),{singleColPlacements:h,multiColPlacements:f,leftoverMargins:p}=function(e,t,n){let r=function(e,t){let n=[];for(let r=0;r<t;r+=1)n.push([]);for(let r of e)for(let e=r.span.start;e<r.span.end;e+=1)n[e].push(r);return n}(e,n.length),i=[],s=[],o=[];for(let a=0;a<n.length;a+=1){let e=r[a],l=[],c=0,u=0;for(let r of e){let e=t[r.index];l.push({seg:Il(e,a,a+1,n),isVisible:!0,isAbsolute:!1,absoluteTop:r.levelCoord,marginTop:r.levelCoord-c}),c=r.levelCoord+r.thickness}let d=[];c=0,u=0;for(let r of e){let e=t[r.index],i=r.span.end-r.span.start>1,s=r.span.start===a;u+=r.levelCoord-c,c=r.levelCoord+r.thickness,i?(u+=r.thickness,s&&d.push({seg:Il(e,r.span.start,r.span.end,n),isVisible:!0,isAbsolute:!0,absoluteTop:r.levelCoord,marginTop:0})):s&&(d.push({seg:Il(e,r.span.start,r.span.end,n),isVisible:!0,isAbsolute:!1,absoluteTop:r.levelCoord,marginTop:u}),u=0)}i.push(l),s.push(d),o.push(u)}return{singleColPlacements:i,multiColPlacements:s,leftoverMargins:o}}(d,e,o),g=[],m=[];for(let v of c){f[v.firstCol].push({seg:v,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let e=v.firstCol;e<=v.lastCol;e+=1)h[e].push({seg:Il(v,e,e+1,o),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let v=0;v<o.length;v+=1)g.push(0);for(let v of u){let t=e[v.index],n=v.span;f[n.start].push({seg:Il(t,n.start,n.end,o),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let e=n.start;e<n.end;e+=1)g[e]+=1,h[e].push({seg:Il(t,e,e+1,o),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let v=0;v<o.length;v+=1)m.push(p[v]);return{singleColPlacements:h,multiColPlacements:f,moreCnts:g,moreMarginTops:m}}function Il(e,t,n,r){if(e.firstCol===t&&e.lastCol===n-1)return e;let i=e.eventRange,s=i.range,o=Qr(s,{start:r[t].date,end:En(r[n-1].date,1)});return Object.assign(Object.assign({},e),{firstCol:t,lastCol:n-1,eventRange:{def:i.def,ui:Object.assign(Object.assign({},i.ui),{durationEditable:!1}),instance:i.instance,range:o},isStart:e.isStart&&o.start.valueOf()===s.start.valueOf(),isEnd:e.isEnd&&o.end.valueOf()===s.end.valueOf()})}class Dl extends qs{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const t=super.addSegs(e),{entriesByLevel:n}=this,r=e=>!this.forceHidden[Gs(e)];for(let i=0;i<n.length;i+=1)n[i]=n[i].filter(r);return t}handleInvalidInsertion(e,t,n){const{entriesByLevel:r,forceHidden:i}=this,{touchingEntry:s,touchingLevel:o,touchingLateral:a}=e;if(this.hiddenConsumes&&s){const e=Gs(s);if(!i[e])if(this.allowReslicing){const e=Object.assign(Object.assign({},s),{span:Qs(s.span,t.span)});i[Gs(e)]=!0,r[o][a]=e,n.push(e),this.splitEntry(s,t,n)}else i[e]=!0,n.push(s)}super.handleInvalidInsertion(e,t,n)}}class Al extends Hs{constructor(){super(...arguments),this.cellElRefs=new wo,this.frameElRefs=new wo,this.fgElRefs=new wo,this.segHarnessRefs=new wo,this.rootElRef={current:null},this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:n}=this,{options:r}=n,i=e.cells.length,s=hl(e.businessHourSegs,i),o=hl(e.bgEventSegs,i),a=hl(this.getHighlightSegs(),i),l=hl(this.getMirrorSegs(),i),{singleColPlacements:c,multiColPlacements:u,moreCnts:d,moreMarginTops:h}=Tl(Yi(e.fgEventSegs,r.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,r.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),f=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return be("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((t,n)=>{let r=this.renderFgSegs(n,e.forPrint?c[n]:u[n],e.todayRange,f),i=this.renderFgSegs(n,function(e,t){if(!e.length)return[];let n=function(e){let t={};for(let n of e)for(let e of n)t[e.seg.eventRange.instance.instanceId]=e.absoluteTop;return t}(t);return e.map(e=>({seg:e,isVisible:!0,isAbsolute:!0,absoluteTop:n[e.eventRange.instance.instanceId],marginTop:0}))}(l[n],u),e.todayRange,{},Boolean(e.eventDrag),Boolean(e.eventResize),!1);return be(El,{key:t.key,elRef:this.cellElRefs.createRef(t.key),innerElRef:this.frameElRefs.createRef(t.key),dateProfile:e.dateProfile,date:t.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&0===n,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:t.extraRenderProps,extraDataAttrs:t.extraDataAttrs,extraClassNames:t.extraClassNames,extraDateSpan:t.extraDateSpan,moreCnt:d[n],moreMarginTop:h[n],singlePlacements:c[n],fgContentElRef:this.fgElRefs.createRef(t.key),fgContent:be(Se,null,be(Se,null,r),be(Se,null,i)),bgContent:be(Se,null,this.renderFillSegs(a[n],"highlight"),this.renderFillSegs(s[n],"non-business"),this.renderFillSegs(o[n],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let n=this.props;this.updateSizing(!yr(e,n))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,n,r,i,s,o){let{context:a}=this,{eventSelection:l}=this.props,{framePositions:c}=this.state,u=1===this.props.cells.length,d=i||s||o,h=[];if(c)for(let f of t){let{seg:e}=f,{instanceId:t}=e.eventRange.instance,p=f.isVisible&&!r[t],g=f.isAbsolute,m="",v="";g&&(a.isRtl?(v=0,m=c.lefts[e.lastCol]-c.lefts[e.firstCol]):(m=0,v=c.rights[e.firstCol]-c.rights[e.lastCol])),h.push(be("div",{className:"fc-daygrid-event-harness"+(g?" fc-daygrid-event-harness-abs":""),key:Cl(e),ref:d?null:this.segHarnessRefs.createRef(xl(e)),style:{visibility:p?"":"hidden",marginTop:g?"":f.marginTop,top:g?f.absoluteTop:"",left:m,right:v}},gl(e)?be(vl,Object.assign({seg:e,isDragging:i,isSelected:t===l,defaultDisplayEventEnd:u},ns(e,n))):be(ml,Object.assign({seg:e,isDragging:i,isResizing:s,isDateSelecting:o,isSelected:t===l,defaultDisplayEventEnd:u},ns(e,n)))))}return h}renderFillSegs(e,t){let{isRtl:n}=this.context,{todayRange:r}=this.props,{framePositions:i}=this.state,s=[];if(i)for(let o of e){let e=n?{right:0,left:i.lefts[o.lastCol]-i.lefts[o.firstCol]}:{left:0,right:i.rights[o.firstCol]-i.rights[o.lastCol]};s.push(be("div",{key:is(o.eventRange),className:"fc-daygrid-bg-harness",style:e},"bg-event"===t?be(Uo,Object.assign({seg:o},ns(o,r))):zo(t)))}return be(Se,{},...s)}updateSizing(e){let{props:t,state:n,frameElRefs:r}=this;if(!t.forPrint&&null!==t.clientWidth){if(e){let e=t.cells.map(e=>r.currentMap[e.key]);if(e.length){let t=this.rootElRef.current,r=new Fs(t,e,!0,!1);n.framePositions&&n.framePositions.similarTo(r)||this.setState({framePositions:new Fs(t,e,!0,!1)})}}const i=this.state.segHeights,s=this.querySegHeights(),o=!0===t.dayMaxEvents||!0===t.dayMaxEventRows;this.safeSetState({segHeights:Object.assign(Object.assign({},i),s),maxContentHeight:o?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let n in e){let r=Math.round(e[n].getBoundingClientRect().height);t[n]=Math.max(t[n]||0,r)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],n=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-n.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(t=>e[t.key])}}Al.addStateEquality({segHeights:yr});class kl extends Hs{constructor(){super(...arguments),this.splitBusinessHourSegs=Un(dl),this.splitBgEventSegs=Un(Nl),this.splitFgEventSegs=Un(dl),this.splitDateSelectionSegs=Un(dl),this.splitEventDrag=Un(fl),this.splitEventResize=Un(fl),this.rowRefs=new wo}render(){let{props:e,context:t}=this,n=e.cells.length,r=this.splitBusinessHourSegs(e.businessHourSegs,n),i=this.splitBgEventSegs(e.bgEventSegs,n),s=this.splitFgEventSegs(e.fgEventSegs,n),o=this.splitDateSelectionSegs(e.dateSelectionSegs,n),a=this.splitEventDrag(e.eventDrag,n),l=this.splitEventResize(e.eventResize,n),c=n>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return be(vs,{unit:"day"},(t,u)=>be(Se,null,e.cells.map((t,d)=>be(Al,{ref:this.rowRefs.createRef(d),key:t.length?t[0].date.toISOString():d,showDayNumbers:n>1,showWeekNumbers:e.showWeekNumbers,todayRange:u,dateProfile:e.dateProfile,cells:t,renderIntro:e.renderRowIntro,businessHourSegs:r[d],eventSelection:e.eventSelection,bgEventSegs:i[d],fgEventSegs:s[d],dateSelectionSegs:o[d],eventDrag:a[d],eventResize:l[d],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:c,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new Fs(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new Fs(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:n,rowPositions:r}=this,i=n.leftToIndex(e),s=r.topToIndex(t);if(null!=s&&null!=i){let e=this.props.cells[s][i];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(s,i),allDay:!0},e.extraDateSpan),dayEl:this.getCellEl(s,i),rect:{left:n.lefts[i],right:n.rights[i],top:r.tops[s],bottom:r.bottoms[s]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let n=this.props.cells[e][t].date;return{start:n,end:En(n,1)}}}function Nl(e,t){return dl(e.filter(Rl),t)}function Rl(e){return e.eventRange.def.allDay}class Ml extends Hs{constructor(){super(...arguments),this.elRef={current:null},this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:n,expandRows:r}=e,i=!0===n||!0===t;i&&!r&&(i=!1,t=null,n=null);let s=["fc-daygrid-body",i?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",r?"":"fc-daygrid-body-natural"];return be("div",{ref:this.elRef,className:s.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},be("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:r?e.clientHeight:""}},e.colGroupNode,be("tbody",{role:"presentation"},be(kl,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:n,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=function(e,t){let n;t.currentRangeUnit.match(/year|month/)&&(n=e.querySelector(`[data-date="${r=t.currentDate,r.toISOString().match(/^\d{4}-\d{2}/)[0]}-01"]`));var r;n||(n=e.querySelector(`[data-date="${Ln(t.currentDate)}"]`));return n}(this.elRef.current,this.props.dateProfile);if(e){const t=e.closest(".fc-daygrid-body"),n=t.closest(".fc-scroller"),r=e.getBoundingClientRect().top-t.getBoundingClientRect().top;n.scrollTop=r?r+1:0}this.needsScrollReset=!1}}}class Ol extends lo{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}}class Pl extends Hs{constructor(){super(...arguments),this.slicer=new Ol,this.tableRef={current:null}}render(){let{props:e,context:t}=this;return be(Ml,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}function Ll(e,t){let n=new oo(e.renderRange,t);return new ao(n,/year|month|week/.test(e.currentRangeUnit))}Ot(':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}');var jl=oa({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:class extends ul{constructor(){super(...arguments),this.buildDayTableModel=Un(Ll),this.headerRef={current:null},this.tableRef={current:null}}render(){let{options:e,dateProfileGenerator:t}=this.context,{props:n}=this,r=this.buildDayTableModel(n.dateProfile,t),i=e.dayHeaders&&be(io,{ref:this.headerRef,dateProfile:n.dateProfile,dates:r.headerDates,datesRepDistinctDays:1===r.rowCnt}),s=t=>be(Pl,{ref:this.tableRef,dateProfile:n.dateProfile,dayTableModel:r,businessHours:n.businessHours,dateSelection:n.dateSelection,eventStore:n.eventStore,eventUiBases:n.eventUiBases,eventSelection:n.eventSelection,eventDrag:n.eventDrag,eventResize:n.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:t.tableColGroupNode,tableMinWidth:t.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!n.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:n.forPrint});return e.dayMinWidth?this.renderHScrollLayout(i,s,r.colCnt,e.dayMinWidth):this.renderSimpleLayout(i,s)}},dateProfileGeneratorClass:class extends ti{buildRenderRange(e,t,n){let r=super.buildRenderRange(e,t,n),{props:i}=this;return function(e){let t,{dateEnv:n,currentRange:r}=e,{start:i,end:s}=r;e.snapToWeek&&(i=n.startOfWeek(i),t=n.startOfWeek(s),t.valueOf()!==s.valueOf()&&(s=Sn(t,1)));if(e.fixedWeekCount){let e=n.startOfWeek(n.startOfMonth(En(r.end,-1)));s=Sn(s,6-Math.ceil(Cn(e,s)/7))}return{start:i,end:s}}({currentRange:r,snapToWeek:/^(year|month)$/.test(t),fixedWeekCount:i.fixedWeekCount,dateEnv:i.dateEnv})}}},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}});class Fl extends _s{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?"background"===(t=e).ui.display||"inverse-background"===t.ui.display?["timed","allDay"]:["allDay"]:["timed"];var t}}const Ul=er({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function Bl(e){let t=["fc-timegrid-slot","fc-timegrid-slot-label",e.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return be(Rr.Consumer,null,n=>{if(!e.isLabeled)return be("td",{className:t.join(" "),"data-time":e.isoTimeStr});let{dateEnv:r,options:i,viewApi:s}=n,o=null==i.slotLabelFormat?Ul:Array.isArray(i.slotLabelFormat)?er(i.slotLabelFormat[0]):er(i.slotLabelFormat),a={level:0,time:e.time,date:r.toDate(e.date),view:s,text:r.format(e.date,o)};return be(Vr,{elTag:"td",elClasses:t,elAttrs:{"data-time":e.isoTimeStr},renderProps:a,generatorName:"slotLabelContent",customGenerator:i.slotLabelContent,defaultGenerator:zl,classNameGenerator:i.slotLabelClassNames,didMount:i.slotLabelDidMount,willUnmount:i.slotLabelWillUnmount},e=>be("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},be(e,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]})))})}function zl(e){return e.text}class Vl extends Pr{render(){return this.props.slatMetas.map(e=>be("tr",{key:e.key},be(Bl,Object.assign({},e))))}}const Hl=er({week:"short"});class ql extends Hs{constructor(){var e;super(...arguments),e=this,this.allDaySplitter=new Fl,this.headerElRef={current:null},this.rootElRef={current:null},this.scrollerElRef={current:null},this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let t=this.scrollerElRef.current;t&&(t.scrollTop=e)},this.renderHeadAxis=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",{options:r}=e.context,{dateProfile:i}=e.props,s=i.renderRange,o=1===Cn(s.start,s.end)?As(e.context,s.start,"week"):{};return r.weekNumbers&&"day"===t?be(Vo,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:s.start,defaultFormat:Hl},e=>be("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:n}},be(e,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:o}))):be("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},be("div",{className:"fc-timegrid-axis-frame",style:{height:n}}))},this.renderTableRowAxis=e=>{let{options:t,viewApi:n}=this.context,r={text:t.allDayText,view:n};return be(Vr,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:r,generatorName:"allDayContent",customGenerator:t.allDayContent,defaultGenerator:$l,classNameGenerator:t.allDayClassNames,didMount:t.allDayDidMount,willUnmount:t.allDayWillUnmount},t=>be("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",null==e?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},be(t,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]})))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,t,n){let{context:r,props:i}=this,s=[],o=Do(r.options);return e&&s.push({type:"header",key:"header",isSticky:o,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),t&&(s.push({type:"body",key:"all-day",chunk:{content:t}}),s.push({type:"body",key:"all-day-divider",outerContent:be("tr",{role:"presentation",className:"fc-scrollgrid-section"},be("td",{className:"fc-timegrid-divider "+r.theme.getClass("tableCellShaded")}))})),s.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(r.options.expandRows),chunk:{scrollerElRef:this.scrollerElRef,content:n}}),be(qr,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:r.viewSpec},be(ko,{liquid:!i.isHeightAuto&&!i.forPrint,collapsibleWidth:i.forPrint,cols:[{width:"shrink"}],sections:s}))}renderHScrollLayout(e,t,n,r,i,s,o){let a=this.context.pluginHooks.scrollGridImpl;if(!a)throw new Error("No ScrollGrid implementation");let{context:l,props:c}=this,u=!c.forPrint&&Do(l.options),d=!c.forPrint&&Ao(l.options),h=[];e&&h.push({type:"header",key:"header",isSticky:u,syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>be("tr",{role:"presentation"},this.renderHeadAxis("day",e.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),t&&(h.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>be("tr",{role:"presentation"},this.renderTableRowAxis(e.rowSyncHeights[0]))},{key:"cols",content:t}]}),h.push({key:"all-day-divider",type:"body",outerContent:be("tr",{role:"presentation",className:"fc-scrollgrid-section"},be("td",{colSpan:2,className:"fc-timegrid-divider "+l.theme.getClass("tableCellShaded")}))}));let f=l.options.nowIndicator;return h.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(l.options.expandRows),chunks:[{key:"axis",content:e=>be("div",{className:"fc-timegrid-axis-chunk"},be("table",{"aria-hidden":!0,style:{height:e.expandRows?e.clientHeight:""}},e.tableColGroupNode,be("tbody",null,be(Vl,{slatMetas:s}))),be("div",{className:"fc-timegrid-now-indicator-container"},be(vs,{unit:f?"minute":"day"},e=>{let t=f&&o&&o.safeComputeTop(e);return"number"===typeof t?be(Oo,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:t},isAxis:!0,date:e}):null})))},{key:"cols",scrollerElRef:this.scrollerElRef,content:n}]}),d&&h.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:Io},{key:"cols",content:Io}]}),be(qr,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:l.viewSpec},be(a,{liquid:!c.isHeightAuto&&!c.forPrint,forPrint:c.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:r,minWidth:i}]}],sections:h}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:t}=this.context.options;return!0!==e&&!0!==t||(e=void 0,t=5),{dayMaxEvents:e,dayMaxEventRows:t}}}function $l(e){return e.text}class Gl{constructor(e,t,n){this.positions=e,this.dateProfile=t,this.slotDuration=n}safeComputeTop(e){let{dateProfile:t}=this;if(Xr(t.currentRange,e)){let n=Tn(e),r=e.valueOf()-n.valueOf();if(r>=mn(t.slotMinTime)&&r<mn(t.slotMaxTime))return this.computeTimeTop(hn(r))}return null}computeDateTop(e,t){return t||(t=Tn(e)),this.computeTimeTop(hn(e.valueOf()-t.valueOf()))}computeTimeTop(e){let t,n,{positions:r,dateProfile:i}=this,s=r.els.length,o=(e.milliseconds-mn(i.slotMinTime))/mn(this.slotDuration);return o=Math.max(0,o),o=Math.min(s,o),t=Math.floor(o),t=Math.min(t,s-1),n=o-t,r.tops[t]+r.getHeight(t)*n}}class Wl extends Pr{render(){let{props:e,context:t}=this,{options:n}=t,{slatElRefs:r}=e;return be("tbody",null,e.slatMetas.map((i,s)=>{let o={time:i.time,date:t.dateEnv.toDate(i.date),view:t.viewApi};return be("tr",{key:i.key,ref:r.createRef(i.key)},e.axis&&be(Bl,Object.assign({},i)),be(Vr,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!i.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":i.isoTimeStr},renderProps:o,generatorName:"slotLaneContent",customGenerator:n.slotLaneContent,classNameGenerator:n.slotLaneClassNames,didMount:n.slotLaneDidMount,willUnmount:n.slotLaneWillUnmount}))}))}}class Ql extends Pr{constructor(){super(...arguments),this.rootElRef={current:null},this.slatElRefs=new wo}render(){let{props:e,context:t}=this;return be("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},be("table",{"aria-hidden":!0,className:t.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,be(Wl,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:t}=this;if(t.onCoords&&null!==t.clientWidth){this.rootElRef.current.offsetHeight&&t.onCoords(new Gl(new Fs(this.rootElRef.current,(n=this.slatElRefs.currentMap,t.slatMetas.map(e=>n[e.key])),!1,!0),this.props.dateProfile,e.options.slotDuration))}var n}}function Kl(e,t){let n,r=[];for(n=0;n<t;n+=1)r.push([]);if(e)for(n=0;n<e.length;n+=1)r[e[n].col].push(e[n]);return r}function Yl(e,t){let n=[];if(e){for(let r=0;r<t;r+=1)n[r]={affectedInstances:e.affectedInstances,isEvent:e.isEvent,segs:[]};for(let t of e.segs)n[t.col].segs.push(t)}else for(let r=0;r<t;r+=1)n[r]=null;return n}class Xl extends Pr{render(){let{props:e}=this;return be(Go,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>lc(e.hiddenSegs,e),defaultGenerator:Jl,forceTimed:!0},e=>be(e,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]}))}}function Jl(e){return e.shortText}function Zl(e,t,n){let r=new qs;null!=t&&(r.strictOrder=t),null!=n&&(r.maxStackCnt=n);let i=function(e){let t=[];for(let n of e){let e=[],r={span:n.span,entries:[n]};for(let n of t)Qs(n.span,r.span)?r={entries:n.entries.concat(r.entries),span:Ws(n.span,r.span)}:e.push(n);e.push(r),t=e}return t}(r.addSegs(e)),s=function(e){const{entriesByLevel:t}=e,n=rc((e,t)=>e+":"+t,(r,i)=>{let s=function(e,t,n){let{levelCoords:r,entriesByLevel:i}=e,s=i[t][n],o=r[t]+s.thickness,a=r.length,l=t;for(;l<a&&r[l]<o;l+=1);for(;l<a;l+=1){let e,t=i[l],n=Ys(t,s.span.start,$s),r=n[0]+n[1],o=r;for(;(e=t[o])&&e.span.start<s.span.end;)o+=1;if(r<o)return{level:l,lateralStart:r,lateralEnd:o}}return null}(e,r,i),o=ec(s,n),a=t[r][i];return[Object.assign(Object.assign({},a),{nextLevelNodes:o[0]}),a.thickness+o[1]]});return ec(t.length?{level:0,lateralStart:0,lateralEnd:t[0].length}:null,n)[0]}(r);return s=function(e,t){const n=rc((e,t,n)=>Gs(e),(e,r,i)=>{let s,{nextLevelNodes:o,thickness:a}=e,l=a+i,c=a/l,u=[];if(o.length)for(let t of o)if(void 0===s){let e=n(t,r,l);s=e[0],u.push(e[1])}else{let e=n(t,s,0);u.push(e[1])}else s=t;let d=(s-r)*c;return[s-d,Object.assign(Object.assign({},e),{thickness:d,nextLevelNodes:u})]});return e.map(e=>n(e,0,0)[1])}(s,1),{segRects:function(e){let t=[];const n=rc((e,t,n)=>Gs(e),(e,n,i)=>{let s=Object.assign(Object.assign({},e),{levelCoord:n,stackDepth:i,stackForward:0});return t.push(s),s.stackForward=r(e.nextLevelNodes,n+e.thickness,i+1)+1});function r(e,t,r){let i=0;for(let s of e)i=Math.max(n(s,t,r),i);return i}return r(e,0,0),t}(s),hiddenGroups:i}}function ec(e,t){if(!e)return[[],0];let{level:n,lateralStart:r,lateralEnd:i}=e,s=r,o=[];for(;s<i;)o.push(t(n,s)),s+=1;return o.sort(tc),[o.map(nc),o[0][1]]}function tc(e,t){return t[1]-e[1]}function nc(e){return e[0]}function rc(e,t){const n={};return function(){let r=e(...arguments);return r in n?n[r]:n[r]=t(...arguments)}}function ic(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=[];if(n)for(let s=0;s<e.length;s+=1){let o=e[s],a=n.computeDateTop(o.start,t),l=Math.max(a+(r||0),n.computeDateTop(o.end,t));i.push({start:Math.round(a),end:Math.round(l)})}return i}const sc=er({hour:"numeric",minute:"2-digit",meridiem:!1});class oc extends Pr{render(){return be(Ro,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:sc}))}}class ac extends Pr{constructor(){super(...arguments),this.sortEventSegs=Un(Yi)}render(){let{props:e,context:t}=this,{options:n}=t,r=n.selectMirror,i=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||r&&e.dateSelectionSegs||[],s=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},o=this.sortEventSegs(e.fgEventSegs,n.eventOrder);return be(Lo,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},t=>be("div",{className:"fc-timegrid-col-frame"},be("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),be("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(o,s,!1,!1,!1)),be("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(i,{},Boolean(e.eventDrag),Boolean(e.eventResize),Boolean(r),"mirror")),be("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),jo(n)&&be(t,{elTag:"div",elClasses:["fc-timegrid-col-misc"]})))}renderFgSegs(e,t,n,r,i,s){let{props:o}=this;return o.forPrint?lc(e,o):this.renderPositionedFgSegs(e,t,n,r,i,s)}renderPositionedFgSegs(e,t,n,r,i,s){let{eventMaxStack:o,eventShortHeight:a,eventOrderStrict:l,eventMinHeight:c}=this.context.options,{date:u,slatCoords:d,eventSelection:h,todayRange:f,nowDate:p}=this.props,g=n||r||i,m=ic(e,u,d,c),{segPlacements:v,hiddenGroups:y}=function(e,t,n,r){let i=[],s=[];for(let c=0;c<e.length;c+=1){let n=t[c];n?i.push({index:c,thickness:1,span:n}):s.push(e[c])}let{segRects:o,hiddenGroups:a}=Zl(i,n,r),l=[];for(let c of o)l.push({seg:e[c.index],rect:c});for(let c of s)l.push({seg:c,rect:null});return{segPlacements:l,hiddenGroups:a}}(e,m,l,o);return be(Se,null,this.renderHiddenGroups(y,e),v.map(e=>{let{seg:o,rect:l}=e,c=o.eventRange.instance.instanceId,u=g||Boolean(!t[c]&&l),d=cc(l&&l.span),m=!g&&l?this.computeSegHStyle(l):{left:0,right:0},v=Boolean(l)&&l.stackForward>0,y=Boolean(l)&&l.span.end-l.span.start<a;return be("div",{className:"fc-timegrid-event-harness"+(v?" fc-timegrid-event-harness-inset":""),key:s||c,style:Object.assign(Object.assign({visibility:u?"":"hidden"},d),m)},be(oc,Object.assign({seg:o,isDragging:n,isResizing:r,isDateSelecting:i,isSelected:c===h,isShort:y},ns(o,f,p))))}))}renderHiddenGroups(e,t){let{extraDateSpan:n,dateProfile:r,todayRange:i,nowDate:s,eventSelection:o,eventDrag:a,eventResize:l}=this.props;return be(Se,null,e.map(e=>{let c=cc(e.span),u=(d=e.entries,h=t,d.map(e=>h[e.index]));var d,h;return be(Xl,{key:Pn(Ko(u)),hiddenSegs:u,top:c.top,bottom:c.bottom,extraDateSpan:n,dateProfile:r,todayRange:i,nowDate:s,eventSelection:o,eventDrag:a,eventResize:l})}))}renderFillSegs(e,t){let{props:n,context:r}=this,i=ic(e,n.date,n.slatCoords,r.options.eventMinHeight).map((r,i)=>{let s=e[i];return be("div",{key:is(s.eventRange),className:"fc-timegrid-bg-harness",style:cc(r)},"bg-event"===t?be(Uo,Object.assign({seg:s},ns(s,n.todayRange,n.nowDate))):zo(t))});return be(Se,null,i)}renderNowIndicator(e){let{slatCoords:t,date:n}=this.props;return t?e.map((e,r)=>be(Oo,{key:r,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:t.computeDateTop(e.start,n)},isAxis:!1,date:n})):null}computeSegHStyle(e){let t,n,{isRtl:r,options:i}=this.context,s=i.slotEventOverlap,o=e.levelCoord,a=e.levelCoord+e.thickness;s&&(a=Math.min(1,o+2*(a-o))),r?(t=1-a,n=o):(t=o,n=1-a);let l={zIndex:e.stackDepth+1,left:100*t+"%",right:100*n+"%"};return s&&!e.stackForward&&(l[r?"marginLeft":"marginRight"]=20),l}}function lc(e,t){let{todayRange:n,nowDate:r,eventSelection:i,eventDrag:s,eventResize:o}=t,a=(s?s.affectedInstances:null)||(o?o.affectedInstances:null)||{};return be(Se,null,e.map(e=>{let t=e.eventRange.instance.instanceId;return be("div",{key:t,style:{visibility:a[t]?"hidden":""}},be(oc,Object.assign({seg:e,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:t===i,isShort:!1},ns(e,n,r))))}))}function cc(e){return e?{top:e.start,bottom:-e.end}:{top:"",bottom:""}}class uc extends Pr{constructor(){super(...arguments),this.splitFgEventSegs=Un(Kl),this.splitBgEventSegs=Un(Kl),this.splitBusinessHourSegs=Un(Kl),this.splitNowIndicatorSegs=Un(Kl),this.splitDateSelectionSegs=Un(Kl),this.splitEventDrag=Un(Yl),this.splitEventResize=Un(Yl),this.rootElRef={current:null},this.cellElRefs=new wo}render(){let{props:e,context:t}=this,n=t.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),r=e.cells.length,i=this.splitFgEventSegs(e.fgEventSegs,r),s=this.splitBgEventSegs(e.bgEventSegs,r),o=this.splitBusinessHourSegs(e.businessHourSegs,r),a=this.splitNowIndicatorSegs(e.nowIndicatorSegs,r),l=this.splitDateSelectionSegs(e.dateSelectionSegs,r),c=this.splitEventDrag(e.eventDrag,r),u=this.splitEventResize(e.eventResize,r);return be("div",{className:"fc-timegrid-cols",ref:this.rootElRef},be("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,be("tbody",{role:"presentation"},be("tr",{role:"row"},e.axis&&be("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},be("div",{className:"fc-timegrid-col-frame"},be("div",{className:"fc-timegrid-now-indicator-container"},"number"===typeof n&&be(Oo,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:n},isAxis:!0,date:e.nowDate})))),e.cells.map((t,n)=>be(ac,{key:t.key,elRef:this.cellElRefs.createRef(t.key),dateProfile:e.dateProfile,date:t.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:t.extraRenderProps,extraDataAttrs:t.extraDataAttrs,extraClassNames:t.extraClassNames,extraDateSpan:t.extraDateSpan,fgEventSegs:i[n],bgEventSegs:s[n],businessHourSegs:o[n],nowIndicatorSegs:a[n],dateSelectionSegs:l[n],eventDrag:c[n],eventResize:u[n],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint}))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;var t;e.onColCoords&&null!==e.clientWidth&&e.onColCoords(new Fs(this.rootElRef.current,(t=this.cellElRefs.currentMap,e.cells.map(e=>t[e.key])),!0,!1))}}class dc extends Hs{constructor(){super(...arguments),this.processSlotOptions=Un(hc),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:t}=this.props,{slatCoords:n}=this.state;if(t&&n){if(e.time){let r=n.computeTimeTop(e.time);r=Math.ceil(r),r&&(r+=1),t(r)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:t}=this;return be("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},be(Ql,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),be(uc,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:t.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,t){let{dateEnv:n,options:r}=this.context,{colCoords:i}=this,{dateProfile:s}=this.props,{slatCoords:o}=this.state,{snapDuration:a,snapsPerSlot:l}=this.processSlotOptions(this.props.slotDuration,r.snapDuration),c=i.leftToIndex(e),u=o.positions.topToIndex(t);if(null!=c&&null!=u){let e=this.props.cells[c],r=o.positions.tops[u],d=o.positions.getHeight(u),h=(t-r)/d,f=u*l+Math.floor(h*l),p=this.props.cells[c].date,g=pn(s.slotMinTime,function(e,t){return{years:e.years*t,months:e.months*t,days:e.days*t,milliseconds:e.milliseconds*t}}(a,f)),m=n.add(p,g),v=n.add(m,a);return{dateProfile:s,dateSpan:Object.assign({range:{start:m,end:v},allDay:!1},e.extraDateSpan),dayEl:i.els[c],rect:{left:i.lefts[c],right:i.rights[c],top:r,bottom:r+d},layer:0}}return null}}function hc(e,t){let n=t||e,r=vn(e,n);return null===r&&(n=e,r=1),{snapDuration:n,snapsPerSlot:r}}class fc extends lo{sliceRange(e,t){let n=[];for(let r=0;r<t.length;r+=1){let i=Qr(e,t[r]);i&&n.push({start:i.start,end:i.end,isStart:i.start.valueOf()===e.start.valueOf(),isEnd:i.end.valueOf()===e.end.valueOf(),col:r})}return n}}class pc extends Hs{constructor(){super(...arguments),this.buildDayRanges=Un(gc),this.slicer=new fc,this.timeColsRef={current:null}}render(){let{props:e,context:t}=this,{dateProfile:n,dayTableModel:r}=e,{nowIndicator:i,nextDayThreshold:s}=t.options,o=this.buildDayRanges(r,n,t.dateEnv);return be(vs,{unit:i?"minute":"day"},(a,l)=>be(dc,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,n,null,t,o),{forPrint:e.forPrint,axis:e.axis,dateProfile:n,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:r.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:a,nowIndicatorSegs:i&&this.slicer.sliceNowDate(a,n,s,t,o),todayRange:l,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords})))}}function gc(e,t,n){let r=[];for(let i of e.headerDates)r.push({start:n.add(i,t.slotMinTime),end:n.add(i,t.slotMaxTime)});return r}const mc=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function vc(e,t,n,r,i){let s=new Date(0),o=e,a=hn(0),l=n||function(e){let t,n,r;for(t=mc.length-1;t>=0;t-=1)if(n=hn(mc[t]),r=vn(n,e),null!==r&&r>1)return n;return e}(r),c=[];for(;mn(o)<mn(t);){let e=i.add(s,o),t=null!==vn(a,l);c.push({date:e,time:o,key:e.toISOString(),isoTimeStr:jn(e),isLabeled:t}),o=pn(o,r),a=pn(a,r)}return c}function yc(e,t){let n=new oo(e.renderRange,t);return new ao(n,!1)}Ot('.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-arrow,.fc .fc-timegrid-now-indicator-line{pointer-events:none}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}');var bc=oa({name:"@fullcalendar/timegrid",initialView:"timeGridWeek",optionRefiners:{allDaySlot:Boolean},views:{timeGrid:{component:class extends ql{constructor(){super(...arguments),this.buildTimeColsModel=Un(yc),this.buildSlatMetas=Un(vc)}render(){let{options:e,dateEnv:t,dateProfileGenerator:n}=this.context,{props:r}=this,{dateProfile:i}=r,s=this.buildTimeColsModel(i,n),o=this.allDaySplitter.splitProps(r),a=this.buildSlatMetas(i.slotMinTime,i.slotMaxTime,e.slotLabelInterval,e.slotDuration,t),{dayMinWidth:l}=e,c=!l,u=l,d=e.dayHeaders&&be(io,{dates:s.headerDates,dateProfile:i,datesRepDistinctDays:!0,renderIntro:c?this.renderHeadAxis:null}),h=!1!==e.allDaySlot&&(t=>be(Pl,Object.assign({},o.allDay,{dateProfile:i,dayTableModel:s,nextDayThreshold:e.nextDayThreshold,tableMinWidth:t.tableMinWidth,colGroupNode:t.tableColGroupNode,renderRowIntro:c?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:r.forPrint},this.getAllDayMaxEventProps()))),f=t=>be(pc,Object.assign({},o.timed,{dayTableModel:s,dateProfile:i,axis:c,slotDuration:e.slotDuration,slatMetas:a,forPrint:r.forPrint,tableColGroupNode:t.tableColGroupNode,tableMinWidth:t.tableMinWidth,clientWidth:t.clientWidth,clientHeight:t.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:t.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return u?this.renderHScrollLayout(d,h,f,s.colCnt,l,a,this.state.slatCoords):this.renderSimpleLayout(d,h,f)}},usesMinMaxTime:!0,allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0},timeGridDay:{type:"timeGrid",duration:{days:1}},timeGridWeek:{type:"timeGrid",duration:{weeks:1}}}});Js.touchMouseIgnoreWait=500;let wc=0,Sc=0,Ec=!1;class _c{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=e=>{if(!this.shouldIgnoreMouse()&&function(e){return 0===e.button&&!e.ctrlKey}(e)&&this.tryStart(e)){let t=this.createEventFromMouse(e,!0);this.emitter.trigger("pointerdown",t),this.initScrollWatch(t),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=e=>{let t=this.createEventFromMouse(e);this.recordCoords(t),this.emitter.trigger("pointermove",t)},this.handleMouseUp=e=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(e)),this.cleanup()},this.handleTouchStart=e=>{if(this.tryStart(e)){this.isTouchDragging=!0;let t=this.createEventFromTouch(e,!0);this.emitter.trigger("pointerdown",t),this.initScrollWatch(t);let n=e.target;this.shouldIgnoreMove||n.addEventListener("touchmove",this.handleTouchMove),n.addEventListener("touchend",this.handleTouchEnd),n.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=e=>{let t=this.createEventFromTouch(e);this.recordCoords(t),this.emitter.trigger("pointermove",t)},this.handleTouchEnd=e=>{if(this.isDragging){let t=e.target;t.removeEventListener("touchmove",this.handleTouchMove),t.removeEventListener("touchend",this.handleTouchEnd),t.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(e)),this.cleanup(),this.isTouchDragging=!1,wc+=1,setTimeout(()=>{wc-=1},Js.touchMouseIgnoreWait)}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=e=>{if(!this.shouldIgnoreMove){let t=window.scrollX-this.prevScrollX+this.prevPageX,n=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:e,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:t,pageY:n,deltaX:t-this.origPageX,deltaY:n-this.origPageY})}},this.containerEl=e,this.emitter=new Ri,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),Sc+=1,1===Sc&&window.addEventListener("touchmove",Cc,{passive:!1})}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),Sc-=1,Sc||window.removeEventListener("touchmove",Cc,{passive:!1})}tryStart(e){let t=this.querySubjectEl(e),n=e.target;return!(!t||this.handleSelector&&!Bt(n,this.handleSelector))&&(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0)}cleanup(){Ec=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?Bt(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return wc||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(Ec=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let n=0,r=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(n=e.pageX-this.origPageX,r=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:n,deltaY:r}}createEventFromTouch(e,t){let n,r,i=e.touches,s=0,o=0;return i&&i.length?(n=i[0].pageX,r=i[0].pageY):(n=e.pageX,r=e.pageY),t?(this.origPageX=n,this.origPageY=r):(s=n-this.origPageX,o=r-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:n,pageY:r,deltaX:s,deltaY:o}}}function Cc(e){Ec&&e.preventDefault()}class xc{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,n){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=n-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let n=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(n,this.revertDuration):setTimeout(n,0)}doRevertAnimation(e,t){let n=this.mirrorEl,r=this.sourceEl.getBoundingClientRect();n.style.transition="top "+t+"ms,left "+t+"ms",Ht(n,{left:r.left,top:r.top}),function(e,t){let n=r=>{t(r),Yt.forEach(t=>{e.removeEventListener(t,n)})};Yt.forEach(t=>{e.addEventListener(t,n)})}(n,()=>{n.style.transition="",e()})}cleanup(){this.mirrorEl&&(Ut(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&Ht(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),Ht(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class Tc extends Bs{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class Ic extends Tc{constructor(e,t){super(new zs(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return Ps(this.scrollController.el)}}class Dc extends Tc{constructor(e){super(new Vs,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const Ac="function"===typeof performance?performance.now:Date.now;class kc{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=Ac();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,n){this.isEnabled&&(this.scrollCaches=this.buildCaches(n),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let n=e-window.scrollX,r=t-window.scrollY,i=null===this.pointerScreenY?0:r-this.pointerScreenY,s=null===this.pointerScreenX?0:n-this.pointerScreenX;i<0?this.everMovedUp=!0:i>0&&(this.everMovedDown=!0),s<0?this.everMovedLeft=!0:s>0&&(this.everMovedRight=!0),this.pointerScreenX=n,this.pointerScreenY=r,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(Ac()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:n}=e,{edgeThreshold:r}=this,i=r-e.distance,s=i*i/(r*r)*this.maxVelocity*t,o=1;switch(e.name){case"left":o=-1;case"right":n.setScrollLeft(n.getScrollLeft()+s*o);break;case"top":o=-1;case"bottom":n.setScrollTop(n.getScrollTop()+s*o)}}computeBestEdge(e,t){let{edgeThreshold:n}=this,r=null,i=this.scrollCaches||[];for(let s of i){let i=s.clientRect,o=e-i.left,a=i.right-e,l=t-i.top,c=i.bottom-t;o>=0&&a>=0&&l>=0&&c>=0&&(l<=n&&this.everMovedUp&&s.canScrollUp()&&(!r||r.distance>l)&&(r={scrollCache:s,name:"top",distance:l}),c<=n&&this.everMovedDown&&s.canScrollDown()&&(!r||r.distance>c)&&(r={scrollCache:s,name:"bottom",distance:c}),o<=n&&this.everMovedLeft&&s.canScrollLeft()&&(!r||r.distance>o)&&(r={scrollCache:s,name:"left",distance:o}),a<=n&&this.everMovedRight&&s.canScrollRight()&&(!r||r.distance>a)&&(r={scrollCache:s,name:"right",distance:a}))}return r}buildCaches(e){return this.queryScrollEls(e).map(e=>e===window?new Dc(!1):new Ic(e,!1))}queryScrollEls(e){let t=[];for(let n of this.scrollQuery)"object"===typeof n?t.push(n):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(n)));return t}}class Nc extends Xs{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=e=>{var t;this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,(t=document.body).style.userSelect="none",t.style.webkitUserSelect="none",t.addEventListener("selectstart",Qt),function(e){e.addEventListener("contextmenu",Qt)}(document.body),e.isTouch||e.origEvent.preventDefault(),this.emitter.trigger("pointerdown",e),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(e.subjectEl,e.pageX,e.pageY),this.startDelay(e),this.minDistance||this.handleDistanceSurpassed(e)))},this.onPointerMove=e=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",e),!this.isDistanceSurpassed){let t,n=this.minDistance,{deltaX:r,deltaY:i}=e;t=r*r+i*i,t>=n*n&&this.handleDistanceSurpassed(e)}this.isDragging&&("scroll"!==e.origEvent.type&&(this.mirror.handleMove(e.pageX,e.pageY),this.autoScroller.handleMove(e.pageX,e.pageY)),this.emitter.trigger("dragmove",e))}},this.onPointerUp=e=>{var t;this.isInteracting&&(this.isInteracting=!1,(t=document.body).style.userSelect="",t.style.webkitUserSelect="",t.removeEventListener("selectstart",Qt),function(e){e.removeEventListener("contextmenu",Qt)}(document.body),this.emitter.trigger("pointerup",e),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(e)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let n=this.pointer=new _c(e);n.emitter.on("pointerdown",this.onPointerDown),n.emitter.on("pointermove",this.onPointerMove),n.emitter.on("pointerup",this.onPointerUp),t&&(n.selector=t),this.mirror=new xc,this.autoScroller=new kc}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){"number"===typeof this.delay?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(this.pointer.wasTouchScroll&&!this.touchScrollAllowed||(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),!1===this.touchScrollAllowed&&this.pointer.cancelTouchScroll()))}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class Rc{constructor(e){this.el=e,this.origRect=Ls(e),this.scrollCaches=js(e).map(e=>new Ic(e,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let n={left:e,top:t};for(let r of this.scrollCaches)if(!Mc(r.getEventTarget())&&!ws(n,r.clientRect))return!1;return!0}}function Mc(e){let t=e.tagName;return"HTML"===t||"BODY"===t}class Oc{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=e=>{let{dragging:t}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(e),this.initialHit||!this.requireInitial?(t.setIgnoreMove(!1),this.emitter.trigger("pointerdown",e)):t.setIgnoreMove(!0)},this.handleDragStart=e=>{this.emitter.trigger("dragstart",e),this.handleMove(e,!0)},this.handleDragMove=e=>{this.emitter.trigger("dragmove",e),this.handleMove(e)},this.handlePointerUp=e=>{this.releaseHits(),this.emitter.trigger("pointerup",e)},this.handleDragEnd=e=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,e),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",e)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Ri}processFirstCoord(e){let t,n={left:e.pageX,top:e.pageY},r=n,i=e.subjectEl;var s,o;i instanceof HTMLElement&&(t=Ls(i),s=r,o=t,r={left:Math.min(Math.max(s.left,o.left),o.right),top:Math.min(Math.max(s.top,o.top),o.bottom)});let a=this.initialHit=this.queryHitForOffset(r.left,r.top);if(a){if(this.useSubjectCenter&&t){let e=Ss(t,a.rect);e&&(r=function(e){return{left:(e.left+e.right)/2,top:(e.top+e.bottom)/2}}(e))}this.coordAdjust=(c=n,{left:(l=r).left-c.left,top:l.top-c.top})}else this.coordAdjust={left:0,top:0};var l,c}handleMove(e,t){let n=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);!t&&Pc(this.movingHit,n)||(this.movingHit=n,this.emitter.trigger("hitupdate",n,!1,e))}prepareHits(){this.offsetTrackers=gr(this.droppableStore,e=>(e.component.prepareHits(),new Rc(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:n,offsetTrackers:r}=this,i=null;for(let s in n){let o=n[s].component,a=r[s];if(a&&a.isWithinClipping(e,t)){let n=a.computeLeft(),r=a.computeTop(),l=e-n,c=t-r,{origRect:u}=a,d=u.right-u.left,h=u.bottom-u.top;if(l>=0&&l<d&&c>=0&&c<h){let e=o.queryHit(l,c,d,h);e&&Yr(e.dateProfile.activeRange,e.dateSpan.range)&&(this.disablePointCheck||a.el.contains(a.el.getRootNode().elementFromPoint(l+n-window.scrollX,c+r-window.scrollY)))&&(!i||e.layer>i.layer)&&(e.componentId=s,e.context=o.context,e.rect.left+=n,e.rect.right+=n,e.rect.top+=r,e.rect.bottom+=r,i=e)}}}return i}}function Pc(e,t){return!e&&!t||Boolean(e)===Boolean(t)&&function(e,t){return n=e.range,r=t.range,(null===n.start?null:n.start.valueOf())===(null===r.start?null:r.start.valueOf())&&(null===n.end?null:n.end.valueOf())===(null===r.end?null:r.end.valueOf())&&e.allDay===t.allDay&&function(e,t){for(let n in t)if("range"!==n&&"allDay"!==n&&e[n]!==t[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}(e,t);var n,r}(e.dateSpan,t.dateSpan)}function Lc(e,t){let n={};for(let s of t.pluginHooks.datePointTransforms)Object.assign(n,s(e,t));var r,i;return Object.assign(n,(r=e,{date:(i=t.dateEnv).toDate(r.range.start),dateStr:i.formatIso(r.range.start,{omitTime:r.allDay}),allDay:r.allDay})),n}class jc extends ps{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=e=>{let t=e.origEvent.target,{component:n,dragging:r}=this,{mirror:i}=r,{options:s}=n.context,o=n.context;this.subjectEl=e.subjectEl;let a=this.subjectSeg=Wi(e.subjectEl),l=(this.eventRange=a.eventRange).instance.instanceId;this.relevantEvents=pi(o.getCurrentData().eventStore,l),r.minDistance=e.isTouch?0:s.eventDragMinDistance,r.delay=e.isTouch&&l!==n.props.eventSelection?function(e){let{options:t}=e.context,n=t.eventLongPressDelay;null==n&&(n=t.longPressDelay);return n}(n):null,s.fixedMirrorParent?i.parentNode=s.fixedMirrorParent:i.parentNode=Bt(t,".fc"),i.revertDuration=s.dragRevertDuration;let c=n.isValidSegDownEl(t)&&!Bt(t,".fc-event-resizer");r.setIgnoreMove(!c),this.isDragging=c&&e.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=e=>{let t=this.component.context,n=this.eventRange,r=n.instance.instanceId;e.isTouch?r!==this.component.props.eventSelection&&t.dispatch({type:"SELECT_EVENT",eventInstanceId:r}):t.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(t.calendarApi.unselect(e),t.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new Vi(t,n.def,n.instance),jsEvent:e.origEvent,view:t.viewApi}))},this.handleHitUpdate=(e,t)=>{if(!this.isDragging)return;let n=this.relevantEvents,r=this.hitDragging.initialHit,i=this.component.context,s=null,o=null,a=null,l=!1,c={affectedEvents:n,mutatedEvents:{defs:{},instances:{}},isEvent:!0};if(e){s=e.context;let t=s.options;i===s||t.editable&&t.droppable?(o=function(e,t,n,r){let i=e.dateSpan,s=t.dateSpan,o=i.range.start,a=s.range.start,l={};i.allDay!==s.allDay&&(l.allDay=s.allDay,l.hasEnd=t.context.options.allDayMaintainDuration,o=s.allDay?Tn(n):n);let c=ei(o,a,e.context.dateEnv,e.componentId===t.componentId?e.largeUnit:null);c.milliseconds&&(l.allDay=!1);let u={datesDelta:c,standardProps:l};for(let d of r)d(u,e,t);return u}(r,e,this.eventRange.instance.range.start,s.getCurrentData().pluginHooks.eventDragMutationMassagers),o&&(a=Fi(n,s.getCurrentData().eventUiBases,o,s),c.mutatedEvents=a,uo(c,e.dateProfile,s)||(l=!0,o=null,a=null,c.mutatedEvents={defs:{},instances:{}}))):s=null}this.displayDrag(s,c),l?tn():nn(),t||(i===s&&Pc(r,e)&&(o=null),this.dragging.setMirrorNeedsRevert(!o),this.dragging.setMirrorIsVisible(!e||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=s,this.validMutation=o,this.mutatedRelevantEvents=a)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=e=>{if(this.isDragging){let t=this.component.context,n=t.viewApi,{receivingContext:r,validMutation:i}=this,s=this.eventRange.def,o=this.eventRange.instance,a=new Vi(t,s,o),l=this.relevantEvents,c=this.mutatedRelevantEvents,{finalHit:u}=this.hitDragging;if(this.clearDrag(),t.emitter.trigger("eventDragStop",{el:this.subjectEl,event:a,jsEvent:e.origEvent,view:n}),i){if(r===t){let r=new Vi(t,c.defs[s.defId],o?c.instances[o.instanceId]:null);t.dispatch({type:"MERGE_EVENTS",eventStore:c});let u={oldEvent:a,event:r,relatedEvents:qi(c,t,o),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})}},d={};for(let e of t.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(d,e(i,t));t.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},u),d),{el:e.subjectEl,delta:i.datesDelta,jsEvent:e.origEvent,view:n})),t.emitter.trigger("eventChange",u)}else if(r){let i={event:a,relatedEvents:qi(l,t,o),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})}};t.emitter.trigger("eventLeave",Object.assign(Object.assign({},i),{draggedEl:e.subjectEl,view:n})),t.dispatch({type:"REMOVE_EVENTS",eventStore:l}),t.emitter.trigger("eventRemove",i);let d=c.defs[s.defId],h=c.instances[o.instanceId],f=new Vi(r,d,h);r.dispatch({type:"MERGE_EVENTS",eventStore:c});let p={event:f,relatedEvents:qi(c,r,h),revert(){r.dispatch({type:"REMOVE_EVENTS",eventStore:c})}};r.emitter.trigger("eventAdd",p),e.isTouch&&r.dispatch({type:"SELECT_EVENT",eventInstanceId:o.instanceId}),r.emitter.trigger("drop",Object.assign(Object.assign({},Lc(u.dateSpan,r)),{draggedEl:e.subjectEl,jsEvent:e.origEvent,view:u.context.viewApi})),r.emitter.trigger("eventReceive",Object.assign(Object.assign({},p),{draggedEl:e.subjectEl,view:u.context.viewApi}))}}else t.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:n}=t.context,r=this.dragging=new Nc(e.el);r.pointer.selector=jc.SELECTOR,r.touchScrollAllowed=!1,r.autoScroller.isEnabled=n.dragScroll;let i=this.hitDragging=new Oc(this.dragging,ms);i.useSubjectCenter=e.useEventCenter,i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("pointerup",this.handlePointerUp),i.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let n=this.component.context,r=this.receivingContext;r&&r!==e&&(r===n?r.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:{defs:{},instances:{}},isEvent:!0}}):r.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}jc.SELECTOR=".fc-event-draggable, .fc-event-resizable";const Fc={fixedMirrorParent:dr},Uc={dateClick:dr,eventDragStart:dr,eventDragStop:dr,eventDrop:dr,eventResizeStart:dr,eventResizeStop:dr,eventResize:dr,drop:dr,eventReceive:dr,eventLeave:dr};Js.dataAttrPrefix="";var Bc=oa({name:"@fullcalendar/interaction",componentInteractions:[class extends ps{constructor(e){super(e),this.handlePointerDown=e=>{let{dragging:t}=this,n=e.origEvent.target;t.setIgnoreMove(!this.component.isValidDateDownEl(n))},this.handleDragEnd=e=>{let{component:t}=this,{pointer:n}=this.dragging;if(!n.wasTouchScroll){let{initialHit:n,finalHit:r}=this.hitDragging;if(n&&r&&Pc(n,r)){let{context:r}=t,i=Object.assign(Object.assign({},Lc(n.dateSpan,r)),{dayEl:n.dayEl,jsEvent:e.origEvent,view:r.viewApi||r.calendarApi.view});r.emitter.trigger("dateClick",i)}}},this.dragging=new Nc(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new Oc(this.dragging,gs(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}},class extends ps{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=e=>{let{component:t,dragging:n}=this,{options:r}=t.context,i=r.selectable&&t.isValidDateDownEl(e.origEvent.target);n.setIgnoreMove(!i),n.delay=e.isTouch?function(e){let{options:t}=e.context,n=t.selectLongPressDelay;null==n&&(n=t.longPressDelay);return n}(t):null},this.handleDragStart=e=>{this.component.context.calendarApi.unselect(e)},this.handleHitUpdate=(e,t)=>{let{context:n}=this.component,r=null,i=!1;if(e){let t=this.hitDragging.initialHit;e.componentId===t.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(t,e)||(r=function(e,t,n){let r=e.dateSpan,i=t.dateSpan,s=[r.range.start,r.range.end,i.range.start,i.range.end];s.sort(an);let o={};for(let a of n){let n=a(e,t);if(!1===n)return null;n&&Object.assign(o,n)}return o.range={start:s[0],end:s[3]},o.allDay=r.allDay,o}(t,e,n.pluginHooks.dateSelectionTransformers)),r&&function(e,t,n){return!!Yr(t.validRange,e.range)&&ho({dateSelection:e},n)}(r,e.dateProfile,n)||(i=!0,r=null)}r?n.dispatch({type:"SELECT_DATES",selection:r}):t||n.dispatch({type:"UNSELECT_DATES"}),i?tn():nn(),t||(this.dragSelection=r)},this.handlePointerUp=e=>{this.dragSelection&&(Pi(this.dragSelection,e,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:n}=t.context,r=this.dragging=new Nc(e.el);r.touchScrollAllowed=!1,r.minDistance=n.selectMinDistance||0,r.autoScroller.isEnabled=n.dragScroll;let i=this.hitDragging=new Oc(this.dragging,gs(e));i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}},jc,class extends ps{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=e=>{let{component:t}=this,n=Wi(this.querySegEl(e)),r=this.eventRange=n.eventRange;this.dragging.minDistance=t.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(e.origEvent.target)||e.isTouch&&this.component.props.eventSelection!==r.instance.instanceId)},this.handleDragStart=e=>{let{context:t}=this.component,n=this.eventRange;this.relevantEvents=pi(t.getCurrentData().eventStore,this.eventRange.instance.instanceId);let r=this.querySegEl(e);this.draggingSegEl=r,this.draggingSeg=Wi(r),t.calendarApi.unselect(),t.emitter.trigger("eventResizeStart",{el:r,event:new Vi(t,n.def,n.instance),jsEvent:e.origEvent,view:t.viewApi})},this.handleHitUpdate=(e,t,n)=>{let{context:r}=this.component,i=this.relevantEvents,s=this.hitDragging.initialHit,o=this.eventRange.instance,a=null,l=null,c=!1,u={affectedEvents:i,mutatedEvents:{defs:{},instances:{}},isEvent:!0};if(e){e.componentId===s.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(s,e)||(a=function(e,t,n,r){let i=e.context.dateEnv,s=e.dateSpan.range.start,o=t.dateSpan.range.start,a=ei(s,o,i,e.largeUnit);if(n){if(i.add(r.start,a)<r.end)return{startDelta:a}}else if(i.add(r.end,a)>r.start)return{endDelta:a};return null}(s,e,n.subjectEl.classList.contains("fc-event-resizer-start"),o.range))}a&&(l=Fi(i,r.getCurrentData().eventUiBases,a,r),u.mutatedEvents=l,uo(u,e.dateProfile,r)||(c=!0,a=null,l=null,u.mutatedEvents=null)),l?r.dispatch({type:"SET_EVENT_RESIZE",state:u}):r.dispatch({type:"UNSET_EVENT_RESIZE"}),c?tn():nn(),t||(a&&Pc(s,e)&&(a=null),this.validMutation=a,this.mutatedRelevantEvents=l)},this.handleDragEnd=e=>{let{context:t}=this.component,n=this.eventRange.def,r=this.eventRange.instance,i=new Vi(t,n,r),s=this.relevantEvents,o=this.mutatedRelevantEvents;if(t.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:i,jsEvent:e.origEvent,view:t.viewApi}),this.validMutation){let a=new Vi(t,o.defs[n.defId],r?o.instances[r.instanceId]:null);t.dispatch({type:"MERGE_EVENTS",eventStore:o});let l={oldEvent:i,event:a,relatedEvents:qi(o,t,r),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:s})}};t.emitter.trigger("eventResize",Object.assign(Object.assign({},l),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||hn(0),endDelta:this.validMutation.endDelta||hn(0),jsEvent:e.origEvent,view:t.viewApi})),t.emitter.trigger("eventChange",l)}else t.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,n=this.dragging=new Nc(e.el);n.pointer.selector=".fc-event-resizer",n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.context.options.dragScroll;let r=this.hitDragging=new Oc(this.dragging,gs(e));r.emitter.on("pointerdown",this.handlePointerDown),r.emitter.on("dragstart",this.handleDragStart),r.emitter.on("hitupdate",this.handleHitUpdate),r.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return Bt(e.subjectEl,".fc-event")}}],calendarInteractions:[class{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=e=>{e.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=e=>{let t=this.context.options.unselectCancel,n=$t(e.origEvent);this.matchesCancel=!!Bt(n,t),this.matchesEvent=!!Bt(n,jc.SELECTOR)},this.onDocumentPointerUp=e=>{let{context:t}=this,{documentPointer:n}=this,r=t.getCurrentData();if(!n.wasTouchScroll){if(r.dateSelection&&!this.isRecentPointerDateSelect){let n=t.options.unselectAuto;!n||n&&this.matchesCancel||t.calendarApi.unselect(e)}r.eventSelection&&!this.matchesEvent&&t.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new _c(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}],elementDraggingImpl:Nc,optionRefiners:Fc,listenerRefiners:Uc}),zc=n(32),Vc=n(558);function Hc(e){const t=(e||"").trim(),n=t.replace(/\u9650$/,"");return"lunch"===n||/lunch/i.test(n)?"\u663c\u4f11\u307f":"after"===n||/after/i.test(n)?"\u653e\u8ab2\u5f8c":/^\d+$/.test(n)?`${n}\u9650`:t}function qc(e,t){t&&/lunch\u9650|after\u9650/i.test(t)&&(t=t.replace(/lunch\u9650/gi,"\u663c\u4f11\u307f").replace(/after\u9650/gi,"\u653e\u8ab2\u5f8c"));let n=e.replace(/lunch\u9650/gi,"lunch").replace(/after\u9650/gi,"after");if(!n.includes(",")&&!n.includes("-"))return Hc(n);const r=e=>Hc(e);if(n.includes(",")){const e=n.split(",").map(e=>e.trim()).filter(Boolean);if(1===e.length)return r(e[0]);const t=e[0],i=e[e.length-1];let s=`${r(t)}\u301c${r(i)}`;return s=s.replace(/lunch\u9650/gi,"\u663c\u4f11\u307f").replace(/after\u9650/gi,"\u653e\u8ab2\u5f8c"),s}if(n.includes("-")){const[e,t]=n.split("-").map(e=>e.trim());let i=`${r(e)}\u301c${r(t)}`;return i=i.replace(/lunch\u9650/gi,"\u663c\u4f11\u307f").replace(/after\u9650/gi,"\u653e\u8ab2\u5f8c"),i}return Hc(n)}const $c=["0","1","2","3","4","lunch","5","6","7","after"],Gc={0:{start:"07:30",end:"08:30",name:"0\u9650"},1:{start:"08:50",end:"09:40",name:"1\u9650"},2:{start:"09:50",end:"10:40",name:"2\u9650"},3:{start:"10:50",end:"11:40",name:"3\u9650"},4:{start:"11:50",end:"12:40",name:"4\u9650"},lunch:{start:"12:40",end:"13:25",name:"\u663c\u4f11\u307f"},5:{start:"13:25",end:"14:15",name:"5\u9650"},6:{start:"14:25",end:"15:15",name:"6\u9650"},7:{start:"15:25",end:"16:15",name:"7\u9650"},after:{start:"16:25",end:"18:00",name:"\u653e\u8ab2\u5f8c"}};function Wc(e){try{const t=new Date(`${e}T00:00:00`).getDay(),n=2===t||4===t||5===t?"15:45":"16:25";return{...Gc,after:{...Gc.after,start:n}}}catch{return Gc}}function Qc(e,t){const n=String(t),r=Wc(e)[n];if(!r)return null;return{start:new Date(`${e}T${r.start}:00`),end:new Date(`${e}T${r.end}:00`),periodName:r.name}}function Kc(e,t,n){return`${e}_${t}_${String(n)}`}function Yc(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Xc(e){const t=new Date(e);return t.setHours(23,59,59,999),t}function Jc(e){return{start:Yc(e),end:Xc(e)}}function Zc(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}const eu="rooms",tu="reservations",nu="reservation_slots",ru="month_overview";async function iu(e,t,n){try{const r=function(e){return e.slice(0,7)}(t),i=(0,zc.doc)(Vc.db,ru,r),s=await e.get(i),o=s.exists()&&s.data().days||{},a=Number(o[t]||0),l=Math.max(0,a+n),c={...o,[t]:l};s.exists()?e.update(i,{days:c,updatedAt:zc.Timestamp.now()}):e.set(i,{monthId:r,days:c,updatedAt:zc.Timestamp.now()})}catch{}}function su(e,t){if(!e)return t;if(e.includes(",")||e.includes("-"))return qc(e,t);const n=t||"";return"lunch"===e||/lunch/i.test(n)?"\u663c\u4f11\u307f":"after"===e||/after/i.test(n)?"\u653e\u8ab2\u5f8c":/^\d+$/.test(e)?Hc(e):t}function ou(e){const t=(null!==e&&void 0!==e?e:"").toString();return/[",\n]/.test(t)?'"'+t.replace(/"/g,'""')+'"':t}const au={async getAllRooms(){try{if(au._cache&&Array.isArray(au._cache))return au._cache;if(au._inflight)return await au._inflight;const e=(async()=>{const e=(await(0,zc.getDocs)((0,zc.collection)(Vc.db,eu))).docs.map(e=>({id:e.id,...e.data()})),t=new Set(["\u5927\u6f14\u7fd2\u5ba45","\u5927\u6f14\u7fd2\u5ba46","\u5927\u6f14\u7fd2\u5ba4\uff15","\u5927\u6f14\u7fd2\u5ba4\uff16"]),n=e.filter(e=>!t.has(String(e.name)));return au._cache=n,n})().finally(()=>{au._inflight=null});return au._inflight=e,await e}catch(e){throw console.error("\u6559\u5ba4\u30c7\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc:",e),e}},async addRoom(e){try{return(await(0,zc.addDoc)((0,zc.collection)(Vc.db,eu),{...e,createdAt:zc.Timestamp.now()})).id}catch(t){throw console.error("\u6559\u5ba4\u8ffd\u52a0\u30a8\u30e9\u30fc:",t),t}}},lu={_dateStr(e){const t=e.toDate();return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},_periods:e=>e?e.includes(",")?e.split(",").map(e=>e.trim()).filter(Boolean):[e]:[],async getReservations(e,t,n){try{var r,i;const s=Number((null===e||void 0===e||null===(r=e.getTime)||void 0===r?void 0:r.call(e))||0),o=`${s}|${Number((null===t||void 0===t||null===(i=t.getTime)||void 0===i?void 0:i.call(t))||0)}`,a=3e4,l=lu;if(l._rangeCache||(l._rangeCache=new Map),l._inflight||(l._inflight=new Map),null===n||void 0===n||!n.noCache){const e=l._rangeCache.get(o),t=Date.now();if(e&&t-e.at<a)return e.data;const n=l._inflight.get(o);if(n)return await n}const c=(async()=>{const r=(0,zc.query)((0,zc.collection)(Vc.db,tu),(0,zc.where)("startTime",">=",zc.Timestamp.fromDate(e)),(0,zc.where)("startTime","<=",zc.Timestamp.fromDate(t)),(0,zc.orderBy)("startTime","asc")),i=(null!==n&&void 0!==n&&n.fromServer?await(0,zc.getDocsFromServer)(r):await(0,zc.getDocs)(r)).docs.map(e=>{const t=e.data();return{id:e.id,...t,createdBy:t.createdBy||void 0,periodName:su(t.period,t.periodName)}});return l._rangeCache.set(o,{at:Date.now(),data:i}),i})().finally(()=>{try{lu._inflight.delete(o)}catch{}});return null!==n&&void 0!==n&&n.noCache||l._inflight.set(o,c),await c}catch(s){throw console.error("\u4e88\u7d04\u30c7\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc:",s),s}},async moveReservation(e,t,n,r){try{await(0,zc.runTransaction)(Vc.db,async i=>{const s=(0,zc.doc)(Vc.db,tu,e),o=await i.get(s);if(!o.exists())throw new Error("\u4e88\u7d04\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093");const a=o.data(),l=Zc(a.startTime.toDate()),c=this._periods(a.period),u=this._periods(r);for(const e of u){const n=Kc(t,l,e),r=(0,zc.doc)(Vc.db,nu,n),s=await i.get(r);if(s.exists()){const e=s.data();if("template-lock"===e.type)i.delete(r);else if(e.reservationId){const t=(0,zc.doc)(Vc.db,tu,String(e.reservationId));if((await i.get(t)).exists())throw new Error("\u540c\u3058\u6559\u5ba4\u30fb\u6642\u9650\u306e\u4e88\u7d04\u304c\u65e2\u306b\u5b58\u5728\u3057\u307e\u3059");i.delete(r)}else i.delete(r)}}for(const e of c){const t=Kc(a.roomId,l,e),n=(0,zc.doc)(Vc.db,nu,t);i.delete(n)}let d=a.startTime,h=a.endTime,f=a.periodName;if(1===u.length){const e=Qc(l,u[0]);if(!e)throw new Error("\u65b0\u3057\u3044\u6642\u9650\u306e\u6642\u9593\u8a08\u7b97\u306b\u5931\u6557\u3057\u307e\u3057\u305f");d=zc.Timestamp.fromDate(e.start),h=zc.Timestamp.fromDate(e.end),f=Hc(u[0])}else if(u.length>1){const e=u[0],t=u[u.length-1],n=Qc(l,e),i=Qc(l,t);if(!n||!i)throw new Error("\u65b0\u3057\u3044\u6642\u9650\u7bc4\u56f2\u306e\u6642\u9593\u8a08\u7b97\u306b\u5931\u6557\u3057\u307e\u3057\u305f");d=zc.Timestamp.fromDate(n.start),h=zc.Timestamp.fromDate(i.end),f=qc(r)}i.update(s,{roomId:t,roomName:n,period:r,periodName:f,startTime:d,endTime:h,updatedAt:zc.Timestamp.now()});for(const n of u){const r=Kc(t,l,n),s=(0,zc.doc)(Vc.db,nu,r);i.set(s,{roomId:t,date:l,period:n,reservationId:e,createdBy:a.createdBy||null,createdAt:zc.Timestamp.now()})}})}catch(i){throw console.error("\u4e88\u7d04\u79fb\u52d5\u30a8\u30e9\u30fc:",i),i}},async exportReservationsCsv(e,t,n){const r=["date","room","title","reservedBy","period","timeRange"];null!==n&&void 0!==n&&n.includeId&&r.push("reservationId"),null!==n&&void 0!==n&&n.includeCreatedAt&&r.push("createdAt"),null!==n&&void 0!==n&&n.includeCreatedByUid&&r.push("createdBy");const i=new Date(e);i.setHours(0,0,0,0);const s=new Date(t);s.setHours(23,59,59,999);const o=null!==n&&void 0!==n&&n.roomId?await this.getRoomReservations(String(n.roomId),i,s):await this.getReservations(i,s),a=[r.join(",")];for(const l of o){const e=l.startTime.toDate(),t=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,r=l.startTime.toDate(),i=l.endTime.toDate(),s=`${r.getHours().toString().padStart(2,"0")}:${r.getMinutes().toString().padStart(2,"0")}-${i.getHours().toString().padStart(2,"0")}:${i.getMinutes().toString().padStart(2,"0")}`,o=su(l.period,l.periodName),c=[t,ou(l.roomName),ou(l.title||""),ou(l.reservationName||l.createdBy||""),ou(o),s];null!==n&&void 0!==n&&n.includeId&&c.push(ou(l.id||"")),null!==n&&void 0!==n&&n.includeCreatedAt&&c.push((l.createdAt instanceof zc.Timestamp?l.createdAt.toDate():new Date).toISOString()),null!==n&&void 0!==n&&n.includeCreatedByUid&&c.push(ou(l.createdBy||"")),a.push(c.join(","))}return a.join("\n")},async getRoomReservations(e,t,n){try{const r=(0,zc.query)((0,zc.collection)(Vc.db,tu),(0,zc.where)("roomId","==",e),(0,zc.where)("startTime",">=",zc.Timestamp.fromDate(t)),(0,zc.where)("startTime","<=",zc.Timestamp.fromDate(n)),(0,zc.orderBy)("startTime","asc"));return(await(0,zc.getDocs)(r)).docs.map(e=>{const t=e.data();return{id:e.id,...t,createdBy:t.createdBy||void 0,periodName:su(t.period,t.periodName)}})}catch(r){throw console.error("\u6559\u5ba4\u4e88\u7d04\u30c7\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc:",r),r}},async addReservation(e){try{const t={...e,periodName:su(e.period,e.periodName),createdAt:zc.Timestamp.now(),updatedAt:zc.Timestamp.now()},n=(0,zc.doc)((0,zc.collection)(Vc.db,tu)),r=Zc(t.startTime.toDate()),i=this._periods(t.period);return await(0,zc.runTransaction)(Vc.db,async e=>{for(const n of i){const i=Kc(t.roomId,r,n),o=(0,zc.doc)(Vc.db,nu,i),a=await e.get(o);if(a.exists()){const t=a.data();if("template-lock"===t.type){console.log(`\ud83d\udd13 \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30ed\u30c3\u30af\u3092\u4e0a\u66f8\u304d: ${i}`),e.delete(o);continue}if(!t.reservationId){console.warn(`\ud83e\uddf9 \u5b64\u7acb\u30b9\u30ed\u30c3\u30c8\u3092\u81ea\u52d5\u524a\u9664 (reservationId\u306a\u3057): ${i}`),e.delete(o);continue}try{const n=(0,zc.doc)(Vc.db,tu,String(t.reservationId));if(!(await e.get(n)).exists()){console.warn(`\ud83e\uddf9 \u5b64\u7acb\u30b9\u30ed\u30c3\u30c8\u3092\u81ea\u52d5\u524a\u9664 (\u4e88\u7d04\u6b20\u843d): ${i} -> ${t.reservationId}`),e.delete(o);continue}}catch(s){console.warn("\u26a0\ufe0f \u4e88\u7d04\u53c2\u7167\u30c1\u30a7\u30c3\u30af\u4e2d\u30a8\u30e9\u30fc: ",t.reservationId,s)}throw new Error("\u540c\u3058\u6559\u5ba4\u30fb\u6642\u9650\u306e\u4e88\u7d04\u304c\u65e2\u306b\u5b58\u5728\u3057\u307e\u3059")}}e.set(n,t);for(const s of i){const i=Kc(t.roomId,r,s),o=(0,zc.doc)(Vc.db,nu,i);e.set(o,{roomId:t.roomId,date:r,period:s,reservationId:n.id,createdBy:t.createdBy||null,createdAt:zc.Timestamp.now()})}await iu(e,r,1)}),n.id}catch(t){throw console.error("\u4e88\u7d04\u8ffd\u52a0\u30a8\u30e9\u30fc:",t),t}},async getSlotsForDate(e){try{const t=(0,zc.query)((0,zc.collection)(Vc.db,nu),(0,zc.where)("date","==",e));return(await(0,zc.getDocs)(t)).docs.map(e=>e.data())}catch(t){return console.error("\u30b9\u30ed\u30c3\u30c8\u53d6\u5f97\u30a8\u30e9\u30fc:",t),[]}},async updateReservation(e,t){try{await(0,zc.updateDoc)((0,zc.doc)(Vc.db,tu,e),{...t,updatedAt:zc.Timestamp.now()})}catch(n){throw console.error("\u4e88\u7d04\u66f4\u65b0\u30a8\u30e9\u30fc:",n),n}},async deleteReservation(e){const t=e=>new Promise(t=>setTimeout(t,e)),n=async()=>{await(0,zc.runTransaction)(Vc.db,async t=>{const n=(0,zc.doc)(Vc.db,tu,e),r=await t.get(n);if(!r.exists())return;const i=r.data(),s=Zc(i.startTime.toDate()),o=this._periods(i.period);t.delete(n);for(const e of o){const n=Kc(i.roomId,s,e),r=(0,zc.doc)(Vc.db,nu,n);t.delete(r)}await iu(t,s,-1)})};let r=null;for(let s=0;s<3;s++)try{return void await n()}catch(i){r=i;const e=i&&(i.code||(null===i||void 0===i?void 0:i.message))||"";if("string"===typeof e&&(/resource-exhausted/i.test(e)||/aborted/i.test(e)||/Too Many Requests/i.test(e))){await t(400*Math.pow(2,s));continue}break}throw console.error("\u4e88\u7d04\u524a\u9664\u30a8\u30e9\u30fc:",r),r},async deleteReservationWithKnown(e){const t=Zc(e.startTime.toDate()),n=this._periods(e.period);await(0,zc.runTransaction)(Vc.db,async r=>{const i=(0,zc.doc)(Vc.db,tu,String(e.id));r.delete(i);for(const s of n){const n=Kc(e.roomId,t,s),i=(0,zc.doc)(Vc.db,nu,n);r.delete(i)}})},async deleteAllReservations(){try{var e,t;console.log("\ud83d\uddd1\ufe0f \u5168\u4e88\u7d04\u30c7\u30fc\u30bf\u524a\u9664\u958b\u59cb...(\u65e7\u65b9\u5f0f) auth.uid=",null===(e=(await Promise.resolve().then(n.bind(n,558))).auth)||void 0===e||null===(t=e.currentUser)||void 0===t?void 0:t.uid);const r=await(0,zc.getDocs)((0,zc.collection)(Vc.db,tu));if(0===r.docs.length)return void console.log("\u524a\u9664\u3059\u308b\u4e88\u7d04\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093");const i=r.docs.map(e=>(0,zc.deleteDoc)(e.ref));await Promise.all(i),console.log(`\u2705 ${r.docs.length}\u4ef6\u306e\u4e88\u7d04\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3057\u307e\u3057\u305f`)}catch(r){throw console.error("\u274c \u5168\u524a\u9664\u30a8\u30e9\u30fc:",r),r}},async deleteAllReservationsBatch(){try{var e;const{auth:t}=await Promise.resolve().then(n.bind(n,558));console.log("\ud83d\uddd1\ufe0f \u5168\u4e88\u7d04\u30c7\u30fc\u30bf(\u30d0\u30c3\u30c1)\u524a\u9664\u958b\u59cb auth.uid=",(null===(e=t.currentUser)||void 0===e?void 0:e.uid)||"NONE");const r=await(0,zc.getDocs)((0,zc.collection)(Vc.db,tu)),i=r.docs.length;if(console.log("\u53d6\u5f97\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u7dcf\u6570(collection\u76f4):",i),0===i)return 0;let s=0,o=(0,zc.writeBatch)(Vc.db),a=0;for(const e of r.docs){const t=e.data(),n=Zc(t.startTime.toDate()),r=this._periods(t.period);o.delete(e.ref),a++,s++;for(const e of r){const r=Kc(t.roomId,n,e),i=(0,zc.doc)(Vc.db,nu,r);o.delete(i),a++}a>=450&&(await o.commit(),console.log(`... \u30d0\u30c3\u30c1\u30b3\u30df\u30c3\u30c8 (\u7d2f\u8a08 ${s}/${i})`),o=(0,zc.writeBatch)(Vc.db),a=0)}return a>0&&(await o.commit(),console.log(`... \u6700\u7d42\u30b3\u30df\u30c3\u30c8 (\u7d2f\u8a08 ${s}/${i})`)),console.log(`\u2705 \u4e00\u62ec\u524a\u9664\u5b8c\u4e86 \u5408\u8a08 ${s}\u4ef6`),s}catch(t){throw console.error("\u274c \u30d0\u30c3\u30c1\u4e00\u62ec\u524a\u9664\u30a8\u30e9\u30fc",t),t}},async deleteAllReservationsWideRange(){const e=new Date(2e3,0,1),t=new Date(2100,0,1);console.log("\ud83d\udd0e WideRange \u53d6\u5f97\u958b\u59cb",e.toISOString(),t.toISOString());const n=await this.getReservations(e,t);console.log("WideRange \u30d2\u30c3\u30c8\u4ef6\u6570:",n.length);let r=0;for(const i of n)if(i.id)try{await this.deleteReservation(i.id),r++}catch(s){console.warn("\u500b\u5225\u524a\u9664\u5931\u6557",i.id,s)}return console.log("WideRange \u524a\u9664\u5b8c\u4e86 \u4ef6\u6570:",r),r},async listAllReservationIds(){const e=(await(0,zc.getDocs)((0,zc.collection)(Vc.db,tu))).docs.map(e=>e.id);return console.log("\ud83d\udcc4 [DEBUG][RESERVATIONS] \u5168ID\u4e00\u89a7:",e),e},async getReservationById(e){try{const t=await(0,zc.getDoc)((0,zc.doc)(Vc.db,tu,e));if(t.exists()){const e=t.data();return{id:t.id,...e,createdBy:e.createdBy||void 0,periodName:su(e.period,e.periodName)}}return null}catch(t){throw console.error("\u4e88\u7d04\u53d6\u5f97\u30a8\u30e9\u30fc:",t),t}},async getDayReservations(e){try{const t=new Date(e);t.setHours(0,0,0,0);const n=new Date(e);return n.setHours(23,59,59,999),await this.getReservations(t,n,{noCache:!0,fromServer:!0})}catch(t){throw console.error("\u65e5\u5225\u4e88\u7d04\u53d6\u5f97\u30a8\u30e9\u30fc:",t),t}},async deleteReservationsInRange(e,t,n){try{const r=new Date(e);r.setHours(0,0,0,0);const i=new Date(t);i.setHours(23,59,59,999);const s=[(0,zc.where)("startTime",">=",zc.Timestamp.fromDate(r)),(0,zc.where)("startTime","<=",zc.Timestamp.fromDate(i))];null!==n&&void 0!==n&&n.roomId&&s.push((0,zc.where)("roomId","==",n.roomId)),null!==n&&void 0!==n&&n.createdBy&&s.push((0,zc.where)("createdBy","==",n.createdBy));const o=(0,zc.query)((0,zc.collection)(Vc.db,tu),...s),a=await(0,zc.getDocs)(o);if(a.empty)return 0;let l=0,c=0,u=(0,zc.writeBatch)(Vc.db);for(const e of a.docs){const t=e.data(),n=Zc(t.startTime.toDate()),r=this._periods(t.period);u.delete(e.ref),c++,l++;for(const e of r){const r=Kc(t.roomId,n,e);u.delete((0,zc.doc)(Vc.db,nu,r)),c++}c>=450&&(await u.commit(),u=(0,zc.writeBatch)(Vc.db),c=0)}return c>0&&await u.commit(),l}catch(r){throw console.error("\u671f\u9593\u524a\u9664\u30a8\u30e9\u30fc:",r),r}}};function cu(e,t){return Qc(e,t)}const uu=$c;var du=n(579);const hu=(0,r.createContext)(void 0),fu=e=>{let{children:t}=e;const[i,s]=(0,r.useState)([]),o=(0,r.useRef)({start:null,end:null}),a=(0,r.useRef)(null),l=(0,r.useRef)(null),c=(0,r.useRef)(null),u=(0,r.useCallback)(async(e,t)=>{if(e&&t)try{const r=Math.floor((e.getTime()+t.getTime())/2),o=new Date(r),a=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`,u=new Date(o.getFullYear(),o.getMonth(),1,0,0,0,0),d=new Date(o.getFullYear(),o.getMonth()+1,0,23,59,59,999);if(l.current!==a||!c.current){const e=await lu.getReservations(u,d);return s(Array.isArray(e)?e:[]),l.current=a,void(c.current=Date.now())}const{collection:h,query:f,where:p,orderBy:g,getDocs:m}=await Promise.resolve().then(n.bind(n,32)),{db:v}=await Promise.resolve().then(n.bind(n,558)),y=zc.Timestamp.fromMillis(c.current),b=f(h(v,"reservations"),p("updatedAt",">",y),g("updatedAt","asc")),w=f(h(v,"reservations"),p("createdAt",">",y),g("createdAt","asc")),[S,E]=await Promise.all([m(b).catch(()=>({docs:[]})),m(w).catch(()=>({docs:[]}))]),_=(S.docs||[]).map(e=>({id:e.id,...e.data()})),C=(E.docs||[]).map(e=>({id:e.id,...e.data()})),x=[],T=new Set;for(const e of[..._,...C]){const t=String(e.id||"");T.has(t)||(T.add(t),x.push(e))}const I=x.filter(e=>{var t,n;const r=(null===(t=e.startTime)||void 0===t||null===(n=t.toDate)||void 0===n?void 0:n.call(t))||new Date(e.startTime);return r>=u&&r<=d}),D=new Map;return i.forEach(e=>e.id&&D.set(e.id,e)),I.forEach(e=>e.id&&D.set(e.id,e)),s(Array.from(D.values())),void(c.current=Date.now())}catch(r){console.error("\u4e88\u7d04\u8aad\u307f\u8fbc\u307f\u30a8\u30e9\u30fc:",r),s([])}else s([])},[i]),d=(0,r.useCallback)((e,t)=>{var n,r;if(!e||!t)return;const i=o.current;(null===(n=i.start)||void 0===n?void 0:n.getTime())===e.getTime()&&(null===(r=i.end)||void 0===r?void 0:r.getTime())===t.getTime()||(o.current={start:e,end:t},a.current=u(e,t))},[u]),h=(0,r.useCallback)(async()=>{const{start:e,end:t}=o.current;l.current=null,c.current=null,a.current=u(e,t),await a.current},[u]),f=(0,r.useMemo)(()=>({reservations:i,setRange:d,refetch:h}),[i,d,h]);return(0,du.jsx)(hu.Provider,{value:f,children:t})};function pu(){const e=(0,r.useContext)(hu);if(!e)throw new Error("useMonthlyReservations must be used within MonthlyReservationsProvider");return e}function gu(e,t){const n=function(e,t){const n=new Date(e);return n.setDate(n.getDate()+t),n}(new Date(`${e}T00:00:00`),t);return mu(n)}function mu(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function vu(){return mu(new Date)}function yu(e,t){console.error(`[${t}] \u30a8\u30e9\u30fc:`,e);const n=function(e){if(e instanceof Error){if("code"in e)switch(e.code){case"permission-denied":return"\u6a29\u9650\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"not-found":return"\u6307\u5b9a\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002";case"already-exists":return"\u3059\u3067\u306b\u5b58\u5728\u3057\u3066\u3044\u307e\u3059\u3002";case"failed-precondition":return"\u64cd\u4f5c\u3092\u5b9f\u884c\u3067\u304d\u307e\u305b\u3093\u3002\u6761\u4ef6\u304c\u6e80\u305f\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"unavailable":return"\u30b5\u30fc\u30d3\u30b9\u304c\u4e00\u6642\u7684\u306b\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\u3057\u3070\u3089\u304f\u3057\u3066\u304b\u3089\u518d\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002";case"deadline-exceeded":return"\u51e6\u7406\u304c\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002";case"cancelled":return"\u64cd\u4f5c\u304c\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u307e\u3057\u305f\u3002";default:return e.message}return e.message}return"\u4e88\u671f\u3057\u306a\u3044\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}(e);alert(`${t}\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f:\n${n}`)}var bu=n(619);const wu=new class{constructor(){this.isAdminCache=new Map,this.isAdminInflight=new Map,this.isSuperCache=new Map,this.isSuperInflight=new Map}async getOrCompute(e,t,n,r){if(t.has(e))return t.get(e);if(n.has(e))return await n.get(e);const i=r();n.set(e,i);try{const n=await i;return t.set(e,n),n}finally{n.delete(e)}}async getIsAdmin(e,t){return this.getOrCompute(e,this.isAdminCache,this.isAdminInflight,t)}async getIsSuperAdmin(e,t){return this.getOrCompute(e,this.isSuperCache,this.isSuperInflight,t)}clear(){this.isAdminCache.clear(),this.isAdminInflight.clear(),this.isSuperCache.clear(),this.isSuperInflight.clear()}clearIsAdmin(){this.isAdminCache.clear(),this.isAdminInflight.clear()}clearIsSuperAdmin(){this.isSuperCache.clear(),this.isSuperInflight.clear()}},Su="212-schooladmin@e.osakamanabi.jp";function Eu(e,t){false}const _u={async isAdmin(e,t){try{const n=`${e}|${t||""}`;return await wu.getIsAdmin(n,async()=>{Eu();if((await(0,zc.getDoc)((0,zc.doc)(Vc.db,"admin_users",e))).exists())return Eu(),!0;if(t){if((await(0,zc.getDoc)((0,zc.doc)(Vc.db,"admin_users",t))).exists())return Eu(),!0;const e=this.generateUidFromEmail(t);if((await(0,zc.getDoc)((0,zc.doc)(Vc.db,"admin_users",e))).exists())return Eu(),!0}return Eu(),!1})}catch(n){return console.error("\u274c \u7ba1\u7406\u8005\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc:",n),!1}},async isSuperAdmin(e,t){try{const n=`${e}|${t||""}`;return await wu.getIsSuperAdmin(n,async()=>{if(Eu(),t&&t===Su)return Eu(),!0;const n=(0,zc.doc)(Vc.db,"admin_users",e),r=await(0,zc.getDoc)(n);if(r.exists()){var i;const e=r.data(),t="super"===(null!==(i=e.tier)&&void 0!==i?i:"super");return Eu(e.tier),t}if(t){const e=(0,zc.doc)(Vc.db,"admin_users",t),n=await(0,zc.getDoc)(e);if(n.exists()){var s;const e=n.data(),t="super"===(null!==(s=e.tier)&&void 0!==s?s:"super");return Eu(e.tier),t}const r=this.generateUidFromEmail(t),i=(0,zc.doc)(Vc.db,"admin_users",r),a=await(0,zc.getDoc)(i);if(a.exists()){var o;const e=a.data(),t="super"===(null!==(o=e.tier)&&void 0!==o?o:"super");return Eu(e.tier),t}}return Eu(),!1})}catch(n){return console.error("\u274c \u30b9\u30fc\u30d1\u30fc\u7ba1\u7406\u8005\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc:",n),!1}},async getAdminUsers(){try{Eu();const l=(await(0,zc.getDocs)((0,zc.collection)(Vc.db,"admin_users"))).docs.map(e=>({docId:e.id,...e.data()}));let c;const u=l.find(e=>e.docId===Su);u&&"string"===typeof u.uid&&(c=String(u.uid));const d=new Map;for(const f of l){const l=String(f.uid||f.docId),u=d.get(l),h={uid:String(f.uid||f.docId),email:String(f.email||""),role:"admin",assignedAt:f.assignedAt||zc.Timestamp.now(),assignedBy:String(f.assignedBy||"unknown"),tier:f.tier};if(!h.email&&c&&h.uid===c&&(h.email=Su,h.tier="super"),u){var e,t,n,r,i,s,o,a;const c="super"===(null!==(e=u.tier)&&void 0!==e?e:"regular")?u:h,f=c===u?h:u,p="super"===(null!==(t=c.tier)&&void 0!==t?t:"regular")?c:f,g=null!==(n=null===(r=u.assignedAt)||void 0===r||null===(i=r.toMillis)||void 0===i?void 0:i.call(r))&&void 0!==n?n:9e15,m=g<=(null!==(s=null===(o=h.assignedAt)||void 0===o||null===(a=o.toMillis)||void 0===a?void 0:a.call(o))&&void 0!==s?s:9e15)?u:h;d.set(l,p===c?p:m)}else d.set(l,h)}const h=Array.from(d.values()).sort((e,t)=>{var n,r,i,s,o,a;return(null!==(n=null===(r=e.assignedAt)||void 0===r||null===(i=r.toMillis)||void 0===i?void 0:i.call(r))&&void 0!==n?n:0)-(null!==(s=null===(o=t.assignedAt)||void 0===o||null===(a=o.toMillis)||void 0===a?void 0:a.call(o))&&void 0!==s?s:0)});return Eu(0,h.length),h}catch(l){return console.error("\u274c \u7ba1\u7406\u8005\u30ea\u30b9\u30c8\u53d6\u5f97\u30a8\u30e9\u30fc:",l),[]}},async addAdmin(e,t,n){try{Eu();if(await this.isAdmin(e))throw console.warn("\u26a0\ufe0f \u65e2\u306b\u7ba1\u7406\u8005\u3067\u3059:",e),new Error("\u3053\u306e\u30e6\u30fc\u30b6\u30fc\u306f\u65e2\u306b\u7ba1\u7406\u8005\u3067\u3059");return await(0,zc.setDoc)((0,zc.doc)(Vc.db,"admin_users",e),{uid:e,email:t,role:"admin",assignedAt:zc.Timestamp.now(),assignedBy:n,tier:"regular"}),await(0,zc.setDoc)((0,zc.doc)(Vc.db,"admin_users",t),{uid:e,email:t,role:"admin",assignedAt:zc.Timestamp.now(),assignedBy:n,tier:"regular"}),Eu(),wu.clear(),!0}catch(r){throw console.error("\u274c \u7ba1\u7406\u8005\u8ffd\u52a0\u30a8\u30e9\u30fc:",r),r}},async removeAdmin(e){try{Eu();if(!await this.isAdmin(e))throw console.warn("\u26a0\ufe0f \u7ba1\u7406\u8005\u3067\u306f\u3042\u308a\u307e\u305b\u3093:",e),new Error("\u3053\u306e\u30e6\u30fc\u30b6\u30fc\u306f\u7ba1\u7406\u8005\u3067\u306f\u3042\u308a\u307e\u305b\u3093");const t=(0,zc.doc)(Vc.db,"admin_users",e),n=await(0,zc.getDoc)(t);let r;if(n.exists()){r=n.data().email}if(!r)try{const t=await(0,zc.getDoc)((0,zc.doc)(Vc.db,"user_profiles",e));t.exists()&&(r=String(t.data().email||""))}catch{}if(r===Su)throw new Error("\u521d\u671f\u7ba1\u7406\u8005\u306f\u524a\u9664\u3067\u304d\u307e\u305b\u3093");if(!r){const t=(0,zc.doc)(Vc.db,"admin_users",Su),n=await(0,zc.getDoc)(t);if(n.exists()&&String(n.data().uid)===e)throw new Error("\u521d\u671f\u7ba1\u7406\u8005\u306f\u524a\u9664\u3067\u304d\u307e\u305b\u3093")}if(await(0,zc.deleteDoc)(t),r){await(0,zc.deleteDoc)((0,zc.doc)(Vc.db,"admin_users",r));const e=this.generateUidFromEmail(r);await(0,zc.deleteDoc)((0,zc.doc)(Vc.db,"admin_users",e));try{const e=await(0,zc.getDocs)((0,zc.query)((0,zc.collection)(Vc.db,"admin_users"),(0,zc.where)("email","==",r)));for(const t of e.docs)await(0,zc.deleteDoc)(t.ref)}catch{}}return Eu(),wu.clear(),!0}catch(t){throw console.error("\u274c \u7ba1\u7406\u8005\u524a\u9664\u30a8\u30e9\u30fc:",t),t}},generateUidFromEmail:e=>e.replace("@","_at_").replace(/\./g,"_dot_"),async getUidByEmail(e){try{const t=await(0,zc.getDocs)((0,zc.query)((0,zc.collection)(Vc.db,"user_profiles"),(0,zc.where)("email","==",e),(0,zc.limit)(1)));return t.empty?null:t.docs[0].id}catch(t){return console.error("\u274c UID\u53d6\u5f97\u30a8\u30e9\u30fc:",t),null}},async upsertUserProfile(e,t,n){try{await(0,zc.setDoc)((0,zc.doc)(Vc.db,"user_profiles",e),{uid:e,email:t,displayName:n||null,updatedAt:zc.Timestamp.now()},{merge:!0})}catch(s){console.error("\u274c user_profiles upsert \u5931\u6557",s)}},async isFirstAdmin(e){try{try{const t=await(0,zc.getDoc)((0,zc.doc)(Vc.db,"admin_users",e));if((t.exists()?t.data().email:void 0)===Su)return!0}catch{}const t=await this.getAdminUsers();if(1===t.length)return t[0].uid===e;if(t.length>1){const n=t.sort((e,t)=>e.assignedAt.toMillis()-t.assignedAt.toMillis());return n[0].uid===e}return!1}catch(t){return console.error("\u274c \u6700\u521d\u306e\u7ba1\u7406\u8005\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc:",t),!1}},async initializeDefaultAdmin(e,t){try{Eu();if((await this.getAdminUsers()).length>0)return void Eu();await(0,zc.setDoc)((0,zc.doc)(Vc.db,"admin_users",t),{uid:t,email:e,role:"admin",assignedAt:zc.Timestamp.now(),assignedBy:"system",tier:"super"}),Eu()}catch(n){throw console.error("\u274c \u30c7\u30d5\u30a9\u30eb\u30c8\u7ba1\u7406\u8005\u521d\u671f\u5316\u30a8\u30e9\u30fc:",n),n}}},Cu="e.osakamanabi.jp",xu=`${Cu}\u30c9\u30e1\u30a4\u30f3\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u307f\u3054\u5229\u7528\u3044\u305f\u3060\u3051\u307e\u3059`,Tu=["212-schooladmin@e.osakamanabi.jp"],Iu={adminPassword:"admin2025",LOGIN_TTL_MS:864e5,LAST_LOGIN_KEY:"lastLoginAt",async signInWithGoogle(){try{try{await(0,bu.oM)(Vc.auth,bu.iM)}catch{}const e=new bu.HF;e.addScope("email"),e.addScope("profile"),e.setCustomParameters({prompt:"select_account"});const t=await(0,bu.df)(Vc.auth,e),n=t.user;if(!n.email)throw console.error("\u274c \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093"),await(0,bu.CI)(Vc.auth),new Error("\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f");if(!n.email.endsWith(`@${Cu}`))throw console.error("\u274c \u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u30c9\u30e1\u30a4\u30f3:",n.email),await(0,bu.CI)(Vc.auth),new Error(xu);console.log("\u2705 Google\u30ed\u30b0\u30a4\u30f3\u6210\u529f:",n.email);try{await _u.upsertUserProfile(n.uid,n.email,n.displayName)}catch{}try{localStorage.setItem(this.LAST_LOGIN_KEY,String(Date.now()))}catch{}return t}catch(e){throw console.error("\u274c Google\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc:",e),e}},async signInAsAdmin(e){if(e!==this.adminPassword)return console.log("\u274c \u7ba1\u7406\u8005\u30ed\u30b0\u30a4\u30f3\u5931\u6557"),!1;try{Vc.auth.currentUser||(await(0,bu.zK)(Vc.auth),console.log("\u2139\ufe0f \u533f\u540d\u8a8d\u8a3c\u3067 Firebase \u306b\u63a5\u7d9a (\u7ba1\u7406\u8005\u30e2\u30fc\u30c9)"));const e=Vc.auth.currentUser;if(!e)return console.error("\u274c Firebase\u30e6\u30fc\u30b6\u30fc\u751f\u6210\u306b\u5931\u6557"),!1;const t={uid:e.uid,email:e.email||"admin@local",displayName:e.displayName||"\u7ba1\u7406\u8005",name:e.displayName||"\u7ba1\u7406\u8005",role:"admin",isAdmin:!0};localStorage.setItem("adminUser",JSON.stringify(t));try{localStorage.setItem(this.LAST_LOGIN_KEY,String(Date.now()))}catch{}return console.log("\u2705 \u7ba1\u7406\u8005\u30ed\u30b0\u30a4\u30f3\u6210\u529f uid=",t.uid),!0}catch(s){return console.error("\u274c \u7ba1\u7406\u8005\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u30a8\u30e9\u30fc",s),!1}},async signOut(){try{localStorage.removeItem("adminUser"),localStorage.removeItem("lastLoginAt"),await(0,bu.CI)(Vc.auth),console.log("\ud83d\udc4b \u30ed\u30b0\u30a2\u30a6\u30c8\u5b8c\u4e86")}catch(e){throw console.error("\u30b5\u30a4\u30f3\u30a2\u30a6\u30c8\u30a8\u30e9\u30fc:",e),e}},onAuthStateChanged(e){const t=localStorage.getItem("adminUser");if(t){try{const t=Number(localStorage.getItem(this.LAST_LOGIN_KEY)||"0");if(t>0&&Date.now()-t>this.LOGIN_TTL_MS)return this.signOut(),e(null),()=>{}}catch{}return setTimeout(()=>e(JSON.parse(t)),0),()=>{}}return(0,bu.hg)(Vc.auth,async t=>{try{const t=Number(localStorage.getItem(this.LAST_LOGIN_KEY)||"0");if(t>0&&Date.now()-t>this.LOGIN_TTL_MS)return await(0,bu.CI)(Vc.auth),localStorage.removeItem(this.LAST_LOGIN_KEY),void e(null)}catch{}if(t){if(t.email&&!this.isAllowedDomain(t.email))return console.error("\u274c \u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u30c9\u30e1\u30a4\u30f3\u3067\u30ed\u30b0\u30a4\u30f3:",t.email),await(0,bu.CI)(Vc.auth),void e(null);const n=!(!t.email||!Tu.includes(t.email));try{localStorage.getItem(this.LAST_LOGIN_KEY)||localStorage.setItem(this.LAST_LOGIN_KEY,String(Date.now()))}catch{}e({uid:t.uid,email:t.email,displayName:t.displayName,role:n?"admin":"teacher",isAdmin:n})}else e(null)})},getCurrentUser(){const e=localStorage.getItem("adminUser");if(e)return JSON.parse(e);const t=Vc.auth.currentUser;if(t){if(t.email&&!this.isAllowedDomain(t.email))return null;const e=!(!t.email||!Tu.includes(t.email));return{uid:t.uid,email:t.email,displayName:t.displayName,role:e?"admin":"teacher",isAdmin:e}}return null},getCurrentUserExtended(){return this.getCurrentUser()},simpleLogout(){this.signOut()},isAdmin(){const e=this.getCurrentUser();return!(null===e||void 0===e||!e.email||!Tu.includes(e.email))||("admin"===(null===e||void 0===e?void 0:e.role)||!0===(null===e||void 0===e?void 0:e.isAdmin))},isEmailAdmin(){const e=this.getCurrentUser();return!(null===e||void 0===e||!e.email||!Tu.includes(e.email))},isTeacher(){const e=this.getCurrentUser();return"teacher"===(null===e||void 0===e?void 0:e.role)||this.isAdmin()},canEditReservation(e){const t=this.getCurrentUser();return!!t&&(!!this.isAdmin()||!!e&&t.uid===e)},canDeleteReservation(e){if(this.isAdmin())return!0;const t=this.getCurrentUser();return!!t&&(!!e&&t.uid===e)},isAllowedDomain:e=>e.endsWith(`@${Cu}`),getAllowedDomain:()=>Cu,getDomainErrorMessage:()=>xu},Du=["\u30b5\u30c6\u30e9\u30a4\u30c8","\u4f1a\u8b70\u5ba4","\u4f1a\u8b70\u5ba4\uff08\u5c0f\uff09","\u793e\u4f1a\u79d1\u6559\u5ba4","\u30b0\u30ed\u30fc\u30d0\u30eb\u6559\u5ba4\u2460","\u30b0\u30ed\u30fc\u30d0\u30eb\u6559\u5ba4\u2461","LL\u6559\u5ba4","\u5c0f\u6f14\u7fd2\u5ba41","\u5c0f\u6f14\u7fd2\u5ba42","\u5c0f\u6f14\u7fd2\u5ba43","\u5c0f\u6f14\u7fd2\u5ba44","\u5c0f\u6f14\u7fd2\u5ba45","\u5c0f\u6f14\u7fd2\u5ba46","\u5927\u6f14\u7fd2\u5ba41","\u5927\u6f14\u7fd2\u5ba42","\u5927\u6f14\u7fd2\u5ba43","\u5927\u6f14\u7fd2\u5ba44","\u30e2\u30ce\u30e9\u30dc","\u8996\u8074\u899a\u6559\u5ba4","\u591a\u76ee\u7684\u5ba4"],Au={SMALL_SEMINAR:/^\u5c0f\u6f14\u7fd2\u5ba4/,LARGE_SEMINAR:/^\u5927\u6f14\u7fd2\u5ba4/,PURPLE:/\u793e\u4f1a|LL|\u30b0\u30ed\u30fc\u30d0\u30eb/,BLUE:/\u30e2\u30ce\u30e9\u30dc|\u8996\u8074\u899a|\u591a\u76ee\u7684/,RED:/\u30b5\u30c6\u30e9\u30a4\u30c8|\u4f1a\u8b70\u5ba4/},ku="room-cat-small",Nu="room-cat-large",Ru="room-cat-purple",Mu="room-cat-blue",Ou="room-cat-red",Pu="room-cat-default";function Lu(e){if(!e){return Zc(new Date)}if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;try{return Zc(new Date(e))}catch{return e.slice(0,10)}}function ju(e,t,n){const r=new Map,i=Iu.getCurrentUser();e.forEach(e=>{if(!e.roomId||!(e=>!n||!!i&&e.createdBy===i.uid)(e))return;const t=function(e){const t=String(e||"");if(t.includes(","))return t.split(",").map(e=>e.trim()).filter(Boolean);if(/^\d+\s*-\s*\d+$/.test(t)){const[e,n]=t.split("-").map(e=>parseInt(e.trim(),10));if(!Number.isNaN(e)&&!Number.isNaN(n)){const t=Math.min(e,n),r=Math.max(e,n),i=[];for(let e=t;e<=r;e+=1)i.push(String(e));return i}}return[t]}(e.period);t.forEach(t=>{const n=String(t);r.has(e.roomId)||r.set(e.roomId,new Map);const i=r.get(e.roomId);i.has(n)||i.set(n,[]);const s=i.get(n);s.push({id:e.id||`${e.roomId}-${t}-${s.length}`,title:e.title,reservationName:e.reservationName,period:n,roomId:e.roomId})})});return r.forEach(e=>{e.forEach((t,n)=>{e.set(n,(e=>[...e].sort((e,t)=>e.title.localeCompare(t.title,"ja")))(t))})}),r}const Fu=e=>{let{date:t,filterMine:n=!1,onFilterMineChange:i,onDateChange:s,onCellClick:o,onReservationClick:a}=e;const l=Lu(t),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)(!0),{reservations:f,setRange:p}=pu(),g=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=!0;return au.getAllRooms().then(t=>{e&&u(function(e){const t=new Map;return Du.forEach((e,n)=>t.set(e,n)),[...e].sort((e,n)=>{const r=t.has(e.name)?t.get(e.name):Number.MAX_SAFE_INTEGER,i=t.has(n.name)?t.get(n.name):Number.MAX_SAFE_INTEGER;return r!==i?r-i:e.name.localeCompare(n.name,"ja")})}(Array.isArray(t)?t:[]))}).catch(t=>{e&&(yu(t,"\u6559\u5ba4\u4e00\u89a7\u306e\u53d6\u5f97"),u([]))}),()=>{e=!1}},[]),(0,r.useEffect)(()=>{if(!l)return;const e=new Date(`${l}T00:00:00`),t=new Date(`${l}T23:59:59`);p(e,t)},[l,p]);const m=(0,r.useMemo)(()=>{const e=l;return f.filter(t=>Zc(t.startTime instanceof zc.Timestamp?t.startTime.toDate():new Date(t.startTime))===e)},[f,l]),v=(0,r.useMemo)(()=>ju(m,0,n),[m,c,n]);(0,r.useEffect)(()=>{if(c.length>0&&f.length>=0){const e=setTimeout(()=>{h(!1)},100);return()=>clearTimeout(e)}},[c.length,f.length]);const y=(0,r.useCallback)(e=>{if(!s)return;const t=Lu(e);s(t)},[s]),b=c,w=(0,r.useMemo)(()=>function(e){try{const t=new Date(`${e}T00:00:00`).getDay();return 2!==t&&4!==t&&5!==t?$c:$c.filter(e=>"7"!==e)}catch{return $c}}(l),[l]),S=(0,r.useMemo)(()=>Wc(l),[l]),E=(0,r.useCallback)(e=>{g.current&&e.shiftKey&&Math.abs(e.deltaY)>Math.abs(e.deltaX)&&(g.current.scrollBy({left:e.deltaY,behavior:"auto"}),e.preventDefault())},[]);return(0,du.jsxs)("div",{className:"ledger-view",children:[(0,du.jsxs)("div",{className:"ledger-toolbar",children:[(0,du.jsxs)("div",{className:"ledger-nav-buttons",children:[(0,du.jsx)("button",{type:"button",onClick:()=>y(gu(l,-1)),children:"< \u524d\u65e5"}),(0,du.jsx)("button",{type:"button",onClick:()=>y(vu()),children:"\u4eca\u65e5"}),(0,du.jsx)("button",{type:"button",onClick:()=>y(gu(l,1)),children:"\u7fcc\u65e5 >"})]}),(0,du.jsxs)("label",{className:"ledger-date-picker",children:["\u65e5\u4ed8",(0,du.jsx)("input",{type:"date",value:l,onChange:e=>y(e.target.value)})]}),(0,du.jsxs)("label",{className:"ledger-filter-mine",children:["\u81ea\u5206\u306e\u4e88\u7d04\u306e\u307f",(0,du.jsx)("input",{type:"checkbox",checked:n,onChange:e=>i&&i(e.target.checked)})]})]}),d?(0,du.jsxs)("div",{className:"ledger-loading",children:[(0,du.jsx)("div",{className:"loading-spinner"}),(0,du.jsx)("p",{children:"\u53f0\u5e33\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059..."})]}):(0,du.jsx)("div",{className:"ledger-table-wrapper",ref:g,onWheel:E,children:(0,du.jsxs)("table",{className:"ledger-table",children:[(0,du.jsx)("thead",{children:(0,du.jsxs)("tr",{children:[(0,du.jsx)("th",{className:"ledger-period-header",children:"\u6642\u9650"}),b.map(e=>(0,du.jsx)("th",{className:"ledger-room-header",children:e.name},String(e.id||e.name)))]})}),(0,du.jsx)("tbody",{children:w.map(e=>{const t=S[e],n=(null===t||void 0===t?void 0:t.name)||e;return(0,du.jsxs)("tr",{children:[(0,du.jsxs)("th",{className:"ledger-period-cell",children:[(0,du.jsx)("div",{className:"period-label",children:n}),(0,du.jsx)("div",{className:"period-time",children:t?`${t.start} - ${t.end}`:""})]}),b.map(t=>{var n;const r=(null===(n=v.get(String(t.id||"")))||void 0===n?void 0:n.get(String(e)))||[];return(0,du.jsx)("td",{className:`ledger-reservation-cell ${i=t.name,i?Au.SMALL_SEMINAR.test(i)?ku:Au.LARGE_SEMINAR.test(i)?Nu:Au.PURPLE.test(i)?Ru:Au.BLUE.test(i)?Mu:Au.RED.test(i)?Ou:Pu:Pu} ${0===r.length?"ledger-cell-clickable":""}`.trim(),onClick:()=>{0===r.length&&o&&t.id&&o(t.id,e,l)},children:0===r.length?(0,du.jsx)("span",{className:"ledger-empty",children:"\u2014"}):(0,du.jsx)("ul",{className:"ledger-reservation-list",children:r.map(e=>(0,du.jsx)("li",{className:"ledger-reservation-item",children:(0,du.jsxs)("button",{type:"button",className:"ledger-reservation-button",onClick:t=>{t.stopPropagation(),a&&a(e.id)},children:[(0,du.jsx)("span",{className:"ledger-reservation-title",children:e.title||"\uff08\u540d\u79f0\u672a\u8a2d\u5b9a\uff09"}),e.reservationName&&(0,du.jsx)("span",{className:"ledger-reservation-owner",children:e.reservationName})]})},e.id))})},`${t.id||t.name}-${e}`);var i})]},e)})})]})})]})},Uu=(0,r.createContext)(void 0),Bu=e=>{let{children:t,date:n}=e;const[i,s]=(0,r.useState)([]),[o,a]=(0,r.useState)([]),l=(0,r.useCallback)(async()=>{try{const e=await au.getAllRooms();s(Array.isArray(e)?e:[])}catch{s([])}},[]),c=(0,r.useCallback)(async e=>{try{const{start:t,end:n}=Jc(e),r=await lu.getReservations(t,n);a(Array.isArray(r)?r:[])}catch{a([])}},[]);(0,r.useEffect)(()=>{l()},[l]),(0,r.useEffect)(()=>{n&&c(n)},[n,c]);const u=(0,r.useMemo)(()=>({rooms:i,reservations:o}),[i,o]);return(0,du.jsx)(Uu.Provider,{value:u,children:t})};function zu(){const e=(0,r.useContext)(Uu);if(!e)throw new Error("useReservationDataContext must be used within ReservationDataProvider");return e}const Vu=()=>{const[e,t]=(0,r.useState)(null),[n,i]=(0,r.useState)(!1),[o,a]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!0),h=async e=>{if(!e)return i(!1),a(!1),void d(!1);try{console.log("\ud83d\udd0d \u7ba1\u7406\u8005\u6a29\u9650\u30c1\u30a7\u30c3\u30af\u958b\u59cb:",e.uid);const t=await _u.isAdmin(e.uid,e.email);i(t),console.log("\ud83d\udd0d \u7ba1\u7406\u8005\u6a29\u9650\u30c1\u30a7\u30c3\u30af\u7d50\u679c:",t);let n=!1;if(t)try{n=await _u.isSuperAdmin(e.uid,e.email)}catch(s){console.error("\u274c \u30b9\u30fc\u30d1\u30fc\u7ba1\u7406\u8005\u6a29\u9650\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc:",s),n=!1}a(n)}catch(t){console.error("\u274c \u7ba1\u7406\u8005\u6a29\u9650\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc:",t),i(!1),a(!1)}finally{d(!1)}};(0,r.useEffect)(()=>{const e=Iu.onAuthStateChanged(async e=>{t(e),console.log("\u8a8d\u8a3c\u72b6\u614b\u5909\u66f4:",e),await h(e)});return()=>e()},[]);return{currentUser:e,isAdmin:n,isSuperAdmin:o,loading:u,showLoginModal:l,setShowLoginModal:c,handleLoginSuccess:async()=>{const e=Iu.getCurrentUserExtended();return t(e),console.log("\u30ed\u30b0\u30a4\u30f3\u6210\u529f:",e),c(!1),await h(e),e},handleLogout:()=>{Iu.simpleLogout(),t(null),i(!1),a(!1),d(!1),console.log("\u30ed\u30b0\u30a2\u30a6\u30c8\u6210\u529f")},refreshAdminStatus:async()=>{e&&await h(e)}}},Hu=e=>{let{selectedDate:t,showWhenEmpty:n=!1,onDateChange:i,filterMine:o,onFilterMineChange:a}=e;const{isAdmin:l}=Vu(),{rooms:c,reservations:u}=zu(),{reservations:d,refetch:h}=pu(),[f,p]=(0,r.useState)([]),[g,m]=(0,r.useState)([]),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(""),[S,E]=(0,r.useState)("all"),[_,C]=(0,r.useState)("all"),x=null!==o&&void 0!==o&&o,[T,I]=(0,r.useState)("reserved"),[D,A]=(0,r.useState)([]),[k,N]=(0,r.useState)(null),[R,M]=(0,r.useState)(0),O=(0,r.useRef)(null),P=r.useMemo(()=>{const e=["\u5c0f\u6f14\u7fd2\u5ba41","\u5c0f\u6f14\u7fd2\u5ba42","\u5c0f\u6f14\u7fd2\u5ba43","\u5c0f\u6f14\u7fd2\u5ba44","\u5c0f\u6f14\u7fd2\u5ba45","\u5c0f\u6f14\u7fd2\u5ba46","\u5927\u6f14\u7fd2\u5ba41","\u5927\u6f14\u7fd2\u5ba42","\u5927\u6f14\u7fd2\u5ba43","\u5927\u6f14\u7fd2\u5ba44","\u5927\u6f14\u7fd2\u5ba45","\u5927\u6f14\u7fd2\u5ba46","\u30b5\u30c6\u30e9\u30a4\u30c8","\u4f1a\u8b70\u5ba4","\u793e\u4f1a\u79d1\u6559\u5ba4","\u30b0\u30ed\u30fc\u30d0\u30eb\u6559\u5ba4\u2460","\u30b0\u30ed\u30fc\u30d0\u30eb\u6559\u5ba4\u2461","LL\u6559\u5ba4","\u30e2\u30ce\u30e9\u30dc","\u8996\u8074\u899a\u6559\u5ba4","\u591a\u76ee\u7684\u5ba4"];return[...c].sort((t,n)=>{const r=e.indexOf(t.name),i=e.indexOf(n.name);return-1!==r&&-1!==i?r-i:-1!==r?-1:-1!==i?1:t.name.localeCompare(n.name)})},[c]),L=r.useMemo(()=>{if(!t)return"";const e=String(t);if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;try{return Zc(new Date(e))}catch{return e.slice(0,10)}},[t]),j=(0,r.useCallback)(async()=>{if(t&&0!==c.length)try{const e=await lu.getDayReservations(new Date(t)),n=e=>{const t=c.find(t=>t.id===e.roomId);let n=0;return n="lunch"===e.period?4.5:"after"===e.period?999:parseInt(e.period)||0,{...e,roomName:(null===t||void 0===t?void 0:t.name)||"\u4e0d\u660e",periodOrder:n}},r=e.map(n),i=(e,t)=>{if("all"===t)return!0;const n=String(e||""),r=String(t);if(n===r)return!0;if(n.includes(",")){const e=n.split(",").map(e=>e.trim()).filter(Boolean);return e.includes(r)}if(/^\d+\s*-\s*\d+$/.test(n)){const[e,t]=n.split("-").map(e=>parseInt(e.trim(),10)),i=parseInt(r,10);if(!Number.isNaN(e)&&!Number.isNaN(t)&&!Number.isNaN(i)){const n=Math.min(e,t),r=Math.max(e,t);return i>=n&&i<=r}}return!1},s=Iu.getCurrentUser();let o=r.filter(e=>("all"===S||e.roomId===S)&&i(String(e.period),String(_))&&(!x||s&&e.createdBy===s.uid));o.sort((e,t)=>e.periodOrder!==t.periodOrder?e.periodOrder-t.periodOrder:e.roomName.localeCompare(t.roomName));const a=[];c.forEach(e=>{const t=o.filter(t=>t.roomId===e.id);t.length>0&&a.push({room:e,reservations:t,isEmpty:!1})}),a.sort((e,t)=>e.room.name.localeCompare(t.room.name)),p(a),m(o)}catch{}},[t,c,S,_,x]);(0,r.useEffect)(()=>{if(!t||0===c.length)return void p([]);let e=!1;return(async()=>{const n=setTimeout(()=>{e||(y(!1),w("\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u304c\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002\u753b\u9762\u3092\u66f4\u65b0\u3057\u3066\u304f\u3060\u3055\u3044\u3002"))},15e3);try{y(!0),w("");const r=Array.isArray(u)&&u.length>0?u:Array.isArray(d)?d:[],{start:i,end:s}=Jc(t);let o=r.filter(e=>{var t,n;const r=(null===(t=e.startTime)||void 0===t||null===(n=t.toDate)||void 0===n?void 0:n.call(t))||new Date(e.startTime);return r>=i&&r<=s});try{o=await lu.getDayReservations(new Date(t))}catch{}if(e)return void clearTimeout(n);const a=e=>{const t=c.find(t=>t.id===e.roomId);let n=0;return n="lunch"===e.period?4.5:"after"===e.period?999:parseInt(e.period)||0,{...e,roomName:(null===t||void 0===t?void 0:t.name)||"\u4e0d\u660e",periodOrder:n}};let l=o.map(a);const h=(e,t)=>{if("all"===t)return!0;const n=String(e||""),r=String(t);if(n===r)return!0;if(n.includes(",")){const e=n.split(",").map(e=>e.trim()).filter(Boolean);return e.includes(r)}if(/^\d+\s*-\s*\d+$/.test(n)){const[e,t]=n.split("-").map(e=>parseInt(e.trim(),10)),i=parseInt(r,10);if(!Number.isNaN(e)&&!Number.isNaN(t)&&!Number.isNaN(i)){const n=Math.min(e,t),r=Math.max(e,t);return i>=n&&i<=r}}return!1},f=Iu.getCurrentUser();l=l.filter(e=>("all"===S||e.roomId===S)&&h(String(e.period),String(_))&&(!x||f&&e.createdBy===f.uid)),l.sort((e,t)=>e.periodOrder!==t.periodOrder?e.periodOrder-t.periodOrder:e.roomName.localeCompare(t.roomName));const g=[];c.forEach(e=>{const t=l.filter(t=>t.roomId===e.id);t.length>0&&g.push({room:e,reservations:t,isEmpty:!1})}),g.sort((e,t)=>e.room.name.localeCompare(t.room.name)),p(g),m(l);const v=e=>{const t=String(e||"");if(t.includes(","))return t.split(",").map(e=>e.trim()).filter(Boolean);if(/^\d+\s*-\s*\d+$/.test(t)){const[e,n]=t.split("-").map(e=>parseInt(e.trim(),10));if(!Number.isNaN(e)&&!Number.isNaN(n)){const t=Math.min(e,n),r=Math.max(e,n),i=[];for(let e=t;e<=r;e++)i.push(String(e));return i}}return[t]},b=[],E=uu,C=Zc(new Date(t));for(const e of c)if("all"===S||e.id===S)for(const n of E){if("all"!==_&&String(_)!==String(n))continue;const r=l.some(t=>t.roomId===e.id&&v(t.period).includes(String(n)));if(!r){const r=cu(C,String(n)),i=(null===r||void 0===r?void 0:r.start)||new Date(`${t}T00:00:00`),s=(null===r||void 0===r?void 0:r.end)||new Date(`${t}T23:59:59`);b.push({roomId:String(e.id),roomName:e.name,period:String(n),periodName:(null===r||void 0===r?void 0:r.periodName)||Hc(String(n)),start:i,end:s})}}b.sort((e,t)=>{const n=E.indexOf(e.period),r=E.indexOf(t.period);return n!==r?n-r:e.roomName.localeCompare(t.roomName)}),A(b)}catch(b){console.error("\u4e88\u7d04\u30c7\u30fc\u30bf\u53d6\u5f97\u30a8\u30e9\u30fc:",b),w("\u4e88\u7d04\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{clearTimeout(n),e||y(!1)}})(),()=>{e=!0,O.current&&clearTimeout(O.current)}},[t,c,S,_,x,R]);const F=e=>e.toDate().toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}),U=Iu.getCurrentUser();return t&&(0!==f.length||n)?(0,du.jsxs)("div",{className:"daily-reservation-table",children:[(0,du.jsxs)("div",{className:"table-header",children:[(0,du.jsxs)("h4",{children:["\ud83d\udccb ",(B=t,new Date(B).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",weekday:"long"}))," \u306e\u4e88\u7d04"]}),(0,du.jsxs)("div",{className:"filters",children:[(0,du.jsxs)("label",{children:["\u65e5\u4ed8:",(0,du.jsx)("input",{type:"date",value:L,onChange:e=>i&&i(e.target.value)})]}),(0,du.jsxs)("label",{children:["\u6559\u5ba4:",(0,du.jsxs)("select",{value:S,onChange:e=>E(e.target.value),children:[(0,du.jsx)("option",{value:"all",children:"\u3059\u3079\u3066"}),P.map(e=>(0,du.jsx)("option",{value:String(e.id),children:e.name},String(e.id)))]})]}),(0,du.jsxs)("label",{children:["\u6642\u9650:",(0,du.jsxs)("select",{value:_,onChange:e=>C(e.target.value),children:[(0,du.jsx)("option",{value:"all",children:"\u3059\u3079\u3066"}),uu.map(e=>(0,du.jsx)("option",{value:String(e),children:Hc(String(e))},String(e)))]})]}),(0,du.jsxs)("label",{children:["\u81ea\u5206\u306e\u4e88\u7d04\u306e\u307f",(0,du.jsx)("input",{type:"checkbox",checked:x,onChange:e=>a&&a(e.target.checked)})]})]})]}),(0,du.jsxs)("div",{className:"subtabs tabs-padding",children:[(0,du.jsx)("button",{className:"reserved"===T?"tab active":"tab",onClick:()=>I("reserved"),children:"\u4e88\u7d04\u72b6\u6cc1"}),(0,du.jsx)("button",{className:"available"===T?"tab active":"tab",onClick:()=>I("available"),children:"\u7a7a\u304d\u72b6\u6cc1"})]}),v&&(0,du.jsx)("div",{className:"loading-inline",children:"\u8aad\u307f\u8fbc\u307f\u4e2d..."}),b&&(0,du.jsx)("div",{className:"error-inline",children:b}),!v&&!b&&0===f.length&&(0,du.jsx)("div",{className:"no-reservations-inline",children:"\u4e88\u7d04\u306f\u3042\u308a\u307e\u305b\u3093"}),(0,du.jsx)("div",{className:"table-scroll-container",children:(0,du.jsx)("div",{className:"table-wrapper",children:(0,du.jsxs)("table",{className:"excel-table",children:[(0,du.jsx)("thead",{children:(0,du.jsxs)("tr",{children:[(0,du.jsx)("th",{className:"col-period",children:"\u6642\u9650"}),(0,du.jsx)("th",{className:"col-room",children:"\u6559\u5ba4"}),(0,du.jsx)("th",{className:"col-time",children:"\u6642\u9593"}),"reserved"===T&&(0,du.jsx)("th",{className:"col-title",children:"\u4e88\u7d04\u5185\u5bb9"}),"reserved"===T&&(0,du.jsx)("th",{className:"col-user",children:"\u4e88\u7d04\u8005"}),"reserved"===T&&(0,du.jsx)("th",{className:"col-actions",children:"\u64cd\u4f5c"})]})}),(0,du.jsxs)("tbody",{children:["reserved"===T&&g.map((e,t)=>{const n=F(e.startTime),r=F(e.endTime),i=(e=>!!l||U&&e.createdBy===U.uid)(e),o=k===e.id;return(0,du.jsxs)("tr",{children:[(0,du.jsx)("td",{className:"col-period",children:(0,du.jsx)("span",{className:"period-badge",children:qc(e.period,e.periodName)})}),(0,du.jsx)("td",{className:"col-room",children:(0,du.jsx)("div",{className:"room-name",children:e.roomName})}),(0,du.jsx)("td",{className:"col-time",children:(0,du.jsxs)("div",{className:"time-range",children:[n,"-",r]})}),(0,du.jsx)("td",{className:"col-title",children:(0,du.jsx)("div",{className:"reservation-title",children:e.title})}),(0,du.jsx)("td",{className:"col-user",children:(0,du.jsx)("div",{className:"reservation-user",children:e.reservationName})}),(0,du.jsxs)("td",{className:"col-actions",children:[i&&!o&&(0,du.jsx)("button",{className:"inline-delete-btn",onClick:()=>N(e.id),children:"\u524a\u9664"}),i&&o&&(0,du.jsxs)("div",{className:"inline-confirm",children:[(0,du.jsx)("button",{className:"confirm",onClick:()=>(async e=>{if(e.id)try{N(null);const t=String(e.id);m(e=>e.filter(e=>String(e.id)!==t)),p(e=>{const n=e.map(e=>({room:e.room,reservations:e.reservations.filter(e=>String(e.id)!==t),isEmpty:!1})).filter(e=>e.reservations.length>0);return n.map(e=>({...e,isEmpty:0===e.reservations.length}))}),y(!0),await lu.deleteReservation(e.id);try{await h()}catch{}await j(),O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{M(e=>e+1)},500)}catch(s){console.error("\u30a4\u30f3\u30e9\u30a4\u30f3\u524a\u9664\u5931\u6557",s),he.error("\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{y(!1)}})(e),children:"\u78ba\u5b9a"}),(0,du.jsx)("button",{className:"cancel",onClick:()=>N(null),children:"\u53d6\u6d88"})]})]})]},`${e.roomId}-${e.id||t}`)}),"available"===T&&D.map((e,t)=>{const n=e.start.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}),r=e.end.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"});return(0,du.jsxs)("tr",{children:[(0,du.jsx)("td",{className:"col-period",children:(0,du.jsx)("span",{className:"period-badge",children:qc(e.period,e.periodName)})}),(0,du.jsx)("td",{className:"col-room",children:(0,du.jsx)("div",{className:"room-name",children:e.roomName})}),(0,du.jsx)("td",{className:"col-time",children:(0,du.jsxs)("div",{className:"time-range",children:[n,"-",r]})})]},`${e.roomId}-${e.period}-${t}`)})]})]})})})]}):null;var B},qu=e=>{if(!e)return Zc(new Date);if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;try{return Zc(new Date(e))}catch{return e.slice(0,10)}};const $u=e=>{let{selectedDate:t,filterMine:n,onFilterMineChange:i,onDateNavigate:s,onLedgerCellClick:o,onReservationClick:a,onDateClick:l,onEventClick:c}=e;const{isAdmin:u,currentUser:d}=Vu(),[h,f]=(0,r.useState)("ledger"),[p,g]=(0,r.useState)(()=>qu(t)),[m,v]=(0,r.useState)(()=>qu(t)),[y,b]=(0,r.useState)([]),[w,S]=(0,r.useState)(!1),E=null!==n&&void 0!==n&&n,{reservations:_,setRange:C}=pu(),x=(0,r.useRef)(null),T=(0,r.useRef)(null),I=(null===d||void 0===d?void 0:d.uid)||"";(0,r.useEffect)(()=>{t&&(g(qu(t)),v(qu(t)))},[t]);const D=(0,r.useCallback)(async(e,t)=>{S(!0);try{const n=Zc(e),r=Zc(t);C(e,t),await new Promise(e=>setTimeout(e,100));const i=_.filter(e=>{const t=Zc(e.startTime instanceof zc.Timestamp?e.startTime.toDate():new Date(e.startTime));return t>=n&&t<=r}).filter(e=>!E||e.createdBy===I).map(e=>{const t=e.startTime instanceof zc.Timestamp?e.startTime.toDate():new Date(e.startTime),n=e.endTime instanceof zc.Timestamp?e.endTime.toDate():new Date(e.endTime);var r;const i={"room-cat-small":{bg:"#10B981",border:"#0E946C",text:"#fff"},"room-cat-large":{bg:"#F59E0B",border:"#C47E08",text:"#111"},"room-cat-purple":{bg:"#8B5CF6",border:"#6D28D9",text:"#fff"},"room-cat-blue":{bg:"#3B82F6",border:"#2563EB",text:"#fff"},"room-cat-red":{bg:"#EF4444",border:"#DC2626",text:"#fff"},"room-cat-default":{bg:"#9CA3AF",border:"#6B7280",text:"#fff"}},s=i[(r=e.roomName)?/^\u5c0f\u6f14\u7fd2\u5ba4/.test(r)?"room-cat-small":/^\u5927\u6f14\u7fd2\u5ba4/.test(r)?"room-cat-large":/\u793e\u4f1a|LL|\u30b0\u30ed\u30fc\u30d0\u30eb/.test(r)?"room-cat-purple":/\u30e2\u30ce\u30e9\u30dc|\u8996\u8074\u899a|\u591a\u76ee\u7684/.test(r)?"room-cat-blue":/\u30b5\u30c6\u30e9\u30a4\u30c8|\u4f1a\u8b70\u5ba4/.test(r)?"room-cat-red":"room-cat-default":"room-cat-default"]||i["room-cat-default"];return{id:e.id||"",title:`${e.roomName} ${qc(e.period)}`,start:t,end:n,backgroundColor:s.bg,borderColor:s.border,textColor:s.text,extendedProps:{roomName:e.roomName,periodName:e.periodName,reservationName:e.reservationName}}});b(i),T.current={start:n,end:r}}catch(n){console.error("\u30a4\u30d9\u30f3\u30c8\u8aad\u307f\u8fbc\u307f\u30a8\u30e9\u30fc:",n)}finally{S(!1)}},[_,E,C,I]),A=(0,r.useCallback)(e=>{if("dayGridMonth"===h){const t=e.start,n=e.end;D(t,n)}},[h,D]);(0,r.useEffect)(()=>{if("dayGridMonth"===h&&T.current){const{start:e,end:t}=T.current,n=new Date(`${e}T00:00:00`),r=new Date(`${t}T23:59:59`);D(n,r)}},[_,E,h,D]);const k=(0,r.useCallback)(e=>{const t=e.dateStr;null===l||void 0===l||l(t)},[l]),N=(0,r.useCallback)(e=>{const t=e.event.id;null===c||void 0===c||c(t)},[c]),R=(0,r.useCallback)(e=>{const t=qu(e);g(t),v(t),null===s||void 0===s||s(t,"ledger")},[s]),M=(0,r.useCallback)(e=>{if(f(e),"dayGridMonth"===e&&x.current){const e=x.current.getApi(),t=e.view.currentStart,n=e.view.currentEnd;D(t,n)}},[D]);return(0,du.jsxs)("div",{className:"calendar-container",children:[(0,du.jsx)("div",{className:"calendar-toolbar",children:u&&(0,du.jsxs)("div",{className:"view-buttons",children:[(0,du.jsx)("button",{className:"view-btn "+("ledger"===h?"active":""),onClick:()=>M("ledger"),children:"\u53f0\u5e33"}),(0,du.jsx)("button",{className:"view-btn "+("dayGridMonth"===h?"active":""),onClick:()=>M("dayGridMonth"),children:"\u6708"})]})}),"ledger"===h&&(0,du.jsxs)(du.Fragment,{children:[(0,du.jsx)(Fu,{date:p,filterMine:E,onFilterMineChange:i,onDateChange:R,onCellClick:o,onReservationClick:a}),u&&(0,du.jsxs)("div",{className:"daily-reservation-section",children:[(0,du.jsx)("h3",{className:"section-title",children:"\u4e88\u7d04\u72b6\u6cc1"}),(0,du.jsx)(Bu,{date:m,children:(0,du.jsx)(Hu,{selectedDate:m,onDateChange:e=>{v(e),null===s||void 0===s||s(e)},filterMine:E,onFilterMineChange:i})})]})]}),"dayGridMonth"===h&&u&&(0,du.jsxs)("div",{className:"calendar-wrapper",children:[w&&(0,du.jsx)("div",{className:"calendar-loading",children:"\u8aad\u307f\u8fbc\u307f\u4e2d..."}),(0,du.jsx)(al,{ref:x,plugins:[jl,bc,Bc],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:""},locale:"ja",buttonText:{today:"\u4eca\u65e5",month:"\u6708",week:"\u9031",day:"\u65e5"},events:y,dateClick:k,eventClick:N,datesSet:A,height:"auto",dayMaxEvents:3,eventDisplay:"block"})]})]})},Gu=e=>{let{currentUser:t,onLogin:n,onLogout:r}=e;return(0,du.jsx)("div",{className:"user-info-section",children:t?(0,du.jsxs)("div",{className:"current-user-info",children:[(0,du.jsx)("div",{className:"user-details",children:(0,du.jsxs)("div",{className:"user-name",children:["\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u308b\u30e6\u30fc\u30b6\u30fc\uff1a",t.displayName||t.name]})}),(0,du.jsx)("button",{className:"logout-button",onClick:r,title:"\u30ed\u30b0\u30a2\u30a6\u30c8",children:"\u30ed\u30b0\u30a2\u30a6\u30c8"})]}):(0,du.jsxs)("div",{className:"login-prompt",children:[(0,du.jsx)("div",{className:"login-message",children:"\u4e88\u7d04\u3092\u4f5c\u6210\u3059\u308b\u306b\u306f\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044"}),(0,du.jsx)("button",{className:"login-button",onClick:n,children:"\u30ed\u30b0\u30a4\u30f3"})]})})};function Wu(e,t){if(!t)return!1;const n=new Date(e),r=new Date(t);return n.getTime()>r.getTime()}function Qu(e,t){return t&&Wu(e,t)?t:e}const Ku=e=>{let{dateRange:t,setDateRange:n,loading:r,maxDateStr:i,limitMonths:s}=e;return(0,du.jsxs)("div",{className:"form-group",children:[(0,du.jsx)("label",{children:"\u65e5\u4ed8:"}),(0,du.jsxs)("div",{className:"date-range-selector",children:[(0,du.jsxs)("div",{className:"date-toggle",children:[(0,du.jsxs)("label",{children:[(0,du.jsx)("input",{type:"radio",name:"dateMode",checked:!t.isRangeMode,onChange:()=>n(e=>({...e,isRangeMode:!1}))}),"\u5358\u65e5\u4e88\u7d04"]}),(0,du.jsxs)("label",{children:[(0,du.jsx)("input",{type:"radio",name:"dateMode",checked:t.isRangeMode,onChange:()=>n(e=>({...e,isRangeMode:!0}))}),"\u671f\u9593\u4e88\u7d04"]})]}),(0,du.jsx)("div",{className:"date-inputs",children:t.isRangeMode?(0,du.jsxs)(du.Fragment,{children:[(0,du.jsxs)("div",{className:"date-input-group",children:[(0,du.jsx)("label",{children:"\u958b\u59cb\u65e5:"}),(0,du.jsx)("input",{type:"date",value:t.startDate,max:i,onChange:e=>{const t=Qu(e.target.value,i);n(e=>({...e,startDate:t}))},disabled:r,"aria-label":"\u958b\u59cb\u65e5\u3092\u9078\u629e"})]}),(0,du.jsxs)("div",{className:"date-input-group",children:[(0,du.jsx)("label",{children:"\u7d42\u4e86\u65e5:"}),(0,du.jsx)("input",{type:"date",value:t.endDate,max:i,onChange:e=>{const t=Qu(e.target.value,i);n(e=>({...e,endDate:t}))},disabled:r,"aria-label":"\u7d42\u4e86\u65e5\u3092\u9078\u629e"})]})]}):(0,du.jsxs)("div",{className:"date-input-group",children:[(0,du.jsx)("label",{children:"\u65e5\u4ed8:"}),(0,du.jsx)("input",{type:"date",value:t.startDate,max:i,onChange:e=>{const t=Qu(e.target.value,i);n(e=>({...e,startDate:t,endDate:t}))},disabled:r,"aria-label":"\u65e5\u4ed8\u3092\u9078\u629e"})]})}),i&&(0,du.jsxs)("div",{className:"helper-text","aria-live":"polite",children:["\u4e88\u7d04\u306f",i,"\u307e\u3067\u9078\u629e\u3067\u304d\u307e\u3059\u3002"]})]})]})},Yu=e=>{let{periodRange:t,setPeriodRange:n,selectedPeriod:i,onPeriodChange:s,loading:o,reservations:a=[],selectedRoom:l,selectedDate:c}=e;const u=r.useRef(t.isRangeMode);r.useEffect(()=>{!u.current&&t.isRangeMode&&i&&n(e=>({...e,startPeriod:i,endPeriod:i})),u.current=t.isRangeMode},[t.isRangeMode,i,n]);const d=e=>{const t=Hc(String(e)),n=cu(c||"",e);if(!n)return t;const r=e=>`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`;return"0"===e?`${t} (- ${r(n.end)})`:"after"===e?`${t} (${r(n.start)} -)`:`${t} (${r(n.start)} - ${r(n.end)})`},h=e=>{if(!l||!c)return!1;const t=a.some(t=>{if(t.roomId!==l)return!1;if(t.startTime.toDate().toDateString()!==new Date(c).toDateString())return!1;if(t.period.includes(",")){const n=t.period.split(",").map(e=>e.trim());return n.includes(e)}return t.period===e});return t},f=r.useMemo(()=>{if(!c)return uu;try{const e=new Date(c).getDay();return 1===e||3===e?uu:uu.filter(e=>"7"!==e)}catch{return uu}},[c]);return(0,du.jsxs)("div",{className:"form-group",children:[(0,du.jsx)("label",{children:"\u6642\u9650:"}),(0,du.jsxs)("div",{className:"period-range-selector",children:[(0,du.jsxs)("div",{className:"period-toggle",children:[(0,du.jsxs)("label",{children:[(0,du.jsx)("input",{type:"radio",name:"periodMode",checked:!t.isRangeMode,onChange:()=>n(e=>({...e,isRangeMode:!1}))}),"\u5358\u4e00\u6642\u9650"]}),(0,du.jsxs)("label",{children:[(0,du.jsx)("input",{type:"radio",name:"periodMode",checked:t.isRangeMode,onChange:()=>n(e=>({...e,isRangeMode:!0}))}),"\u8907\u6570\u6642\u9650"]})]}),t.isRangeMode?(0,du.jsxs)("div",{className:"period-inputs",children:[(0,du.jsxs)("div",{className:"period-input-group",children:[(0,du.jsx)("label",{children:"\u958b\u59cb\u6642\u9650:"}),(0,du.jsxs)("select",{value:t.startPeriod,onChange:e=>n(t=>({...t,startPeriod:e.target.value})),disabled:o,"aria-label":"\u958b\u59cb\u6642\u9650\u3092\u9078\u629e",children:[(0,du.jsx)("option",{value:"",children:"\u9078\u629e"}),f.map(e=>{const t=h(e),n=t?"period-option reserved":"period-option";return(0,du.jsxs)("option",{value:e,disabled:t,className:n,children:[d(e),t?" (\u4e88\u7d04\u6e08\u307f)":""]},e)})]})]}),(0,du.jsxs)("div",{className:"period-input-group",children:[(0,du.jsx)("label",{children:"\u7d42\u4e86\u6642\u9650:"}),(0,du.jsxs)("select",{value:t.endPeriod,onChange:e=>n(t=>({...t,endPeriod:e.target.value})),disabled:o,"aria-label":"\u7d42\u4e86\u6642\u9650\u3092\u9078\u629e",children:[(0,du.jsx)("option",{value:"",children:"\u9078\u629e"}),f.map(e=>{const t=h(e),n=t?"period-option reserved":"period-option";return(0,du.jsxs)("option",{value:e,disabled:t,className:n,children:[d(e),t?" (\u4e88\u7d04\u6e08\u307f)":""]},e)})]})]})]}):(0,du.jsxs)("select",{value:i,onChange:e=>s(e.target.value),disabled:o,"aria-label":"\u6642\u9650\u3092\u9078\u629e",children:[(0,du.jsx)("option",{value:"",children:"\u6642\u9650\u3092\u9078\u629e"}),f.map(e=>{const t=h(e),n=t?"period-option reserved":"period-option";return(0,du.jsxs)("option",{value:e,disabled:t,className:n,children:[d(e),t?" (\u4e88\u7d04\u6e08\u307f)":""]},e)})]})]})]})},Xu=e=>{let{conflictCheck:t}=e;return t.hasConflict?(0,du.jsxs)("div",{className:"conflict-warning",children:[(0,du.jsxs)("div",{className:"conflict-header",children:["\u26a0\ufe0f ",t.conflictMessage]}),t.conflictDetails.length>0&&(0,du.jsx)("div",{className:"conflict-details",children:t.conflictDetails.map((e,t)=>(0,du.jsxs)("div",{className:"conflict-item",children:["\u2022 ",e]},t))})]}):null},Ju=e=>{let{showForm:t,onShowForm:n,loading:i,currentUser:s,formData:o,updateFormData:a,dateRange:l,setDateRange:c,periodRange:u,setPeriodRange:d,rooms:h,conflictCheck:f,onCreateReservation:p,reservations:g=[],selectedDate:m,maxDateStr:v,limitMonths:y}=e;const b=m||l.startDate,w=(0,r.useMemo)(()=>{const e=["\u5c0f\u6f14\u7fd2\u5ba41","\u5c0f\u6f14\u7fd2\u5ba42","\u5c0f\u6f14\u7fd2\u5ba43","\u5c0f\u6f14\u7fd2\u5ba44","\u5c0f\u6f14\u7fd2\u5ba45","\u5c0f\u6f14\u7fd2\u5ba46","\u5927\u6f14\u7fd2\u5ba41","\u5927\u6f14\u7fd2\u5ba42","\u5927\u6f14\u7fd2\u5ba43","\u5927\u6f14\u7fd2\u5ba44","\u5927\u6f14\u7fd2\u5ba45","\u5927\u6f14\u7fd2\u5ba46","\u30b5\u30c6\u30e9\u30a4\u30c8","\u4f1a\u8b70\u5ba4","\u793e\u4f1a\u79d1\u6559\u5ba4","\u30b0\u30ed\u30fc\u30d0\u30eb\u6559\u5ba4\u2460","\u30b0\u30ed\u30fc\u30d0\u30eb\u6559\u5ba4\u2461","LL\u6559\u5ba4","\u30e2\u30ce\u30e9\u30dc","\u8996\u8074\u899a\u6559\u5ba4","\u591a\u76ee\u7684\u5ba4"];return[...h].sort((t,n)=>{const r=e.indexOf(t.name),i=e.indexOf(n.name);return-1!==r&&-1!==i?r-i:-1!==r?-1:-1!==i?1:t.name.localeCompare(n.name)})},[h]);return t?(0,du.jsx)("div",{className:"reservation-form-section",children:(0,du.jsxs)("div",{className:"reservation-form",children:[(0,du.jsx)("h5",{children:"\ud83d\udcdd \u65b0\u3057\u3044\u4e88\u7d04"}),(0,du.jsx)(Ku,{dateRange:l,setDateRange:c,loading:i,maxDateStr:v,limitMonths:y}),(0,du.jsxs)("div",{className:"form-group",children:[(0,du.jsx)("label",{children:"\u6559\u5ba4:"}),(0,du.jsxs)("select",{value:o.selectedRoom,onChange:e=>a("selectedRoom",e.target.value),disabled:i,"aria-label":"\u6559\u5ba4\u3092\u9078\u629e",children:[(0,du.jsx)("option",{value:"",children:"\u6559\u5ba4\u3092\u9078\u629e"}),w.map(e=>(0,du.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,du.jsx)(Yu,{periodRange:u,setPeriodRange:d,selectedPeriod:o.selectedPeriod,onPeriodChange:e=>a("selectedPeriod",e),loading:i,reservations:g,selectedRoom:o.selectedRoom,selectedDate:b}),(0,du.jsx)(Xu,{conflictCheck:f}),(0,du.jsxs)("div",{className:"form-group",children:[(0,du.jsx)("label",{children:"\u5185\u5bb9:"}),(0,du.jsx)("input",{type:"text",value:o.title,onChange:e=>a("title",e.target.value),placeholder:"\u4e88\u7d04\u306e\u5185\u5bb9\u3092\u5165\u529b\uff0815\u6587\u5b57\u307e\u3067\uff09",maxLength:15,disabled:i}),(0,du.jsxs)("div",{className:"character-count",style:{fontSize:"0.75rem",color:"#666",marginTop:"4px"},children:[o.title.length,"/15\u6587\u5b57"]})]}),(0,du.jsxs)("div",{className:"form-group",children:[(0,du.jsx)("label",{children:"\u4e88\u7d04\u8005\u540d:"}),(0,du.jsx)("input",{type:"text",value:o.reservationName,onChange:e=>a("reservationName",e.target.value),placeholder:"\u4e88\u7d04\u8005\u540d\u3092\u5165\u529b",disabled:i})]}),(0,du.jsxs)("div",{className:"form-buttons",children:[(0,du.jsx)("button",{className:"submit-button "+(f.hasConflict?"disabled conflict":""),onClick:p,disabled:i||f.hasConflict,children:i?"\u4f5c\u6210\u4e2d...":f.hasConflict?"\u91cd\u8907\u306e\u305f\u3081\u4e88\u7d04\u4e0d\u53ef":"\u4e88\u7d04\u3092\u4f5c\u6210"}),(0,du.jsx)("button",{className:"cancel-button",onClick:()=>n(!1),disabled:i,children:"\u30ad\u30e3\u30f3\u30bb\u30eb"})]})]})}):(0,du.jsx)("div",{className:"reservation-form-section",children:(0,du.jsx)("button",{className:"create-button",onClick:()=>n(!0),disabled:i||!s,children:"\u2795 \u65b0\u3057\u3044\u4e88\u7d04\u3092\u4f5c\u6210"})})},Zu=e=>{let{onAuthStateChange:t}=e;const[n,i]=(0,r.useState)(!1),[s,o]=(0,r.useState)(""),[a,l]=(0,r.useState)(""),c=async()=>{if(s.trim()){i(!0),l("");try{await Iu.signInAsAdmin(s)?(t(),o("")):l("\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093")}catch(e){console.error("\u7ba1\u7406\u8005\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc:",e),l("\u30ed\u30b0\u30a4\u30f3\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{i(!1)}}else l("\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044")};return(0,du.jsx)("div",{className:"simple-login-overlay",children:(0,du.jsxs)("div",{className:"simple-login-modal",children:[(0,du.jsxs)("div",{className:"simple-login-header",children:[(0,du.jsx)("h2",{children:"\u685c\u548c\u9ad8\u6821\u6559\u5ba4\u4e88\u7d04\u30b7\u30b9\u30c6\u30e0"}),(0,du.jsx)("button",{className:"close-button",onClick:()=>{},disabled:n,children:"\u2715"})]}),(0,du.jsxs)("div",{className:"simple-login-body",children:[(0,du.jsxs)("div",{className:"login-description",children:[(0,du.jsx)("p",{children:"\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044"}),(0,du.jsxs)("p",{className:"domain-restriction",children:["\ud83d\udce7 ",Iu.getAllowedDomain()," \u30c9\u30e1\u30a4\u30f3\u306e",(0,du.jsx)("br",{}),"Google\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u307f\u5229\u7528\u53ef\u80fd\u3067\u3059"]})]}),a&&(0,du.jsx)("div",{className:"error-message",children:a}),(0,du.jsxs)("div",{className:"login-methods",children:[(0,du.jsxs)("div",{className:"login-method",children:[(0,du.jsx)("h3",{children:"\u901a\u5e38\u30ed\u30b0\u30a4\u30f3"}),(0,du.jsx)("button",{onClick:async()=>{i(!0),l("");try{await Iu.signInWithGoogle(),t()}catch(e){console.error("Google\u30ed\u30b0\u30a4\u30f3\u30a8\u30e9\u30fc:",e),e.message&&e.message.includes(Iu.getAllowedDomain())?l(e.message):l(`\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u306f ${Iu.getAllowedDomain()} \u30c9\u30e1\u30a4\u30f3\u306eGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u307f\u5229\u7528\u3067\u304d\u307e\u3059`)}finally{i(!1)}},disabled:n,className:"google-login-btn",children:n?"\u30ed\u30b0\u30a4\u30f3\u4e2d...":"Google\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3"})]}),(0,du.jsxs)("div",{className:"login-method",children:[(0,du.jsx)("h3",{children:"\u7ba1\u7406\u8005\u30ed\u30b0\u30a4\u30f3"}),(0,du.jsxs)("div",{className:"admin-login",children:[(0,du.jsx)("input",{type:"password",value:s,onChange:e=>o(e.target.value),placeholder:"\u7ba1\u7406\u8005\u30d1\u30b9\u30ef\u30fc\u30c9",onKeyPress:e=>{"Enter"===e.key&&c()},disabled:n}),(0,du.jsx)("button",{onClick:c,disabled:n,className:"admin-login-btn",children:n?"\u30ed\u30b0\u30a4\u30f3\u4e2d...":"\u30ed\u30b0\u30a4\u30f3"})]})]})]})]})]})})},ed=function(){0},td=()=>{const[e,t]=(0,r.useState)({hasConflict:!1,conflictMessage:"",conflictDetails:[]}),n=(0,r.useRef)(null),i=(0,r.useRef)(new Map),o=(0,r.useCallback)(async e=>{const t=`day:${e}`,n=Date.now(),r=i.current.get(t);if(r&&n-r.ts<5e3)return r.periodsByRoom;const{start:o,end:a}=Jc(e),l=await(async()=>{let e=null;for(let t=0;t<3;t++)try{const e=await lu.getReservations(o,a),t={};for(const n of e){const e=n.period.includes(",")?n.period.split(",").map(e=>e.trim()):[n.period];t[n.roomId]||(t[n.roomId]=[]),t[n.roomId].push(...e)}return t}catch(s){e=s,await new Promise(e=>setTimeout(e,400*Math.pow(2,t)))}throw e})();return i.current.set(t,{ts:n,periodsByRoom:l}),l},[]),a=(0,r.useCallback)(async(e,t,n,r)=>{if(ed(),!n||0===e.length||0===t.length)return ed(),{hasConflict:!1,message:"",details:[]};try{const r=[];for(const i of e){ed();const e=(await o(i))[n]||[];ed(e.join(","));for(const n of t){ed();if(e.includes(n)){const e=new Date(i).toLocaleDateString("ja-JP"),t=Hc(n);r.push(`${e} ${t} - \u65e2\u306b\u4e88\u7d04\u304c\u3042\u308a\u307e\u3059`),ed()}else ed()}}return ed(r.length),r.length>0?(ed(),r.forEach((e,t)=>ed()),{hasConflict:!0,message:"\u9078\u629e\u3057\u305f\u6642\u9593\u5e2f\u306f\u65e2\u306b\u4e88\u7d04\u304c\u3042\u308a\u307e\u3059\u3002",details:r}):(ed(),{hasConflict:!1,message:"",details:[]})}catch(i){return console.error("\u91cd\u8907\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc:",i),{hasConflict:!1,message:"",details:[]}}},[o]),l=(0,r.useCallback)(async(e,r,i,s)=>{n.current&&clearTimeout(n.current),n.current=setTimeout(async()=>{if(!i||0===e.length||0===r.length)return ed(),void t({hasConflict:!1,conflictMessage:"",conflictDetails:[]});const n=await a(e,r,i,s);t({hasConflict:n.hasConflict,conflictMessage:n.message,conflictDetails:n.details})},500)},[a]),c=(0,r.useCallback)(()=>{t({hasConflict:!1,conflictMessage:"",conflictDetails:[]})},[]);return{conflictCheck:e,performConflictCheck:l,checkForConflicts:a,resetConflict:c}},nd=function(){0},rd="system_settings",id="global",sd={async get(){const e=Date.now(),t=sd;var n;if(t._cacheTime&&e-t._cacheTime<3e5)return null!==(n=t._cache)&&void 0!==n?n:null;if(t._inflight)return await t._inflight;const r=(async()=>{const e=(0,zc.doc)(Vc.db,rd,id),n=await(0,zc.getDoc)(e),r=n.exists()?n.data():null;return t._cache=r,t._cacheTime=Date.now(),r})().finally(()=>{sd._inflight=null});return t._inflight=r,await r},async upsert(e){const t=(0,zc.doc)(Vc.db,rd,id),n=zc.Timestamp.now();await(0,zc.setDoc)(t,{...e,updatedAt:n},{merge:!0});try{var r;const t=sd,i=null!==(r=t._cache)&&void 0!==r?r:null,s=i?{...i,...e,updatedAt:n}:{...e,updatedAt:n};t._cache=s,t._cacheTime=Date.now()}catch{}}};function od(e){const t=new Date,n=new Date(t);return n.setHours(23,59,59,999),n.setMonth(n.getMonth()+e),n}const ad=()=>{const[e,t]=(0,r.useState)(!0),[n,i]=(0,r.useState)(null),[o,a]=(0,r.useState)(3),[l,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{var n;t(!0);const r=await sd.get();if(!e)return;const i=null!==(n=null===r||void 0===r?void 0:r.reservationLimitMonths)&&void 0!==n?n:3;a(i),null!==r&&void 0!==r&&r.reservationMaxTimestamp?c(r.reservationMaxTimestamp.toDate()):c(od(i))}catch(s){if(!e)return;i((null===s||void 0===s?void 0:s.message)||"\u8a2d\u5b9a\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f"),a(3),c(od(3))}finally{e&&t(!1)}})(),()=>{e=!1}},[]);const u=(0,r.useMemo)(()=>{if(!l)return;return`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`},[l]);return{loading:e,error:n,limitMonths:o,maxDate:l,maxDateStr:u}},ld=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,cd=e=>{let{currentUserId:t}=e;const{loading:n,error:i,maxDate:o,maxDateStr:a}=ad(),[l,c]=(0,r.useState)(a||""),[u,d]=(0,r.useState)(!1),[h,f]=(0,r.useState)(""),{isAdmin:p}=Vu(),g=p;(0,r.useEffect)(()=>{a&&c(a)},[a]);return(0,du.jsxs)("div",{className:"admin-card rls-card",children:[(0,du.jsx)("h5",{className:"rls-title",children:"\ud83d\udee1\ufe0f \u4e88\u7d04\u5236\u9650\u8a2d\u5b9a"}),n&&(0,du.jsx)("div",{className:"rls-loading",children:"\u8a2d\u5b9a\u3092\u8aad\u307f\u8fbc\u307f\u4e2d\u2026"}),i&&(0,du.jsx)("div",{className:"rls-error",children:i}),(0,du.jsxs)("div",{className:"rls-row",children:[(0,du.jsx)("label",{className:"rls-label",children:"\u56fa\u5b9a\u65e5\u4ed8\u3067\u5236\u9650"}),(0,du.jsx)("input",{type:"date",value:l,onChange:e=>c(e.target.value),disabled:!g||u,"aria-label":"\u56fa\u5b9a\u7de0\u5207\u65e5"})]}),(0,du.jsxs)("div",{className:"rls-info",children:[(0,du.jsxs)("div",{children:["\u73fe\u5728\u306e\u9069\u7528\u4e0a\u9650: ",(0,du.jsx)("strong",{children:o?ld(o):"\u672a\u8a2d\u5b9a"})]}),(0,du.jsxs)("div",{children:["\u4eca\u56de\u306e\u4fdd\u5b58\u5185\u5bb9\u30d7\u30ec\u30d3\u30e5\u30fc: ",(0,du.jsx)("strong",{children:l||"\u2014"})]}),(0,du.jsx)("div",{className:"rls-hint",children:"\u4fdd\u5b58\u3059\u308b\u3068 UI \u3068 \u30eb\u30fc\u30eb\uff08\u4e88\u7d04\u4f5c\u6210\u306e startTime\uff09\u306b\u5373\u6642\u53cd\u6620\u3055\u308c\u307e\u3059\u3002"})]}),(0,du.jsxs)("div",{className:"rls-actions",children:[(0,du.jsx)("button",{type:"button",onClick:async()=>{if(t&&g)try{if(d(!0),!l)return void alert("\u56fa\u5b9a\u65e5\u4ed8\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044");const[e,n,r]=l.split("-").map(e=>parseInt(e,10)),i=new Date(e,n-1,r,23,59,59,999);await sd.upsert({reservationMaxTimestamp:zc.Timestamp.fromDate(i),updatedBy:t}),f("\u2705 \u8a2d\u5b9a\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f"),setTimeout(()=>f(""),3e3)}catch(s){console.error(s);const t="permission-denied"===(null===s||void 0===s?void 0:s.code)?"\u274c \u6a29\u9650\u30a8\u30e9\u30fc: \u7ba1\u7406\u8005\u30e1\u30fc\u30eb\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044":"\u274c \u8a2d\u5b9a\u306e\u4fdd\u5b58\u306b\u5931\u6557\u3057\u307e\u3057\u305f";f(t),setTimeout(()=>f(""),4e3)}finally{d(!1)}else alert("\u7ba1\u7406\u8005\u30e1\u30fc\u30eb\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u8a2d\u5b9a\u306e\u4fdd\u5b58\u306b\u306f\u7ba1\u7406\u8005\u6a29\u9650\u304c\u5fc5\u8981\u3067\u3059\uff09")},disabled:u||!g,children:u?"\u4fdd\u5b58\u4e2d\u2026":"\u4fdd\u5b58"}),!g&&(0,du.jsx)("div",{className:"rls-note",children:"\u8a2d\u5b9a\u306e\u5909\u66f4\u306b\u306f\u7ba1\u7406\u8005\u30e1\u30fc\u30eb\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u304c\u5fc5\u8981\u3067\u3059\u3002"}),h&&(0,du.jsx)("div",{className:"rls-msg",children:h})]})]})},ud="rooms",dd="reservations",hd="reservation_slots",fd="weekly_templates",pd="template-lock",gd="normal",md="other",vd=!1;function yd(e){return{...e,priority:e.priority||gd,category:e.category||md,forceOverride:e.forceOverride||vd,weekdays:e.weekdays||(void 0!==e.weekday?[e.weekday]:[1]),id:e.id,name:e.name,roomId:e.roomId,weekday:e.weekday,periods:e.periods,startDate:e.startDate,endDate:e.endDate,createdBy:e.createdBy,createdAt:e.createdAt,updatedBy:e.updatedBy,updatedAt:e.updatedAt,enabled:e.enabled,description:e.description,teacherName:e.teacherName,studentCount:e.studentCount}}const bd=(0,zc.collection)(Vc.db,fd),wd={list:async()=>(await(0,zc.getDocs)(bd)).docs.map(e=>{const t=e.data();return{id:e.id,...yd(t)}}),async upsert(e){const t=e.id||(0,zc.doc)(bd).id,n=(0,zc.serverTimestamp)(),r=(0,zc.doc)(bd,t),i=await(0,zc.getDoc)(r),s={...e,priority:e.priority||gd,category:e.category||md,forceOverride:e.forceOverride||vd,weekdays:e.weekdays||(void 0!==e.weekday?[e.weekday]:[1])},o=(a={...s,id:t,updatedAt:n},Object.fromEntries(Object.entries(a).filter(e=>{let[,t]=e;return void 0!==t})));var a;return i.exists()||(o.createdAt=n,e.createdBy&&(o.createdBy=e.createdBy)),await(0,zc.setDoc)(r,o,{merge:!0}),t},async remove(e){await(0,zc.deleteDoc)((0,zc.doc)(bd,e))},async listByPriority(e){const t=(0,zc.query)(bd,(0,zc.where)("priority","==",e));return(await(0,zc.getDocs)(t)).docs.map(e=>{const t=e.data();return{id:e.id,...yd(t)}})},async listByCategory(e){const t=(0,zc.query)(bd,(0,zc.where)("category","==",e));return(await(0,zc.getDocs)(t)).docs.map(e=>{const t=e.data();return{id:e.id,...yd(t)}})},async listEnabled(){const e=(0,zc.query)(bd,(0,zc.where)("enabled","==",!0));return(await(0,zc.getDocs)(e)).docs.map(e=>{const t=e.data();return{id:e.id,...yd(t)}})},async listByRoom(e){const t=(0,zc.query)(bd,(0,zc.where)("roomId","==",e));return(await(0,zc.getDocs)(t)).docs.map(e=>{const t=e.data();return{id:e.id,...yd(t)}})},async listByWeekday(e){const t=(0,zc.query)(bd,(0,zc.where)("weekdays","array-contains",e));return(await(0,zc.getDocs)(t)).docs.map(e=>{const t=e.data();return{id:e.id,...yd(t)}})}};class Sd{static async resolveTemplateConflicts(e,t){try{switch(e.priority||"normal"){case"critical":return await this.forceOverride(e,t);case"high":return await this.relocateOrRemove(e,t);default:return await this.skipIfConflict(e,t)}}catch(n){return console.error("\u7af6\u5408\u89e3\u6c7a\u30a8\u30e9\u30fc:",n),{success:!1,action:"skipped",conflicts:[],error:n instanceof Error?n.message:"\u4e0d\u660e\u306a\u30a8\u30e9\u30fc"}}}static async forceOverride(e,t){const n=[];for(const i of t)try{i.id&&await lu.deleteReservation(i.id),n.push({date:Zc(i.startTime.toDate()),roomId:i.roomId,roomName:i.roomName,period:i.period,periodName:i.periodName,existingReservation:{id:i.id||"",title:i.title,reservationName:i.reservationName,createdBy:i.createdBy||""},template:{id:e.id||"",name:e.name,roomId:e.roomId,weekday:e.weekday,periods:e.periods,startDate:e.startDate,endDate:e.endDate,enabled:e.enabled,priority:e.priority||"normal",category:e.category||"other",createdBy:e.createdBy,description:e.description,teacherName:e.teacherName,studentCount:e.studentCount,forceOverride:e.forceOverride},action:"overridden"})}catch(r){console.error("\u4e88\u7d04\u524a\u9664\u30a8\u30e9\u30fc:",r)}return{success:!0,action:"overridden",conflicts:n}}static async relocateOrRemove(e,t){const n=[];for(const i of t)try{const t=await this.findAlternativeLocation(i.startTime.toDate(),i.period,e.roomId);t?(await this.moveReservation(i,t),n.push({date:Zc(i.startTime.toDate()),roomId:i.roomId,roomName:i.roomName,period:i.period,periodName:i.periodName,existingReservation:{id:i.id||"",title:i.title,reservationName:i.reservationName,createdBy:i.createdBy||""},template:{id:e.id||"",name:e.name,roomId:e.roomId,weekday:e.weekday,periods:e.periods,startDate:e.startDate,endDate:e.endDate,enabled:e.enabled,priority:e.priority||"normal",category:e.category||"other",createdBy:e.createdBy,description:e.description,teacherName:e.teacherName,studentCount:e.studentCount,forceOverride:e.forceOverride},action:"relocated",newLocation:t})):(i.id&&await lu.deleteReservation(i.id),n.push({date:Zc(i.startTime.toDate()),roomId:i.roomId,roomName:i.roomName,period:i.period,periodName:i.periodName,existingReservation:{id:i.id||"",title:i.title,reservationName:i.reservationName,createdBy:i.createdBy||""},template:{id:e.id||"",name:e.name,roomId:e.roomId,weekday:e.weekday,periods:e.periods,startDate:e.startDate,endDate:e.endDate,enabled:e.enabled,priority:e.priority||"normal",category:e.category||"other",createdBy:e.createdBy,description:e.description,teacherName:e.teacherName,studentCount:e.studentCount,forceOverride:e.forceOverride},action:"overridden"}))}catch(r){console.error("\u4e88\u7d04\u79fb\u52d5\u30a8\u30e9\u30fc:",r)}return{success:!0,action:"relocated",conflicts:n}}static async skipIfConflict(e,t){const n=t.map(t=>({date:Zc(t.startTime.toDate()),roomId:t.roomId,roomName:t.roomName,period:t.period,periodName:t.periodName,existingReservation:{id:t.id||"",title:t.title,reservationName:t.reservationName,createdBy:t.createdBy||""},template:{id:e.id||"",name:e.name,roomId:e.roomId,weekday:e.weekday,periods:e.periods,startDate:e.startDate,endDate:e.endDate,enabled:e.enabled,priority:e.priority||"normal",category:e.category||"other",createdBy:e.createdBy,description:e.description,teacherName:e.teacherName,studentCount:e.studentCount,forceOverride:e.forceOverride},action:"skipped"}));return{success:0===t.length,action:"skipped",conflicts:n}}static async findAlternativeLocation(e,t,n){try{const r=(await(0,zc.getDocs)((0,zc.collection)(Vc.db,ud))).docs.map(e=>({id:e.id,name:e.data().name||"\u4e0d\u660e\u306a\u6559\u5ba4",...e.data()}));for(const i of r){if(i.id===n)continue;if(await this.isPeriodAvailable(Zc(e),i.id,t))return{roomId:i.id,roomName:i.name,period:t}}return null}catch(r){return console.error("\u4ee3\u66ff\u5834\u6240\u691c\u7d22\u30a8\u30e9\u30fc:",r),null}}static async isPeriodAvailable(e,t,n){try{return(await(0,zc.getDocs)((0,zc.query)((0,zc.collection)(Vc.db,hd),(0,zc.where)("roomId","==",t),(0,zc.where)("date","==",e),(0,zc.where)("period","==",n)))).empty}catch(r){return console.error("\u5229\u7528\u53ef\u80fd\u6027\u30c1\u30a7\u30c3\u30af\u30a8\u30e9\u30fc:",r),!1}}static async moveReservation(e,t){try{e.id&&await lu.moveReservation(e.id,t.roomId,t.roomName,t.period)}catch(n){throw console.error("\u4e88\u7d04\u79fb\u52d5\u30a8\u30e9\u30fc:",n),n}}}const Ed=hd,_d=fd;function Cd(e,t){const n=[],r=new Date(e.getFullYear(),e.getMonth(),e.getDate());for(;r<=t;)n.push(new Date(r)),r.setDate(r.getDate()+1);return n}function xd(e){const[t,n,r]=e.split("-").map(e=>parseInt(e,10));return new Date(t,n-1,r)}async function Td(){return(await(0,zc.getDocs)((0,zc.collection)(Vc.db,_d))).docs.map(e=>({id:e.id,...e.data()})).filter(e=>e.enabled)}async function Id(e,t,n){return async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=xd(e),s=xd(t),o=await Td();let a=0,l=0,c=[],u=0,d=0;const h=["critical","high","normal"],f=o.sort((e,t)=>{const n=e.priority||"normal",r=t.priority||"normal";return h.indexOf(n)-h.indexOf(r)});for(const g of f){if(r.priority&&g.priority!==r.priority)continue;const e=xd(g.startDate),t=g.endDate?xd(g.endDate):void 0;for(const o of Cd(i,s)){if(o.getDay()!==g.weekday)continue;if(o<e)continue;if(t&&o>t)continue;const i=Zc(o);for(const e of g.periods)try{const t=await Dd(g,i,e,n,r);t.success?("overridden"===t.action?u++:"relocated"===t.action&&d++,a++):l++,t.conflicts.length>0&&c.push(...t.conflicts)}catch(p){console.error(`\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u51e6\u7406\u30a8\u30e9\u30fc: ${g.name} ${i} ${e}`,p),l++}}}return{created:a,skipped:l,conflicts:c,overridden:u,relocated:d}}(e,t,n)}async function Dd(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(i.experimentalTwoPhase){const s=(0,zc.query)((0,zc.collection)(Vc.db,Ed),(0,zc.where)("roomId","==",e.roomId),(0,zc.where)("date","==",t),(0,zc.where)("period","==",String(n))),o=await(0,zc.getDocs)(s);if(o.empty){const i=await(0,zc.runTransaction)(Vc.db,async i=>{const s=Kc(e.roomId,t,String(n)),o=(0,zc.doc)(Vc.db,Ed,s),a=await i.get(o);if(a.exists()){const e=a.data();return e.type===pd?{success:!1,action:"skipped",conflicts:[]}:{success:!1,action:"skipped",conflicts:[e]}}return i.set(o,{roomId:e.roomId,date:t,period:String(n),reservationId:null,type:pd,templateId:e.id||null,createdBy:r||"template",createdAt:zc.Timestamp.now(),priority:e.priority||"normal",category:e.category||"other"}),{success:!0,action:"skipped",conflicts:[]}});return i}const a=o.docs[0].data();if(a.type===pd)return{success:!1,action:"skipped",conflicts:[]};if(a.reservationId){const s=await(0,zc.getDoc)((0,zc.doc)(Vc.db,dd,String(a.reservationId))),o=s.exists()?{id:s.id,...s.data()}:null;if(o){const s=await Sd.resolveTemplateConflicts(e,[o],{forceOverride:i.forceOverride});if(s.success&&("overridden"===s.action||"relocated"===s.action)){const i=await(0,zc.runTransaction)(Vc.db,async i=>{const o=Kc(e.roomId,t,String(n)),a=(0,zc.doc)(Vc.db,Ed,o),l=await i.get(a);if(l.exists()){return l.data().type!==pd?{success:!1,action:"skipped",conflicts:s.conflicts}:{success:!0,action:s.action,conflicts:s.conflicts}}return i.set(a,{roomId:e.roomId,date:t,period:String(n),reservationId:null,type:pd,templateId:e.id||null,createdBy:r||"template",createdAt:zc.Timestamp.now(),priority:e.priority||"normal",category:e.category||"other"}),{success:!0,action:s.action,conflicts:s.conflicts}});return i}return{success:!1,action:"skipped",conflicts:s.conflicts}}const l=await(0,zc.runTransaction)(Vc.db,async i=>{const s=Kc(e.roomId,t,String(n)),o=(0,zc.doc)(Vc.db,Ed,s),a=await i.get(o);if(a.exists()){a.data().type!==pd&&i.delete(o)}return i.set(o,{roomId:e.roomId,date:t,period:String(n),reservationId:null,type:pd,templateId:e.id||null,createdBy:r||"template",createdAt:zc.Timestamp.now(),priority:e.priority||"normal",category:e.category||"other"}),{success:!0,action:"skipped",conflicts:[]}});return l}return{success:!1,action:"skipped",conflicts:[]}}const s=Kc(e.roomId,t,String(n)),o=(0,zc.doc)(Vc.db,Ed,s);if(i.dryRun){const r=await(0,zc.getDocs)((0,zc.query)((0,zc.collection)(Vc.db,Ed),(0,zc.where)("roomId","==",e.roomId),(0,zc.where)("date","==",t),(0,zc.where)("period","==",String(n))));if(r.empty)return{success:!0,action:"skipped",conflicts:[]};return{success:!1,action:"skipped",conflicts:r.docs.map(e=>e.data())}}return await(0,zc.runTransaction)(Vc.db,async s=>{const a=await s.get(o);if(a.exists()){const l=a.data();if(l.type===pd)return{success:!1,action:"skipped",conflicts:[]};if(l.reservationId){const a=await async function(e){try{const t=await(0,zc.getDocs)((0,zc.query)((0,zc.collection)(Vc.db,dd),(0,zc.where)("__name__","==",e)));if(!t.empty){const e=t.docs[0];return{id:e.id,...e.data()}}return null}catch(t){return console.error("\u65e2\u5b58\u4e88\u7d04\u53d6\u5f97\u30a8\u30e9\u30fc:",t),null}}(l.reservationId);if(a){const l=await Sd.resolveTemplateConflicts(e,[a],{forceOverride:i.forceOverride});if(l.success){if("overridden"===l.action)return s.delete(o),s.set(o,{roomId:e.roomId,date:t,period:String(n),reservationId:null,type:pd,templateId:e.id||null,createdBy:r||"template",createdAt:zc.Timestamp.now(),priority:e.priority||"normal",category:e.category||"other"}),{success:!0,action:"overridden",conflicts:l.conflicts};if("relocated"===l.action)return s.delete(o),s.set(o,{roomId:e.roomId,date:t,period:String(n),reservationId:null,type:pd,templateId:e.id||null,createdBy:r||"template",createdAt:zc.Timestamp.now(),priority:e.priority||"normal",category:e.category||"other"}),{success:!0,action:"relocated",conflicts:l.conflicts}}return{success:!1,action:"skipped",conflicts:l.conflicts}}}return{success:!1,action:"skipped",conflicts:[]}}return s.set(o,{roomId:e.roomId,date:t,period:String(n),reservationId:null,type:pd,templateId:e.id||null,createdBy:r||"template",createdAt:zc.Timestamp.now(),priority:e.priority||"normal",category:e.category||"other"}),{success:!0,action:"skipped",conflicts:[]}})}const Ad=["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"];function kd(e){let{isAdmin:t,currentUserId:n,roomOptions:i}=e;const[o,a]=(0,r.useState)([]),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(null),[h,f]=(0,r.useState)(null),[p,g]=(0,r.useState)(new Set),m=(0,r.useMemo)(()=>Object.fromEntries(i.map(e=>[e.id,e.name])),[i]),v=async()=>{c(!0),f(null);try{const e=await(async()=>{try{console.log("\ud83d\udd0d Firestore\u63a5\u7d9a\u30c6\u30b9\u30c8\u958b\u59cb...");const e=(0,zc.collection)(Vc.db,"system_settings"),t=await(0,zc.getDocs)(e);console.log("\u2705 \u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u8aad\u307f\u53d6\u308a\u6210\u529f:",t.size,"\u4ef6");const n=(0,zc.collection)(Vc.db,fd),r=await(0,zc.getDocs)(n);return console.log("\u2705 \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u8aad\u307f\u53d6\u308a\u6210\u529f:",r.size,"\u4ef6"),!0}catch(h){return console.error("\u274c Firestore\u63a5\u7d9a\u30c6\u30b9\u30c8\u5931\u6557:",h),!1}})();if(!e)return void f("Firestore\u63a5\u7d9a\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u62e1\u5f35\u6a5f\u80fd\u3092\u7121\u52b9\u5316\u3057\u3066\u304f\u3060\u3055\u3044\u3002");const t=await wd.list();a(t)}catch(s){f((null===s||void 0===s?void 0:s.message)||"\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{c(!1)}};(0,r.useEffect)(()=>{v()},[]);return(0,du.jsxs)("div",{className:"rtm-wrap",children:[(0,du.jsxs)("div",{className:"rtm-header",children:[(0,du.jsx)("h3",{children:"\u56fa\u5b9a\uff08\u6bce\u9031\uff09\u4e88\u7d04\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8"}),(0,du.jsxs)("div",{children:[(0,du.jsx)("button",{onClick:v,disabled:l,children:"\u518d\u8aad\u8fbc"}),t&&(0,du.jsx)("button",{onClick:()=>{var e;d({name:"",roomId:(null===(e=i[0])||void 0===e?void 0:e.id)||"",weekday:1,weekdays:[1],periods:[],startDate:(new Date).toISOString().slice(0,10),endDate:void 0,createdBy:n||"unknown",enabled:!0})},disabled:l,children:"\u65b0\u898f\u4f5c\u6210"})]})]}),h&&(0,du.jsx)("div",{className:"rtm-error",children:h}),l&&(0,du.jsx)("div",{className:"rtm-loading",children:"\u8aad\u307f\u8fbc\u307f\u4e2d\u2026"}),!u&&(0,du.jsxs)(du.Fragment,{children:[(0,du.jsxs)("div",{className:"rtm-actions-bar",children:[(0,du.jsxs)("div",{className:"rtm-selection-info",children:["\u9078\u629e\u4e2d: ",p.size,"\u4ef6"]}),(0,du.jsxs)("div",{className:"rtm-action-buttons",children:[(0,du.jsx)("button",{onClick:()=>{const e=Array.from(p);if(1!==e.length)return void alert("\u7de8\u96c6\u3059\u308b\u306b\u306f1\u3064\u306e\u9805\u76ee\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044");const t=o.find(t=>t.id===e[0]);t&&d(t)},disabled:1!==p.size||!t,title:"\u9078\u629e\u3055\u308c\u305f\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u7de8\u96c6",children:"\u7de8\u96c6"}),(0,du.jsx)("button",{onClick:()=>{0!==p.size?window.confirm(`\u9078\u629e\u3055\u308c\u305f${p.size}\u4ef6\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)&&(c(!0),f(null),Promise.all(Array.from(p).map(e=>wd.remove(e))).then(()=>(g(new Set),v())).catch(e=>{f((null===e||void 0===e?void 0:e.message)||"\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}).finally(()=>{c(!1)})):alert("\u524a\u9664\u3059\u308b\u9805\u76ee\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044")},disabled:0===p.size||!t,title:"\u9078\u629e\u3055\u308c\u305f\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u524a\u9664",children:"\u524a\u9664"}),(0,du.jsx)("button",{onClick:()=>{0!==p.size?window.confirm(`\u9078\u629e\u3055\u308c\u305f${p.size}\u4ef6\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u56fa\u5b9a\u4e88\u7d04\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)&&(c(!0),f(null),Promise.all(Array.from(p).map(e=>async function(e,t,n){const r=[(0,zc.where)("type","==",pd),(0,zc.where)("templateId","==",e)];t&&r.push((0,zc.where)("date",">=",t)),n&&r.push((0,zc.where)("date","<=",n));const i=(0,zc.query)((0,zc.collection)(Vc.db,Ed),...r),s=await(0,zc.getDocs)(i);if(s.empty)return{deleted:0,details:[]};const o=s.docs.map(e=>({id:e.id,...e.data()}));let a=0,l=(0,zc.writeBatch)(Vc.db),c=0;for(const u of s.docs)l.delete(u.ref),c++,a++,c>=450&&(await l.commit(),console.log(`... \u30d0\u30c3\u30c1\u30b3\u30df\u30c3\u30c8 (\u7d2f\u8a08 ${a}/${s.size})`),l=(0,zc.writeBatch)(Vc.db),c=0);return c>0&&await l.commit(),console.log(`... \u6700\u7d42\u30b3\u30df\u30c3\u30c8 (\u7d2f\u8a08 ${a}/${s.size})`),{deleted:a,details:o}}(e))).then(e=>{const t=e.reduce((e,t)=>e+t.deleted,0);alert(`${t}\u4ef6\u306e\u56fa\u5b9a\u4e88\u7d04\u3092\u524a\u9664\u3057\u307e\u3057\u305f`),g(new Set)}).catch(e=>{f((null===e||void 0===e?void 0:e.message)||"\u56fa\u5b9a\u4e88\u7d04\u306e\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}).finally(()=>{c(!1)})):alert("\u56fa\u5b9a\u4e88\u7d04\u3092\u524a\u9664\u3059\u308b\u9805\u76ee\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044")},disabled:0===p.size||!t,className:"remove-locks-button",title:"\u9078\u629e\u3055\u308c\u305f\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u56fa\u5b9a\u4e88\u7d04\u3092\u524a\u9664",children:"\u56fa\u5b9a\u4e88\u7d04\u524a\u9664"})]})]}),(0,du.jsx)("div",{className:"rtm-table-container",children:(0,du.jsxs)("table",{className:"rtm-table",children:[(0,du.jsx)("thead",{children:(0,du.jsxs)("tr",{children:[(0,du.jsx)("th",{children:(0,du.jsx)("input",{type:"checkbox",checked:p.size===o.length&&o.length>0,onChange:()=>{p.size===o.length?g(new Set):g(new Set(o.map(e=>e.id)))},title:"\u3059\u3079\u3066\u9078\u629e/\u9078\u629e\u89e3\u9664"})}),(0,du.jsx)("th",{children:"\u540d\u79f0"}),(0,du.jsx)("th",{children:"\u6559\u5ba4"}),(0,du.jsx)("th",{children:"\u66dc\u65e5"}),(0,du.jsx)("th",{children:"\u6642\u9650"}),(0,du.jsx)("th",{children:"\u671f\u9593"}),(0,du.jsx)("th",{children:"\u72b6\u614b"})]})}),(0,du.jsx)("tbody",{children:o.map(e=>{return(0,du.jsxs)("tr",{className:p.has(e.id)?"selected":"",children:[(0,du.jsx)("td",{children:(0,du.jsx)("input",{type:"checkbox",checked:p.has(e.id),onChange:()=>(e=>{const t=new Set(p);t.has(e)?t.delete(e):t.add(e),g(t)})(e.id),title:`${e.name}\u3092\u9078\u629e`})}),(0,du.jsx)("td",{children:e.name}),(0,du.jsx)("td",{children:m[e.roomId]||e.roomId}),(0,du.jsx)("td",{children:(e.weekdays||[e.weekday]).map(e=>Ad[e]).join(", ")}),(0,du.jsx)("td",{children:(t=e.periods,t.map(e=>{const t=String(e);return Gc[t]?Gc[t].name:/^\d+$/.test(String(e))?`${e}\u9650`:String(e)}).join(", "))}),(0,du.jsxs)("td",{children:[e.startDate,e.endDate?` \u301c ${e.endDate}`:""]}),(0,du.jsx)("td",{children:e.enabled?"\u6709\u52b9":"\u7121\u52b9"})]},e.id);var t})})]})})]}),u&&(0,du.jsxs)("div",{className:"rtm-editor",children:[(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{htmlFor:"rtm-name",children:"\u540d\u79f0"}),(0,du.jsx)("input",{id:"rtm-name",value:u.name,onChange:e=>d({...u,name:e.target.value}),title:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d\u79f0","aria-label":"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d\u79f0"})]}),(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{htmlFor:"rtm-room",children:"\u6559\u5ba4"}),(0,du.jsx)("select",{id:"rtm-room",value:u.roomId,onChange:e=>d({...u,roomId:e.target.value}),title:"\u6559\u5ba4\u9078\u629e","aria-label":"\u6559\u5ba4\u9078\u629e",children:i.map(e=>(0,du.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{children:"\u66dc\u65e5\u30fb\u6642\u9650"}),(0,du.jsxs)("div",{className:"weekday-period-container",children:[(0,du.jsxs)("div",{className:"weekday-section",children:[(0,du.jsx)("div",{className:"weekday-label",children:"\u66dc\u65e5:"}),(0,du.jsx)("div",{className:"weekday-toggle-grid",children:Ad.map((e,t)=>{var n,r;return(0,du.jsxs)("label",{className:"toggle weekday-toggle "+(null!==(n=u.weekdays)&&void 0!==n&&n.includes(t)?"on":"off"),children:[(0,du.jsx)("input",{type:"checkbox",checked:(null===(r=u.weekdays)||void 0===r?void 0:r.includes(t))||!1,onChange:e=>{const n=u.weekdays||[u.weekday];let r;r=e.target.checked?[...n,t]:n.filter(e=>e!==t),0===r.length&&(r=[u.weekday]),d({...u,weekdays:r,weekday:r[0]})}}),(0,du.jsx)("span",{children:e})]},t)})})]}),(0,du.jsxs)("div",{className:"period-section",children:[(0,du.jsx)("div",{className:"period-label",children:"\u6642\u9650:"}),(0,du.jsx)("div",{className:"period-toggle-grid",children:$c.map(e=>(0,du.jsxs)("label",{className:"toggle period-toggle "+(u.periods.map(String).includes(String(e))?"on":"off"),children:[(0,du.jsx)("input",{type:"checkbox",checked:u.periods.map(String).includes(String(e)),onChange:t=>{const n=u.periods.map(String);let r;r=t.target.checked?[...n,String(e)]:n.filter(t=>t!==String(e));const i=r.map(e=>/^\d+$/.test(String(e))?Number(e):String(e));d({...u,periods:i})}}),(0,du.jsx)("span",{children:Gc[e].name})]},e))})]})]})]}),(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{htmlFor:"rtm-start",children:"\u958b\u59cb\u65e5\uff08\u9069\u7528\u7bc4\u56f2\uff09"}),(0,du.jsx)("input",{type:"date",value:u.startDate,id:"rtm-start",title:"\u958b\u59cb\u65e5","aria-label":"\u958b\u59cb\u65e5",onChange:e=>d({...u,startDate:e.target.value})})]}),(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{htmlFor:"rtm-end",children:"\u7d42\u4e86\u65e5\uff08\u9069\u7528\u7bc4\u56f2\uff09"}),(0,du.jsx)("input",{type:"date",value:u.endDate||"",id:"rtm-end",title:"\u7d42\u4e86\u65e5","aria-label":"\u7d42\u4e86\u65e5",onChange:e=>d({...u,endDate:e.target.value||void 0})})]}),(0,du.jsxs)("div",{className:"rtm-editor-actions",children:[(0,du.jsx)("button",{onClick:()=>d(null),children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),t&&(0,du.jsx)("button",{onClick:async()=>{if(u)if(t)if(u.name&&u.roomId&&null!=u.weekday&&0!==u.periods.length){c(!0),f(null);try{await wd.upsert({...u,updatedBy:n}),d(null),await v()}catch(s){f((null===s||void 0===s?void 0:s.message)||"\u4fdd\u5b58\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{c(!1)}}else f("\u540d\u79f0/\u6559\u5ba4/\u66dc\u65e5/\u30b3\u30de\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044");else f("\u7ba1\u7406\u8005\u306e\u307f\u7de8\u96c6\u3067\u304d\u307e\u3059")},disabled:l,children:"\u4fdd\u5b58"})]})]})]})}function Nd(e){const[t,n,r]=e.split("-").map(e=>parseInt(e,10));return new Date(t,n-1,r)}function Rd(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function Md(e,t){const n=[],r=new Date(e.getFullYear(),e.getMonth(),e.getDate());for(;r<=t;)n.push(new Date(r)),r.setDate(r.getDate()+1);return n}function Od(e){let{open:t,onClose:i,isAdmin:o,currentUserId:a,roomOptions:l}=e;const{maxDateStr:c,limitMonths:u}=ad(),d=(0,r.useMemo)(()=>(new Date).toISOString().slice(0,10),[]),h=(0,r.useMemo)(()=>{if(c)return c;const e=new Date;return e.setMonth(e.getMonth()+(u||3)),e.toISOString().slice(0,10)},[c,u]),[f,p]=(0,r.useState)(d),[g,m]=(0,r.useState)(h),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1),[S,E]=(0,r.useState)(""),[_,C]=(0,r.useState)(""),[x,T]=(0,r.useState)(!1);if(!t)return null;const I=e=>c&&e>c?c:e;return(0,du.jsx)("div",{className:"rtm-modal-backdrop",children:(0,du.jsxs)("div",{className:"rtm-modal",children:[(0,du.jsxs)("div",{className:"rtm-modal-header",children:[(0,du.jsx)("h3",{children:"\u56fa\u5b9a\uff08\u6bce\u9031\uff09\u4e88\u7d04\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8"}),(0,du.jsx)("button",{onClick:i,className:"close-btn",children:"\xd7"})]}),(0,du.jsxs)("div",{className:"rtm-modal-body",children:[(0,du.jsxs)("div",{className:"rtm-pane",children:[(0,du.jsx)("h4",{children:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u4e00\u89a7/\u7de8\u96c6"}),(0,du.jsx)(kd,{isAdmin:o,currentUserId:a,roomOptions:l})]}),(0,du.jsxs)("div",{className:"rtm-pane",children:[(0,du.jsx)("h4",{children:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u9069\u7528\uff08\u30ed\u30c3\u30af\u751f\u6210\uff09"}),(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{children:"\u958b\u59cb\u65e5"}),(0,du.jsx)("input",{type:"date",value:f,onChange:e=>p(e.target.value),title:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u9069\u7528\u306e\u958b\u59cb\u65e5"})]}),(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{children:"\u7d42\u4e86\u65e5"}),(0,du.jsx)("input",{type:"date",value:g,max:c||void 0,onChange:e=>m(I(e.target.value)),title:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u9069\u7528\u306e\u7d42\u4e86\u65e5"})]}),(0,du.jsxs)("div",{className:"hint",children:["\u6700\u5927\u4e88\u7d04\u65e5: ",c||"\uff08\u672a\u8a2d\u5b9a\uff09"]}),(0,du.jsxs)("div",{className:"actions",style:{display:"flex",gap:8},children:[(0,du.jsx)("button",{onClick:async()=>{if(o)if(!f||!g||f>g)alert("\u9069\u7528\u671f\u9593\u3092\u6b63\u3057\u304f\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044");else{y(!0),E("\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u9069\u7528\u4e2d...");try{const e=await Id(f,g,a);E(`\u2705 \u30ed\u30c3\u30af\u751f\u6210\u5b8c\u4e86: \u8ffd\u52a0 ${e.created} / \u65e2\u5b58 ${e.skipped}`)}catch(s){console.error(s),E(`\u274c \u5931\u6557: ${(null===s||void 0===s?void 0:s.message)||"\u4e0d\u660e\u306a\u30a8\u30e9\u30fc"}`)}finally{y(!1),setTimeout(()=>E(""),5e3)}}},disabled:!o||v,children:"\u30ed\u30c3\u30af\u751f\u6210"}),(0,du.jsx)("button",{onClick:async()=>{if(o)if(!f||!g||f>g)alert("\u524a\u9664\u671f\u9593\u3092\u6b63\u3057\u304f\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044");else if(window.confirm(`\u671f\u9593 ${f} \u301c ${g} \u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30ed\u30c3\u30af\u3092\u524a\u9664\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f`)){T(!0),E("\u30ed\u30c3\u30af\u3092\u524a\u9664\u4e2d...");try{const e=await async function(e,t,n){let r=0;const i=[(0,zc.where)("date",">=",e),(0,zc.where)("date","<=",t),(0,zc.where)("type","==",pd)];null!==n&&void 0!==n&&n.roomId&&i.push((0,zc.where)("roomId","==",n.roomId)),null!==n&&void 0!==n&&n.templateId&&i.push((0,zc.where)("templateId","==",n.templateId));const s=(0,zc.query)((0,zc.collection)(Vc.db,Ed),...i),o=await(0,zc.getDocs)(s);if(!o.empty){let e=0,t=(0,zc.writeBatch)(Vc.db),n=0;for(const r of o.docs)t.delete(r.ref),n++,e++,n>=450&&(await t.commit(),console.log(`... \u30b9\u30ed\u30c3\u30c8\u30d0\u30c3\u30c1\u30b3\u30df\u30c3\u30c8 (\u7d2f\u8a08 ${e}/${o.size})`),t=(0,zc.writeBatch)(Vc.db),n=0);n>0&&await t.commit(),console.log(`... \u30b9\u30ed\u30c3\u30c8\u6700\u7d42\u30b3\u30df\u30c3\u30c8 (\u7d2f\u8a08 ${e}/${o.size})`),r+=e}const a=new Date(e),l=new Date(t);l.setHours(23,59,59,999);const c=[(0,zc.where)("startTime",">=",zc.Timestamp.fromDate(a)),(0,zc.where)("startTime","<=",zc.Timestamp.fromDate(l))];null!==n&&void 0!==n&&n.roomId&&c.push((0,zc.where)("roomId","==",n.roomId));const u=(0,zc.query)((0,zc.collection)(Vc.db,"reservations"),...c),d=await(0,zc.getDocs)(u);if(!d.empty){let e=0,t=(0,zc.writeBatch)(Vc.db),i=0;for(const r of d.docs){const s=r.data();s.createdBy&&s.title&&(null!==n&&void 0!==n&&n.templateId||s.createdBy.includes("cu1vyAtjBjTizSkCOsV2AxsMA6H2"))&&(t.delete(r.ref),i++,e++,i>=450&&(await t.commit(),console.log(`... \u4e88\u7d04\u30d0\u30c3\u30c1\u30b3\u30df\u30c3\u30c8 (\u7d2f\u8a08 ${e})`),t=(0,zc.writeBatch)(Vc.db),i=0))}i>0&&await t.commit(),console.log(`... \u4e88\u7d04\u6700\u7d42\u30b3\u30df\u30c3\u30c8 (\u7d2f\u8a08 ${e})`),r+=e}return{deleted:r}}(f,g);E(`\u2705 \u30ed\u30c3\u30af\u524a\u9664\u5b8c\u4e86: \u524a\u9664 ${e.deleted}`)}catch(s){console.error(s),E(`\u274c \u5931\u6557: ${(null===s||void 0===s?void 0:s.message)||"\u4e0d\u660e\u306a\u30a8\u30e9\u30fc"}`)}finally{T(!1),setTimeout(()=>E(""),5e3)}}},disabled:!o||x,children:"\u30ed\u30c3\u30af\u524a\u9664"})]})]}),S&&(0,du.jsx)("div",{className:"msg",children:S}),(0,du.jsx)("div",{className:"note",children:"\u6ce8: \u30ed\u30c3\u30af\u306f\u4e88\u7d04\u30b9\u30ed\u30c3\u30c8\u306b\u4f5c\u6210\u3055\u308c\u3001\u901a\u5e38\u306e\u4e88\u7d04\u4f5c\u6210\u3092\u30d6\u30ed\u30c3\u30af\u3057\u307e\u3059\u3002"}),(0,du.jsxs)("div",{className:"rtm-pane",children:[(0,du.jsx)("h4",{children:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u9069\u7528\uff08\u5b9f\u4e88\u7d04\u751f\u6210\uff09"}),(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{children:"\u958b\u59cb\u65e5"}),(0,du.jsx)("input",{type:"date",value:f,onChange:e=>p(e.target.value)})]}),(0,du.jsxs)("div",{className:"form-row",children:[(0,du.jsx)("label",{children:"\u7d42\u4e86\u65e5"}),(0,du.jsx)("input",{type:"date",value:g,max:c||void 0,onChange:e=>m(I(e.target.value))})]}),(0,du.jsx)("div",{className:"hint",children:"\u6ce8: \u5b9f\u4e88\u7d04\u306f\u5f93\u6765\u306e\u624b\u52d5\u4e88\u7d04\u3068\u540c\u4e00\u306e\u51e6\u7406\u3067\u4f5c\u6210\u3055\u308c\u307e\u3059\uff08\u30b9\u30ed\u30c3\u30c8\u91cd\u8907\u306f\u81ea\u52d5\u30b9\u30ad\u30c3\u30d7\uff09\u3002"}),(0,du.jsx)("div",{className:"actions",children:(0,du.jsx)("button",{onClick:async()=>{if(o)if(!f||!g||f>g)alert("\u9069\u7528\u671f\u9593\u3092\u6b63\u3057\u304f\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044");else{w(!0),C("\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304b\u3089\u5b9f\u4e88\u7d04\u3092\u4f5c\u6210\u4e2d...");try{const e=await async function(e,t,r){const i=Nd(e),o=Nd(t),a=await Td();let l=0,c=0,u=0;for(const d of a){const e=Nd(d.startDate),t=d.endDate?Nd(d.endDate):void 0;for(const a of Md(i,o)){if(a.getDay()!==d.weekday)continue;if(a<e)continue;if(t&&a>t)continue;const i=Rd(a);for(const e of d.periods)try{const t=cu(i,String(e));if(!t){c++;continue}await lu.addReservation({roomId:d.roomId,roomName:d.roomId,title:d.name||"\u56fa\u5b9a\u4e88\u7d04",reservationName:"\u56fa\u5b9a\u4e88\u7d04",startTime:(await Promise.resolve().then(n.bind(n,32))).Timestamp.fromDate(t.start),endTime:(await Promise.resolve().then(n.bind(n,32))).Timestamp.fromDate(t.end),period:String(e),periodName:t.periodName,createdBy:r||"template"}),l++}catch(s){const t=String((null===s||void 0===s?void 0:s.message)||"");/\u65e2\u306b\u5b58\u5728\u3057\u307e\u3059|exists/i.test(t)?c++:u++}}}return{created:l,skipped:c,errors:u}}(f,g,a);C(`\u2705 \u5b9f\u4e88\u7d04\u751f\u6210: \u4f5c\u6210 ${e.created} / \u91cd\u8907 ${e.skipped} / \u5931\u6557 ${e.errors}`)}catch(s){console.error(s),C(`\u274c \u5931\u6557: ${(null===s||void 0===s?void 0:s.message)||"\u4e0d\u660e\u306a\u30a8\u30e9\u30fc"}`)}finally{w(!1),setTimeout(()=>C(""),7e3)}}},disabled:!o||b,children:"\u5b9f\u4e88\u7d04\u3092\u4f5c\u6210"})}),_&&(0,du.jsx)("div",{className:"msg",children:_})]})]})]})})}const Pd=()=>{const{currentUser:e,isAdmin:t,isSuperAdmin:n,refreshAdminStatus:i}=Vu(),[s,o]=(0,r.useState)([]),[a,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(null),[f,p]=(0,r.useState)(null),[g,m]=(0,r.useState)(null),v=async()=>{try{u(!0),h(null),console.log("\ud83d\udccb \u7ba1\u7406\u8005\u30ea\u30b9\u30c8\u8aad\u307f\u8fbc\u307f\u958b\u59cb");const e=await _u.getAdminUsers();o(e);try{const e=await _u.getUidByEmail(Su);e&&m(e)}catch{}console.log("\ud83d\udccb \u7ba1\u7406\u8005\u30ea\u30b9\u30c8\u8aad\u307f\u8fbc\u307f\u5b8c\u4e86:",e.length,"\u4ef6")}catch(d){console.error("\u274c \u7ba1\u7406\u8005\u30ea\u30b9\u30c8\u8aad\u307f\u8fbc\u307f\u30a8\u30e9\u30fc:",d),h("\u7ba1\u7406\u8005\u30ea\u30b9\u30c8\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{u(!1)}},y=e=>{try{if(!e)return"\u4e0d\u660e";if("function"===typeof e.toDate){return e.toDate().toLocaleDateString("ja-JP")}if("number"===typeof e.seconds){return new Date(1e3*e.seconds).toLocaleDateString("ja-JP")}const t=new Date(e);return Number.isNaN(t.getTime())?"\u4e0d\u660e":t.toLocaleDateString("ja-JP")}catch{return"\u4e0d\u660e"}};return(0,r.useEffect)(()=>{t&&v()},[t]),t?(0,du.jsxs)("div",{className:"admin-user-manager",children:[(0,du.jsxs)("div",{className:"admin-header",children:[(0,du.jsx)("h3",{children:"\ud83d\udc51 \u7ba1\u7406\u8005\u6a29\u9650\u7ba1\u7406"}),(0,du.jsx)("p",{children:"\u30b7\u30b9\u30c6\u30e0\u306e\u7ba1\u7406\u8005\u6a29\u9650\u3092\u7ba1\u7406\u3067\u304d\u307e\u3059\u3002"})]}),d&&(0,du.jsxs)("div",{className:"error-message",children:[(0,du.jsxs)("span",{children:["\u274c ",d]}),(0,du.jsx)("button",{onClick:()=>{h(null)},className:"close-btn",children:"\xd7"})]}),f&&(0,du.jsxs)("div",{className:"success-message",children:[(0,du.jsxs)("span",{children:["\u2705 ",f]}),(0,du.jsx)("button",{onClick:()=>{p(null)},className:"close-btn",children:"\xd7"})]}),n&&(0,du.jsxs)("div",{className:"add-admin-section",children:[(0,du.jsx)("h4",{children:"\u2795 \u65b0\u3057\u3044\u7ba1\u7406\u8005\u3092\u8ffd\u52a0"}),(0,du.jsxs)("div",{className:"add-admin-form",children:[(0,du.jsx)("input",{type:"email",value:a,onChange:e=>l(e.target.value),placeholder:"\u7ba1\u7406\u8005\u306b\u8ffd\u52a0\u3059\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9",disabled:c,className:"email-input"}),(0,du.jsx)("button",{onClick:async()=>{if(!a||!e)return void h("\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044");if(!n)return void h("\u7ba1\u7406\u8005\u306e\u8ffd\u52a0\u306f\u6700\u521d\u306e\u7ba1\u7406\u8005\uff08\u30b9\u30fc\u30d1\u30fc\u7ba1\u7406\u8005\uff09\u306e\u307f\u304c\u884c\u3048\u307e\u3059");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))try{u(!0),h(null),p(null),console.log("\u2795 \u7ba1\u7406\u8005\u8ffd\u52a0\u958b\u59cb:",a);const t=await _u.getUidByEmail(a);if(!t)return void h("\u3053\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\u307e\u305a\u305d\u306e\u30e6\u30fc\u30b6\u30fc\u306bGoogle\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3082\u3089\u3063\u3066\u304f\u3060\u3055\u3044\u3002");await _u.addAdmin(t,a,e.uid),l(""),p("\u7ba1\u7406\u8005\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f"),await v(),t===e.uid&&await i(),console.log("\u2705 \u7ba1\u7406\u8005\u8ffd\u52a0\u5b8c\u4e86")}catch(d){console.error("\u274c \u7ba1\u7406\u8005\u8ffd\u52a0\u30a8\u30e9\u30fc:",d),h(d.message||"\u7ba1\u7406\u8005\u306e\u8ffd\u52a0\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{u(!1)}else h("\u6b63\u3057\u3044\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044")},disabled:c||!a,className:"add-admin-btn",children:c?"\u51e6\u7406\u4e2d...":"\u7ba1\u7406\u8005\u306b\u8ffd\u52a0"})]}),(0,du.jsx)("p",{className:"form-note",children:"\u203b \u7ba1\u7406\u8005\u306b\u8ffd\u52a0\u3059\u308b\u30e6\u30fc\u30b6\u30fc\u306f\u3001\u307e\u305aGoogle\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304b\u3089\u7ba1\u7406\u8005\u8ffd\u52a0\u3092\u884c\u3063\u3066\u304f\u3060\u3055\u3044"})]}),(0,du.jsxs)("div",{className:"admin-list-section",children:[(0,du.jsx)("h4",{children:"\ud83d\udccb \u73fe\u5728\u306e\u7ba1\u7406\u8005\u4e00\u89a7"}),c?(0,du.jsx)("div",{className:"loading-message",children:(0,du.jsx)("span",{children:"\u23f3 \u8aad\u307f\u8fbc\u307f\u4e2d..."})}):0===s.length?(0,du.jsx)("div",{className:"empty-message",children:(0,du.jsx)("span",{children:"\ud83d\udced \u7ba1\u7406\u8005\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093"})}):(0,du.jsx)("div",{className:"admin-list",children:s.map(t=>(0,du.jsxs)("div",{className:"admin-user-item",children:[(0,du.jsxs)("div",{className:"admin-user-info",children:[(0,du.jsx)("span",{className:"admin-email",children:t.email}),(0,du.jsxs)("span",{className:"admin-uid",children:["ID: ",t.uid]}),(0,du.jsxs)("span",{className:"admin-assigned-date",children:["\u8ffd\u52a0\u65e5: ",y(t.assignedAt)]})]}),n&&"super"!==t.tier&&t.email!==Su&&t.uid!==g&&(0,du.jsx)("button",{onClick:()=>(async(t,r)=>{if(n)if(r!==Su){if(window.confirm(`\u300c${r}\u300d\u306e\u7ba1\u7406\u8005\u6a29\u9650\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`))try{u(!0),h(null),p(null),console.log("\u2796 \u7ba1\u7406\u8005\u524a\u9664\u958b\u59cb:",t),await _u.removeAdmin(t),p("\u7ba1\u7406\u8005\u6a29\u9650\u3092\u524a\u9664\u3057\u307e\u3057\u305f"),await v(),t===(null===e||void 0===e?void 0:e.uid)&&await i(),console.log("\u2705 \u7ba1\u7406\u8005\u524a\u9664\u5b8c\u4e86")}catch(d){console.error("\u274c \u7ba1\u7406\u8005\u524a\u9664\u30a8\u30e9\u30fc:",d),h(d.message||"\u7ba1\u7406\u8005\u6a29\u9650\u306e\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{u(!1)}}else h("\u521d\u671f\u7ba1\u7406\u8005\u306f\u524a\u9664\u3067\u304d\u307e\u305b\u3093");else h("\u7ba1\u7406\u8005\u306e\u524a\u9664\u306f\u6700\u521d\u306e\u7ba1\u7406\u8005\u306e\u307f\u304c\u884c\u3048\u307e\u3059")})(t.uid,t.email),className:"remove-admin-btn",disabled:c,title:"\u7ba1\u7406\u8005\u6a29\u9650\u3092\u524a\u9664",children:"\ud83d\uddd1\ufe0f \u524a\u9664"}),(!n||"super"===t.tier||t.email===Su||t.uid===g)&&(0,du.jsx)("span",{className:"no-permission-text",children:"\u524a\u9664\u4e0d\u53ef"})]},t.uid))})]}),(0,du.jsxs)("div",{className:"admin-stats",children:[(0,du.jsxs)("p",{children:["\ud83d\udcca \u7ba1\u7406\u8005\u6570: ",s.length,"\u4eba"]}),e&&(0,du.jsxs)("p",{children:["\ud83d\udc64 \u73fe\u5728\u306e\u30e6\u30fc\u30b6\u30fc: ",e.email]})]})]}):(0,du.jsx)("div",{className:"admin-user-manager",children:(0,du.jsxs)("div",{className:"access-denied",children:[(0,du.jsx)("h3",{children:"\ud83d\udd12 \u30a2\u30af\u30bb\u30b9\u62d2\u5426"}),(0,du.jsx)("p",{children:"\u3053\u306e\u6a5f\u80fd\u3092\u4f7f\u7528\u3059\u308b\u306b\u306f\u7ba1\u7406\u8005\u6a29\u9650\u304c\u5fc5\u8981\u3067\u3059\u3002"})]})})},Ld="2.1.3",jd=e=>{let{selectedDate:t,selectedEventId:n,onClose:i,onReservationCreated:s,prefilledRoomId:o,prefilledPeriod:a}=e;const{currentUser:l,showLoginModal:c,setShowLoginModal:u,handleLoginSuccess:d,handleLogout:h,isAdmin:f,isSuperAdmin:p}=Vu(),{rooms:g,reservations:m}=zu(),{reservations:v}=pu(),y=r.useMemo(()=>Array.isArray(m)&&m.length>0?m:Array.isArray(v)?v:[],[m,v]),b=(0,r.useMemo)(()=>g.filter(e=>!!e.id).map(e=>({id:e.id,name:e.name})),[g]),[w,S]=(0,r.useState)(!1),[E,_]=(0,r.useState)(!1),C=(0,r.useRef)(0),x=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0;const[s,o]=(0,r.useState)(!1),[a,l]=(0,r.useState)(!1),{checkForConflicts:c}=td(),[u,d]=(0,r.useState)({selectedRoom:"",selectedPeriod:"",title:"",reservationName:""}),[h,f]=(0,r.useState)({startDate:e||"",endDate:e||"",isRangeMode:!1}),[p,g]=(0,r.useState)({startPeriod:"",endPeriod:"",isRangeMode:!1});(0,r.useEffect)(()=>{e&&f(t=>({...t,startDate:e,endDate:e}))},[e]),(0,r.useEffect)(()=>{d(t?e=>({...e,reservationName:t.displayName||t.name||""}):e=>({...e,reservationName:""}))},[t]);const m=(0,r.useCallback)((e,t)=>{d(n=>({...n,[e]:t}))},[]),v=(0,r.useCallback)((e,t)=>{const n=[],r=new Date(e),i=new Date(t);for(;r<=i;)n.push(r.toISOString().split("T")[0]),r.setDate(r.getDate()+1);return n},[]),y=(0,r.useCallback)((e,t)=>{const n=["0","1","2","3","4","lunch","5","6","7","after"],r=n.indexOf(e),i=n.indexOf(t);return-1===r||-1===i||r>i?[]:n.slice(r,i+1)},[]),b=(0,r.useCallback)(()=>h.isRangeMode?v(h.startDate,h.endDate):h.startDate?[h.startDate]:e?[e]:[],[h.isRangeMode,h.startDate,h.endDate,e,v]),w=(0,r.useCallback)(()=>p.isRangeMode?y(p.startPeriod,p.endPeriod):u.selectedPeriod?[u.selectedPeriod]:[],[p.isRangeMode,p.startPeriod,p.endPeriod,u.selectedPeriod,y]),S=(0,r.useCallback)(()=>{d(e=>({selectedRoom:"",selectedPeriod:"",title:"",reservationName:e.reservationName})),o(!1),e&&f({isRangeMode:!1,startDate:e,endDate:e}),g({isRangeMode:!1,startPeriod:"",endPeriod:""})},[e]);return{showForm:s,setShowForm:o,loading:a,formData:u,setFormData:d,updateFormData:m,dateRange:h,setDateRange:f,periodRange:p,setPeriodRange:g,handleCreateReservation:async()=>{if(!t)return void he.error("\u4e88\u7d04\u3092\u4f5c\u6210\u3059\u308b\u306b\u306f\u30ed\u30b0\u30a4\u30f3\u304c\u5fc5\u8981\u3067\u3059");const e=b(),r=w();if(0===e.length||!u.selectedRoom||0===r.length||!u.title.trim()||!u.reservationName.trim())return void he.error("\u3059\u3079\u3066\u306e\u9805\u76ee\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044");nd("\ud83d\udd0d \u91cd\u8907\u30c1\u30a7\u30c3\u30af\u958b\u59cb:",{datesToReserve:e,periodsToReserve:r,selectedRoom:u.selectedRoom,userId:null===t||void 0===t?void 0:t.uid});const s=await c(e,r,u.selectedRoom,null===t||void 0===t?void 0:t.uid);if(nd("\ud83d\udd0d \u91cd\u8907\u30c1\u30a7\u30c3\u30af\u7d50\u679c:",s),s.hasConflict){const e=`${s.message}\n\n${s.details.join("\n")}`;return nd("\u274c \u91cd\u8907\u691c\u51fa:",e),void he.error(e,{duration:5e3})}nd("\u2705 \u91cd\u8907\u306a\u3057\u3001\u4e88\u7d04\u4f5c\u6210\u7d9a\u884c");try{l(!0);const s=n.find(e=>e.id===u.selectedRoom);if(!s)return void he.error("\u6559\u5ba4\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093");const o=[];for(const n of e)if(1===r.length){const e=r[0],i=cu(n,e);if(!i)throw new Error(`\u65e5\u6642\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f: ${n} ${e}`);const a={roomId:u.selectedRoom,roomName:s.name,title:u.title.trim(),reservationName:u.reservationName.trim(),startTime:zc.Timestamp.fromDate(i.start),endTime:zc.Timestamp.fromDate(i.end),period:e,periodName:Hc(e),createdAt:zc.Timestamp.now(),createdBy:t.uid};nd("\ud83d\udcdd \u5358\u4e00\u6642\u9650\u4e88\u7d04\u4f5c\u6210:",{period:a.period,periodName:a.periodName,startTime:i.start,endTime:i.end}),o.push(lu.addReservation(a))}else{const e=r[0],i=r[r.length-1],a=cu(n,e),l=cu(n,i);if(!a||!l)throw new Error(`\u65e5\u6642\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f: ${n} ${e}-${i}`);const c=r.length>1?`${Hc(e)}\u301c${Hc(i)}`:Hc(e),d={roomId:u.selectedRoom,roomName:s.name,title:u.title.trim(),reservationName:u.reservationName.trim(),startTime:zc.Timestamp.fromDate(a.start),endTime:zc.Timestamp.fromDate(l.end),period:r.join(","),periodName:c,createdAt:zc.Timestamp.now(),createdBy:t.uid};nd("\ud83d\udcdd \u8907\u6570\u6642\u9650\u4e88\u7d04\u4f5c\u6210:",{period:d.period,periodName:d.periodName,periodsToReserve:r,startTime:a.start,endTime:l.end}),o.push(lu.addReservation(d))}await Promise.all(o),S(),i&&i();const a=e.length;a>1?r.length>1?he.success(`${a}\u4ef6\u306e\u4e88\u7d04\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\uff08${e.length}\u65e5\u9593 \xd7 ${r.length}\u6642\u9650\u9023\u7d9a\uff09`):he.success(`${a}\u4ef6\u306e\u4e88\u7d04\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\uff08${e.length}\u65e5\u9593\uff09`):r.length>1?he.success(`\u4e88\u7d04\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\uff08${r.length}\u6642\u9650\u9023\u7d9a\uff09`):he.success("\u4e88\u7d04\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f"),setTimeout(()=>window.location.reload(),500)}catch(o){console.error("\u4e88\u7d04\u4f5c\u6210\u30a8\u30e9\u30fc:",o),he.error("\u4e88\u7d04\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{l(!1)}},resetForm:S,getReservationDates:b,getReservationPeriods:w,generateDateList:v,generatePeriodList:y}}(t,l,g,()=>{C.current=Date.now()+2e3;try{D()}catch{}try{s&&s()}catch{}});(0,r.useEffect)(()=>{o&&a&&(x.updateFormData("selectedRoom",o),x.updateFormData("selectedPeriod",a),x.setShowForm(!0))},[o,a]);const{conflictCheck:T,performConflictCheck:I,resetConflict:D}=td(),{maxDateStr:A,limitMonths:k}=ad(),{showForm:N,formData:R,getReservationDates:M,getReservationPeriods:O}=x,{selectedRoom:P}=R;(0,r.useEffect)(()=>{if(N){if(Date.now()<C.current)return;const e=setTimeout(()=>{const e=M(),t=O();e.length>0&&t.length>0&&P&&I(e,t,P,null===l||void 0===l?void 0:l.uid)},300);return()=>clearTimeout(e)}},[N,P,M,O,I,null===l||void 0===l?void 0:l.uid]),(0,r.useEffect)(()=>{D()},[t,P,D]),(0,r.useEffect)(()=>{if(!c)return;const e=e=>{"Escape"===e.key&&u(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[c,u]);return(0,du.jsxs)("div",{className:"side-panel",children:[(0,du.jsx)("div",{className:"only-mobile mobile-inline-close-wrapper",children:(0,du.jsx)("button",{onClick:i,"aria-label":"\u9589\u3058\u308b",className:"mobile-inline-close-btn",children:"\u2715 \u9589\u3058\u308b"})}),(0,du.jsx)(Gu,{currentUser:l,onLogin:()=>u(!0),onLogout:h}),(0,du.jsx)("div",{className:"side-panel-header",children:(0,du.jsxs)("h3",{children:["\ud83d\udcc5 \u4e88\u7d04\u7ba1\u7406 ",(0,du.jsxs)("span",{className:"app-version",children:["Ver ",Ld]})]})}),t?(0,du.jsxs)("div",{className:"side-panel-content",children:[(0,du.jsx)("div",{className:"selected-date",children:(0,du.jsx)("h4",{children:(L=t,new Date(L).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",weekday:"long"}))})}),(0,du.jsx)(Ju,{showForm:x.showForm,onShowForm:x.setShowForm,loading:x.loading,currentUser:l,formData:x.formData,updateFormData:x.updateFormData,dateRange:x.dateRange,setDateRange:x.setDateRange,periodRange:x.periodRange,setPeriodRange:x.setPeriodRange,rooms:g,conflictCheck:T,onCreateReservation:async()=>{const e=function(e,t){if(!t)return{ok:!0};for(const n of e)if(Wu(n,t))return{ok:!1,firstInvalid:n};return{ok:!0}}(x.getReservationDates(),A);if(!e.ok){const t=`\u8a2d\u5b9a\u3057\u305f\u65e5\u4ed8\uff08${A}\uff09\u307e\u3067\u3057\u304b\u4e88\u7d04\u3067\u304d\u307e\u305b\u3093\u3002\u7121\u52b9\u306a\u65e5\u4ed8: ${e.firstInvalid}`;return void he.error(t,{duration:4e3})}await x.handleCreateReservation()},reservations:y,selectedDate:t,maxDateStr:A,limitMonths:k}),f&&(0,du.jsxs)("div",{className:"admin-section",children:[(0,du.jsx)("h4",{children:"\ud83d\udd27 \u7ba1\u7406\u8005\u6a5f\u80fd"}),(0,du.jsx)(cd,{currentUserId:null===l||void 0===l?void 0:l.uid}),p&&(0,du.jsxs)("div",{className:"admin-actions-row",children:[(0,du.jsx)("button",{className:"admin-btn",onClick:()=>S(!0),children:"\u56fa\u5b9a\u4e88\u7d04\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u958b\u304f"}),(0,du.jsx)("button",{className:"admin-btn",onClick:()=>_(!0),children:"\u7ba1\u7406\u8005\u6a29\u9650\u7ba1\u7406"}),(0,du.jsx)(Od,{open:w,onClose:()=>S(!1),isAdmin:p,currentUserId:null===l||void 0===l?void 0:l.uid,roomOptions:b})]}),(0,du.jsx)("div",{className:"admin-functions"})]}),(0,du.jsx)("div",{className:"info-message",children:(0,du.jsx)("p",{children:"\u26a0\ufe0f \u6559\u5ba4\u4e88\u7d04\u6e08\u307f\u306e\u5834\u5408\u306f\u5148\u751f\u9593\u3067\u76f8\u8ac7\u3057\u5909\u66f4\u3057\u3066\u4e0b\u3055\u3044"})})]}):(0,du.jsx)("div",{className:"no-date-selected",children:(0,du.jsx)("p",{children:"\ud83d\udcc5 \u30ab\u30ec\u30f3\u30c0\u30fc\u304b\u3089\u65e5\u4ed8\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u4e88\u7d04\u3092\u7ba1\u7406\u3057\u3066\u304f\u3060\u3055\u3044"})}),c&&(0,du.jsx)("div",{className:"modal-overlay",onClick:()=>u(!1),children:(0,du.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,du.jsx)(Zu,{onAuthStateChange:d}),(0,du.jsx)("button",{className:"modal-close-btn",onClick:()=>u(!1),children:"\u2715"})]})}),E&&(0,du.jsx)("div",{className:"modal-overlay",onClick:()=>_(!1),children:(0,du.jsxs)("div",{className:"modal-content admin-manager-modal",onClick:e=>e.stopPropagation(),children:[(0,du.jsx)(Pd,{}),(0,du.jsx)("button",{className:"modal-close-btn",onClick:()=>_(!1),children:"\u2715"})]})})]});var L},Fd=e=>{var t;let{isOpen:n,reservationId:i,onClose:o,onReservationUpdated:a}=e;const[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(!1),[h,f]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),m=(0,r.useRef)(null),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(""),[S,E]=(0,r.useState)(""),_=(0,r.useCallback)(async()=>{if(!i)return;d(!0),f("");const e=setTimeout(()=>{d(!1),f("\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u304c\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002\u518d\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002")},1e4);try{const t=await lu.getReservationById(i);clearTimeout(e),t?(c(t),w(t.title||""),E(t.reservationName||"")):f("\u4e88\u7d04\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093")}catch(h){clearTimeout(e),console.error("\u4e88\u7d04\u53d6\u5f97\u30a8\u30e9\u30fc:",h),f("\u4e88\u7d04\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{d(!1)}},[i]);(0,r.useEffect)(()=>{n&&i?_():n||(c(null),d(!1),f(""),g(!1),y(!1))},[n,i,_]);const{isAdmin:C}=Vu(),x=(null===l||void 0===l?void 0:l.createdBy)&&(null===(t=Iu.getCurrentUser())||void 0===t?void 0:t.uid)===(null===l||void 0===l?void 0:l.createdBy),T=C||!0===x,I=C||!0===x;return(0,r.useEffect)(()=>{p&&m.current&&m.current.focus()},[p]),n?(0,du.jsx)("div",{className:"reservation-modal-overlay",children:(0,du.jsxs)("div",{className:"reservation-modal compact",children:[(0,du.jsxs)("div",{className:"reservation-modal-header",children:[(0,du.jsx)("h2",{children:"\u4e88\u7d04\u8a73\u7d30"}),(0,du.jsx)("button",{className:"close-button",onClick:o,disabled:u,title:"\u9589\u3058\u308b",children:"\u2715"})]}),(0,du.jsxs)("div",{className:"reservation-modal-body",children:[u&&(0,du.jsx)("div",{className:"loading-message",children:"\u8aad\u307f\u8fbc\u307f\u4e2d..."}),h&&(0,du.jsx)("div",{className:"error-message",children:h}),l&&(0,du.jsxs)("div",{className:"reservation-details details-grid",children:[(0,du.jsxs)("div",{className:"detail-item",children:[(0,du.jsx)("div",{className:"item-label",children:"\u65e5\u4ed8"}),(0,du.jsx)("div",{className:"item-value",children:(e=>{const t=e.toDate();return`${t.getFullYear()}/${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")} (${["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"][t.getDay()]})`})(l.startTime)})]}),(0,du.jsxs)("div",{className:"detail-item",children:[(0,du.jsx)("div",{className:"item-label",children:"\u6642\u9650"}),(0,du.jsx)("div",{className:"item-value",children:(e=>qc(e.period,e.periodName))(l)})]}),(0,du.jsxs)("div",{className:"detail-item",children:[(0,du.jsx)("div",{className:"item-label",children:"\u6559\u5ba4"}),(0,du.jsx)("div",{className:"item-value",children:l.roomName})]}),(0,du.jsxs)("div",{className:"detail-item",children:[(0,du.jsx)("div",{className:"item-label",children:"\u4e88\u7d04\u8005"}),(0,du.jsx)("div",{className:"item-value",children:v?(0,du.jsx)("input",{type:"text",value:S,onChange:e=>E(e.target.value),disabled:u,"aria-label":"\u4e88\u7d04\u8005\u540d\u3092\u7de8\u96c6",placeholder:"\u4e88\u7d04\u8005\u540d"}):l.reservationName})]}),(0,du.jsxs)("div",{className:"detail-item span-2",children:[(0,du.jsx)("div",{className:"item-label",children:"\u4e88\u7d04\u5185\u5bb9"}),(0,du.jsx)("div",{className:"item-value",children:v?(0,du.jsx)("input",{type:"text",value:b,onChange:e=>w(e.target.value),disabled:u,"aria-label":"\u4e88\u7d04\u5185\u5bb9\u3092\u7de8\u96c6",placeholder:"\u4e88\u7d04\u5185\u5bb9"}):l.title})]})]}),(0,du.jsxs)("div",{className:"reservation-actions "+(p?"confirm-mode":""),children:[I&&!p&&(v?(0,du.jsxs)("div",{className:"edit-inline",children:[(0,du.jsx)("button",{className:"confirm-edit-btn",onClick:async()=>{if(l&&l.id)try{d(!0);const e={title:b.trim(),reservationName:S.trim()};await lu.updateReservation(String(l.id),e),c({...l,...e}),y(!1),he.success("\u4e88\u7d04\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f"),setTimeout(()=>window.location.reload(),300)}catch(s){console.error("\u4e88\u7d04\u66f4\u65b0\u30a8\u30e9\u30fc:",s),f("\u4e88\u7d04\u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{d(!1)}},disabled:u||!b.trim()&&!S.trim(),children:"\u4fdd\u5b58"}),(0,du.jsx)("button",{className:"cancel-edit-btn",onClick:()=>{y(!1),w((null===l||void 0===l?void 0:l.title)||""),E((null===l||void 0===l?void 0:l.reservationName)||"")},disabled:u,children:"\u53d6\u6d88"})]}):(0,du.jsx)("button",{className:"edit-button",onClick:()=>y(!0),disabled:u,children:"\u270f\ufe0f \u7de8\u96c6"})),T&&!p&&(0,du.jsx)("button",{className:"delete-button",onClick:()=>g(!0),disabled:u,children:"\ud83d\uddd1\ufe0f \u4e88\u7d04\u3092\u524a\u9664"}),T&&p&&(0,du.jsxs)("div",{className:"delete-inline improved",role:"alertdialog","aria-label":"\u524a\u9664\u78ba\u8a8d",children:[(0,du.jsxs)("div",{className:"confirm-left",children:[(0,du.jsx)("span",{className:"confirm-text-strong",children:"\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"}),(0,du.jsx)("span",{className:"confirm-sub",children:"\u53d6\u308a\u6d88\u3057\u306f\u3067\u304d\u307e\u305b\u3093"})]}),(0,du.jsxs)("div",{className:"inline-buttons",children:[(0,du.jsx)("button",{ref:m,className:"confirm-delete-btn",onClick:async()=>{if(l&&l.id)try{d(!0),await lu.deleteReservationWithKnown(l),console.log("\u2705 \u4e88\u7d04\u524a\u9664\u6210\u529f"),he.success("\u4e88\u7d04\u3092\u524a\u9664\u3057\u307e\u3057\u305f"),o(),setTimeout(()=>window.location.reload(),300)}catch(h){console.error("\u274c \u4e88\u7d04\u524a\u9664\u30a8\u30e9\u30fc:",h);const t=h&&(h.message||h.code)||"";/quota/i.test(String(t))||/resource-exhausted/i.test(String(t))?f("\u901a\u4fe1\u304c\u6df7\u96d1\u3057\u3066\u3044\u307e\u3059\u3002\u5c11\u3057\u5f85\u3063\u3066\u304b\u3089\u518d\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002"):f("\u4e88\u7d04\u306e\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f")}finally{d(!1),g(!1)}},disabled:u,children:"\u78ba\u5b9a"}),(0,du.jsx)("button",{className:"cancel-delete-btn",onClick:()=>g(!1),disabled:u,children:"\u30ad\u30e3\u30f3\u30bb\u30eb"})]})]})]})]})]})}):null},Ud=e=>{let{date:t,open:n,onClose:i,onOpenSidePanel:s}=e;const o=(0,r.useRef)(null),a=(0,r.useRef)(null);return(0,r.useEffect)(()=>{var e,t;n?(a.current=document.activeElement,document.body.classList.add("no-scroll"),setTimeout(()=>{var e,t;null===(e=o.current)||void 0===e||null===(t=e.querySelector("[data-autofocus]"))||void 0===t||t.focus()},0)):(document.body.classList.remove("no-scroll"),null===(e=a.current)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e));return()=>{document.body.classList.remove("no-scroll")}},[n]),(0,r.useEffect)(()=>{if(!n)return;const e=e=>{if("Escape"===e.key)e.preventDefault(),i();else if("Tab"===e.key){var t;const n=null===(t=o.current)||void 0===t?void 0:t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!n||0===n.length)return;const r=Array.from(n).filter(e=>!e.hasAttribute("disabled")),i=r[0],s=r[r.length-1];e.shiftKey&&document.activeElement===i?(e.preventDefault(),s.focus()):e.shiftKey||document.activeElement!==s||(e.preventDefault(),i.focus())}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n,i]),n?(0,du.jsxs)("div",{className:"reservation-sheet-overlay",role:"dialog","aria-modal":"true","aria-labelledby":"reservationSheetTitle",children:[(0,du.jsxs)("div",{className:"reservation-sheet",ref:o,onClick:e=>e.stopPropagation(),children:[(0,du.jsx)("div",{className:"sheet-handle","aria-hidden":"true"}),(0,du.jsxs)("div",{className:"sheet-header",children:[(0,du.jsx)("span",{id:"reservationSheetTitle",children:"\ud83d\udccb \u4e88\u7d04\u72b6\u6cc1"}),(0,du.jsx)("button",{"data-autofocus":!0,onClick:i,"aria-label":"\u9589\u3058\u308b",className:"sheet-close-btn",children:"\u2715"})]}),(0,du.jsx)("div",{className:"sheet-content",children:t&&(0,du.jsx)(fu,{children:(0,du.jsx)(Bu,{date:t,children:(0,du.jsx)(Hu,{selectedDate:t,showWhenEmpty:!0})})})}),(0,du.jsx)("div",{className:"sheet-footer",children:(0,du.jsx)("button",{className:"sheet-action-btn",onClick:s,children:"\u3053\u306e\u65e5\u306e\u4e88\u7d04\u3092\u8ffd\u52a0\u30fb\u7de8\u96c6"})})]}),(0,du.jsx)("div",{className:"reservation-sheet-backdrop",onClick:i})]}):null},Bd=()=>{const{currentUser:e}=Vu(),[t,n]=(0,r.useState)((()=>{const e=new URLSearchParams(window.location.search).get("date");return e&&/^\d{4}-\d{2}-\d{2}$/.test(e)?e:""})()),[i,s]=(0,r.useState)(""),[o,a]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)(""),[m,v]=(0,r.useState)(""),y=(()=>{if("undefined"===typeof window)return!1;if("1"===new URLSearchParams(window.location.search).get("preview"))return!0;const e=window.location.pathname.replace(/\/+$/,"");return"/preview"===e||"/ux-preview"===e})();(0,r.useEffect)(()=>{if(t){const e=new URLSearchParams(window.location.search);e.set("date",t);const n=`${window.location.pathname}?${e.toString()}`;window.history.replaceState({},"",n)}},[t]);const b=(0,r.useCallback)(e=>{n(e)},[]),w=(0,r.useCallback)(e=>{n(e),a(!0)},[]),S=(0,r.useCallback)(e=>{s(e),c(!0)},[]),E=()=>{a(!1),n(""),s(""),g(""),v("")},_=(0,r.useCallback)(()=>{window.location.reload()},[]),C=(0,r.useCallback)((t,r,i)=>{e?(g(""),v(""),setTimeout(()=>{n(i),g(t),v(r),a(!0)},0)):he.error("\u4e88\u7d04\u6a5f\u80fd\u3092\u5229\u7528\u3059\u308b\u306b\u306f\u30ed\u30b0\u30a4\u30f3\u304c\u5fc5\u8981\u3067\u3059")},[e]),x=(0,r.useCallback)(e=>{console.log("\ud83d\udcc5 \u4e88\u7d04\u30af\u30ea\u30c3\u30af:",e),s(e),c(!0)},[]);return(0,du.jsxs)("div",{className:"main-app",children:[(0,du.jsx)(de,{position:"top-center",toastOptions:{duration:3e3,style:{background:"#fff",color:"#363636",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}}),(0,du.jsxs)("header",{className:"main-header",children:[(0,du.jsxs)("h1",{children:[(0,du.jsx)("img",{src:"/logo_clear.png",alt:"\u6821\u7ae0",className:"header-logo",width:32,height:32})," ","\u685c\u548c\u9ad8\u6821\u6559\u5ba4\u4e88\u7d04\u30b7\u30b9\u30c6\u30e0"]}),(0,du.jsxs)("div",{className:"header-info",children:[(0,du.jsxs)("div",{className:"system-info",children:["v",Ld]}),(0,du.jsx)("button",{className:"toggle-panel-button",onClick:()=>a(!o),children:o?"\ud83d\udccb \u30d1\u30cd\u30eb\u3092\u9589\u3058\u308b":"\ud83d\udccb \u4e88\u7d04\u7ba1\u7406"})]})]}),(0,du.jsxs)("main",{className:"main-content",children:[(0,du.jsx)("div",{className:"calendar-section",children:(0,du.jsx)(fu,{children:(0,du.jsx)($u,{selectedDate:t,filterMine:h,onFilterMineChange:f,onDateNavigate:b,onLedgerCellClick:C,onReservationClick:x,onDateClick:w,onEventClick:S})})}),o&&(0,du.jsxs)("aside",{className:"side-panel-section",children:[(0,du.jsx)("button",{className:"mobile-close-panel only-mobile",onClick:E,"aria-label":"\u30d1\u30cd\u30eb\u3092\u9589\u3058\u308b",children:"\u2190 \u30ab\u30ec\u30f3\u30c0\u30fc\u3078\u623b\u308b"}),(0,du.jsx)(fu,{children:(0,du.jsx)(Bu,{date:t,children:(0,du.jsx)(jd,{selectedDate:t,selectedEventId:i,onClose:E,onReservationCreated:_,prefilledRoomId:p,prefilledPeriod:m})})})]})]}),(0,du.jsx)("footer",{className:"main-footer",children:(0,du.jsx)("p",{children:"\xa9 2025 \u685c\u548c\u9ad8\u6821\u6559\u5ba4\u4e88\u7d04\u30b7\u30b9\u30c6\u30e0 (owa-cbs) - Developed by YUKI KONDO"})}),y&&(0,du.jsx)("button",{className:"fab only-mobile","aria-label":"\u4e88\u7d04\u3092\u8ffd\u52a0",onClick:()=>{t||n(vu()),a(!0)},title:"\u4e88\u7d04\u3092\u8ffd\u52a0",children:"\uff0b"}),(0,du.jsx)(Fd,{isOpen:l,reservationId:i,onClose:()=>{c(!1),s("")},onReservationUpdated:_}),(0,du.jsx)(Ud,{date:t,open:u,onClose:()=>d(!1),onOpenSidePanel:()=>{d(!1),a(!0)}})]})},zd=()=>(0,du.jsxs)("div",{children:[(0,du.jsx)("div",{className:"ux-preview-banner",children:(0,du.jsx)("strong",{children:"UX Preview"})}),(0,du.jsx)(Bd,{})]});const Vd=function(){const e=(()=>{if("undefined"===typeof window)return!1;if("1"===new URLSearchParams(window.location.search).get("preview"))return!0;const e=window.location.pathname.replace(/\/+$/,"");return"/preview"===e||"/ux-preview"===e})();return(0,du.jsx)("div",{className:"App",children:e?(0,du.jsx)(zd,{}):(0,du.jsx)(Bd,{})})},Hd=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)})};i.createRoot(document.getElementById("root")).render((0,du.jsx)(r.StrictMode,{children:(0,du.jsx)(Vd,{})})),Hd()})();
//# sourceMappingURL=main.503f9fbd.js.map